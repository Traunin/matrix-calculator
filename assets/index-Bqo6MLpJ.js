var Le=Object.defineProperty;var De=(e,t,r)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var we=(e,t,r)=>De(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function makeMap(e){const t=Object.create(null);for(const r of e.split(","))t[r]=1;return r=>r in t}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),isModelListener=e=>e.startsWith("onUpdate:"),extend=Object.assign,remove=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},hasOwnProperty$1=Object.prototype.hasOwnProperty,hasOwn=(e,t)=>hasOwnProperty$1.call(e,t),isArray$1=Array.isArray,isMap=e=>toTypeString(e)==="[object Map]",isSet=e=>toTypeString(e)==="[object Set]",isFunction=e=>typeof e=="function",isString=e=>typeof e=="string",isSymbol=e=>typeof e=="symbol",isObject$1=e=>e!==null&&typeof e=="object",isPromise=e=>(isObject$1(e)||isFunction(e))&&isFunction(e.then)&&isFunction(e.catch),objectToString=Object.prototype.toString,toTypeString=e=>objectToString.call(e),toRawType=e=>toTypeString(e).slice(8,-1),isPlainObject=e=>toTypeString(e)==="[object Object]",isIntegerKey=e=>isString(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(e=>e.replace(camelizeRE,(t,r)=>r?r.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(e=>e.replace(hyphenateRE,"-$1").toLowerCase()),capitalize=cacheStringFunction(e=>e.charAt(0).toUpperCase()+e.slice(1)),toHandlerKey=cacheStringFunction(e=>e?`on${capitalize(e)}`:""),hasChanged=(e,t)=>!Object.is(e,t),invokeArrayFns=(e,...t)=>{for(let r=0;r<e.length;r++)e[r](...t)},def=(e,t,r,n=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:n,value:r})},looseToNumber=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(e){if(isArray$1(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],s=isString(n)?parseStringStyle(n):normalizeStyle(n);if(s)for(const i in s)t[i]=s[i]}return t}else if(isString(e)||isObject$1(e))return e}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(e){const t={};return e.replace(styleCommentRE,"").split(listDelimiterRE).forEach(r=>{if(r){const n=r.split(propertyDelimiterRE);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function normalizeClass(e){let t="";if(isString(e))t=e;else if(isArray$1(e))for(let r=0;r<e.length;r++){const n=normalizeClass(e[r]);n&&(t+=n+" ")}else if(isObject$1(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(e){return!!e||e===""}const isRef$1=e=>!!(e&&e.__v_isRef===!0),toDisplayString=e=>isString(e)?e:e==null?"":isArray$1(e)||isObject$1(e)&&(e.toString===objectToString||!isFunction(e.toString))?isRef$1(e)?toDisplayString(e.value):JSON.stringify(e,replacer,2):String(e),replacer=(e,t)=>isRef$1(t)?replacer(e,t.value):isMap(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,s],i)=>(r[stringifySymbol(n,i)+" =>"]=s,r),{})}:isSet(t)?{[`Set(${t.size})`]:[...t.values()].map(r=>stringifySymbol(r))}:isSymbol(t)?stringifySymbol(t):isObject$1(t)&&!isArray$1(t)&&!isPlainObject(t)?String(t):t,stringifySymbol=(e,t="")=>{var r;return isSymbol(e)?`Symbol(${(r=e.description)!=null?r:t})`:e};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(t=!1){this.detached=t,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=activeEffectScope,!t&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].pause();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,r;if(this.scopes)for(t=0,r=this.scopes.length;t<r;t++)this.scopes[t].resume();for(t=0,r=this.effects.length;t<r;t++)this.effects[t].resume()}}run(t){if(this._active){const r=activeEffectScope;try{return activeEffectScope=this,t()}finally{activeEffectScope=r}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(t){if(this._active){this._active=!1;let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(this.effects.length=0,r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.cleanups.length=0,this.scopes){for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const s=this.parent.scopes.pop();s&&s!==this&&(this.parent.scopes[this.index]=s,s.index=this.index)}this.parent=void 0}}}function getCurrentScope(){return activeEffectScope}function onScopeDispose(e,t=!1){activeEffectScope&&activeEffectScope.cleanups.push(e)}let activeSub;const pausedQueueEffects=new WeakSet;class ReactiveEffect{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,activeEffectScope&&activeEffectScope.active&&activeEffectScope.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pausedQueueEffects.has(this)&&(pausedQueueEffects.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||batch(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);const t=activeSub,r=shouldTrack;activeSub=this,shouldTrack=!0;try{return this.fn()}finally{cleanupDeps(this),activeSub=t,shouldTrack=r,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)removeSub(t);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pausedQueueEffects.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}}let batchDepth=0,batchedSub,batchedComputed;function batch(e,t=!1){if(e.flags|=8,t){e.next=batchedComputed,batchedComputed=e;return}e.next=batchedSub,batchedSub=e}function startBatch(){batchDepth++}function endBatch(){if(--batchDepth>0)return;if(batchedComputed){let t=batchedComputed;for(batchedComputed=void 0;t;){const r=t.next;t.next=void 0,t.flags&=-9,t=r}}let e;for(;batchedSub;){let t=batchedSub;for(batchedSub=void 0;t;){const r=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(n){e||(e=n)}t=r}}if(e)throw e}function prepareDeps(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function cleanupDeps(e){let t,r=e.depsTail,n=r;for(;n;){const s=n.prevDep;n.version===-1?(n===r&&(r=s),removeSub(n),removeDep(n)):t=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=s}e.deps=t,e.depsTail=r}function isDirty(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(refreshComputed(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function refreshComputed(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===globalVersion))return;e.globalVersion=globalVersion;const t=e.dep;if(e.flags|=2,t.version>0&&!e.isSSR&&e.deps&&!isDirty(e)){e.flags&=-3;return}const r=activeSub,n=shouldTrack;activeSub=e,shouldTrack=!0;try{prepareDeps(e);const s=e.fn(e._value);(t.version===0||hasChanged(s,e._value))&&(e._value=s,t.version++)}catch(s){throw t.version++,s}finally{activeSub=r,shouldTrack=n,cleanupDeps(e),e.flags&=-3}}function removeSub(e,t=!1){const{dep:r,prevSub:n,nextSub:s}=e;if(n&&(n.nextSub=s,e.prevSub=void 0),s&&(s.prevSub=n,e.nextSub=void 0),r.subs===e&&(r.subs=n,!n&&r.computed)){r.computed.flags&=-5;for(let i=r.computed.deps;i;i=i.nextDep)removeSub(i,!0)}!t&&!--r.sc&&r.map&&r.map.delete(r.key)}function removeDep(e){const{prevDep:t,nextDep:r}=e;t&&(t.nextDep=r,e.prevDep=void 0),r&&(r.prevDep=t,e.nextDep=void 0)}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const e=trackStack.pop();shouldTrack=e===void 0?!0:e}function cleanupEffect(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const r=activeSub;activeSub=void 0;try{t()}finally{activeSub=r}}}let globalVersion=0;class Link{constructor(t,r){this.sub=t,this.dep=r,this.version=r.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dep{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(t){if(!activeSub||!shouldTrack||activeSub===this.computed)return;let r=this.activeLink;if(r===void 0||r.sub!==activeSub)r=this.activeLink=new Link(activeSub,this),activeSub.deps?(r.prevDep=activeSub.depsTail,activeSub.depsTail.nextDep=r,activeSub.depsTail=r):activeSub.deps=activeSub.depsTail=r,addSub(r);else if(r.version===-1&&(r.version=this.version,r.nextDep)){const n=r.nextDep;n.prevDep=r.prevDep,r.prevDep&&(r.prevDep.nextDep=n),r.prevDep=activeSub.depsTail,r.nextDep=void 0,activeSub.depsTail.nextDep=r,activeSub.depsTail=r,activeSub.deps===r&&(activeSub.deps=n)}return r}trigger(t){this.version++,globalVersion++,this.notify(t)}notify(t){startBatch();try{for(let r=this.subs;r;r=r.prevSub)r.sub.notify()&&r.sub.dep.notify()}finally{endBatch()}}}function addSub(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let n=t.deps;n;n=n.nextDep)addSub(n)}const r=e.dep.subs;r!==e&&(e.prevSub=r,r&&(r.nextSub=e)),e.dep.subs=e}}const targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol(""),ARRAY_ITERATE_KEY=Symbol("");function track(e,t,r){if(shouldTrack&&activeSub){let n=targetMap.get(e);n||targetMap.set(e,n=new Map);let s=n.get(r);s||(n.set(r,s=new Dep),s.map=n,s.key=r),s.track()}}function trigger(e,t,r,n,s,i){const a=targetMap.get(e);if(!a){globalVersion++;return}const l=u=>{u&&u.trigger()};if(startBatch(),t==="clear")a.forEach(l);else{const u=isArray$1(e),c=u&&isIntegerKey(r);if(u&&r==="length"){const f=Number(n);a.forEach((d,m)=>{(m==="length"||m===ARRAY_ITERATE_KEY||!isSymbol(m)&&m>=f)&&l(d)})}else switch((r!==void 0||a.has(void 0))&&l(a.get(r)),c&&l(a.get(ARRAY_ITERATE_KEY)),t){case"add":u?c&&l(a.get("length")):(l(a.get(ITERATE_KEY)),isMap(e)&&l(a.get(MAP_KEY_ITERATE_KEY)));break;case"delete":u||(l(a.get(ITERATE_KEY)),isMap(e)&&l(a.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(e)&&l(a.get(ITERATE_KEY));break}}endBatch()}function getDepFromReactive(e,t){const r=targetMap.get(e);return r&&r.get(t)}function reactiveReadArray(e){const t=toRaw(e);return t===e?t:(track(t,"iterate",ARRAY_ITERATE_KEY),isShallow(e)?t:t.map(toReactive))}function shallowReadArray(e){return track(e=toRaw(e),"iterate",ARRAY_ITERATE_KEY),e}const arrayInstrumentations={__proto__:null,[Symbol.iterator](){return iterator(this,Symbol.iterator,toReactive)},concat(...e){return reactiveReadArray(this).concat(...e.map(t=>isArray$1(t)?reactiveReadArray(t):t))},entries(){return iterator(this,"entries",e=>(e[1]=toReactive(e[1]),e))},every(e,t){return apply(this,"every",e,t,void 0,arguments)},filter(e,t){return apply(this,"filter",e,t,r=>r.map(toReactive),arguments)},find(e,t){return apply(this,"find",e,t,toReactive,arguments)},findIndex(e,t){return apply(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return apply(this,"findLast",e,t,toReactive,arguments)},findLastIndex(e,t){return apply(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return apply(this,"forEach",e,t,void 0,arguments)},includes(...e){return searchProxy(this,"includes",e)},indexOf(...e){return searchProxy(this,"indexOf",e)},join(e){return reactiveReadArray(this).join(e)},lastIndexOf(...e){return searchProxy(this,"lastIndexOf",e)},map(e,t){return apply(this,"map",e,t,void 0,arguments)},pop(){return noTracking(this,"pop")},push(...e){return noTracking(this,"push",e)},reduce(e,...t){return reduce(this,"reduce",e,t)},reduceRight(e,...t){return reduce(this,"reduceRight",e,t)},shift(){return noTracking(this,"shift")},some(e,t){return apply(this,"some",e,t,void 0,arguments)},splice(...e){return noTracking(this,"splice",e)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(e){return reactiveReadArray(this).toSorted(e)},toSpliced(...e){return reactiveReadArray(this).toSpliced(...e)},unshift(...e){return noTracking(this,"unshift",e)},values(){return iterator(this,"values",toReactive)}};function iterator(e,t,r){const n=shallowReadArray(e),s=n[t]();return n!==e&&!isShallow(e)&&(s._next=s.next,s.next=()=>{const i=s._next();return i.value&&(i.value=r(i.value)),i}),s}const arrayProto=Array.prototype;function apply(e,t,r,n,s,i){const a=shallowReadArray(e),l=a!==e&&!isShallow(e),u=a[t];if(u!==arrayProto[t]){const d=u.apply(e,i);return l?toReactive(d):d}let c=r;a!==e&&(l?c=function(d,m){return r.call(this,toReactive(d),m,e)}:r.length>2&&(c=function(d,m){return r.call(this,d,m,e)}));const f=u.call(a,c,n);return l&&s?s(f):f}function reduce(e,t,r,n){const s=shallowReadArray(e);let i=r;return s!==e&&(isShallow(e)?r.length>3&&(i=function(a,l,u){return r.call(this,a,l,u,e)}):i=function(a,l,u){return r.call(this,a,toReactive(l),u,e)}),s[t](i,...n)}function searchProxy(e,t,r){const n=toRaw(e);track(n,"iterate",ARRAY_ITERATE_KEY);const s=n[t](...r);return(s===-1||s===!1)&&isProxy(r[0])?(r[0]=toRaw(r[0]),n[t](...r)):s}function noTracking(e,t,r=[]){pauseTracking(),startBatch();const n=toRaw(e)[t].apply(e,r);return endBatch(),resetTracking(),n}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(isSymbol));function hasOwnProperty(e){isSymbol(e)||(e=String(e));const t=toRaw(this);return track(t,"has",e),t.hasOwnProperty(e)}class BaseReactiveHandler{constructor(t=!1,r=!1){this._isReadonly=t,this._isShallow=r}get(t,r,n){if(r==="__v_skip")return t.__v_skip;const s=this._isReadonly,i=this._isShallow;if(r==="__v_isReactive")return!s;if(r==="__v_isReadonly")return s;if(r==="__v_isShallow")return i;if(r==="__v_raw")return n===(s?i?shallowReadonlyMap:readonlyMap:i?shallowReactiveMap:reactiveMap).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(n)?t:void 0;const a=isArray$1(t);if(!s){let u;if(a&&(u=arrayInstrumentations[r]))return u;if(r==="hasOwnProperty")return hasOwnProperty}const l=Reflect.get(t,r,isRef(t)?t:n);return(isSymbol(r)?builtInSymbols.has(r):isNonTrackableKeys(r))||(s||track(t,"get",r),i)?l:isRef(l)?a&&isIntegerKey(r)?l:l.value:isObject$1(l)?s?readonly(l):reactive(l):l}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(t=!1){super(!1,t)}set(t,r,n,s){let i=t[r];if(!this._isShallow){const u=isReadonly(i);if(!isShallow(n)&&!isReadonly(n)&&(i=toRaw(i),n=toRaw(n)),!isArray$1(t)&&isRef(i)&&!isRef(n))return u?!1:(i.value=n,!0)}const a=isArray$1(t)&&isIntegerKey(r)?Number(r)<t.length:hasOwn(t,r),l=Reflect.set(t,r,n,isRef(t)?t:s);return t===toRaw(s)&&(a?hasChanged(n,i)&&trigger(t,"set",r,n):trigger(t,"add",r,n)),l}deleteProperty(t,r){const n=hasOwn(t,r);t[r];const s=Reflect.deleteProperty(t,r);return s&&n&&trigger(t,"delete",r,void 0),s}has(t,r){const n=Reflect.has(t,r);return(!isSymbol(r)||!builtInSymbols.has(r))&&track(t,"has",r),n}ownKeys(t){return track(t,"iterate",isArray$1(t)?"length":ITERATE_KEY),Reflect.ownKeys(t)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(t=!1){super(!0,t)}set(t,r){return!0}deleteProperty(t,r){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),shallowReadonlyHandlers=new ReadonlyReactiveHandler(!0),toShallow=e=>e,getProto=e=>Reflect.getPrototypeOf(e);function createIterableMethod(e,t,r){return function(...n){const s=this.__v_raw,i=toRaw(s),a=isMap(i),l=e==="entries"||e===Symbol.iterator&&a,u=e==="keys"&&a,c=s[e](...n),f=r?toShallow:t?toReadonly:toReactive;return!t&&track(i,"iterate",u?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:d,done:m}=c.next();return m?{value:d,done:m}:{value:l?[f(d[0]),f(d[1])]:f(d),done:m}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function createInstrumentations(e,t){const r={get(s){const i=this.__v_raw,a=toRaw(i),l=toRaw(s);e||(hasChanged(s,l)&&track(a,"get",s),track(a,"get",l));const{has:u}=getProto(a),c=t?toShallow:e?toReadonly:toReactive;if(u.call(a,s))return c(i.get(s));if(u.call(a,l))return c(i.get(l));i!==a&&i.get(s)},get size(){const s=this.__v_raw;return!e&&track(toRaw(s),"iterate",ITERATE_KEY),Reflect.get(s,"size",s)},has(s){const i=this.__v_raw,a=toRaw(i),l=toRaw(s);return e||(hasChanged(s,l)&&track(a,"has",s),track(a,"has",l)),s===l?i.has(s):i.has(s)||i.has(l)},forEach(s,i){const a=this,l=a.__v_raw,u=toRaw(l),c=t?toShallow:e?toReadonly:toReactive;return!e&&track(u,"iterate",ITERATE_KEY),l.forEach((f,d)=>s.call(i,c(f),c(d),a))}};return extend(r,e?{add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear")}:{add(s){!t&&!isShallow(s)&&!isReadonly(s)&&(s=toRaw(s));const i=toRaw(this);return getProto(i).has.call(i,s)||(i.add(s),trigger(i,"add",s,s)),this},set(s,i){!t&&!isShallow(i)&&!isReadonly(i)&&(i=toRaw(i));const a=toRaw(this),{has:l,get:u}=getProto(a);let c=l.call(a,s);c||(s=toRaw(s),c=l.call(a,s));const f=u.call(a,s);return a.set(s,i),c?hasChanged(i,f)&&trigger(a,"set",s,i):trigger(a,"add",s,i),this},delete(s){const i=toRaw(this),{has:a,get:l}=getProto(i);let u=a.call(i,s);u||(s=toRaw(s),u=a.call(i,s)),l&&l.call(i,s);const c=i.delete(s);return u&&trigger(i,"delete",s,void 0),c},clear(){const s=toRaw(this),i=s.size!==0,a=s.clear();return i&&trigger(s,"clear",void 0,void 0),a}}),["keys","values","entries",Symbol.iterator].forEach(s=>{r[s]=createIterableMethod(s,e,t)}),r}function createInstrumentationGetter(e,t){const r=createInstrumentations(e,t);return(n,s,i)=>s==="__v_isReactive"?!e:s==="__v_isReadonly"?e:s==="__v_raw"?n:Reflect.get(hasOwn(r,s)&&s in n?r:n,s,i)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},shallowReadonlyCollectionHandlers={get:createInstrumentationGetter(!0,!0)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(e){return e.__v_skip||!Object.isExtensible(e)?0:targetTypeMap(toRawType(e))}function reactive(e){return isReadonly(e)?e:createReactiveObject(e,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(e){return createReactiveObject(e,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(e){return createReactiveObject(e,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function shallowReadonly(e){return createReactiveObject(e,!0,shallowReadonlyHandlers,shallowReadonlyCollectionHandlers,shallowReadonlyMap)}function createReactiveObject(e,t,r,n,s){if(!isObject$1(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=s.get(e);if(i)return i;const a=getTargetType(e);if(a===0)return e;const l=new Proxy(e,a===2?n:r);return s.set(e,l),l}function isReactive(e){return isReadonly(e)?isReactive(e.__v_raw):!!(e&&e.__v_isReactive)}function isReadonly(e){return!!(e&&e.__v_isReadonly)}function isShallow(e){return!!(e&&e.__v_isShallow)}function isProxy(e){return e?!!e.__v_raw:!1}function toRaw(e){const t=e&&e.__v_raw;return t?toRaw(t):e}function markRaw(e){return!hasOwn(e,"__v_skip")&&Object.isExtensible(e)&&def(e,"__v_skip",!0),e}const toReactive=e=>isObject$1(e)?reactive(e):e,toReadonly=e=>isObject$1(e)?readonly(e):e;function isRef(e){return e?e.__v_isRef===!0:!1}function ref(e){return createRef(e,!1)}function shallowRef(e){return createRef(e,!0)}function createRef(e,t){return isRef(e)?e:new RefImpl(e,t)}class RefImpl{constructor(t,r){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=r?t:toRaw(t),this._value=r?t:toReactive(t),this.__v_isShallow=r}get value(){return this.dep.track(),this._value}set value(t){const r=this._rawValue,n=this.__v_isShallow||isShallow(t)||isReadonly(t);t=n?t:toRaw(t),hasChanged(t,r)&&(this._rawValue=t,this._value=n?t:toReactive(t),this.dep.trigger())}}function unref(e){return isRef(e)?e.value:e}function toValue(e){return isFunction(e)?e():unref(e)}const shallowUnwrapHandlers={get:(e,t,r)=>t==="__v_raw"?e:unref(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const s=e[t];return isRef(s)&&!isRef(r)?(s.value=r,!0):Reflect.set(e,t,r,n)}};function proxyRefs(e){return isReactive(e)?e:new Proxy(e,shallowUnwrapHandlers)}class CustomRefImpl{constructor(t){this.__v_isRef=!0,this._value=void 0;const r=this.dep=new Dep,{get:n,set:s}=t(r.track.bind(r),r.trigger.bind(r));this._get=n,this._set=s}get value(){return this._value=this._get()}set value(t){this._set(t)}}function customRef(e){return new CustomRefImpl(e)}class ObjectRefImpl{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0,this._value=void 0}get value(){const t=this._object[this._key];return this._value=t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}get dep(){return getDepFromReactive(toRaw(this._object),this._key)}}class GetterRefImpl{constructor(t){this._getter=t,this.__v_isRef=!0,this.__v_isReadonly=!0,this._value=void 0}get value(){return this._value=this._getter()}}function toRef$1(e,t,r){return isRef(e)?e:isFunction(e)?new GetterRefImpl(e):isObject$1(e)&&arguments.length>1?propertyToRef(e,t,r):ref(e)}function propertyToRef(e,t,r){const n=e[t];return isRef(n)?n:new ObjectRefImpl(e,t,r)}class ComputedRefImpl{constructor(t,r,n){this.fn=t,this.setter=r,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=globalVersion-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!r,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&activeSub!==this)return batch(this,!0),!0}get value(){const t=this.dep.track();return refreshComputed(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function computed$1(e,t,r=!1){let n,s;return isFunction(e)?n=e:(n=e.get,s=e.set),new ComputedRefImpl(n,s,r)}const INITIAL_WATCHER_VALUE={},cleanupMap=new WeakMap;let activeWatcher;function onWatcherCleanup(e,t=!1,r=activeWatcher){if(r){let n=cleanupMap.get(r);n||cleanupMap.set(r,n=[]),n.push(e)}}function watch$1(e,t,r=EMPTY_OBJ){const{immediate:n,deep:s,once:i,scheduler:a,augmentJob:l,call:u}=r,c=B=>s?B:isShallow(B)||s===!1||s===0?traverse(B,1):traverse(B);let f,d,m,g,S=!1,y=!1;if(isRef(e)?(d=()=>e.value,S=isShallow(e)):isReactive(e)?(d=()=>c(e),S=!0):isArray$1(e)?(y=!0,S=e.some(B=>isReactive(B)||isShallow(B)),d=()=>e.map(B=>{if(isRef(B))return B.value;if(isReactive(B))return c(B);if(isFunction(B))return u?u(B,2):B()})):isFunction(e)?t?d=u?()=>u(e,2):e:d=()=>{if(m){pauseTracking();try{m()}finally{resetTracking()}}const B=activeWatcher;activeWatcher=f;try{return u?u(e,3,[g]):e(g)}finally{activeWatcher=B}}:d=NOOP,t&&s){const B=d,H=s===!0?1/0:s;d=()=>traverse(B(),H)}const R=getCurrentScope(),w=()=>{f.stop(),R&&R.active&&remove(R.effects,f)};if(i&&t){const B=t;t=(...H)=>{B(...H),w()}}let P=y?new Array(e.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const C=B=>{if(!(!(f.flags&1)||!f.dirty&&!B))if(t){const H=f.run();if(s||S||(y?H.some((te,K)=>hasChanged(te,P[K])):hasChanged(H,P))){m&&m();const te=activeWatcher;activeWatcher=f;try{const K=[H,P===INITIAL_WATCHER_VALUE?void 0:y&&P[0]===INITIAL_WATCHER_VALUE?[]:P,g];u?u(t,3,K):t(...K),P=H}finally{activeWatcher=te}}}else f.run()};return l&&l(C),f=new ReactiveEffect(d),f.scheduler=a?()=>a(C,!1):C,g=B=>onWatcherCleanup(B,!1,f),m=f.onStop=()=>{const B=cleanupMap.get(f);if(B){if(u)u(B,4);else for(const H of B)H();cleanupMap.delete(f)}},t?n?C(!0):P=f.run():a?a(C.bind(null,!0),!0):f.run(),w.pause=f.pause.bind(f),w.resume=f.resume.bind(f),w.stop=w,w}function traverse(e,t=1/0,r){if(t<=0||!isObject$1(e)||e.__v_skip||(r=r||new Set,r.has(e)))return e;if(r.add(e),t--,isRef(e))traverse(e.value,t,r);else if(isArray$1(e))for(let n=0;n<e.length;n++)traverse(e[n],t,r);else if(isSet(e)||isMap(e))e.forEach(n=>{traverse(n,t,r)});else if(isPlainObject(e)){for(const n in e)traverse(e[n],t,r);for(const n of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,n)&&traverse(e[n],t,r)}return e}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack=[];let isWarning=!1;function warn$1(e,...t){if(isWarning)return;isWarning=!0,pauseTracking();const r=stack.length?stack[stack.length-1].component:null,n=r&&r.appContext.config.warnHandler,s=getComponentTrace();if(n)callWithErrorHandling(n,r,11,[e+t.map(i=>{var a,l;return(l=(a=i.toString)==null?void 0:a.call(i))!=null?l:JSON.stringify(i)}).join(""),r&&r.proxy,s.map(({vnode:i})=>`at <${formatComponentName(r,i.type)}>`).join(`
`),s]);else{const i=[`[Vue warn]: ${e}`,...t];s.length&&i.push(`
`,...formatTrace(s)),console.warn(...i)}resetTracking(),isWarning=!1}function getComponentTrace(){let e=stack[stack.length-1];if(!e)return[];const t=[];for(;e;){const r=t[0];r&&r.vnode===e?r.recurseCount++:t.push({vnode:e,recurseCount:0});const n=e.component&&e.component.parent;e=n&&n.vnode}return t}function formatTrace(e){const t=[];return e.forEach((r,n)=>{t.push(...n===0?[]:[`
`],...formatTraceEntry(r))}),t}function formatTraceEntry({vnode:e,recurseCount:t}){const r=t>0?`... (${t} recursive calls)`:"",n=e.component?e.component.parent==null:!1,s=` at <${formatComponentName(e.component,e.type,n)}`,i=">"+r;return e.props?[s,...formatProps(e.props),i]:[s+i]}function formatProps(e){const t=[],r=Object.keys(e);return r.slice(0,3).forEach(n=>{t.push(...formatProp(n,e[n]))}),r.length>3&&t.push(" ..."),t}function formatProp(e,t,r){return isString(t)?(t=JSON.stringify(t),r?t:[`${e}=${t}`]):typeof t=="number"||typeof t=="boolean"||t==null?r?t:[`${e}=${t}`]:isRef(t)?(t=formatProp(e,toRaw(t.value),!0),r?t:[`${e}=Ref<`,t,">"]):isFunction(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=toRaw(t),r?t:[`${e}=`,t])}function callWithErrorHandling(e,t,r,n){try{return n?e(...n):e()}catch(s){handleError(s,t,r)}}function callWithAsyncErrorHandling(e,t,r,n){if(isFunction(e)){const s=callWithErrorHandling(e,t,r,n);return s&&isPromise(s)&&s.catch(i=>{handleError(i,t,r)}),s}if(isArray$1(e)){const s=[];for(let i=0;i<e.length;i++)s.push(callWithAsyncErrorHandling(e[i],t,r,n));return s}}function handleError(e,t,r,n=!0){const s=t?t.vnode:null,{errorHandler:i,throwUnhandledErrorInProduction:a}=t&&t.appContext.config||EMPTY_OBJ;if(t){let l=t.parent;const u=t.proxy,c=`https://vuejs.org/error-reference/#runtime-${r}`;for(;l;){const f=l.ec;if(f){for(let d=0;d<f.length;d++)if(f[d](e,u,c)===!1)return}l=l.parent}if(i){pauseTracking(),callWithErrorHandling(i,null,10,[e,u,c]),resetTracking();return}}logError(e,r,s,n,a)}function logError(e,t,r,n=!0,s=!1){if(s)throw e;console.error(e)}const queue=[];let flushIndex=-1;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(e){const t=currentFlushPromise||resolvedPromise;return e?t.then(this?e.bind(this):e):t}function findInsertionIndex$1(e){let t=flushIndex+1,r=queue.length;for(;t<r;){const n=t+r>>>1,s=queue[n],i=getId(s);i<e||i===e&&s.flags&2?t=n+1:r=n}return t}function queueJob(e){if(!(e.flags&1)){const t=getId(e),r=queue[queue.length-1];!r||!(e.flags&2)&&t>=getId(r)?queue.push(e):queue.splice(findInsertionIndex$1(t),0,e),e.flags|=1,queueFlush()}}function queueFlush(){currentFlushPromise||(currentFlushPromise=resolvedPromise.then(flushJobs))}function queuePostFlushCb(e){isArray$1(e)?pendingPostFlushCbs.push(...e):activePostFlushCbs&&e.id===-1?activePostFlushCbs.splice(postFlushIndex+1,0,e):e.flags&1||(pendingPostFlushCbs.push(e),e.flags|=1),queueFlush()}function flushPreFlushCbs(e,t,r=flushIndex+1){for(;r<queue.length;r++){const n=queue[r];if(n&&n.flags&2){if(e&&n.id!==e.uid)continue;queue.splice(r,1),r--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function flushPostFlushCbs(e){if(pendingPostFlushCbs.length){const t=[...new Set(pendingPostFlushCbs)].sort((r,n)=>getId(r)-getId(n));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...t);return}for(activePostFlushCbs=t,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++){const r=activePostFlushCbs[postFlushIndex];r.flags&4&&(r.flags&=-2),r.flags&8||r(),r.flags&=-2}activePostFlushCbs=null,postFlushIndex=0}}const getId=e=>e.id==null?e.flags&2?-1:1/0:e.id;function flushJobs(e){try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const t=queue[flushIndex];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),callWithErrorHandling(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;flushIndex<queue.length;flushIndex++){const t=queue[flushIndex];t&&(t.flags&=-2)}flushIndex=-1,queue.length=0,flushPostFlushCbs(),currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(e){const t=currentRenderingInstance;return currentRenderingInstance=e,currentScopeId=e&&e.type.__scopeId||null,t}function withCtx(e,t=currentRenderingInstance,r){if(!t||e._n)return e;const n=(...s)=>{n._d&&setBlockTracking(-1);const i=setCurrentRenderingInstance(t);let a;try{a=e(...s)}finally{setCurrentRenderingInstance(i),n._d&&setBlockTracking(1)}return a};return n._n=!0,n._c=!0,n._d=!0,n}function withDirectives(e,t){if(currentRenderingInstance===null)return e;const r=getComponentPublicInstance(currentRenderingInstance),n=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[i,a,l,u=EMPTY_OBJ]=t[s];i&&(isFunction(i)&&(i={mounted:i,updated:i}),i.deep&&traverse(a),n.push({dir:i,instance:r,value:a,oldValue:void 0,arg:l,modifiers:u}))}return e}function invokeDirectiveHook(e,t,r,n){const s=e.dirs,i=t&&t.dirs;for(let a=0;a<s.length;a++){const l=s[a];i&&(l.oldValue=i[a].value);let u=l.dir[n];u&&(pauseTracking(),callWithAsyncErrorHandling(u,r,8,[e.el,l,e,t]),resetTracking())}}const TeleportEndKey=Symbol("_vte"),isTeleport=e=>e.__isTeleport;function setTransitionHooks(e,t){e.shapeFlag&6&&e.component?(e.transition=t,setTransitionHooks(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(e,t){return isFunction(e)?extend({name:e.name},t,{setup:e}):e}function markAsyncBoundary(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}function useTemplateRef(e){const t=getCurrentInstance(),r=shallowRef(null);if(t){const s=t.refs===EMPTY_OBJ?t.refs={}:t.refs;Object.defineProperty(s,e,{enumerable:!0,get:()=>r.value,set:i=>r.value=i})}return r}function setRef(e,t,r,n,s=!1){if(isArray$1(e)){e.forEach((S,y)=>setRef(S,t&&(isArray$1(t)?t[y]:t),r,n,s));return}if(isAsyncWrapper(n)&&!s){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&setRef(e,t,r,n.component.subTree);return}const i=n.shapeFlag&4?getComponentPublicInstance(n.component):n.el,a=s?null:i,{i:l,r:u}=e,c=t&&t.r,f=l.refs===EMPTY_OBJ?l.refs={}:l.refs,d=l.setupState,m=toRaw(d),g=d===EMPTY_OBJ?()=>!1:S=>hasOwn(m,S);if(c!=null&&c!==u&&(isString(c)?(f[c]=null,g(c)&&(d[c]=null)):isRef(c)&&(c.value=null)),isFunction(u))callWithErrorHandling(u,l,12,[a,f]);else{const S=isString(u),y=isRef(u);if(S||y){const R=()=>{if(e.f){const w=S?g(u)?d[u]:f[u]:u.value;s?isArray$1(w)&&remove(w,i):isArray$1(w)?w.includes(i)||w.push(i):S?(f[u]=[i],g(u)&&(d[u]=f[u])):(u.value=[i],e.k&&(f[e.k]=u.value))}else S?(f[u]=a,g(u)&&(d[u]=a)):y&&(u.value=a,e.k&&(f[e.k]=a))};a?(R.id=-1,queuePostRenderEffect(R,r)):R()}}}getGlobalThis().requestIdleCallback;getGlobalThis().cancelIdleCallback;const isAsyncWrapper=e=>!!e.type.__asyncLoader,isKeepAlive=e=>e.type.__isKeepAlive;function onActivated(e,t){registerKeepAliveHook(e,"a",t)}function onDeactivated(e,t){registerKeepAliveHook(e,"da",t)}function registerKeepAliveHook(e,t,r=currentInstance){const n=e.__wdc||(e.__wdc=()=>{let s=r;for(;s;){if(s.isDeactivated)return;s=s.parent}return e()});if(injectHook(t,n,r),r){let s=r.parent;for(;s&&s.parent;)isKeepAlive(s.parent.vnode)&&injectToKeepAliveRoot(n,t,r,s),s=s.parent}}function injectToKeepAliveRoot(e,t,r,n){const s=injectHook(t,e,n,!0);onUnmounted(()=>{remove(n[t],s)},r)}function injectHook(e,t,r=currentInstance,n=!1){if(r){const s=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...a)=>{pauseTracking();const l=setCurrentInstance(r),u=callWithAsyncErrorHandling(t,r,e,a);return l(),resetTracking(),u});return n?s.unshift(i):s.push(i),i}}const createHook=e=>(t,r=currentInstance)=>{(!isInSSRComponentSetup||e==="sp")&&injectHook(e,(...n)=>t(...n),r)},onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(e,t=currentInstance){injectHook("ec",e,t)}const COMPONENTS="components";function resolveComponent(e,t){return resolveAsset(COMPONENTS,e,!0,t)||e}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveAsset(e,t,r=!0,n=!1){const s=currentRenderingInstance||currentInstance;if(s){const i=s.type;{const l=getComponentName(i,!1);if(l&&(l===t||l===camelize(t)||l===capitalize(camelize(t))))return i}const a=resolve(s[e]||i[e],t)||resolve(s.appContext[e],t);return!a&&n?i:a}}function resolve(e,t){return e&&(e[t]||e[camelize(t)]||e[capitalize(camelize(t))])}function renderList(e,t,r,n){let s;const i=r,a=isArray$1(e);if(a||isString(e)){const l=a&&isReactive(e);let u=!1;l&&(u=!isShallow(e),e=shallowReadArray(e)),s=new Array(e.length);for(let c=0,f=e.length;c<f;c++)s[c]=t(u?toReactive(e[c]):e[c],c,void 0,i)}else if(typeof e=="number"){s=new Array(e);for(let l=0;l<e;l++)s[l]=t(l+1,l,void 0,i)}else if(isObject$1(e))if(e[Symbol.iterator])s=Array.from(e,(l,u)=>t(l,u,void 0,i));else{const l=Object.keys(e);s=new Array(l.length);for(let u=0,c=l.length;u<c;u++){const f=l[u];s[u]=t(e[f],f,u,i)}}else s=[];return s}const getPublicInstance=e=>e?isStatefulComponent(e)?getComponentPublicInstance(e):getPublicInstance(e.parent):null,publicPropertiesMap=extend(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>getPublicInstance(e.parent),$root:e=>getPublicInstance(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>resolveMergedOptions(e),$forceUpdate:e=>e.f||(e.f=()=>{queueJob(e.update)}),$nextTick:e=>e.n||(e.n=nextTick.bind(e.proxy)),$watch:e=>instanceWatch.bind(e)}),hasSetupBinding=(e,t)=>e!==EMPTY_OBJ&&!e.__isScriptSetup&&hasOwn(e,t),PublicInstanceProxyHandlers={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:r,setupState:n,data:s,props:i,accessCache:a,type:l,appContext:u}=e;let c;if(t[0]!=="$"){const g=a[t];if(g!==void 0)switch(g){case 1:return n[t];case 2:return s[t];case 4:return r[t];case 3:return i[t]}else{if(hasSetupBinding(n,t))return a[t]=1,n[t];if(s!==EMPTY_OBJ&&hasOwn(s,t))return a[t]=2,s[t];if((c=e.propsOptions[0])&&hasOwn(c,t))return a[t]=3,i[t];if(r!==EMPTY_OBJ&&hasOwn(r,t))return a[t]=4,r[t];shouldCacheAccess&&(a[t]=0)}}const f=publicPropertiesMap[t];let d,m;if(f)return t==="$attrs"&&track(e.attrs,"get",""),f(e);if((d=l.__cssModules)&&(d=d[t]))return d;if(r!==EMPTY_OBJ&&hasOwn(r,t))return a[t]=4,r[t];if(m=u.config.globalProperties,hasOwn(m,t))return m[t]},set({_:e},t,r){const{data:n,setupState:s,ctx:i}=e;return hasSetupBinding(s,t)?(s[t]=r,!0):n!==EMPTY_OBJ&&hasOwn(n,t)?(n[t]=r,!0):hasOwn(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:s,propsOptions:i}},a){let l;return!!r[a]||e!==EMPTY_OBJ&&hasOwn(e,a)||hasSetupBinding(t,a)||(l=i[0])&&hasOwn(l,a)||hasOwn(n,a)||hasOwn(publicPropertiesMap,a)||hasOwn(s.config.globalProperties,a)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:hasOwn(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};function normalizePropsOrEmits(e){return isArray$1(e)?e.reduce((t,r)=>(t[r]=null,t),{}):e}let shouldCacheAccess=!0;function applyOptions(e){const t=resolveMergedOptions(e),r=e.proxy,n=e.ctx;shouldCacheAccess=!1,t.beforeCreate&&callHook(t.beforeCreate,e,"bc");const{data:s,computed:i,methods:a,watch:l,provide:u,inject:c,created:f,beforeMount:d,mounted:m,beforeUpdate:g,updated:S,activated:y,deactivated:R,beforeDestroy:w,beforeUnmount:P,destroyed:C,unmounted:B,render:H,renderTracked:te,renderTriggered:K,errorCaptured:oe,serverPrefetch:re,expose:ae,inheritAttrs:J,components:ie,directives:ue,filters:fe}=t;if(c&&resolveInjections(c,n,null),a)for(const me in a){const de=a[me];isFunction(de)&&(n[me]=de.bind(r))}if(s){const me=s.call(r,r);isObject$1(me)&&(e.data=reactive(me))}if(shouldCacheAccess=!0,i)for(const me in i){const de=i[me],be=isFunction(de)?de.bind(r,r):isFunction(de.get)?de.get.bind(r,r):NOOP,ve=!isFunction(de)&&isFunction(de.set)?de.set.bind(r):NOOP,Ae=computed({get:be,set:ve});Object.defineProperty(n,me,{enumerable:!0,configurable:!0,get:()=>Ae.value,set:xe=>Ae.value=xe})}if(l)for(const me in l)createWatcher(l[me],n,r,me);if(u){const me=isFunction(u)?u.call(r):u;Reflect.ownKeys(me).forEach(de=>{provide(de,me[de])})}f&&callHook(f,e,"c");function _e(me,de){isArray$1(de)?de.forEach(be=>me(be.bind(r))):de&&me(de.bind(r))}if(_e(onBeforeMount,d),_e(onMounted,m),_e(onBeforeUpdate,g),_e(onUpdated,S),_e(onActivated,y),_e(onDeactivated,R),_e(onErrorCaptured,oe),_e(onRenderTracked,te),_e(onRenderTriggered,K),_e(onBeforeUnmount,P),_e(onUnmounted,B),_e(onServerPrefetch,re),isArray$1(ae))if(ae.length){const me=e.exposed||(e.exposed={});ae.forEach(de=>{Object.defineProperty(me,de,{get:()=>r[de],set:be=>r[de]=be})})}else e.exposed||(e.exposed={});H&&e.render===NOOP&&(e.render=H),J!=null&&(e.inheritAttrs=J),ie&&(e.components=ie),ue&&(e.directives=ue),re&&markAsyncBoundary(e)}function resolveInjections(e,t,r=NOOP){isArray$1(e)&&(e=normalizeInject(e));for(const n in e){const s=e[n];let i;isObject$1(s)?"default"in s?i=inject(s.from||n,s.default,!0):i=inject(s.from||n):i=inject(s),isRef(i)?Object.defineProperty(t,n,{enumerable:!0,configurable:!0,get:()=>i.value,set:a=>i.value=a}):t[n]=i}}function callHook(e,t,r){callWithAsyncErrorHandling(isArray$1(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function createWatcher(e,t,r,n){let s=n.includes(".")?createPathGetter(r,n):()=>r[n];if(isString(e)){const i=t[e];isFunction(i)&&watch(s,i)}else if(isFunction(e))watch(s,e.bind(r));else if(isObject$1(e))if(isArray$1(e))e.forEach(i=>createWatcher(i,t,r,n));else{const i=isFunction(e.handler)?e.handler.bind(r):t[e.handler];isFunction(i)&&watch(s,i,e)}}function resolveMergedOptions(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:s,optionsCache:i,config:{optionMergeStrategies:a}}=e.appContext,l=i.get(t);let u;return l?u=l:!s.length&&!r&&!n?u=t:(u={},s.length&&s.forEach(c=>mergeOptions$1(u,c,a,!0)),mergeOptions$1(u,t,a)),isObject$1(t)&&i.set(t,u),u}function mergeOptions$1(e,t,r,n=!1){const{mixins:s,extends:i}=t;i&&mergeOptions$1(e,i,r,!0),s&&s.forEach(a=>mergeOptions$1(e,a,r,!0));for(const a in t)if(!(n&&a==="expose")){const l=internalOptionMergeStrats[a]||r&&r[a];e[a]=l?l(e[a],t[a]):t[a]}return e}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(e,t){return t?e?function(){return extend(isFunction(e)?e.call(this,this):e,isFunction(t)?t.call(this,this):t)}:t:e}function mergeInject(e,t){return mergeObjectOptions(normalizeInject(e),normalizeInject(t))}function normalizeInject(e){if(isArray$1(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function mergeAsArray(e,t){return e?[...new Set([].concat(e,t))]:t}function mergeObjectOptions(e,t){return e?extend(Object.create(null),e,t):t}function mergeEmitsOrPropsOptions(e,t){return e?isArray$1(e)&&isArray$1(t)?[...new Set([...e,...t])]:extend(Object.create(null),normalizePropsOrEmits(e),normalizePropsOrEmits(t??{})):t}function mergeWatchOptions(e,t){if(!e)return t;if(!t)return e;const r=extend(Object.create(null),e);for(const n in t)r[n]=mergeAsArray(e[n],t[n]);return r}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(e,t){return function(n,s=null){isFunction(n)||(n=extend({},n)),s!=null&&!isObject$1(s)&&(s=null);const i=createAppContext(),a=new WeakSet,l=[];let u=!1;const c=i.app={_uid:uid$1++,_component:n,_props:s,_container:null,_context:i,_instance:null,version,get config(){return i.config},set config(f){},use(f,...d){return a.has(f)||(f&&isFunction(f.install)?(a.add(f),f.install(c,...d)):isFunction(f)&&(a.add(f),f(c,...d))),c},mixin(f){return i.mixins.includes(f)||i.mixins.push(f),c},component(f,d){return d?(i.components[f]=d,c):i.components[f]},directive(f,d){return d?(i.directives[f]=d,c):i.directives[f]},mount(f,d,m){if(!u){const g=c._ceVNode||createVNode(n,s);return g.appContext=i,m===!0?m="svg":m===!1&&(m=void 0),e(g,f,m),u=!0,c._container=f,f.__vue_app__=c,getComponentPublicInstance(g.component)}},onUnmount(f){l.push(f)},unmount(){u&&(callWithAsyncErrorHandling(l,c._instance,16),e(null,c._container),delete c._container.__vue_app__)},provide(f,d){return i.provides[f]=d,c},runWithContext(f){const d=currentApp;currentApp=c;try{return f()}finally{currentApp=d}}};return c}}let currentApp=null;function provide(e,t){if(currentInstance){let r=currentInstance.provides;const n=currentInstance.parent&&currentInstance.parent.provides;n===r&&(r=currentInstance.provides=Object.create(n)),r[e]=t}}function inject(e,t,r=!1){const n=currentInstance||currentRenderingInstance;if(n||currentApp){const s=currentApp?currentApp._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(s&&e in s)return s[e];if(arguments.length>1)return r&&isFunction(t)?t.call(n&&n.proxy):t}}function hasInjectionContext(){return!!(currentInstance||currentRenderingInstance||currentApp)}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=e=>Object.getPrototypeOf(e)===internalObjectProto;function initProps(e,t,r,n=!1){const s={},i=createInternalObject();e.propsDefaults=Object.create(null),setFullProps(e,t,s,i);for(const a in e.propsOptions[0])a in s||(s[a]=void 0);r?e.props=n?s:shallowReactive(s):e.type.props?e.props=s:e.props=i,e.attrs=i}function updateProps(e,t,r,n){const{props:s,attrs:i,vnode:{patchFlag:a}}=e,l=toRaw(s),[u]=e.propsOptions;let c=!1;if((n||a>0)&&!(a&16)){if(a&8){const f=e.vnode.dynamicProps;for(let d=0;d<f.length;d++){let m=f[d];if(isEmitListener(e.emitsOptions,m))continue;const g=t[m];if(u)if(hasOwn(i,m))g!==i[m]&&(i[m]=g,c=!0);else{const S=camelize(m);s[S]=resolvePropValue(u,l,S,g,e,!1)}else g!==i[m]&&(i[m]=g,c=!0)}}}else{setFullProps(e,t,s,i)&&(c=!0);let f;for(const d in l)(!t||!hasOwn(t,d)&&((f=hyphenate(d))===d||!hasOwn(t,f)))&&(u?r&&(r[d]!==void 0||r[f]!==void 0)&&(s[d]=resolvePropValue(u,l,d,void 0,e,!0)):delete s[d]);if(i!==l)for(const d in i)(!t||!hasOwn(t,d))&&(delete i[d],c=!0)}c&&trigger(e.attrs,"set","")}function setFullProps(e,t,r,n){const[s,i]=e.propsOptions;let a=!1,l;if(t)for(let u in t){if(isReservedProp(u))continue;const c=t[u];let f;s&&hasOwn(s,f=camelize(u))?!i||!i.includes(f)?r[f]=c:(l||(l={}))[f]=c:isEmitListener(e.emitsOptions,u)||(!(u in n)||c!==n[u])&&(n[u]=c,a=!0)}if(i){const u=toRaw(r),c=l||EMPTY_OBJ;for(let f=0;f<i.length;f++){const d=i[f];r[d]=resolvePropValue(s,u,d,c[d],e,!hasOwn(c,d))}}return a}function resolvePropValue(e,t,r,n,s,i){const a=e[r];if(a!=null){const l=hasOwn(a,"default");if(l&&n===void 0){const u=a.default;if(a.type!==Function&&!a.skipFactory&&isFunction(u)){const{propsDefaults:c}=s;if(r in c)n=c[r];else{const f=setCurrentInstance(s);n=c[r]=u.call(null,t),f()}}else n=u;s.ce&&s.ce._setProp(r,n)}a[0]&&(i&&!l?n=!1:a[1]&&(n===""||n===hyphenate(r))&&(n=!0))}return n}const mixinPropsCache=new WeakMap;function normalizePropsOptions(e,t,r=!1){const n=r?mixinPropsCache:t.propsCache,s=n.get(e);if(s)return s;const i=e.props,a={},l=[];let u=!1;if(!isFunction(e)){const f=d=>{u=!0;const[m,g]=normalizePropsOptions(d,t,!0);extend(a,m),g&&l.push(...g)};!r&&t.mixins.length&&t.mixins.forEach(f),e.extends&&f(e.extends),e.mixins&&e.mixins.forEach(f)}if(!i&&!u)return isObject$1(e)&&n.set(e,EMPTY_ARR),EMPTY_ARR;if(isArray$1(i))for(let f=0;f<i.length;f++){const d=camelize(i[f]);validatePropName(d)&&(a[d]=EMPTY_OBJ)}else if(i)for(const f in i){const d=camelize(f);if(validatePropName(d)){const m=i[f],g=a[d]=isArray$1(m)||isFunction(m)?{type:m}:extend({},m),S=g.type;let y=!1,R=!0;if(isArray$1(S))for(let w=0;w<S.length;++w){const P=S[w],C=isFunction(P)&&P.name;if(C==="Boolean"){y=!0;break}else C==="String"&&(R=!1)}else y=isFunction(S)&&S.name==="Boolean";g[0]=y,g[1]=R,(y||hasOwn(g,"default"))&&l.push(d)}}const c=[a,l];return isObject$1(e)&&n.set(e,c),c}function validatePropName(e){return e[0]!=="$"&&!isReservedProp(e)}const isInternalKey=e=>e[0]==="_"||e==="$stable",normalizeSlotValue=e=>isArray$1(e)?e.map(normalizeVNode):[normalizeVNode(e)],normalizeSlot$1=(e,t,r)=>{if(t._n)return t;const n=withCtx((...s)=>normalizeSlotValue(t(...s)),r);return n._c=!1,n},normalizeObjectSlots=(e,t,r)=>{const n=e._ctx;for(const s in e){if(isInternalKey(s))continue;const i=e[s];if(isFunction(i))t[s]=normalizeSlot$1(s,i,n);else if(i!=null){const a=normalizeSlotValue(i);t[s]=()=>a}}},normalizeVNodeSlots=(e,t)=>{const r=normalizeSlotValue(t);e.slots.default=()=>r},assignSlots=(e,t,r)=>{for(const n in t)(r||n!=="_")&&(e[n]=t[n])},initSlots=(e,t,r)=>{const n=e.slots=createInternalObject();if(e.vnode.shapeFlag&32){const s=t._;s?(assignSlots(n,t,r),r&&def(n,"_",s,!0)):normalizeObjectSlots(t,n)}else t&&normalizeVNodeSlots(e,t)},updateSlots=(e,t,r)=>{const{vnode:n,slots:s}=e;let i=!0,a=EMPTY_OBJ;if(n.shapeFlag&32){const l=t._;l?r&&l===1?i=!1:assignSlots(s,t,r):(i=!t.$stable,normalizeObjectSlots(t,s)),a=t}else t&&(normalizeVNodeSlots(e,t),a={default:1});if(i)for(const l in s)!isInternalKey(l)&&a[l]==null&&delete s[l]},queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(e){return baseCreateRenderer(e)}function baseCreateRenderer(e,t){const r=getGlobalThis();r.__VUE__=!0;const{insert:n,remove:s,patchProp:i,createElement:a,createText:l,createComment:u,setText:c,setElementText:f,parentNode:d,nextSibling:m,setScopeId:g=NOOP,insertStaticContent:S}=e,y=(v,A,k,q=null,j=null,F=null,I=void 0,ee=null,Q=!!A.dynamicChildren)=>{if(v===A)return;v&&!isSameVNodeType(v,A)&&(q=T(v),xe(v,j,F,!0),v=null),A.patchFlag===-2&&(Q=!1,A.dynamicChildren=null);const{type:W,ref:le,shapeFlag:ne}=A;switch(W){case Text:R(v,A,k,q);break;case Comment:w(v,A,k,q);break;case Static:v==null&&P(A,k,q,I);break;case Fragment:ie(v,A,k,q,j,F,I,ee,Q);break;default:ne&1?H(v,A,k,q,j,F,I,ee,Q):ne&6?ue(v,A,k,q,j,F,I,ee,Q):(ne&64||ne&128)&&W.process(v,A,k,q,j,F,I,ee,Q,se)}le!=null&&j&&setRef(le,v&&v.ref,F,A||v,!A)},R=(v,A,k,q)=>{if(v==null)n(A.el=l(A.children),k,q);else{const j=A.el=v.el;A.children!==v.children&&c(j,A.children)}},w=(v,A,k,q)=>{v==null?n(A.el=u(A.children||""),k,q):A.el=v.el},P=(v,A,k,q)=>{[v.el,v.anchor]=S(v.children,A,k,q,v.el,v.anchor)},C=({el:v,anchor:A},k,q)=>{let j;for(;v&&v!==A;)j=m(v),n(v,k,q),v=j;n(A,k,q)},B=({el:v,anchor:A})=>{let k;for(;v&&v!==A;)k=m(v),s(v),v=k;s(A)},H=(v,A,k,q,j,F,I,ee,Q)=>{A.type==="svg"?I="svg":A.type==="math"&&(I="mathml"),v==null?te(A,k,q,j,F,I,ee,Q):re(v,A,j,F,I,ee,Q)},te=(v,A,k,q,j,F,I,ee)=>{let Q,W;const{props:le,shapeFlag:ne,transition:X,dirs:ce}=v;if(Q=v.el=a(v.type,F,le&&le.is,le),ne&8?f(Q,v.children):ne&16&&oe(v.children,Q,null,q,j,resolveChildrenNamespace(v,F),I,ee),ce&&invokeDirectiveHook(v,null,q,"created"),K(Q,v,v.scopeId,I,q),le){for(const b in le)b!=="value"&&!isReservedProp(b)&&i(Q,b,null,le[b],F,q);"value"in le&&i(Q,"value",null,le.value,F),(W=le.onVnodeBeforeMount)&&invokeVNodeHook(W,q,v)}ce&&invokeDirectiveHook(v,null,q,"beforeMount");const _=needTransition(j,X);_&&X.beforeEnter(Q),n(Q,A,k),((W=le&&le.onVnodeMounted)||_||ce)&&queuePostRenderEffect(()=>{W&&invokeVNodeHook(W,q,v),_&&X.enter(Q),ce&&invokeDirectiveHook(v,null,q,"mounted")},j)},K=(v,A,k,q,j)=>{if(k&&g(v,k),q)for(let F=0;F<q.length;F++)g(v,q[F]);if(j){let F=j.subTree;if(A===F||isSuspense(F.type)&&(F.ssContent===A||F.ssFallback===A)){const I=j.vnode;K(v,I,I.scopeId,I.slotScopeIds,j.parent)}}},oe=(v,A,k,q,j,F,I,ee,Q=0)=>{for(let W=Q;W<v.length;W++){const le=v[W]=ee?cloneIfMounted(v[W]):normalizeVNode(v[W]);y(null,le,A,k,q,j,F,I,ee)}},re=(v,A,k,q,j,F,I)=>{const ee=A.el=v.el;let{patchFlag:Q,dynamicChildren:W,dirs:le}=A;Q|=v.patchFlag&16;const ne=v.props||EMPTY_OBJ,X=A.props||EMPTY_OBJ;let ce;if(k&&toggleRecurse(k,!1),(ce=X.onVnodeBeforeUpdate)&&invokeVNodeHook(ce,k,A,v),le&&invokeDirectiveHook(A,v,k,"beforeUpdate"),k&&toggleRecurse(k,!0),(ne.innerHTML&&X.innerHTML==null||ne.textContent&&X.textContent==null)&&f(ee,""),W?ae(v.dynamicChildren,W,ee,k,q,resolveChildrenNamespace(A,j),F):I||de(v,A,ee,null,k,q,resolveChildrenNamespace(A,j),F,!1),Q>0){if(Q&16)J(ee,ne,X,k,j);else if(Q&2&&ne.class!==X.class&&i(ee,"class",null,X.class,j),Q&4&&i(ee,"style",ne.style,X.style,j),Q&8){const _=A.dynamicProps;for(let b=0;b<_.length;b++){const x=_[b],O=ne[x],D=X[x];(D!==O||x==="value")&&i(ee,x,O,D,j,k)}}Q&1&&v.children!==A.children&&f(ee,A.children)}else!I&&W==null&&J(ee,ne,X,k,j);((ce=X.onVnodeUpdated)||le)&&queuePostRenderEffect(()=>{ce&&invokeVNodeHook(ce,k,A,v),le&&invokeDirectiveHook(A,v,k,"updated")},q)},ae=(v,A,k,q,j,F,I)=>{for(let ee=0;ee<A.length;ee++){const Q=v[ee],W=A[ee],le=Q.el&&(Q.type===Fragment||!isSameVNodeType(Q,W)||Q.shapeFlag&70)?d(Q.el):k;y(Q,W,le,null,q,j,F,I,!0)}},J=(v,A,k,q,j)=>{if(A!==k){if(A!==EMPTY_OBJ)for(const F in A)!isReservedProp(F)&&!(F in k)&&i(v,F,A[F],null,j,q);for(const F in k){if(isReservedProp(F))continue;const I=k[F],ee=A[F];I!==ee&&F!=="value"&&i(v,F,ee,I,j,q)}"value"in k&&i(v,"value",A.value,k.value,j)}},ie=(v,A,k,q,j,F,I,ee,Q)=>{const W=A.el=v?v.el:l(""),le=A.anchor=v?v.anchor:l("");let{patchFlag:ne,dynamicChildren:X,slotScopeIds:ce}=A;ce&&(ee=ee?ee.concat(ce):ce),v==null?(n(W,k,q),n(le,k,q),oe(A.children||[],k,le,j,F,I,ee,Q)):ne>0&&ne&64&&X&&v.dynamicChildren?(ae(v.dynamicChildren,X,k,j,F,I,ee),(A.key!=null||j&&A===j.subTree)&&traverseStaticChildren(v,A,!0)):de(v,A,k,le,j,F,I,ee,Q)},ue=(v,A,k,q,j,F,I,ee,Q)=>{A.slotScopeIds=ee,v==null?A.shapeFlag&512?j.ctx.activate(A,k,q,I,Q):fe(A,k,q,j,F,I,Q):Se(v,A,Q)},fe=(v,A,k,q,j,F,I)=>{const ee=v.component=createComponentInstance(v,q,j);if(isKeepAlive(v)&&(ee.ctx.renderer=se),setupComponent(ee,!1,I),ee.asyncDep){if(j&&j.registerDep(ee,_e,I),!v.el){const Q=ee.subTree=createVNode(Comment);w(null,Q,A,k)}}else _e(ee,v,A,k,j,F,I)},Se=(v,A,k)=>{const q=A.component=v.component;if(shouldUpdateComponent(v,A,k))if(q.asyncDep&&!q.asyncResolved){me(q,A,k);return}else q.next=A,q.update();else A.el=v.el,q.vnode=A},_e=(v,A,k,q,j,F,I)=>{const ee=()=>{if(v.isMounted){let{next:ne,bu:X,u:ce,parent:_,vnode:b}=v;{const G=locateNonHydratedAsyncRoot(v);if(G){ne&&(ne.el=b.el,me(v,ne,I)),G.asyncDep.then(()=>{v.isUnmounted||ee()});return}}let x=ne,O;toggleRecurse(v,!1),ne?(ne.el=b.el,me(v,ne,I)):ne=b,X&&invokeArrayFns(X),(O=ne.props&&ne.props.onVnodeBeforeUpdate)&&invokeVNodeHook(O,_,ne,b),toggleRecurse(v,!0);const D=renderComponentRoot(v),L=v.subTree;v.subTree=D,y(L,D,d(L.el),T(L),v,j,F),ne.el=D.el,x===null&&updateHOCHostEl(v,D.el),ce&&queuePostRenderEffect(ce,j),(O=ne.props&&ne.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(O,_,ne,b),j)}else{let ne;const{el:X,props:ce}=A,{bm:_,m:b,parent:x,root:O,type:D}=v,L=isAsyncWrapper(A);toggleRecurse(v,!1),_&&invokeArrayFns(_),!L&&(ne=ce&&ce.onVnodeBeforeMount)&&invokeVNodeHook(ne,x,A),toggleRecurse(v,!0);{O.ce&&O.ce._injectChildStyle(D);const G=v.subTree=renderComponentRoot(v);y(null,G,k,q,v,j,F),A.el=G.el}if(b&&queuePostRenderEffect(b,j),!L&&(ne=ce&&ce.onVnodeMounted)){const G=A;queuePostRenderEffect(()=>invokeVNodeHook(ne,x,G),j)}(A.shapeFlag&256||x&&isAsyncWrapper(x.vnode)&&x.vnode.shapeFlag&256)&&v.a&&queuePostRenderEffect(v.a,j),v.isMounted=!0,A=k=q=null}};v.scope.on();const Q=v.effect=new ReactiveEffect(ee);v.scope.off();const W=v.update=Q.run.bind(Q),le=v.job=Q.runIfDirty.bind(Q);le.i=v,le.id=v.uid,Q.scheduler=()=>queueJob(le),toggleRecurse(v,!0),W()},me=(v,A,k)=>{A.component=v;const q=v.vnode.props;v.vnode=A,v.next=null,updateProps(v,A.props,q,k),updateSlots(v,A.children,k),pauseTracking(),flushPreFlushCbs(v),resetTracking()},de=(v,A,k,q,j,F,I,ee,Q=!1)=>{const W=v&&v.children,le=v?v.shapeFlag:0,ne=A.children,{patchFlag:X,shapeFlag:ce}=A;if(X>0){if(X&128){ve(W,ne,k,q,j,F,I,ee,Q);return}else if(X&256){be(W,ne,k,q,j,F,I,ee,Q);return}}ce&8?(le&16&&Oe(W,j,F),ne!==W&&f(k,ne)):le&16?ce&16?ve(W,ne,k,q,j,F,I,ee,Q):Oe(W,j,F,!0):(le&8&&f(k,""),ce&16&&oe(ne,k,q,j,F,I,ee,Q))},be=(v,A,k,q,j,F,I,ee,Q)=>{v=v||EMPTY_ARR,A=A||EMPTY_ARR;const W=v.length,le=A.length,ne=Math.min(W,le);let X;for(X=0;X<ne;X++){const ce=A[X]=Q?cloneIfMounted(A[X]):normalizeVNode(A[X]);y(v[X],ce,k,null,j,F,I,ee,Q)}W>le?Oe(v,j,F,!0,!1,ne):oe(A,k,q,j,F,I,ee,Q,ne)},ve=(v,A,k,q,j,F,I,ee,Q)=>{let W=0;const le=A.length;let ne=v.length-1,X=le-1;for(;W<=ne&&W<=X;){const ce=v[W],_=A[W]=Q?cloneIfMounted(A[W]):normalizeVNode(A[W]);if(isSameVNodeType(ce,_))y(ce,_,k,null,j,F,I,ee,Q);else break;W++}for(;W<=ne&&W<=X;){const ce=v[ne],_=A[X]=Q?cloneIfMounted(A[X]):normalizeVNode(A[X]);if(isSameVNodeType(ce,_))y(ce,_,k,null,j,F,I,ee,Q);else break;ne--,X--}if(W>ne){if(W<=X){const ce=X+1,_=ce<le?A[ce].el:q;for(;W<=X;)y(null,A[W]=Q?cloneIfMounted(A[W]):normalizeVNode(A[W]),k,_,j,F,I,ee,Q),W++}}else if(W>X)for(;W<=ne;)xe(v[W],j,F,!0),W++;else{const ce=W,_=W,b=new Map;for(W=_;W<=X;W++){const pe=A[W]=Q?cloneIfMounted(A[W]):normalizeVNode(A[W]);pe.key!=null&&b.set(pe.key,W)}let x,O=0;const D=X-_+1;let L=!1,G=0;const V=new Array(D);for(W=0;W<D;W++)V[W]=0;for(W=ce;W<=ne;W++){const pe=v[W];if(O>=D){xe(pe,j,F,!0);continue}let he;if(pe.key!=null)he=b.get(pe.key);else for(x=_;x<=X;x++)if(V[x-_]===0&&isSameVNodeType(pe,A[x])){he=x;break}he===void 0?xe(pe,j,F,!0):(V[he-_]=W+1,he>=G?G=he:L=!0,y(pe,A[he],k,null,j,F,I,ee,Q),O++)}const Z=L?getSequence(V):EMPTY_ARR;for(x=Z.length-1,W=D-1;W>=0;W--){const pe=_+W,he=A[pe],ge=pe+1<le?A[pe+1].el:q;V[W]===0?y(null,he,k,ge,j,F,I,ee,Q):L&&(x<0||W!==Z[x]?Ae(he,k,ge,2):x--)}}},Ae=(v,A,k,q,j=null)=>{const{el:F,type:I,transition:ee,children:Q,shapeFlag:W}=v;if(W&6){Ae(v.component.subTree,A,k,q);return}if(W&128){v.suspense.move(A,k,q);return}if(W&64){I.move(v,A,k,se);return}if(I===Fragment){n(F,A,k);for(let ne=0;ne<Q.length;ne++)Ae(Q[ne],A,k,q);n(v.anchor,A,k);return}if(I===Static){C(v,A,k);return}if(q!==2&&W&1&&ee)if(q===0)ee.beforeEnter(F),n(F,A,k),queuePostRenderEffect(()=>ee.enter(F),j);else{const{leave:ne,delayLeave:X,afterLeave:ce}=ee,_=()=>n(F,A,k),b=()=>{ne(F,()=>{_(),ce&&ce()})};X?X(F,_,b):b()}else n(F,A,k)},xe=(v,A,k,q=!1,j=!1)=>{const{type:F,props:I,ref:ee,children:Q,dynamicChildren:W,shapeFlag:le,patchFlag:ne,dirs:X,cacheIndex:ce}=v;if(ne===-2&&(j=!1),ee!=null&&setRef(ee,null,k,v,!0),ce!=null&&(A.renderCache[ce]=void 0),le&256){A.ctx.deactivate(v);return}const _=le&1&&X,b=!isAsyncWrapper(v);let x;if(b&&(x=I&&I.onVnodeBeforeUnmount)&&invokeVNodeHook(x,A,v),le&6)Te(v.component,k,q);else{if(le&128){v.suspense.unmount(k,q);return}_&&invokeDirectiveHook(v,null,A,"beforeUnmount"),le&64?v.type.remove(v,A,k,se,q):W&&!W.hasOnce&&(F!==Fragment||ne>0&&ne&64)?Oe(W,A,k,!1,!0):(F===Fragment&&ne&384||!j&&le&16)&&Oe(Q,A,k),q&&Re(v)}(b&&(x=I&&I.onVnodeUnmounted)||_)&&queuePostRenderEffect(()=>{x&&invokeVNodeHook(x,A,v),_&&invokeDirectiveHook(v,null,A,"unmounted")},k)},Re=v=>{const{type:A,el:k,anchor:q,transition:j}=v;if(A===Fragment){Ee(k,q);return}if(A===Static){B(v);return}const F=()=>{s(k),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(v.shapeFlag&1&&j&&!j.persisted){const{leave:I,delayLeave:ee}=j,Q=()=>I(k,F);ee?ee(v.el,F,Q):Q()}else F()},Ee=(v,A)=>{let k;for(;v!==A;)k=m(v),s(v),v=k;s(A)},Te=(v,A,k)=>{const{bum:q,scope:j,job:F,subTree:I,um:ee,m:Q,a:W}=v;invalidateMount(Q),invalidateMount(W),q&&invokeArrayFns(q),j.stop(),F&&(F.flags|=8,xe(I,v,A,k)),ee&&queuePostRenderEffect(ee,A),queuePostRenderEffect(()=>{v.isUnmounted=!0},A),A&&A.pendingBranch&&!A.isUnmounted&&v.asyncDep&&!v.asyncResolved&&v.suspenseId===A.pendingId&&(A.deps--,A.deps===0&&A.resolve())},Oe=(v,A,k,q=!1,j=!1,F=0)=>{for(let I=F;I<v.length;I++)xe(v[I],A,k,q,j)},T=v=>{if(v.shapeFlag&6)return T(v.component.subTree);if(v.shapeFlag&128)return v.suspense.next();const A=m(v.anchor||v.el),k=A&&A[TeleportEndKey];return k?m(k):A};let z=!1;const Y=(v,A,k)=>{v==null?A._vnode&&xe(A._vnode,null,null,!0):y(A._vnode||null,v,A,null,null,null,k),A._vnode=v,z||(z=!0,flushPreFlushCbs(),flushPostFlushCbs(),z=!1)},se={p:y,um:xe,m:Ae,r:Re,mt:fe,mc:oe,pc:de,pbc:ae,n:T,o:e};return{render:Y,hydrate:void 0,createApp:createAppAPI(Y)}}function resolveChildrenNamespace({type:e,props:t},r){return r==="svg"&&e==="foreignObject"||r==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:r}function toggleRecurse({effect:e,job:t},r){r?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function needTransition(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function traverseStaticChildren(e,t,r=!1){const n=e.children,s=t.children;if(isArray$1(n)&&isArray$1(s))for(let i=0;i<n.length;i++){const a=n[i];let l=s[i];l.shapeFlag&1&&!l.dynamicChildren&&((l.patchFlag<=0||l.patchFlag===32)&&(l=s[i]=cloneIfMounted(s[i]),l.el=a.el),!r&&l.patchFlag!==-2&&traverseStaticChildren(a,l)),l.type===Text&&(l.el=a.el)}}function getSequence(e){const t=e.slice(),r=[0];let n,s,i,a,l;const u=e.length;for(n=0;n<u;n++){const c=e[n];if(c!==0){if(s=r[r.length-1],e[s]<c){t[n]=s,r.push(n);continue}for(i=0,a=r.length-1;i<a;)l=i+a>>1,e[r[l]]<c?i=l+1:a=l;c<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,a=r[i-1];i-- >0;)r[i]=a,a=t[a];return r}function locateNonHydratedAsyncRoot(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:locateNonHydratedAsyncRoot(t)}function invalidateMount(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject(ssrContextKey);function watchEffect(e,t){return doWatch(e,null,t)}function watch(e,t,r){return doWatch(e,t,r)}function doWatch(e,t,r=EMPTY_OBJ){const{immediate:n,deep:s,flush:i,once:a}=r,l=extend({},r),u=t&&n||!t&&i!=="post";let c;if(isInSSRComponentSetup){if(i==="sync"){const g=useSSRContext();c=g.__watcherHandles||(g.__watcherHandles=[])}else if(!u){const g=()=>{};return g.stop=NOOP,g.resume=NOOP,g.pause=NOOP,g}}const f=currentInstance;l.call=(g,S,y)=>callWithAsyncErrorHandling(g,f,S,y);let d=!1;i==="post"?l.scheduler=g=>{queuePostRenderEffect(g,f&&f.suspense)}:i!=="sync"&&(d=!0,l.scheduler=(g,S)=>{S?g():queueJob(g)}),l.augmentJob=g=>{t&&(g.flags|=4),d&&(g.flags|=2,f&&(g.id=f.uid,g.i=f))};const m=watch$1(e,t,l);return isInSSRComponentSetup&&(c?c.push(m):u&&m()),m}function instanceWatch(e,t,r){const n=this.proxy,s=isString(e)?e.includes(".")?createPathGetter(n,e):()=>n[e]:e.bind(n,n);let i;isFunction(t)?i=t:(i=t.handler,r=t);const a=setCurrentInstance(this),l=doWatch(s,i.bind(n),r);return a(),l}function createPathGetter(e,t){const r=t.split(".");return()=>{let n=e;for(let s=0;s<r.length&&n;s++)n=n[r[s]];return n}}const getModelModifiers=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${camelize(t)}Modifiers`]||e[`${hyphenate(t)}Modifiers`];function emit(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||EMPTY_OBJ;let s=r;const i=t.startsWith("update:"),a=i&&getModelModifiers(n,t.slice(7));a&&(a.trim&&(s=r.map(f=>isString(f)?f.trim():f)),a.number&&(s=r.map(looseToNumber)));let l,u=n[l=toHandlerKey(t)]||n[l=toHandlerKey(camelize(t))];!u&&i&&(u=n[l=toHandlerKey(hyphenate(t))]),u&&callWithAsyncErrorHandling(u,e,6,s);const c=n[l+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[l])return;e.emitted[l]=!0,callWithAsyncErrorHandling(c,e,6,s)}}function normalizeEmitsOptions(e,t,r=!1){const n=t.emitsCache,s=n.get(e);if(s!==void 0)return s;const i=e.emits;let a={},l=!1;if(!isFunction(e)){const u=c=>{const f=normalizeEmitsOptions(c,t,!0);f&&(l=!0,extend(a,f))};!r&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!i&&!l?(isObject$1(e)&&n.set(e,null),null):(isArray$1(i)?i.forEach(u=>a[u]=null):extend(a,i),isObject$1(e)&&n.set(e,a),a)}function isEmitListener(e,t){return!e||!isOn(t)?!1:(t=t.slice(2).replace(/Once$/,""),hasOwn(e,t[0].toLowerCase()+t.slice(1))||hasOwn(e,hyphenate(t))||hasOwn(e,t))}function markAttrsAccessed(){}function renderComponentRoot(e){const{type:t,vnode:r,proxy:n,withProxy:s,propsOptions:[i],slots:a,attrs:l,emit:u,render:c,renderCache:f,props:d,data:m,setupState:g,ctx:S,inheritAttrs:y}=e,R=setCurrentRenderingInstance(e);let w,P;try{if(r.shapeFlag&4){const B=s||n,H=B;w=normalizeVNode(c.call(H,B,f,d,g,m,S)),P=l}else{const B=t;w=normalizeVNode(B.length>1?B(d,{attrs:l,slots:a,emit:u}):B(d,null)),P=t.props?l:getFunctionalFallthrough(l)}}catch(B){blockStack.length=0,handleError(B,e,1),w=createVNode(Comment)}let C=w;if(P&&y!==!1){const B=Object.keys(P),{shapeFlag:H}=C;B.length&&H&7&&(i&&B.some(isModelListener)&&(P=filterModelListeners(P,i)),C=cloneVNode(C,P,!1,!0))}return r.dirs&&(C=cloneVNode(C,null,!1,!0),C.dirs=C.dirs?C.dirs.concat(r.dirs):r.dirs),r.transition&&setTransitionHooks(C,r.transition),w=C,setCurrentRenderingInstance(R),w}const getFunctionalFallthrough=e=>{let t;for(const r in e)(r==="class"||r==="style"||isOn(r))&&((t||(t={}))[r]=e[r]);return t},filterModelListeners=(e,t)=>{const r={};for(const n in e)(!isModelListener(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function shouldUpdateComponent(e,t,r){const{props:n,children:s,component:i}=e,{props:a,children:l,patchFlag:u}=t,c=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&u>=0){if(u&1024)return!0;if(u&16)return n?hasPropsChanged(n,a,c):!!a;if(u&8){const f=t.dynamicProps;for(let d=0;d<f.length;d++){const m=f[d];if(a[m]!==n[m]&&!isEmitListener(c,m))return!0}}}else return(s||l)&&(!l||!l.$stable)?!0:n===a?!1:n?a?hasPropsChanged(n,a,c):!0:!!a;return!1}function hasPropsChanged(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let s=0;s<n.length;s++){const i=n[s];if(t[i]!==e[i]&&!isEmitListener(r,i))return!0}return!1}function updateHOCHostEl({vnode:e,parent:t},r){for(;t;){const n=t.subTree;if(n.suspense&&n.suspense.activeBranch===e&&(n.el=e.el),n===e)(e=t.vnode).el=r,t=t.parent;else break}}const isSuspense=e=>e.__isSuspense;function queueEffectWithSuspense(e,t){t&&t.pendingBranch?isArray$1(e)?t.effects.push(...e):t.effects.push(e):queuePostFlushCb(e)}const Fragment=Symbol.for("v-fgt"),Text=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(e=!1){blockStack.push(currentBlock=e?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(e,t=!1){isBlockTreeEnabled+=e,e<0&&currentBlock&&t&&(currentBlock.hasOnce=!0)}function setupBlock(e){return e.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(e),e}function createElementBlock(e,t,r,n,s,i){return setupBlock(createBaseVNode(e,t,r,n,s,i,!0))}function createBlock(e,t,r,n,s){return setupBlock(createVNode(e,t,r,n,s,!0))}function isVNode(e){return e?e.__v_isVNode===!0:!1}function isSameVNodeType(e,t){return e.type===t.type&&e.key===t.key}const normalizeKey=({key:e})=>e??null,normalizeRef=({ref:e,ref_key:t,ref_for:r})=>(typeof e=="number"&&(e=""+e),e!=null?isString(e)||isRef(e)||isFunction(e)?{i:currentRenderingInstance,r:e,k:t,f:!!r}:e:null);function createBaseVNode(e,t=null,r=null,n=0,s=null,i=e===Fragment?0:1,a=!1,l=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&normalizeKey(t),ref:t&&normalizeRef(t),scopeId:currentScopeId,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:s,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return l?(normalizeChildren(u,r),i&128&&e.normalize(u)):r&&(u.shapeFlag|=isString(r)?8:16),isBlockTreeEnabled>0&&!a&&currentBlock&&(u.patchFlag>0||i&6)&&u.patchFlag!==32&&currentBlock.push(u),u}const createVNode=_createVNode;function _createVNode(e,t=null,r=null,n=0,s=null,i=!1){if((!e||e===NULL_DYNAMIC_COMPONENT)&&(e=Comment),isVNode(e)){const l=cloneVNode(e,t,!0);return r&&normalizeChildren(l,r),isBlockTreeEnabled>0&&!i&&currentBlock&&(l.shapeFlag&6?currentBlock[currentBlock.indexOf(e)]=l:currentBlock.push(l)),l.patchFlag=-2,l}if(isClassComponent(e)&&(e=e.__vccOpts),t){t=guardReactiveProps(t);let{class:l,style:u}=t;l&&!isString(l)&&(t.class=normalizeClass(l)),isObject$1(u)&&(isProxy(u)&&!isArray$1(u)&&(u=extend({},u)),t.style=normalizeStyle(u))}const a=isString(e)?1:isSuspense(e)?128:isTeleport(e)?64:isObject$1(e)?4:isFunction(e)?2:0;return createBaseVNode(e,t,r,n,s,a,i,!0)}function guardReactiveProps(e){return e?isProxy(e)||isInternalObject(e)?extend({},e):e:null}function cloneVNode(e,t,r=!1,n=!1){const{props:s,ref:i,patchFlag:a,children:l,transition:u}=e,c=t?mergeProps(s||{},t):s,f={__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&normalizeKey(c),ref:t&&t.ref?r&&i?isArray$1(i)?i.concat(normalizeRef(t)):[i,normalizeRef(t)]:normalizeRef(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:l,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Fragment?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&cloneVNode(e.ssContent),ssFallback:e.ssFallback&&cloneVNode(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&n&&setTransitionHooks(f,u.clone(f)),f}function createTextVNode(e=" ",t=0){return createVNode(Text,null,e,t)}function createCommentVNode(e="",t=!1){return t?(openBlock(),createBlock(Comment,null,e)):createVNode(Comment,null,e)}function normalizeVNode(e){return e==null||typeof e=="boolean"?createVNode(Comment):isArray$1(e)?createVNode(Fragment,null,e.slice()):isVNode(e)?cloneIfMounted(e):createVNode(Text,null,String(e))}function cloneIfMounted(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:cloneVNode(e)}function normalizeChildren(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(isArray$1(t))r=16;else if(typeof t=="object")if(n&65){const s=t.default;s&&(s._c&&(s._d=!1),normalizeChildren(e,s()),s._c&&(s._d=!0));return}else{r=32;const s=t._;!s&&!isInternalObject(t)?t._ctx=currentRenderingInstance:s===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else isFunction(t)?(t={default:t,_ctx:currentRenderingInstance},r=32):(t=String(t),n&64?(r=16,t=[createTextVNode(t)]):r=8);e.children=t,e.shapeFlag|=r}function mergeProps(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const s in n)if(s==="class")t.class!==n.class&&(t.class=normalizeClass([t.class,n.class]));else if(s==="style")t.style=normalizeStyle([t.style,n.style]);else if(isOn(s)){const i=t[s],a=n[s];a&&i!==a&&!(isArray$1(i)&&i.includes(a))&&(t[s]=i?[].concat(i,a):a)}else s!==""&&(t[s]=n[s])}return t}function invokeVNodeHook(e,t,r,n=null){callWithAsyncErrorHandling(e,t,7,[r,n])}const emptyAppContext=createAppContext();let uid$2=0;function createComponentInstance(e,t,r){const n=e.type,s=(t?t.appContext:e.appContext)||emptyAppContext,i={uid:uid$2++,vnode:e,type:n,parent:t,appContext:s,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(s.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(n,s),emitsOptions:normalizeEmitsOptions(n,s),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=emit.bind(null,i),e.ce&&e.ce(i),i}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const e=getGlobalThis(),t=(r,n)=>{let s;return(s=e[r])||(s=e[r]=[]),s.push(n),i=>{s.length>1?s.forEach(a=>a(i)):s[0](i)}};internalSetCurrentInstance=t("__VUE_INSTANCE_SETTERS__",r=>currentInstance=r),setInSSRSetupState=t("__VUE_SSR_SETTERS__",r=>isInSSRComponentSetup=r)}const setCurrentInstance=e=>{const t=currentInstance;return internalSetCurrentInstance(e),e.scope.on(),()=>{e.scope.off(),internalSetCurrentInstance(t)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(e){return e.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(e,t=!1,r=!1){t&&setInSSRSetupState(t);const{props:n,children:s}=e.vnode,i=isStatefulComponent(e);initProps(e,n,i,t),initSlots(e,s,r);const a=i?setupStatefulComponent(e,t):void 0;return t&&setInSSRSetupState(!1),a}function setupStatefulComponent(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,PublicInstanceProxyHandlers);const{setup:n}=r;if(n){pauseTracking();const s=e.setupContext=n.length>1?createSetupContext(e):null,i=setCurrentInstance(e),a=callWithErrorHandling(n,e,0,[e.props,s]),l=isPromise(a);if(resetTracking(),i(),(l||e.sp)&&!isAsyncWrapper(e)&&markAsyncBoundary(e),l){if(a.then(unsetCurrentInstance,unsetCurrentInstance),t)return a.then(u=>{handleSetupResult(e,u)}).catch(u=>{handleError(u,e,0)});e.asyncDep=a}else handleSetupResult(e,a)}else finishComponentSetup(e)}function handleSetupResult(e,t,r){isFunction(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:isObject$1(t)&&(e.setupState=proxyRefs(t)),finishComponentSetup(e)}function finishComponentSetup(e,t,r){const n=e.type;e.render||(e.render=n.render||NOOP);{const s=setCurrentInstance(e);pauseTracking();try{applyOptions(e)}finally{resetTracking(),s()}}}const attrsProxyHandlers={get(e,t){return track(e,"get",""),e[t]}};function createSetupContext(e){const t=r=>{e.exposed=r||{}};return{attrs:new Proxy(e.attrs,attrsProxyHandlers),slots:e.slots,emit:e.emit,expose:t}}function getComponentPublicInstance(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(proxyRefs(markRaw(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in publicPropertiesMap)return publicPropertiesMap[r](e)},has(t,r){return r in t||r in publicPropertiesMap}})):e.proxy}const classifyRE=/(?:^|[-_])(\w)/g,classify=e=>e.replace(classifyRE,t=>t.toUpperCase()).replace(/[-_]/g,"");function getComponentName(e,t=!0){return isFunction(e)?e.displayName||e.name:e.name||t&&e.__name}function formatComponentName(e,t,r=!1){let n=getComponentName(t);if(!n&&t.__file){const s=t.__file.match(/([^/\\]+)\.\w+$/);s&&(n=s[1])}if(!n&&e&&e.parent){const s=i=>{for(const a in i)if(i[a]===t)return a};n=s(e.components||e.parent.type.components)||s(e.appContext.components)}return n?classify(n):r?"App":"Anonymous"}function isClassComponent(e){return isFunction(e)&&"__vccOpts"in e}const computed=(e,t)=>computed$1(e,t,isInSSRComponentSetup);function h(e,t,r){const n=arguments.length;return n===2?isObject$1(t)&&!isArray$1(t)?isVNode(t)?createVNode(e,null,[t]):createVNode(e,t):createVNode(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&isVNode(r)&&(r=[r]),createVNode(e,t,r))}const version="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let policy;const tt=typeof window<"u"&&window.trustedTypes;if(tt)try{policy=tt.createPolicy("vue",{createHTML:e=>e})}catch{}const unsafeToTrustedHTML=policy?e=>policy.createHTML(e):e=>e,svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const s=t==="svg"?doc.createElementNS(svgNS,e):t==="mathml"?doc.createElementNS(mathmlNS,e):r?doc.createElement(e,{is:r}):doc.createElement(e);return e==="select"&&n&&n.multiple!=null&&s.setAttribute("multiple",n.multiple),s},createText:e=>doc.createTextNode(e),createComment:e=>doc.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>doc.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,r,n,s,i){const a=r?r.previousSibling:t.lastChild;if(s&&(s===i||s.nextSibling))for(;t.insertBefore(s.cloneNode(!0),r),!(s===i||!(s=s.nextSibling)););else{templateContainer.innerHTML=unsafeToTrustedHTML(n==="svg"?`<svg>${e}</svg>`:n==="mathml"?`<math>${e}</math>`:e);const l=templateContainer.content;if(n==="svg"||n==="mathml"){const u=l.firstChild;for(;u.firstChild;)l.appendChild(u.firstChild);l.removeChild(u)}t.insertBefore(l,r)}return[a?a.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}},vtcKey=Symbol("_vtc");function patchClass(e,t,r){const n=e[vtcKey];n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(e,{value:t},{transition:r}){e[vShowOriginalDisplay]=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):setDisplay(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),setDisplay(e,!0),n.enter(e)):n.leave(e,()=>{setDisplay(e,!1)}):setDisplay(e,t))},beforeUnmount(e,{value:t}){setDisplay(e,t)}};function setDisplay(e,t){e.style.display=t?e[vShowOriginalDisplay]:"none",e[vShowHidden]=!t}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(e,t,r){const n=e.style,s=isString(r);let i=!1;if(r&&!s){if(t)if(isString(t))for(const a of t.split(";")){const l=a.slice(0,a.indexOf(":")).trim();r[l]==null&&setStyle(n,l,"")}else for(const a in t)r[a]==null&&setStyle(n,a,"");for(const a in r)a==="display"&&(i=!0),setStyle(n,a,r[a])}else if(s){if(t!==r){const a=n[CSS_VAR_TEXT];a&&(r+=";"+a),n.cssText=r,i=displayRE.test(r)}}else t&&e.removeAttribute("style");vShowOriginalDisplay in e&&(e[vShowOriginalDisplay]=i?n.display:"",e[vShowHidden]&&(n.display="none"))}const importantRE=/\s*!important$/;function setStyle(e,t,r){if(isArray$1(r))r.forEach(n=>setStyle(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=autoPrefix(e,t);importantRE.test(r)?e.setProperty(hyphenate(n),r.replace(importantRE,""),"important"):e[n]=r}}const prefixes=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(e,t){const r=prefixCache[t];if(r)return r;let n=camelize(t);if(n!=="filter"&&n in e)return prefixCache[t]=n;n=capitalize(n);for(let s=0;s<prefixes.length;s++){const i=prefixes[s]+n;if(i in e)return prefixCache[t]=i}return t}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(e,t,r,n,s,i=isSpecialBooleanAttr(t)){n&&t.startsWith("xlink:")?r==null?e.removeAttributeNS(xlinkNS,t.slice(6,t.length)):e.setAttributeNS(xlinkNS,t,r):r==null||i&&!includeBooleanAttr(r)?e.removeAttribute(t):e.setAttribute(t,i?"":isSymbol(r)?String(r):r)}function patchDOMProp(e,t,r,n,s){if(t==="innerHTML"||t==="textContent"){r!=null&&(e[t]=t==="innerHTML"?unsafeToTrustedHTML(r):r);return}const i=e.tagName;if(t==="value"&&i!=="PROGRESS"&&!i.includes("-")){const l=i==="OPTION"?e.getAttribute("value")||"":e.value,u=r==null?e.type==="checkbox"?"on":"":String(r);(l!==u||!("_value"in e))&&(e.value=u),r==null&&e.removeAttribute(t),e._value=r;return}let a=!1;if(r===""||r==null){const l=typeof e[t];l==="boolean"?r=includeBooleanAttr(r):r==null&&l==="string"?(r="",a=!0):l==="number"&&(r=0,a=!0)}try{e[t]=r}catch{}a&&e.removeAttribute(s||t)}function addEventListener(e,t,r,n){e.addEventListener(t,r,n)}function removeEventListener(e,t,r,n){e.removeEventListener(t,r,n)}const veiKey=Symbol("_vei");function patchEvent(e,t,r,n,s=null){const i=e[veiKey]||(e[veiKey]={}),a=i[t];if(n&&a)a.value=n;else{const[l,u]=parseName(t);if(n){const c=i[t]=createInvoker(n,s);addEventListener(e,l,c,u)}else a&&(removeEventListener(e,l,a,u),i[t]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(e){let t;if(optionsModifierRE.test(e)){t={};let n;for(;n=e.match(optionsModifierRE);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):hyphenate(e.slice(2)),t]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(e,t){const r=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=r.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(n,r.value),t,5,[n])};return r.value=e,r.attached=getNow(),r}function patchStopImmediatePropagation(e,t){if(isArray$1(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>s=>!s._stopped&&n&&n(s))}else return t}const isNativeOn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,patchProp=(e,t,r,n,s,i)=>{const a=s==="svg";t==="class"?patchClass(e,n,a):t==="style"?patchStyle(e,r,n):isOn(t)?isModelListener(t)||patchEvent(e,t,r,n,i):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):shouldSetAsProp(e,t,n,a))?(patchDOMProp(e,t,n),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&patchAttr(e,t,n,a,i,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!isString(n))?patchDOMProp(e,camelize(t),n,i,t):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),patchAttr(e,t,n,a))};function shouldSetAsProp(e,t,r,n){if(n)return!!(t==="innerHTML"||t==="textContent"||t in e&&isNativeOn(t)&&isFunction(r));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const s=e.tagName;if(s==="IMG"||s==="VIDEO"||s==="CANVAS"||s==="SOURCE")return!1}return isNativeOn(t)&&isString(r)?!1:t in e}const getModelAssigner=e=>{const t=e.props["onUpdate:modelValue"]||!1;return isArray$1(t)?r=>invokeArrayFns(t,r):t};function onCompositionStart(e){e.target.composing=!0}function onCompositionEnd(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const assignKey=Symbol("_assign"),vModelText={created(e,{modifiers:{lazy:t,trim:r,number:n}},s){e[assignKey]=getModelAssigner(s);const i=n||s.props&&s.props.type==="number";addEventListener(e,t?"change":"input",a=>{if(a.target.composing)return;let l=e.value;r&&(l=l.trim()),i&&(l=looseToNumber(l)),e[assignKey](l)}),r&&addEventListener(e,"change",()=>{e.value=e.value.trim()}),t||(addEventListener(e,"compositionstart",onCompositionStart),addEventListener(e,"compositionend",onCompositionEnd),addEventListener(e,"change",onCompositionEnd))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:r,modifiers:{lazy:n,trim:s,number:i}},a){if(e[assignKey]=getModelAssigner(a),e.composing)return;const l=(i||e.type==="number")&&!/^0\d/.test(e.value)?looseToNumber(e.value):e.value,u=t??"";l!==u&&(document.activeElement===e&&e.type!=="range"&&(n&&t===r||s&&e.value.trim()===u)||(e.value=u))}},systemModifiers=["ctrl","shift","alt","meta"],modifierGuards={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>systemModifiers.some(r=>e[`${r}Key`]&&!t.includes(r))},withModifiers=(e,t)=>{const r=e._withMods||(e._withMods={}),n=t.join(".");return r[n]||(r[n]=(s,...i)=>{for(let a=0;a<t.length;a++){const l=modifierGuards[t[a]];if(l&&l(s,t))return}return e(s,...i)})},rendererOptions=extend({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...e)=>{const t=ensureRenderer().createApp(...e),{mount:r}=t;return t.mount=n=>{const s=normalizeContainer(n);if(!s)return;const i=t._component;!isFunction(i)&&!i.render&&!i.template&&(i.template=s.innerHTML),s.nodeType===1&&(s.textContent="");const a=r(s,!1,resolveRootNamespace(s));return s instanceof Element&&(s.removeAttribute("v-cloak"),s.setAttribute("data-v-app","")),a},t};function resolveRootNamespace(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function normalizeContainer(e){return isString(e)?document.querySelector(e):e}function tryOnScopeDispose(e){return getCurrentScope()?(onScopeDispose(e),!0):!1}const localProvidedStateMap=new WeakMap,injectLocal=(...e)=>{var t;const r=e[0],n=(t=getCurrentInstance())==null?void 0:t.proxy;if(n==null&&!hasInjectionContext())throw new Error("injectLocal must be called in setup");return n&&localProvidedStateMap.has(n)&&r in localProvidedStateMap.get(n)?localProvidedStateMap.get(n)[r]:inject(...e)},isClient=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const toString=Object.prototype.toString,isObject=e=>toString.call(e)==="[object Object]",noop$1=()=>{};function toRef(...e){if(e.length!==1)return toRef$1(...e);const t=e[0];return typeof t=="function"?readonly(customRef(()=>({get:t,set:noop$1}))):ref(t)}function createFilterWrapper(e,t){function r(...n){return new Promise((s,i)=>{Promise.resolve(e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})).then(s).catch(i)})}return r}const bypassFilter=e=>e();function pausableFilter(e=bypassFilter,t={}){const{initialState:r="active"}=t,n=toRef(r==="active");function s(){n.value=!1}function i(){n.value=!0}const a=(...l)=>{n.value&&e(...l)};return{isActive:readonly(n),pause:s,resume:i,eventFilter:a}}function pxValue(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function toArray(e){return Array.isArray(e)?e:[e]}function getLifeCycleTarget(e){return getCurrentInstance()}function watchWithFilter(e,t,r={}){const{eventFilter:n=bypassFilter,...s}=r;return watch(e,createFilterWrapper(n,t),s)}function watchPausable(e,t,r={}){const{eventFilter:n,initialState:s="active",...i}=r,{eventFilter:a,pause:l,resume:u,isActive:c}=pausableFilter(n,{initialState:s});return{stop:watchWithFilter(e,t,{...i,eventFilter:a}),pause:l,resume:u,isActive:c}}function tryOnMounted(e,t=!0,r){getLifeCycleTarget()?onMounted(e,r):t?e():nextTick(e)}function useToggle(e=!1,t={}){const{truthyValue:r=!0,falsyValue:n=!1}=t,s=isRef(e),i=shallowRef(e);function a(l){if(arguments.length)return i.value=l,i.value;{const u=toValue(r);return i.value=i.value===u?toValue(n):u,i.value}}return s?a:[i,a]}function watchImmediate(e,t,r){return watch(e,t,{...r,immediate:!0})}const defaultWindow=isClient?window:void 0;function unrefElement(e){var t;const r=toValue(e);return(t=r==null?void 0:r.$el)!=null?t:r}function useEventListener(...e){const t=[],r=()=>{t.forEach(l=>l()),t.length=0},n=(l,u,c,f)=>(l.addEventListener(u,c,f),()=>l.removeEventListener(u,c,f)),s=computed(()=>{const l=toArray(toValue(e[0])).filter(u=>u!=null);return l.every(u=>typeof u!="string")?l:void 0}),i=watchImmediate(()=>{var l,u;return[(u=(l=s.value)==null?void 0:l.map(c=>unrefElement(c)))!=null?u:[defaultWindow].filter(c=>c!=null),toArray(toValue(s.value?e[1]:e[0])),toArray(unref(s.value?e[2]:e[1])),toValue(s.value?e[3]:e[2])]},([l,u,c,f])=>{if(r(),!(l!=null&&l.length)||!(u!=null&&u.length)||!(c!=null&&c.length))return;const d=isObject(f)?{...f}:f;t.push(...l.flatMap(m=>u.flatMap(g=>c.map(S=>n(m,g,S,d)))))},{flush:"post"}),a=()=>{i(),r()};return tryOnScopeDispose(r),a}function useMounted(){const e=shallowRef(!1),t=getCurrentInstance();return t&&onMounted(()=>{e.value=!0},t),e}function useSupported(e){const t=useMounted();return computed(()=>(t.value,!!e()))}const ssrWidthSymbol=Symbol("vueuse-ssr-width");function useSSRWidth(){const e=hasInjectionContext()?injectLocal(ssrWidthSymbol,null):null;return typeof e=="number"?e:void 0}function useMediaQuery(e,t={}){const{window:r=defaultWindow,ssrWidth:n=useSSRWidth()}=t,s=useSupported(()=>r&&"matchMedia"in r&&typeof r.matchMedia=="function"),i=shallowRef(typeof n=="number"),a=shallowRef(),l=shallowRef(!1),u=c=>{l.value=c.matches};return watchEffect(()=>{if(i.value){i.value=!s.value;const c=toValue(e).split(",");l.value=c.some(f=>{const d=f.includes("not all"),m=f.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),g=f.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let S=!!(m||g);return m&&S&&(S=n>=pxValue(m[1])),g&&S&&(S=n<=pxValue(g[1])),d?!S:S});return}s.value&&(a.value=r.matchMedia(toValue(e)),l.value=a.value.matches)}),useEventListener(a,"change",u,{passive:!0}),computed(()=>l.value)}const _global=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},globalKey="__vueuse_ssr_handlers__",handlers=getHandlers();function getHandlers(){return globalKey in _global||(_global[globalKey]=_global[globalKey]||{}),_global[globalKey]}function getSSRHandler(e,t){return handlers[e]||t}function usePreferredDark(e){return useMediaQuery("(prefers-color-scheme: dark)",e)}function guessSerializerType(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"?"object":Number.isNaN(e)?"any":"number"}const StorageSerializers={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}},customStorageEventName="vueuse-storage";function useStorage(e,t,r,n={}){var s;const{flush:i="pre",deep:a=!0,listenToStorageChanges:l=!0,writeDefaults:u=!0,mergeDefaults:c=!1,shallow:f,window:d=defaultWindow,eventFilter:m,onError:g=J=>{console.error(J)},initOnMounted:S}=n,y=(f?shallowRef:ref)(typeof t=="function"?t():t),R=computed(()=>toValue(e));if(!r)try{r=getSSRHandler("getDefaultStorage",()=>{var J;return(J=defaultWindow)==null?void 0:J.localStorage})()}catch(J){g(J)}if(!r)return y;const w=toValue(t),P=guessSerializerType(w),C=(s=n.serializer)!=null?s:StorageSerializers[P],{pause:B,resume:H}=watchPausable(y,()=>K(y.value),{flush:i,deep:a,eventFilter:m});watch(R,()=>re(),{flush:i}),d&&l&&tryOnMounted(()=>{r instanceof Storage?useEventListener(d,"storage",re,{passive:!0}):useEventListener(d,customStorageEventName,ae),S&&re()}),S||re();function te(J,ie){if(d){const ue={key:R.value,oldValue:J,newValue:ie,storageArea:r};d.dispatchEvent(r instanceof Storage?new StorageEvent("storage",ue):new CustomEvent(customStorageEventName,{detail:ue}))}}function K(J){try{const ie=r.getItem(R.value);if(J==null)te(ie,null),r.removeItem(R.value);else{const ue=C.write(J);ie!==ue&&(r.setItem(R.value,ue),te(ie,ue))}}catch(ie){g(ie)}}function oe(J){const ie=J?J.newValue:r.getItem(R.value);if(ie==null)return u&&w!=null&&r.setItem(R.value,C.write(w)),w;if(!J&&c){const ue=C.read(ie);return typeof c=="function"?c(ue,w):P==="object"&&!Array.isArray(ue)?{...w,...ue}:ue}else return typeof ie!="string"?ie:C.read(ie)}function re(J){if(!(J&&J.storageArea!==r)){if(J&&J.key==null){y.value=w;return}if(!(J&&J.key!==R.value)){B();try{(J==null?void 0:J.newValue)!==C.write(y.value)&&(y.value=oe(J))}catch(ie){g(ie)}finally{J?nextTick(H):H()}}}}function ae(J){re(J.detail)}return y}const CSS_DISABLE_TRANS="*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}";function useColorMode(e={}){const{selector:t="html",attribute:r="class",initialValue:n="auto",window:s=defaultWindow,storage:i,storageKey:a="vueuse-color-scheme",listenToStorageChanges:l=!0,storageRef:u,emitAuto:c,disableTransition:f=!0}=e,d={auto:"",light:"light",dark:"dark",...e.modes||{}},m=usePreferredDark({window:s}),g=computed(()=>m.value?"dark":"light"),S=u||(a==null?toRef(n):useStorage(a,n,i,{window:s,listenToStorageChanges:l})),y=computed(()=>S.value==="auto"?g.value:S.value),R=getSSRHandler("updateHTMLAttrs",(B,H,te)=>{const K=typeof B=="string"?s==null?void 0:s.document.querySelector(B):unrefElement(B);if(!K)return;const oe=new Set,re=new Set;let ae=null;if(H==="class"){const ie=te.split(/\s/g);Object.values(d).flatMap(ue=>(ue||"").split(/\s/g)).filter(Boolean).forEach(ue=>{ie.includes(ue)?oe.add(ue):re.add(ue)})}else ae={key:H,value:te};if(oe.size===0&&re.size===0&&ae===null)return;let J;f&&(J=s.document.createElement("style"),J.appendChild(document.createTextNode(CSS_DISABLE_TRANS)),s.document.head.appendChild(J));for(const ie of oe)K.classList.add(ie);for(const ie of re)K.classList.remove(ie);ae&&K.setAttribute(ae.key,ae.value),f&&(s.getComputedStyle(J).opacity,document.head.removeChild(J))});function w(B){var H;R(t,r,(H=d[B])!=null?H:B)}function P(B){e.onChanged?e.onChanged(B,w):w(B)}watch(y,P,{flush:"post",immediate:!0}),tryOnMounted(()=>P(y.value));const C=computed({get(){return c?S.value:y.value},set(B){S.value=B}});return Object.assign(C,{store:S,system:g,state:y})}function useDark(e={}){const{valueDark:t="dark",valueLight:r=""}=e,n=useColorMode({...e,onChanged:(a,l)=>{var u;e.onChanged?(u=e.onChanged)==null||u.call(e,a==="dark",l,a):l(a)},modes:{dark:t,light:r}}),s=computed(()=>n.system.value);return computed({get(){return n.value==="dark"},set(a){const l=a?"dark":"light";s.value===l?n.value="auto":n.value=l}})}const _sfc_main$f=defineComponent({__name:"navbar-element",props:{route:{}},setup(e){return(t,r)=>{const n=resolveComponent("router-link");return openBlock(),createBlock(n,{key:t.route.path,to:t.route.path,class:"link","active-class":"active"},{default:withCtx(()=>[createTextVNode(toDisplayString(t.route.name)+" ",1),r[0]||(r[0]=createBaseVNode("span",{class:"dropdown-icon"},"  ",-1))]),_:1},8,["to"])}}}),_export_sfc=(e,t)=>{const r=e.__vccOpts||e;for(const[n,s]of t)r[n]=s;return r},NavbarElement=_export_sfc(_sfc_main$f,[["__scopeId","data-v-40d066cd"]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser=typeof document<"u";function isRouteComponent(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function isESModule(e){return e.__esModule||e[Symbol.toStringTag]==="Module"||e.default&&isRouteComponent(e.default)}const assign=Object.assign;function applyToParams(e,t){const r={};for(const n in t){const s=t[n];r[n]=isArray(s)?s.map(e):e(s)}return r}const noop=()=>{},isArray=Array.isArray,HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(e){return encodeURI(""+e).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(e){return commonEncode(e).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(e){return commonEncode(e).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(e){return encodeQueryValue(e).replace(EQUAL_RE,"%3D")}function encodePath(e){return commonEncode(e).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(e){return e==null?"":encodePath(e).replace(SLASH_RE,"%2F")}function decode(e){try{return decodeURIComponent(""+e)}catch{}return""+e}const TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=e=>e.replace(TRAILING_SLASH_RE,"");function parseURL(e,t,r="/"){let n,s={},i="",a="";const l=t.indexOf("#");let u=t.indexOf("?");return l<u&&l>=0&&(u=-1),u>-1&&(n=t.slice(0,u),i=t.slice(u+1,l>-1?l:t.length),s=e(i)),l>-1&&(n=n||t.slice(0,l),a=t.slice(l,t.length)),n=resolveRelativePath(n??t,r),{fullPath:n+(i&&"?")+i+a,path:n,query:s,hash:decode(a)}}function stringifyURL(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function stripBase(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function isSameRouteLocation(e,t,r){const n=t.matched.length-1,s=r.matched.length-1;return n>-1&&n===s&&isSameRouteRecord(t.matched[n],r.matched[s])&&isSameRouteLocationParams(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function isSameRouteRecord(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function isSameRouteLocationParams(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!isSameRouteLocationParamsValue(e[r],t[r]))return!1;return!0}function isSameRouteLocationParamsValue(e,t){return isArray(e)?isEquivalentArray(e,t):isArray(t)?isEquivalentArray(t,e):e===t}function isEquivalentArray(e,t){return isArray(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function resolveRelativePath(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/"),s=n[n.length-1];(s===".."||s===".")&&n.push("");let i=r.length-1,a,l;for(a=0;a<n.length;a++)if(l=n[a],l!==".")if(l==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a).join("/")}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var NavigationType;(function(e){e.pop="pop",e.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(e){e.back="back",e.forward="forward",e.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(e){if(!e)if(isBrowser){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),removeTrailingSlash(e)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(e,t){return e.replace(BEFORE_HASH_RE,"#")+t}function getElementPosition(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const computeScrollPosition=()=>({left:window.scrollX,top:window.scrollY});function scrollToPosition(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),s=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!s)return;t=getElementPosition(s,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.scrollX,t.top!=null?t.top:window.scrollY)}function getScrollKey(e,t){return(history.state?history.state.position-t:-1)+e}const scrollPositions=new Map;function saveScrollPosition(e,t){scrollPositions.set(e,t)}function getSavedScrollPosition(e){const t=scrollPositions.get(e);return scrollPositions.delete(e),t}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(e,t){const{pathname:r,search:n,hash:s}=t,i=e.indexOf("#");if(i>-1){let l=s.includes(e.slice(i))?e.slice(i).length:1,u=s.slice(l);return u[0]!=="/"&&(u="/"+u),stripBase(u,"")}return stripBase(r,e)+n+s}function useHistoryListeners(e,t,r,n){let s=[],i=[],a=null;const l=({state:m})=>{const g=createCurrentLocation(e,location),S=r.value,y=t.value;let R=0;if(m){if(r.value=g,t.value=m,a&&a===S){a=null;return}R=y?m.position-y.position:0}else n(g);s.forEach(w=>{w(r.value,S,{delta:R,type:NavigationType.pop,direction:R?R>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function u(){a=r.value}function c(m){s.push(m);const g=()=>{const S=s.indexOf(m);S>-1&&s.splice(S,1)};return i.push(g),g}function f(){const{history:m}=window;m.state&&m.replaceState(assign({},m.state,{scroll:computeScrollPosition()}),"")}function d(){for(const m of i)m();i=[],window.removeEventListener("popstate",l),window.removeEventListener("beforeunload",f)}return window.addEventListener("popstate",l),window.addEventListener("beforeunload",f,{passive:!0}),{pauseListeners:u,listen:c,destroy:d}}function buildState(e,t,r,n=!1,s=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:s?computeScrollPosition():null}}function useHistoryStateNavigation(e){const{history:t,location:r}=window,n={value:createCurrentLocation(e,r)},s={value:t.state};s.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(u,c,f){const d=e.indexOf("#"),m=d>-1?(r.host&&document.querySelector("base")?e:e.slice(d))+u:createBaseLocation()+e+u;try{t[f?"replaceState":"pushState"](c,"",m),s.value=c}catch(g){console.error(g),r[f?"replace":"assign"](m)}}function a(u,c){const f=assign({},t.state,buildState(s.value.back,u,s.value.forward,!0),c,{position:s.value.position});i(u,f,!0),n.value=u}function l(u,c){const f=assign({},s.value,t.state,{forward:u,scroll:computeScrollPosition()});i(f.current,f,!0);const d=assign({},buildState(n.value,u,null),{position:f.position+1},c);i(u,d,!1),n.value=u}return{location:n,state:s,push:l,replace:a}}function createWebHistory(e){e=normalizeBase(e);const t=useHistoryStateNavigation(e),r=useHistoryListeners(e,t.state,t.location,t.replace);function n(i,a=!0){a||r.pauseListeners(),history.go(i)}const s=assign({location:"",base:e,go:n,createHref:createHref.bind(null,e)},t,r);return Object.defineProperty(s,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(s,"state",{enumerable:!0,get:()=>t.state.value}),s}function createWebHashHistory(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),createWebHistory(e)}function isRouteLocation(e){return typeof e=="string"||e&&typeof e=="object"}function isRouteName(e){return typeof e=="string"||typeof e=="symbol"}const NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(e,t){return assign(new Error,{type:e,[NavigationFailureSymbol]:!0},t)}function isNavigationFailure(e,t){return e instanceof Error&&NavigationFailureSymbol in e&&(t==null||!!(e.type&t))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(e,t){const r=assign({},BASE_PATH_PARSER_OPTIONS,t),n=[];let s=r.start?"^":"";const i=[];for(const c of e){const f=c.length?[]:[90];r.strict&&!c.length&&(s+="/");for(let d=0;d<c.length;d++){const m=c[d];let g=40+(r.sensitive?.25:0);if(m.type===0)d||(s+="/"),s+=m.value.replace(REGEX_CHARS_RE,"\\$&"),g+=40;else if(m.type===1){const{value:S,repeatable:y,optional:R,regexp:w}=m;i.push({name:S,repeatable:y,optional:R});const P=w||BASE_PARAM_PATTERN;if(P!==BASE_PARAM_PATTERN){g+=10;try{new RegExp(`(${P})`)}catch(B){throw new Error(`Invalid custom RegExp for param "${S}" (${P}): `+B.message)}}let C=y?`((?:${P})(?:/(?:${P}))*)`:`(${P})`;d||(C=R&&c.length<2?`(?:/${C})`:"/"+C),R&&(C+="?"),s+=C,g+=20,R&&(g+=-8),y&&(g+=-20),P===".*"&&(g+=-50)}f.push(g)}n.push(f)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(s+="/?"),r.end?s+="$":r.strict&&!s.endsWith("/")&&(s+="(?:/|$)");const a=new RegExp(s,r.sensitive?"":"i");function l(c){const f=c.match(a),d={};if(!f)return null;for(let m=1;m<f.length;m++){const g=f[m]||"",S=i[m-1];d[S.name]=g&&S.repeatable?g.split("/"):g}return d}function u(c){let f="",d=!1;for(const m of e){(!d||!f.endsWith("/"))&&(f+="/"),d=!1;for(const g of m)if(g.type===0)f+=g.value;else if(g.type===1){const{value:S,repeatable:y,optional:R}=g,w=S in c?c[S]:"";if(isArray(w)&&!y)throw new Error(`Provided param "${S}" is an array but it is not repeatable (* or + modifiers)`);const P=isArray(w)?w.join("/"):w;if(!P)if(R)m.length<2&&(f.endsWith("/")?f=f.slice(0,-1):d=!0);else throw new Error(`Missing required param "${S}"`);f+=P}}return f||"/"}return{re:a,score:n,keys:i,parse:l,stringify:u}}function compareScoreArray(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===80?-1:1:e.length>t.length?t.length===1&&t[0]===80?1:-1:0}function comparePathParserScore(e,t){let r=0;const n=e.score,s=t.score;for(;r<n.length&&r<s.length;){const i=compareScoreArray(n[r],s[r]);if(i)return i;r++}if(Math.abs(s.length-n.length)===1){if(isLastScoreNegative(n))return 1;if(isLastScoreNegative(s))return-1}return s.length-n.length}function isLastScoreNegative(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(e){if(!e)return[[]];if(e==="/")return[[ROOT_TOKEN]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(g){throw new Error(`ERR (${r})/"${c}": ${g}`)}let r=0,n=r;const s=[];let i;function a(){i&&s.push(i),i=[]}let l=0,u,c="",f="";function d(){c&&(r===0?i.push({type:0,value:c}):r===1||r===2||r===3?(i.length>1&&(u==="*"||u==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:c,regexp:f,repeatable:u==="*"||u==="+",optional:u==="*"||u==="?"})):t("Invalid state to consume buffer"),c="")}function m(){c+=u}for(;l<e.length;){if(u=e[l++],u==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:u==="/"?(c&&d(),a()):u===":"?(d(),r=1):m();break;case 4:m(),r=n;break;case 1:u==="("?r=2:VALID_PARAM_RE.test(u)?m():(d(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&l--);break;case 2:u===")"?f[f.length-1]=="\\"?f=f.slice(0,-1)+u:r=3:f+=u;break;case 3:d(),r=0,u!=="*"&&u!=="?"&&u!=="+"&&l--,f="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),d(),a(),s}function createRouteRecordMatcher(e,t,r){const n=tokensToParser(tokenizePath(e.path),r),s=assign(n,{record:e,parent:t,children:[],alias:[]});return t&&!s.record.aliasOf==!t.record.aliasOf&&t.children.push(s),s}function createRouterMatcher(e,t){const r=[],n=new Map;t=mergeOptions({strict:!1,end:!0,sensitive:!1},t);function s(d){return n.get(d)}function i(d,m,g){const S=!g,y=normalizeRouteRecord(d);y.aliasOf=g&&g.record;const R=mergeOptions(t,d),w=[y];if("alias"in d){const B=typeof d.alias=="string"?[d.alias]:d.alias;for(const H of B)w.push(normalizeRouteRecord(assign({},y,{components:g?g.record.components:y.components,path:H,aliasOf:g?g.record:y})))}let P,C;for(const B of w){const{path:H}=B;if(m&&H[0]!=="/"){const te=m.record.path,K=te[te.length-1]==="/"?"":"/";B.path=m.record.path+(H&&K+H)}if(P=createRouteRecordMatcher(B,m,R),g?g.alias.push(P):(C=C||P,C!==P&&C.alias.push(P),S&&d.name&&!isAliasRecord(P)&&a(d.name)),isMatchable(P)&&u(P),y.children){const te=y.children;for(let K=0;K<te.length;K++)i(te[K],P,g&&g.children[K])}g=g||P}return C?()=>{a(C)}:noop}function a(d){if(isRouteName(d)){const m=n.get(d);m&&(n.delete(d),r.splice(r.indexOf(m),1),m.children.forEach(a),m.alias.forEach(a))}else{const m=r.indexOf(d);m>-1&&(r.splice(m,1),d.record.name&&n.delete(d.record.name),d.children.forEach(a),d.alias.forEach(a))}}function l(){return r}function u(d){const m=findInsertionIndex(d,r);r.splice(m,0,d),d.record.name&&!isAliasRecord(d)&&n.set(d.record.name,d)}function c(d,m){let g,S={},y,R;if("name"in d&&d.name){if(g=n.get(d.name),!g)throw createRouterError(1,{location:d});R=g.record.name,S=assign(paramsFromLocation(m.params,g.keys.filter(C=>!C.optional).concat(g.parent?g.parent.keys.filter(C=>C.optional):[]).map(C=>C.name)),d.params&&paramsFromLocation(d.params,g.keys.map(C=>C.name))),y=g.stringify(S)}else if(d.path!=null)y=d.path,g=r.find(C=>C.re.test(y)),g&&(S=g.parse(y),R=g.record.name);else{if(g=m.name?n.get(m.name):r.find(C=>C.re.test(m.path)),!g)throw createRouterError(1,{location:d,currentLocation:m});R=g.record.name,S=assign({},m.params,d.params),y=g.stringify(S)}const w=[];let P=g;for(;P;)w.unshift(P.record),P=P.parent;return{name:R,path:y,params:S,matched:w,meta:mergeMetaFields(w)}}e.forEach(d=>i(d));function f(){r.length=0,n.clear()}return{addRoute:i,resolve:c,removeRoute:a,clearRoutes:f,getRoutes:l,getRecordMatcher:s}}function paramsFromLocation(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function normalizeRouteRecord(e){const t={path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:e.aliasOf,beforeEnter:e.beforeEnter,props:normalizeRecordProps(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}};return Object.defineProperty(t,"mods",{value:{}}),t}function normalizeRecordProps(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="object"?r[n]:r;return t}function isAliasRecord(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function mergeMetaFields(e){return e.reduce((t,r)=>assign(t,r.meta),{})}function mergeOptions(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function findInsertionIndex(e,t){let r=0,n=t.length;for(;r!==n;){const i=r+n>>1;comparePathParserScore(e,t[i])<0?n=i:r=i+1}const s=getInsertionAncestor(e);return s&&(n=t.lastIndexOf(s,n-1)),n}function getInsertionAncestor(e){let t=e;for(;t=t.parent;)if(isMatchable(t)&&comparePathParserScore(e,t)===0)return t}function isMatchable({record:e}){return!!(e.name||e.components&&Object.keys(e.components).length||e.redirect)}function parseQuery(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let s=0;s<n.length;++s){const i=n[s].replace(PLUS_RE," "),a=i.indexOf("="),l=decode(a<0?i:i.slice(0,a)),u=a<0?null:decode(i.slice(a+1));if(l in t){let c=t[l];isArray(c)||(c=t[l]=[c]),c.push(u)}else t[l]=u}return t}function stringifyQuery(e){let t="";for(let r in e){const n=e[r];if(r=encodeQueryKey(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(isArray(n)?n.map(i=>i&&encodeQueryValue(i)):[n&&encodeQueryValue(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function normalizeQuery(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=isArray(n)?n.map(s=>s==null?null:""+s):n==null?n:""+n)}return t}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let e=[];function t(n){return e.push(n),()=>{const s=e.indexOf(n);s>-1&&e.splice(s,1)}}function r(){e=[]}return{add:t,list:()=>e.slice(),reset:r}}function guardToPromiseFn(e,t,r,n,s,i=a=>a()){const a=n&&(n.enterCallbacks[s]=n.enterCallbacks[s]||[]);return()=>new Promise((l,u)=>{const c=m=>{m===!1?u(createRouterError(4,{from:r,to:t})):m instanceof Error?u(m):isRouteLocation(m)?u(createRouterError(2,{from:t,to:m})):(a&&n.enterCallbacks[s]===a&&typeof m=="function"&&a.push(m),l())},f=i(()=>e.call(n&&n.instances[s],t,r,c));let d=Promise.resolve(f);e.length<3&&(d=d.then(c)),d.catch(m=>u(m))})}function extractComponentsGuards(e,t,r,n,s=i=>i()){const i=[];for(const a of e)for(const l in a.components){let u=a.components[l];if(!(t!=="beforeRouteEnter"&&!a.instances[l]))if(isRouteComponent(u)){const f=(u.__vccOpts||u)[t];f&&i.push(guardToPromiseFn(f,r,n,a,l,s))}else{let c=u();i.push(()=>c.then(f=>{if(!f)throw new Error(`Couldn't resolve component "${l}" at "${a.path}"`);const d=isESModule(f)?f.default:f;a.mods[l]=f,a.components[l]=d;const g=(d.__vccOpts||d)[t];return g&&guardToPromiseFn(g,r,n,a,l,s)()}))}}return i}function useLink(e){const t=inject(routerKey),r=inject(routeLocationKey),n=computed(()=>{const u=unref(e.to);return t.resolve(u)}),s=computed(()=>{const{matched:u}=n.value,{length:c}=u,f=u[c-1],d=r.matched;if(!f||!d.length)return-1;const m=d.findIndex(isSameRouteRecord.bind(null,f));if(m>-1)return m;const g=getOriginalPath(u[c-2]);return c>1&&getOriginalPath(f)===g&&d[d.length-1].path!==g?d.findIndex(isSameRouteRecord.bind(null,u[c-2])):m}),i=computed(()=>s.value>-1&&includesParams(r.params,n.value.params)),a=computed(()=>s.value>-1&&s.value===r.matched.length-1&&isSameRouteLocationParams(r.params,n.value.params));function l(u={}){if(guardEvent(u)){const c=t[unref(e.replace)?"replace":"push"](unref(e.to)).catch(noop);return e.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>c),c}return Promise.resolve()}return{route:n,href:computed(()=>n.value.href),isActive:i,isExactActive:a,navigate:l}}function preferSingleVNode(e){return e.length===1?e[0]:e}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(e,{slots:t}){const r=reactive(useLink(e)),{options:n}=inject(routerKey),s=computed(()=>({[getLinkClass(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[getLinkClass(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&preferSingleVNode(t.default(r));return e.custom?i:h("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:s.value},i)}}}),RouterLink=RouterLinkImpl;function guardEvent(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function includesParams(e,t){for(const r in t){const n=t[r],s=e[r];if(typeof n=="string"){if(n!==s)return!1}else if(!isArray(s)||s.length!==n.length||n.some((i,a)=>i!==s[a]))return!1}return!0}function getOriginalPath(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const getLinkClass=(e,t,r)=>e??t??r,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=inject(routerViewLocationKey),s=computed(()=>e.route||n.value),i=inject(viewDepthKey,0),a=computed(()=>{let c=unref(i);const{matched:f}=s.value;let d;for(;(d=f[c])&&!d.components;)c++;return c}),l=computed(()=>s.value.matched[a.value]);provide(viewDepthKey,computed(()=>a.value+1)),provide(matchedRouteKey,l),provide(routerViewLocationKey,s);const u=ref();return watch(()=>[u.value,l.value,e.name],([c,f,d],[m,g,S])=>{f&&(f.instances[d]=c,g&&g!==f&&c&&c===m&&(f.leaveGuards.size||(f.leaveGuards=g.leaveGuards),f.updateGuards.size||(f.updateGuards=g.updateGuards))),c&&f&&(!g||!isSameRouteRecord(f,g)||!m)&&(f.enterCallbacks[d]||[]).forEach(y=>y(c))},{flush:"post"}),()=>{const c=s.value,f=e.name,d=l.value,m=d&&d.components[f];if(!m)return normalizeSlot(r.default,{Component:m,route:c});const g=d.props[f],S=g?g===!0?c.params:typeof g=="function"?g(c):g:null,R=h(m,assign({},S,t,{onVnodeUnmounted:w=>{w.component.isUnmounted&&(d.instances[f]=null)},ref:u}));return normalizeSlot(r.default,{Component:R,route:c})||R}}});function normalizeSlot(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const RouterView=RouterViewImpl;function createRouter(e){const t=createRouterMatcher(e.routes,e),r=e.parseQuery||parseQuery,n=e.stringifyQuery||stringifyQuery,s=e.history,i=useCallbacks(),a=useCallbacks(),l=useCallbacks(),u=shallowRef(START_LOCATION_NORMALIZED);let c=START_LOCATION_NORMALIZED;isBrowser&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const f=applyToParams.bind(null,T=>""+T),d=applyToParams.bind(null,encodeParam),m=applyToParams.bind(null,decode);function g(T,z){let Y,se;return isRouteName(T)?(Y=t.getRecordMatcher(T),se=z):se=T,t.addRoute(se,Y)}function S(T){const z=t.getRecordMatcher(T);z&&t.removeRoute(z)}function y(){return t.getRoutes().map(T=>T.record)}function R(T){return!!t.getRecordMatcher(T)}function w(T,z){if(z=assign({},z||u.value),typeof T=="string"){const k=parseURL(r,T,z.path),q=t.resolve({path:k.path},z),j=s.createHref(k.fullPath);return assign(k,q,{params:m(q.params),hash:decode(k.hash),redirectedFrom:void 0,href:j})}let Y;if(T.path!=null)Y=assign({},T,{path:parseURL(r,T.path,z.path).path});else{const k=assign({},T.params);for(const q in k)k[q]==null&&delete k[q];Y=assign({},T,{params:d(k)}),z.params=d(z.params)}const se=t.resolve(Y,z),ye=T.hash||"";se.params=f(m(se.params));const v=stringifyURL(n,assign({},T,{hash:encodeHash(ye),path:se.path})),A=s.createHref(v);return assign({fullPath:v,hash:ye,query:n===stringifyQuery?normalizeQuery(T.query):T.query||{}},se,{redirectedFrom:void 0,href:A})}function P(T){return typeof T=="string"?parseURL(r,T,u.value.path):assign({},T)}function C(T,z){if(c!==T)return createRouterError(8,{from:z,to:T})}function B(T){return K(T)}function H(T){return B(assign(P(T),{replace:!0}))}function te(T){const z=T.matched[T.matched.length-1];if(z&&z.redirect){const{redirect:Y}=z;let se=typeof Y=="function"?Y(T):Y;return typeof se=="string"&&(se=se.includes("?")||se.includes("#")?se=P(se):{path:se},se.params={}),assign({query:T.query,hash:T.hash,params:se.path!=null?{}:T.params},se)}}function K(T,z){const Y=c=w(T),se=u.value,ye=T.state,v=T.force,A=T.replace===!0,k=te(Y);if(k)return K(assign(P(k),{state:typeof k=="object"?assign({},ye,k.state):ye,force:v,replace:A}),z||Y);const q=Y;q.redirectedFrom=z;let j;return!v&&isSameRouteLocation(n,se,Y)&&(j=createRouterError(16,{to:q,from:se}),Ae(se,se,!0,!1)),(j?Promise.resolve(j):ae(q,se)).catch(F=>isNavigationFailure(F)?isNavigationFailure(F,2)?F:ve(F):de(F,q,se)).then(F=>{if(F){if(isNavigationFailure(F,2))return K(assign({replace:A},P(F.to),{state:typeof F.to=="object"?assign({},ye,F.to.state):ye,force:v}),z||q)}else F=ie(q,se,!0,A,ye);return J(q,se,F),F})}function oe(T,z){const Y=C(T,z);return Y?Promise.reject(Y):Promise.resolve()}function re(T){const z=Ee.values().next().value;return z&&typeof z.runWithContext=="function"?z.runWithContext(T):T()}function ae(T,z){let Y;const[se,ye,v]=extractChangingRecords(T,z);Y=extractComponentsGuards(se.reverse(),"beforeRouteLeave",T,z);for(const k of se)k.leaveGuards.forEach(q=>{Y.push(guardToPromiseFn(q,T,z))});const A=oe.bind(null,T,z);return Y.push(A),Oe(Y).then(()=>{Y=[];for(const k of i.list())Y.push(guardToPromiseFn(k,T,z));return Y.push(A),Oe(Y)}).then(()=>{Y=extractComponentsGuards(ye,"beforeRouteUpdate",T,z);for(const k of ye)k.updateGuards.forEach(q=>{Y.push(guardToPromiseFn(q,T,z))});return Y.push(A),Oe(Y)}).then(()=>{Y=[];for(const k of v)if(k.beforeEnter)if(isArray(k.beforeEnter))for(const q of k.beforeEnter)Y.push(guardToPromiseFn(q,T,z));else Y.push(guardToPromiseFn(k.beforeEnter,T,z));return Y.push(A),Oe(Y)}).then(()=>(T.matched.forEach(k=>k.enterCallbacks={}),Y=extractComponentsGuards(v,"beforeRouteEnter",T,z,re),Y.push(A),Oe(Y))).then(()=>{Y=[];for(const k of a.list())Y.push(guardToPromiseFn(k,T,z));return Y.push(A),Oe(Y)}).catch(k=>isNavigationFailure(k,8)?k:Promise.reject(k))}function J(T,z,Y){l.list().forEach(se=>re(()=>se(T,z,Y)))}function ie(T,z,Y,se,ye){const v=C(T,z);if(v)return v;const A=z===START_LOCATION_NORMALIZED,k=isBrowser?history.state:{};Y&&(se||A?s.replace(T.fullPath,assign({scroll:A&&k&&k.scroll},ye)):s.push(T.fullPath,ye)),u.value=T,Ae(T,z,Y,A),ve()}let ue;function fe(){ue||(ue=s.listen((T,z,Y)=>{if(!Te.listening)return;const se=w(T),ye=te(se);if(ye){K(assign(ye,{replace:!0,force:!0}),se).catch(noop);return}c=se;const v=u.value;isBrowser&&saveScrollPosition(getScrollKey(v.fullPath,Y.delta),computeScrollPosition()),ae(se,v).catch(A=>isNavigationFailure(A,12)?A:isNavigationFailure(A,2)?(K(assign(P(A.to),{force:!0}),se).then(k=>{isNavigationFailure(k,20)&&!Y.delta&&Y.type===NavigationType.pop&&s.go(-1,!1)}).catch(noop),Promise.reject()):(Y.delta&&s.go(-Y.delta,!1),de(A,se,v))).then(A=>{A=A||ie(se,v,!1),A&&(Y.delta&&!isNavigationFailure(A,8)?s.go(-Y.delta,!1):Y.type===NavigationType.pop&&isNavigationFailure(A,20)&&s.go(-1,!1)),J(se,v,A)}).catch(noop)}))}let Se=useCallbacks(),_e=useCallbacks(),me;function de(T,z,Y){ve(T);const se=_e.list();return se.length?se.forEach(ye=>ye(T,z,Y)):console.error(T),Promise.reject(T)}function be(){return me&&u.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((T,z)=>{Se.add([T,z])})}function ve(T){return me||(me=!T,fe(),Se.list().forEach(([z,Y])=>T?Y(T):z()),Se.reset()),T}function Ae(T,z,Y,se){const{scrollBehavior:ye}=e;if(!isBrowser||!ye)return Promise.resolve();const v=!Y&&getSavedScrollPosition(getScrollKey(T.fullPath,0))||(se||!Y)&&history.state&&history.state.scroll||null;return nextTick().then(()=>ye(T,z,v)).then(A=>A&&scrollToPosition(A)).catch(A=>de(A,T,z))}const xe=T=>s.go(T);let Re;const Ee=new Set,Te={currentRoute:u,listening:!0,addRoute:g,removeRoute:S,clearRoutes:t.clearRoutes,hasRoute:R,getRoutes:y,resolve:w,options:e,push:B,replace:H,go:xe,back:()=>xe(-1),forward:()=>xe(1),beforeEach:i.add,beforeResolve:a.add,afterEach:l.add,onError:_e.add,isReady:be,install(T){const z=this;T.component("RouterLink",RouterLink),T.component("RouterView",RouterView),T.config.globalProperties.$router=z,Object.defineProperty(T.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(u)}),isBrowser&&!Re&&u.value===START_LOCATION_NORMALIZED&&(Re=!0,B(s.location).catch(ye=>{}));const Y={};for(const ye in START_LOCATION_NORMALIZED)Object.defineProperty(Y,ye,{get:()=>u.value[ye],enumerable:!0});T.provide(routerKey,z),T.provide(routeLocationKey,shallowReactive(Y)),T.provide(routerViewLocationKey,u);const se=T.unmount;Ee.add(T),T.unmount=function(){Ee.delete(T),Ee.size<1&&(c=START_LOCATION_NORMALIZED,ue&&ue(),ue=null,u.value=START_LOCATION_NORMALIZED,Re=!1,me=!1),se()}}};function Oe(T){return T.reduce((z,Y)=>z.then(()=>re(Y)),Promise.resolve())}return Te}function extractChangingRecords(e,t){const r=[],n=[],s=[],i=Math.max(t.matched.length,e.matched.length);for(let a=0;a<i;a++){const l=t.matched[a];l&&(e.matched.find(c=>isSameRouteRecord(c,l))?n.push(l):r.push(l));const u=e.matched[a];u&&(t.matched.find(c=>isSameRouteRecord(c,u))||s.push(u))}return[r,n,s]}const _sfc_main$e={},_hoisted_1$c={id:"Capa_1",fill:"#000000",version:"1.1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",width:"15px",height:"15px",viewBox:"0 0 93.842 93.843","xml:space":"preserve"};function _sfc_render(e,t){return openBlock(),createElementBlock("svg",_hoisted_1$c,t[0]||(t[0]=[createBaseVNode("g",null,[createBaseVNode("path",{d:`M74.042,11.379h-9.582v-0.693c0-1.768-1.438-3.205-3.206-3.205h-6.435V3.205C54.819,1.437,53.381,0,51.614,0H42.23
c-1.768,0-3.206,1.438-3.206,3.205V7.48H32.59c-1.768,0-3.206,1.438-3.206,3.205v0.693h-9.582c-2.393,0-4.339,1.945-4.339,4.34
v73.785c0,2.394,1.946,4.34,4.339,4.34h54.238c2.394,0,4.339-1.946,4.339-4.34V15.719C78.38,13.324,76.434,11.379,74.042,11.379z
M32.617,25.336h28.61c1.709,0,3.102-1.391,3.102-3.1v-3.438h7.554l0.021,68.164l-49.939,0.021V18.801h7.554v3.436
C29.517,23.945,30.907,25.336,32.617,25.336z`})],-1)]))}const EditorIcon=_export_sfc(_sfc_main$e,[["render",_sfc_render]]),_hoisted_1$b=["id","aria-label"],_sfc_main$d=defineComponent({__name:"matrix-cell",props:{rowIndex:{},colIndex:{},matrixId:{},value:{}},setup(e){const t=e,r=useTemplateRef("input"),n=ref(t.value);function s(){var a;(a=r.value)==null||a.select()}function i(){const a=Number.parseFloat(String(n.value));n.value=Number.isNaN(a)?0:a}return watch(()=>t.value,a=>{n.value!==""&&(n.value=a)}),(a,l)=>(openBlock(),createElementBlock("td",null,[withDirectives(createBaseVNode("input",{id:`cell-${a.matrixId}-${a.colIndex}-${a.rowIndex}`,ref_key:"input",ref:r,"onUpdate:modelValue":l[0]||(l[0]=u=>n.value=u),"aria-label":`cell-${a.matrixId}-${a.colIndex}-${a.rowIndex}`,type:"text",inputmode:"numeric",autocomplete:"off",onFocus:s,onBlur:i},null,40,_hoisted_1$b),[[vModelText,n.value]])]))}}),MatrixCell=_export_sfc(_sfc_main$d,[["__scopeId","data-v-da76d6c2"]]),_hoisted_1$a={class:"caption"},_hoisted_2$8=["name","aria-label"],debounceDelay=200,_sfc_main$c=defineComponent({__name:"size-controller",props:{name:{},size:{}},emits:["update"],setup(e,{emit:t}){const r=e,n=t;let s=null;const i=ref(r.size);watch(()=>r.size,d=>{s!=null&&clearTimeout(s),i.value=d});function a(d){/^\d$/.test(d.key)||d.preventDefault()}function l(){s!=null&&clearTimeout(s),s=setTimeout(f,debounceDelay)}function u(d){const m=Number(i.value)+d;m>0&&m<20&&(i.value+=d,l())}function c(){f(),i.value=r.size}function f(){n("update",Number(i.value))}return(d,m)=>(openBlock(),createElementBlock("div",null,[createBaseVNode("div",_hoisted_1$a,toDisplayString(d.name),1),createBaseVNode("button",{onClick:m[0]||(m[0]=withModifiers(g=>u(-1),["prevent"]))},"  "),withDirectives(createBaseVNode("input",{"onUpdate:modelValue":m[1]||(m[1]=g=>i.value=g),name:d.name,"aria-label":`Set matrix ${d.name}`,onBlur:c,onKeypress:m[2]||(m[2]=g=>a(g))},null,40,_hoisted_2$8),[[vModelText,i.value]]),createBaseVNode("button",{onClick:m[3]||(m[3]=withModifiers(g=>u(1),["prevent"]))}," + ")]))}}),SizeController=_export_sfc(_sfc_main$c,[["__scopeId","data-v-fec331ed"]]);function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var algebrite={},BigInteger={exports:{}},hasRequiredBigInteger;function requireBigInteger(){return hasRequiredBigInteger||(hasRequiredBigInteger=1,function(e){var t=function(r){var n=1e7,s=7,i=9007199254740992,a=S(i),l="0123456789abcdefghijklmnopqrstuvwxyz",u=typeof BigInt=="function";function c(_,b,x,O){return typeof _>"u"?c[0]:typeof b<"u"?+b==10&&!x?X(_):F(_,b,x,O):X(_)}function f(_,b){this.value=_,this.sign=b,this.isSmall=!1}f.prototype=Object.create(c.prototype);function d(_){this.value=_,this.sign=_<0,this.isSmall=!0}d.prototype=Object.create(c.prototype);function m(_){this.value=_}m.prototype=Object.create(c.prototype);function g(_){return-9007199254740992<_&&_<i}function S(_){return _<1e7?[_]:_<1e14?[_%1e7,Math.floor(_/1e7)]:[_%1e7,Math.floor(_/1e7)%1e7,Math.floor(_/1e14)]}function y(_){R(_);var b=_.length;if(b<4&&ve(_,a)<0)switch(b){case 0:return 0;case 1:return _[0];case 2:return _[0]+_[1]*n;default:return _[0]+(_[1]+_[2]*n)*n}return _}function R(_){for(var b=_.length;_[--b]===0;);_.length=b+1}function w(_){for(var b=new Array(_),x=-1;++x<_;)b[x]=0;return b}function P(_){return _>0?Math.floor(_):Math.ceil(_)}function C(_,b){var x=_.length,O=b.length,D=new Array(x),L=0,G=n,V,Z;for(Z=0;Z<O;Z++)V=_[Z]+b[Z]+L,L=V>=G?1:0,D[Z]=V-L*G;for(;Z<x;)V=_[Z]+L,L=V===G?1:0,D[Z++]=V-L*G;return L>0&&D.push(L),D}function B(_,b){return _.length>=b.length?C(_,b):C(b,_)}function H(_,b){var x=_.length,O=new Array(x),D=n,L,G;for(G=0;G<x;G++)L=_[G]-D+b,b=Math.floor(L/D),O[G]=L-b*D,b+=1;for(;b>0;)O[G++]=b%D,b=Math.floor(b/D);return O}f.prototype.add=function(_){var b=X(_);if(this.sign!==b.sign)return this.subtract(b.negate());var x=this.value,O=b.value;return b.isSmall?new f(H(x,Math.abs(O)),this.sign):new f(B(x,O),this.sign)},f.prototype.plus=f.prototype.add,d.prototype.add=function(_){var b=X(_),x=this.value;if(x<0!==b.sign)return this.subtract(b.negate());var O=b.value;if(b.isSmall){if(g(x+O))return new d(x+O);O=S(Math.abs(O))}return new f(H(O,Math.abs(x)),x<0)},d.prototype.plus=d.prototype.add,m.prototype.add=function(_){return new m(this.value+X(_).value)},m.prototype.plus=m.prototype.add;function te(_,b){var x=_.length,O=b.length,D=new Array(x),L=0,G=n,V,Z;for(V=0;V<O;V++)Z=_[V]-L-b[V],Z<0?(Z+=G,L=1):L=0,D[V]=Z;for(V=O;V<x;V++){if(Z=_[V]-L,Z<0)Z+=G;else{D[V++]=Z;break}D[V]=Z}for(;V<x;V++)D[V]=_[V];return R(D),D}function K(_,b,x){var O;return ve(_,b)>=0?O=te(_,b):(O=te(b,_),x=!x),O=y(O),typeof O=="number"?(x&&(O=-O),new d(O)):new f(O,x)}function oe(_,b,x){var O=_.length,D=new Array(O),L=-b,G=n,V,Z;for(V=0;V<O;V++)Z=_[V]+L,L=Math.floor(Z/G),Z%=G,D[V]=Z<0?Z+G:Z;return D=y(D),typeof D=="number"?(x&&(D=-D),new d(D)):new f(D,x)}f.prototype.subtract=function(_){var b=X(_);if(this.sign!==b.sign)return this.add(b.negate());var x=this.value,O=b.value;return b.isSmall?oe(x,Math.abs(O),this.sign):K(x,O,this.sign)},f.prototype.minus=f.prototype.subtract,d.prototype.subtract=function(_){var b=X(_),x=this.value;if(x<0!==b.sign)return this.add(b.negate());var O=b.value;return b.isSmall?new d(x-O):oe(O,Math.abs(x),x>=0)},d.prototype.minus=d.prototype.subtract,m.prototype.subtract=function(_){return new m(this.value-X(_).value)},m.prototype.minus=m.prototype.subtract,f.prototype.negate=function(){return new f(this.value,!this.sign)},d.prototype.negate=function(){var _=this.sign,b=new d(-this.value);return b.sign=!_,b},m.prototype.negate=function(){return new m(-this.value)},f.prototype.abs=function(){return new f(this.value,!1)},d.prototype.abs=function(){return new d(Math.abs(this.value))},m.prototype.abs=function(){return new m(this.value>=0?this.value:-this.value)};function re(_,b){var x=_.length,O=b.length,D=x+O,L=w(D),G=n,V,Z,pe,he,ge;for(pe=0;pe<x;++pe){he=_[pe];for(var Ie=0;Ie<O;++Ie)ge=b[Ie],V=he*ge+L[pe+Ie],Z=Math.floor(V/G),L[pe+Ie]=V-Z*G,L[pe+Ie+1]+=Z}return R(L),L}function ae(_,b){var x=_.length,O=new Array(x),D=n,L=0,G,V;for(V=0;V<x;V++)G=_[V]*b+L,L=Math.floor(G/D),O[V]=G-L*D;for(;L>0;)O[V++]=L%D,L=Math.floor(L/D);return O}function J(_,b){for(var x=[];b-- >0;)x.push(0);return x.concat(_)}function ie(_,b){var x=Math.max(_.length,b.length);if(x<=30)return re(_,b);x=Math.ceil(x/2);var O=_.slice(x),D=_.slice(0,x),L=b.slice(x),G=b.slice(0,x),V=ie(D,G),Z=ie(O,L),pe=ie(B(D,O),B(G,L)),he=B(B(V,J(te(te(pe,V),Z),x)),J(Z,2*x));return R(he),he}function ue(_,b){return-.012*_-.012*b+15e-6*_*b>0}f.prototype.multiply=function(_){var b=X(_),x=this.value,O=b.value,D=this.sign!==b.sign,L;if(b.isSmall){if(O===0)return c[0];if(O===1)return this;if(O===-1)return this.negate();if(L=Math.abs(O),L<n)return new f(ae(x,L),D);O=S(L)}return ue(x.length,O.length)?new f(ie(x,O),D):new f(re(x,O),D)},f.prototype.times=f.prototype.multiply;function fe(_,b,x){return _<n?new f(ae(b,_),x):new f(re(b,S(_)),x)}d.prototype._multiplyBySmall=function(_){return g(_.value*this.value)?new d(_.value*this.value):fe(Math.abs(_.value),S(Math.abs(this.value)),this.sign!==_.sign)},f.prototype._multiplyBySmall=function(_){return _.value===0?c[0]:_.value===1?this:_.value===-1?this.negate():fe(Math.abs(_.value),this.value,this.sign!==_.sign)},d.prototype.multiply=function(_){return X(_)._multiplyBySmall(this)},d.prototype.times=d.prototype.multiply,m.prototype.multiply=function(_){return new m(this.value*X(_).value)},m.prototype.times=m.prototype.multiply;function Se(_){var b=_.length,x=w(b+b),O=n,D,L,G,V,Z;for(G=0;G<b;G++){V=_[G],L=0-V*V;for(var pe=G;pe<b;pe++)Z=_[pe],D=2*(V*Z)+x[G+pe]+L,L=Math.floor(D/O),x[G+pe]=D-L*O;x[G+b]=L}return R(x),x}f.prototype.square=function(){return new f(Se(this.value),!1)},d.prototype.square=function(){var _=this.value*this.value;return g(_)?new d(_):new f(Se(S(Math.abs(this.value))),!1)},m.prototype.square=function(_){return new m(this.value*this.value)};function _e(_,b){var x=_.length,O=b.length,D=n,L=w(b.length),G=b[O-1],V=Math.ceil(D/(2*G)),Z=ae(_,V),pe=ae(b,V),he,ge,Ie,Me,Ne,ke,Pe;for(Z.length<=x&&Z.push(0),pe.push(0),G=pe[O-1],ge=x-O;ge>=0;ge--){for(he=D-1,Z[ge+O]!==G&&(he=Math.floor((Z[ge+O]*D+Z[ge+O-1])/G)),Ie=0,Me=0,ke=pe.length,Ne=0;Ne<ke;Ne++)Ie+=he*pe[Ne],Pe=Math.floor(Ie/D),Me+=Z[ge+Ne]-(Ie-Pe*D),Ie=Pe,Me<0?(Z[ge+Ne]=Me+D,Me=-1):(Z[ge+Ne]=Me,Me=0);for(;Me!==0;){for(he-=1,Ie=0,Ne=0;Ne<ke;Ne++)Ie+=Z[ge+Ne]-D+pe[Ne],Ie<0?(Z[ge+Ne]=Ie+D,Ie=0):(Z[ge+Ne]=Ie,Ie=1);Me+=Ie}L[ge]=he}return Z=de(Z,V)[0],[y(L),y(Z)]}function me(_,b){for(var x=_.length,O=b.length,D=[],L=[],G=n,V,Z,pe,he,ge;x;){if(L.unshift(_[--x]),R(L),ve(L,b)<0){D.push(0);continue}Z=L.length,pe=L[Z-1]*G+L[Z-2],he=b[O-1]*G+b[O-2],Z>O&&(pe=(pe+1)*G),V=Math.ceil(pe/he);do{if(ge=ae(b,V),ve(ge,L)<=0)break;V--}while(V);D.push(V),L=te(L,ge)}return D.reverse(),[y(D),y(L)]}function de(_,b){var x=_.length,O=w(x),D=n,L,G,V,Z;for(V=0,L=x-1;L>=0;--L)Z=V*D+_[L],G=P(Z/b),V=Z-G*b,O[L]=G|0;return[O,V|0]}function be(_,b){var x,O=X(b);if(u)return[new m(_.value/O.value),new m(_.value%O.value)];var D=_.value,L=O.value,G;if(L===0)throw new Error("Cannot divide by zero");if(_.isSmall)return O.isSmall?[new d(P(D/L)),new d(D%L)]:[c[0],_];if(O.isSmall){if(L===1)return[_,c[0]];if(L==-1)return[_.negate(),c[0]];var V=Math.abs(L);if(V<n){x=de(D,V),G=y(x[0]);var Z=x[1];return _.sign&&(Z=-Z),typeof G=="number"?(_.sign!==O.sign&&(G=-G),[new d(G),new d(Z)]):[new f(G,_.sign!==O.sign),new d(Z)]}L=S(V)}var pe=ve(D,L);if(pe===-1)return[c[0],_];if(pe===0)return[c[_.sign===O.sign?1:-1],c[0]];D.length+L.length<=200?x=_e(D,L):x=me(D,L),G=x[0];var he=_.sign!==O.sign,ge=x[1],Ie=_.sign;return typeof G=="number"?(he&&(G=-G),G=new d(G)):G=new f(G,he),typeof ge=="number"?(Ie&&(ge=-ge),ge=new d(ge)):ge=new f(ge,Ie),[G,ge]}f.prototype.divmod=function(_){var b=be(this,_);return{quotient:b[0],remainder:b[1]}},m.prototype.divmod=d.prototype.divmod=f.prototype.divmod,f.prototype.divide=function(_){return be(this,_)[0]},m.prototype.over=m.prototype.divide=function(_){return new m(this.value/X(_).value)},d.prototype.over=d.prototype.divide=f.prototype.over=f.prototype.divide,f.prototype.mod=function(_){return be(this,_)[1]},m.prototype.mod=m.prototype.remainder=function(_){return new m(this.value%X(_).value)},d.prototype.remainder=d.prototype.mod=f.prototype.remainder=f.prototype.mod,f.prototype.pow=function(_){var b=X(_),x=this.value,O=b.value,D,L,G;if(O===0)return c[1];if(x===0)return c[0];if(x===1)return c[1];if(x===-1)return b.isEven()?c[1]:c[-1];if(b.sign)return c[0];if(!b.isSmall)throw new Error("The exponent "+b.toString()+" is too large.");if(this.isSmall&&g(D=Math.pow(x,O)))return new d(P(D));for(L=this,G=c[1];O&!0&&(G=G.times(L),--O),O!==0;)O/=2,L=L.square();return G},d.prototype.pow=f.prototype.pow,m.prototype.pow=function(_){var b=X(_),x=this.value,O=b.value,D=BigInt(0),L=BigInt(1),G=BigInt(2);if(O===D)return c[1];if(x===D)return c[0];if(x===L)return c[1];if(x===BigInt(-1))return b.isEven()?c[1]:c[-1];if(b.isNegative())return new m(D);for(var V=this,Z=c[1];(O&L)===L&&(Z=Z.times(V),--O),O!==D;)O/=G,V=V.square();return Z},f.prototype.modPow=function(_,b){if(_=X(_),b=X(b),b.isZero())throw new Error("Cannot take modPow with modulus 0");var x=c[1],O=this.mod(b);for(_.isNegative()&&(_=_.multiply(c[-1]),O=O.modInv(b));_.isPositive();){if(O.isZero())return c[0];_.isOdd()&&(x=x.multiply(O).mod(b)),_=_.divide(2),O=O.square().mod(b)}return x},m.prototype.modPow=d.prototype.modPow=f.prototype.modPow;function ve(_,b){if(_.length!==b.length)return _.length>b.length?1:-1;for(var x=_.length-1;x>=0;x--)if(_[x]!==b[x])return _[x]>b[x]?1:-1;return 0}f.prototype.compareAbs=function(_){var b=X(_),x=this.value,O=b.value;return b.isSmall?1:ve(x,O)},d.prototype.compareAbs=function(_){var b=X(_),x=Math.abs(this.value),O=b.value;return b.isSmall?(O=Math.abs(O),x===O?0:x>O?1:-1):-1},m.prototype.compareAbs=function(_){var b=this.value,x=X(_).value;return b=b>=0?b:-b,x=x>=0?x:-x,b===x?0:b>x?1:-1},f.prototype.compare=function(_){if(_===1/0)return-1;if(_===-1/0)return 1;var b=X(_),x=this.value,O=b.value;return this.sign!==b.sign?b.sign?1:-1:b.isSmall?this.sign?-1:1:ve(x,O)*(this.sign?-1:1)},f.prototype.compareTo=f.prototype.compare,d.prototype.compare=function(_){if(_===1/0)return-1;if(_===-1/0)return 1;var b=X(_),x=this.value,O=b.value;return b.isSmall?x==O?0:x>O?1:-1:x<0!==b.sign?x<0?-1:1:x<0?1:-1},d.prototype.compareTo=d.prototype.compare,m.prototype.compare=function(_){if(_===1/0)return-1;if(_===-1/0)return 1;var b=this.value,x=X(_).value;return b===x?0:b>x?1:-1},m.prototype.compareTo=m.prototype.compare,f.prototype.equals=function(_){return this.compare(_)===0},m.prototype.eq=m.prototype.equals=d.prototype.eq=d.prototype.equals=f.prototype.eq=f.prototype.equals,f.prototype.notEquals=function(_){return this.compare(_)!==0},m.prototype.neq=m.prototype.notEquals=d.prototype.neq=d.prototype.notEquals=f.prototype.neq=f.prototype.notEquals,f.prototype.greater=function(_){return this.compare(_)>0},m.prototype.gt=m.prototype.greater=d.prototype.gt=d.prototype.greater=f.prototype.gt=f.prototype.greater,f.prototype.lesser=function(_){return this.compare(_)<0},m.prototype.lt=m.prototype.lesser=d.prototype.lt=d.prototype.lesser=f.prototype.lt=f.prototype.lesser,f.prototype.greaterOrEquals=function(_){return this.compare(_)>=0},m.prototype.geq=m.prototype.greaterOrEquals=d.prototype.geq=d.prototype.greaterOrEquals=f.prototype.geq=f.prototype.greaterOrEquals,f.prototype.lesserOrEquals=function(_){return this.compare(_)<=0},m.prototype.leq=m.prototype.lesserOrEquals=d.prototype.leq=d.prototype.lesserOrEquals=f.prototype.leq=f.prototype.lesserOrEquals,f.prototype.isEven=function(){return(this.value[0]&1)===0},d.prototype.isEven=function(){return(this.value&1)===0},m.prototype.isEven=function(){return(this.value&BigInt(1))===BigInt(0)},f.prototype.isOdd=function(){return(this.value[0]&1)===1},d.prototype.isOdd=function(){return(this.value&1)===1},m.prototype.isOdd=function(){return(this.value&BigInt(1))===BigInt(1)},f.prototype.isPositive=function(){return!this.sign},d.prototype.isPositive=function(){return this.value>0},m.prototype.isPositive=d.prototype.isPositive,f.prototype.isNegative=function(){return this.sign},d.prototype.isNegative=function(){return this.value<0},m.prototype.isNegative=d.prototype.isNegative,f.prototype.isUnit=function(){return!1},d.prototype.isUnit=function(){return Math.abs(this.value)===1},m.prototype.isUnit=function(){return this.abs().value===BigInt(1)},f.prototype.isZero=function(){return!1},d.prototype.isZero=function(){return this.value===0},m.prototype.isZero=function(){return this.value===BigInt(0)},f.prototype.isDivisibleBy=function(_){var b=X(_);return b.isZero()?!1:b.isUnit()?!0:b.compareAbs(2)===0?this.isEven():this.mod(b).isZero()},m.prototype.isDivisibleBy=d.prototype.isDivisibleBy=f.prototype.isDivisibleBy;function Ae(_){var b=_.abs();if(b.isUnit())return!1;if(b.equals(2)||b.equals(3)||b.equals(5))return!0;if(b.isEven()||b.isDivisibleBy(3)||b.isDivisibleBy(5))return!1;if(b.lesser(49))return!0}function xe(_,b){for(var x=_.prev(),O=x,D=0,L,G,V;O.isEven();)O=O.divide(2),D++;e:for(G=0;G<b.length;G++)if(!_.lesser(b[G])&&(V=t(b[G]).modPow(O,_),!(V.isUnit()||V.equals(x)))){for(L=D-1;L!=0;L--){if(V=V.square().mod(_),V.isUnit())return!1;if(V.equals(x))continue e}return!1}return!0}f.prototype.isPrime=function(_){var b=Ae(this);if(b!==r)return b;var x=this.abs(),O=x.bitLength();if(O<=64)return xe(x,[2,3,5,7,11,13,17,19,23,29,31,37]);for(var D=Math.log(2)*O.toJSNumber(),L=Math.ceil(_===!0?2*Math.pow(D,2):D),G=[],V=0;V<L;V++)G.push(t(V+2));return xe(x,G)},m.prototype.isPrime=d.prototype.isPrime=f.prototype.isPrime,f.prototype.isProbablePrime=function(_,b){var x=Ae(this);if(x!==r)return x;for(var O=this.abs(),D=_===r?5:_,L=[],G=0;G<D;G++)L.push(t.randBetween(2,O.minus(2),b));return xe(O,L)},m.prototype.isProbablePrime=d.prototype.isProbablePrime=f.prototype.isProbablePrime,f.prototype.modInv=function(_){for(var b=t.zero,x=t.one,O=X(_),D=this.abs(),L,G,V;!D.isZero();)L=O.divide(D),G=b,V=O,b=x,O=D,x=G.subtract(L.multiply(x)),D=V.subtract(L.multiply(D));if(!O.isUnit())throw new Error(this.toString()+" and "+_.toString()+" are not co-prime");return b.compare(0)===-1&&(b=b.add(_)),this.isNegative()?b.negate():b},m.prototype.modInv=d.prototype.modInv=f.prototype.modInv,f.prototype.next=function(){var _=this.value;return this.sign?oe(_,1,this.sign):new f(H(_,1),this.sign)},d.prototype.next=function(){var _=this.value;return _+1<i?new d(_+1):new f(a,!1)},m.prototype.next=function(){return new m(this.value+BigInt(1))},f.prototype.prev=function(){var _=this.value;return this.sign?new f(H(_,1),!0):oe(_,1,this.sign)},d.prototype.prev=function(){var _=this.value;return _-1>-9007199254740992?new d(_-1):new f(a,!0)},m.prototype.prev=function(){return new m(this.value-BigInt(1))};for(var Re=[1];2*Re[Re.length-1]<=n;)Re.push(2*Re[Re.length-1]);var Ee=Re.length,Te=Re[Ee-1];function Oe(_){return Math.abs(_)<=n}f.prototype.shiftLeft=function(_){var b=X(_).toJSNumber();if(!Oe(b))throw new Error(String(b)+" is too large for shifting.");if(b<0)return this.shiftRight(-b);var x=this;if(x.isZero())return x;for(;b>=Ee;)x=x.multiply(Te),b-=Ee-1;return x.multiply(Re[b])},m.prototype.shiftLeft=d.prototype.shiftLeft=f.prototype.shiftLeft,f.prototype.shiftRight=function(_){var b,x=X(_).toJSNumber();if(!Oe(x))throw new Error(String(x)+" is too large for shifting.");if(x<0)return this.shiftLeft(-x);for(var O=this;x>=Ee;){if(O.isZero()||O.isNegative()&&O.isUnit())return O;b=be(O,Te),O=b[1].isNegative()?b[0].prev():b[0],x-=Ee-1}return b=be(O,Re[x]),b[1].isNegative()?b[0].prev():b[0]},m.prototype.shiftRight=d.prototype.shiftRight=f.prototype.shiftRight;function T(_,b,x){b=X(b);for(var O=_.isNegative(),D=b.isNegative(),L=O?_.not():_,G=D?b.not():b,V=0,Z=0,pe=null,he=null,ge=[];!L.isZero()||!G.isZero();)pe=be(L,Te),V=pe[1].toJSNumber(),O&&(V=Te-1-V),he=be(G,Te),Z=he[1].toJSNumber(),D&&(Z=Te-1-Z),L=pe[0],G=he[0],ge.push(x(V,Z));for(var Ie=x(O?1:0,D?1:0)!==0?t(-1):t(0),Me=ge.length-1;Me>=0;Me-=1)Ie=Ie.multiply(Te).add(t(ge[Me]));return Ie}f.prototype.not=function(){return this.negate().prev()},m.prototype.not=d.prototype.not=f.prototype.not,f.prototype.and=function(_){return T(this,_,function(b,x){return b&x})},m.prototype.and=d.prototype.and=f.prototype.and,f.prototype.or=function(_){return T(this,_,function(b,x){return b|x})},m.prototype.or=d.prototype.or=f.prototype.or,f.prototype.xor=function(_){return T(this,_,function(b,x){return b^x})},m.prototype.xor=d.prototype.xor=f.prototype.xor;var z=1<<30,Y=(n&-1e7)*(n&-1e7)|z;function se(_){var b=_.value,x=typeof b=="number"?b|z:typeof b=="bigint"?b|BigInt(z):b[0]+b[1]*n|Y;return x&-x}function ye(_,b){if(b.compareTo(_)<=0){var x=ye(_,b.square(b)),O=x.p,D=x.e,L=O.multiply(b);return L.compareTo(_)<=0?{p:L,e:D*2+1}:{p:O,e:D*2}}return{p:t(1),e:0}}f.prototype.bitLength=function(){var _=this;return _.compareTo(t(0))<0&&(_=_.negate().subtract(t(1))),_.compareTo(t(0))===0?t(0):t(ye(_,t(2)).e).add(t(1))},m.prototype.bitLength=d.prototype.bitLength=f.prototype.bitLength;function v(_,b){return _=X(_),b=X(b),_.greater(b)?_:b}function A(_,b){return _=X(_),b=X(b),_.lesser(b)?_:b}function k(_,b){if(_=X(_).abs(),b=X(b).abs(),_.equals(b))return _;if(_.isZero())return b;if(b.isZero())return _;for(var x=c[1],O,D;_.isEven()&&b.isEven();)O=A(se(_),se(b)),_=_.divide(O),b=b.divide(O),x=x.multiply(O);for(;_.isEven();)_=_.divide(se(_));do{for(;b.isEven();)b=b.divide(se(b));_.greater(b)&&(D=b,b=_,_=D),b=b.subtract(_)}while(!b.isZero());return x.isUnit()?_:_.multiply(x)}function q(_,b){return _=X(_).abs(),b=X(b).abs(),_.divide(k(_,b)).multiply(b)}function j(_,b,x){_=X(_),b=X(b);var O=x||Math.random,D=A(_,b),L=v(_,b),G=L.subtract(D).add(1);if(G.isSmall)return D.add(Math.floor(O()*G));for(var V=Q(G,n).value,Z=[],pe=!0,he=0;he<V.length;he++){var ge=pe?V[he]+(he+1<V.length?V[he+1]/n:0):n,Ie=P(O()*ge);Z.push(Ie),Ie<V[he]&&(pe=!1)}return D.add(c.fromArray(Z,n,!1))}var F=function(_,b,x,O){x=x||l,_=String(_),O||(_=_.toLowerCase(),x=x.toLowerCase());var D=_.length,L,G=Math.abs(b),V={};for(L=0;L<x.length;L++)V[x[L]]=L;for(L=0;L<D;L++){var Z=_[L];if(Z!=="-"&&Z in V&&V[Z]>=G){if(Z==="1"&&G===1)continue;throw new Error(Z+" is not a valid digit in base "+b+".")}}b=X(b);var pe=[],he=_[0]==="-";for(L=he?1:0;L<_.length;L++){var Z=_[L];if(Z in V)pe.push(X(V[Z]));else if(Z==="<"){var ge=L;do L++;while(_[L]!==">"&&L<_.length);pe.push(X(_.slice(ge+1,L)))}else throw new Error(Z+" is not a valid character")}return I(pe,b,he)};function I(_,b,x){var O=c[0],D=c[1],L;for(L=_.length-1;L>=0;L--)O=O.add(_[L].times(D)),D=D.times(b);return x?O.negate():O}function ee(_,b){return b=b||l,_<b.length?b[_]:"<"+_+">"}function Q(_,b){if(b=t(b),b.isZero()){if(_.isZero())return{value:[0],isNegative:!1};throw new Error("Cannot convert nonzero numbers to base 0.")}if(b.equals(-1)){if(_.isZero())return{value:[0],isNegative:!1};if(_.isNegative())return{value:[].concat.apply([],Array.apply(null,Array(-_.toJSNumber())).map(Array.prototype.valueOf,[1,0])),isNegative:!1};var x=Array.apply(null,Array(_.toJSNumber()-1)).map(Array.prototype.valueOf,[0,1]);return x.unshift([1]),{value:[].concat.apply([],x),isNegative:!1}}var O=!1;if(_.isNegative()&&b.isPositive()&&(O=!0,_=_.abs()),b.isUnit())return _.isZero()?{value:[0],isNegative:!1}:{value:Array.apply(null,Array(_.toJSNumber())).map(Number.prototype.valueOf,1),isNegative:O};for(var D=[],L=_,G;L.isNegative()||L.compareAbs(b)>=0;){G=L.divmod(b),L=G.quotient;var V=G.remainder;V.isNegative()&&(V=b.minus(V).abs(),L=L.next()),D.push(V.toJSNumber())}return D.push(L.toJSNumber()),{value:D.reverse(),isNegative:O}}function W(_,b,x){var O=Q(_,b);return(O.isNegative?"-":"")+O.value.map(function(D){return ee(D,x)}).join("")}f.prototype.toArray=function(_){return Q(this,_)},d.prototype.toArray=function(_){return Q(this,_)},m.prototype.toArray=function(_){return Q(this,_)},f.prototype.toString=function(_,b){if(_===r&&(_=10),_!==10||b)return W(this,_,b);for(var x=this.value,O=x.length,D=String(x[--O]),L="0000000",G;--O>=0;)G=String(x[O]),D+=L.slice(G.length)+G;var V=this.sign?"-":"";return V+D},d.prototype.toString=function(_,b){return _===r&&(_=10),_!=10||b?W(this,_,b):String(this.value)},m.prototype.toString=d.prototype.toString,m.prototype.toJSON=f.prototype.toJSON=d.prototype.toJSON=function(){return this.toString()},f.prototype.valueOf=function(){return parseInt(this.toString(),10)},f.prototype.toJSNumber=f.prototype.valueOf,d.prototype.valueOf=function(){return this.value},d.prototype.toJSNumber=d.prototype.valueOf,m.prototype.valueOf=m.prototype.toJSNumber=function(){return parseInt(this.toString(),10)};function le(_){if(g(+_)){var b=+_;if(b===P(b))return u?new m(BigInt(b)):new d(b);throw new Error("Invalid integer: "+_)}var x=_[0]==="-";x&&(_=_.slice(1));var O=_.split(/e/i);if(O.length>2)throw new Error("Invalid integer: "+O.join("e"));if(O.length===2){var D=O[1];if(D[0]==="+"&&(D=D.slice(1)),D=+D,D!==P(D)||!g(D))throw new Error("Invalid integer: "+D+" is not a valid exponent.");var L=O[0],G=L.indexOf(".");if(G>=0&&(D-=L.length-G-1,L=L.slice(0,G)+L.slice(G+1)),D<0)throw new Error("Cannot include negative exponent part for integers");L+=new Array(D+1).join("0"),_=L}var V=/^([0-9][0-9]*)$/.test(_);if(!V)throw new Error("Invalid integer: "+_);if(u)return new m(BigInt(x?"-"+_:_));for(var Z=[],pe=_.length,he=s,ge=pe-he;pe>0;)Z.push(+_.slice(ge,pe)),ge-=he,ge<0&&(ge=0),pe-=he;return R(Z),new f(Z,x)}function ne(_){if(u)return new m(BigInt(_));if(g(_)){if(_!==P(_))throw new Error(_+" is not an integer.");return new d(_)}return le(_.toString())}function X(_){return typeof _=="number"?ne(_):typeof _=="string"?le(_):typeof _=="bigint"?new m(_):_}for(var ce=0;ce<1e3;ce++)c[ce]=X(ce),ce>0&&(c[-ce]=X(-ce));return c.one=c[1],c.zero=c[0],c.minusOne=c[-1],c.max=v,c.min=A,c.gcd=k,c.lcm=q,c.isInstance=function(_){return _ instanceof f||_ instanceof d||_ instanceof m},c.randBetween=j,c.fromArray=function(_,b,x){return I(_.map(X),X(b||10),x)},c}();e.hasOwnProperty("exports")&&(e.exports=t)}(BigInteger)),BigInteger.exports}var hasRequiredAlgebrite;function requireAlgebrite(){return hasRequiredAlgebrite||(hasRequiredAlgebrite=1,function(exports){(function(){var $,ABS,ADD,ADJ,AND,APPROXRATIO,ARCCOS,ARCCOSH,ARCSIN,ARCSINH,ARCTAN,ARCTANH,ARG,ASSUME_REAL_VARIABLES,ATOMIZE,AUTOEXPAND,BAKE,BESSELJ,BESSELY,BINDING,BINOMIAL,BINOM_check_args,C1,C2,C3,C4,C5,C6,CEILING,CHECK,CHOOSE,CIRCEXP,CLEAR,CLEARALL,CLEARPATTERNS,CLOCK,COEFF,COFACTOR,CONDENSE,CONJ,CONS,CONTRACT,COS,COSH,Condense,DEBUG,DEBUG_ABS,DEBUG_ARG,DEBUG_CLOCKFORM,DEBUG_IMAG,DEBUG_IS,DEBUG_MULTIPLY,DEBUG_POWER,DEBUG_RATIONALIZE,DEBUG_RECT,DEBUG_SIMPLIFY,DECOMP,DEFINT,DEGREE,DENOMINATOR,DERIVATIVE,DET,DET_check_arg,DIM,DIRAC,DIVISORS,DO,DOT,DOUBLE,DRAW,DRAWX,DSOLVE,E,EIGEN,EIGENVAL,EIGENVEC,EIG_N,EIG_check_arg,EIG_yydd,EIG_yyqq,ERF,ERFC,EVAL,EXP,EXPAND,EXPCOS,EXPSIN,Eval,Eval_Eval,Eval_abs,Eval_add,Eval_adj,Eval_and,Eval_approxratio,Eval_arccos,Eval_arccosh,Eval_arcsin,Eval_arcsinh,Eval_arctan,Eval_arctanh,Eval_arg,Eval_besselj,Eval_bessely,Eval_binding,Eval_binomial,Eval_ceiling,Eval_check,Eval_choose,Eval_circexp,Eval_clear,Eval_clearall,Eval_clearpatterns,Eval_clock,Eval_coeff,Eval_cofactor,Eval_condense,Eval_conj,Eval_cons,Eval_contract,Eval_cos,Eval_cosh,Eval_decomp,Eval_defint,Eval_degree,Eval_denominator,Eval_derivative,Eval_det,Eval_dim,Eval_dirac,Eval_divisors,Eval_do,Eval_dsolve,Eval_eigen,Eval_eigenval,Eval_eigenvec,Eval_erf,Eval_erfc,Eval_exp,Eval_expand,Eval_expcos,Eval_expsin,Eval_factor,Eval_factorial,Eval_factorpoly,Eval_filter,Eval_float,Eval_floor,Eval_for,Eval_function_reference,Eval_gamma,Eval_gcd,Eval_hermite,Eval_hilbert,Eval_imag,Eval_index,Eval_inner,Eval_integral,Eval_inv,Eval_invg,Eval_isinteger,Eval_isprime,Eval_laguerre,Eval_lcm,Eval_leading,Eval_legendre,Eval_log,Eval_lookup,Eval_mod,Eval_multiply,Eval_not,Eval_nroots,Eval_number,Eval_numerator,Eval_operator,Eval_or,Eval_outer,Eval_pattern,Eval_patternsinfo,Eval_polar,Eval_power,Eval_predicate,Eval_prime,Eval_print,Eval_print2dascii,Eval_printcomputer,Eval_printhuman,Eval_printlatex,Eval_printlist,Eval_product,Eval_quote,Eval_quotient,Eval_rank,Eval_rationalize,Eval_real,Eval_rect,Eval_roots,Eval_round,Eval_setq,Eval_sgn,Eval_shape,Eval_silentpattern,Eval_simplify,Eval_sin,Eval_sinh,Eval_sqrt,Eval_stop,Eval_subst,Eval_sum,Eval_sym,Eval_symbolsinfo,Eval_tan,Eval_tanh,Eval_taylor,Eval_tensor,Eval_test,Eval_testeq,Eval_testge,Eval_testgt,Eval_testle,Eval_testlt,Eval_transpose,Eval_unit,Eval_user_function,Eval_zero,Evalpoly,FACTOR,FACTORIAL,FACTORPOLY,FILTER,FLOATF,FLOOR,FOR,FORCE_FIXED_PRINTOUT,FUNCTION,Find,GAMMA,GCD,HERMITE,HILBERT,IMAG,INDEX,INNER,INTEGRAL,INV,INVG,INV_check_arg,INV_decomp,ISINTEGER,ISPRIME,LAGUERRE,LAST,LAST_2DASCII_PRINT,LAST_FULL_PRINT,LAST_LATEX_PRINT,LAST_LIST_PRINT,LAST_PLAIN_PRINT,LAST_PRINT,LCM,LEADING,LEGENDRE,LOG,LOOKUP,M,MAXDIM,MAXPRIMETAB,MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES,MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE,MAX_FIXED_PRINTOUT_DIGITS,MEQUAL,METAA,METAB,METAX,MOD,MSIGN,MULTIPLY,MZERO,N,NIL,NOT,NROOTS,NROOTS_ABS,NROOTS_DELTA,NROOTS_EPSILON,NROOTS_RANDOM,NROOTS_YMAX,NROOTS_divpoly,NSYM,NUM,NUMBER,NUMERATOR,OPERATOR,OR,OUTER,PATTERN,PATTERNSINFO,PI,POLAR,POWER,PRIME,PRINT,PRINT2DASCII,PRINTFULL,PRINTLATEX,PRINTLIST,PRINTMODE_2DASCII,PRINTMODE_COMPUTER,PRINTMODE_HUMAN,PRINTMODE_LATEX,PRINTMODE_LIST,PRINTOUTRESULT,PRINTPLAIN,PRINT_LEAVE_E_ALONE,PRINT_LEAVE_X_ALONE,PRODUCT,QUOTE,QUOTIENT,RANK,RATIONALIZE,REAL,ROOTS,ROUND,SECRETX,SETQ,SGN,SHAPE,SILENTPATTERN,SIMPLIFY,SIN,SINH,SPACE_BETWEEN_COLUMNS,SPACE_BETWEEN_ROWS,SQRT,STOP,STR,SUBST,SUM,SYM,SYMBOLSINFO,SYMBOL_A,SYMBOL_A_UNDERSCORE,SYMBOL_B,SYMBOL_B_UNDERSCORE,SYMBOL_C,SYMBOL_D,SYMBOL_I,SYMBOL_IDENTITY_MATRIX,SYMBOL_J,SYMBOL_N,SYMBOL_R,SYMBOL_S,SYMBOL_T,SYMBOL_X,SYMBOL_X_UNDERSCORE,SYMBOL_Y,SYMBOL_Z,TAN,TANH,TAYLOR,TENSOR,TEST,TESTEQ,TESTGE,TESTGT,TESTLE,TESTLT,TIMING_DEBUGS,TOS,TRACE,TRANSPOSE,T_DOUBLE,T_EQ,T_FUNCTION,T_GTEQ,T_INTEGER,T_LTEQ,T_NEQ,T_NEWLINE,T_QUOTASSIGN,T_STRING,T_SYMBOL,U,UNIT,VERSION,YMAX,YYE,YYRECT,ZERO,__emit_char,__emit_str,__factor_add,__factorial,__is_negative,__is_radical_number,__lcm,__legendre,__legendre2,__legendre3,__normalize_radical_factors,__rationalize_tensor,_print,abs,absValFloat,absval,absval_tensor,add,addSymbolLeftOfAssignment,addSymbolRightOfAssignment,add_all,add_factor_to_accumulator,add_numbers,add_terms,adj,alloc_tensor,allocatedId,any_denominators,approxAll,approxLogs,approxLogsOfRationals,approxOneRatioOnly,approxRadicals,approxRadicalsOfRationals,approxRationalsOfLogs,approxRationalsOfPowersOfE,approxRationalsOfPowersOfPI,approxRationalsOfRadicals,approxSineOfRationalMultiplesOfPI,approxSineOfRationals,approxTrigonometric,approx_just_an_integer,approx_logarithmsOfRationals,approx_radicalOfRatio,approx_ratioOfRadical,approx_rationalOfE,approx_rationalOfPi,approx_rationalsOfLogarithms,approx_sine_of_pi_times_rational,approx_sine_of_rational,approxratioRecursive,arccos,arccosh,arcsin,arcsinh,arctan,arctanh,areunivarpolysfactoredorexpandedform,arg,assignmentFound,avoidCalculatingPowersIntoArctans,bake,bake_poly,bake_poly_term,besselj,bessely,bigInt,bignum_factorial,bignum_float,bignum_power_number,bignum_scan_float,bignum_scan_integer,bignum_truncate,binding,binomial,build_tensor,caaddr,caadr,caar,cadaddr,cadadr,cadar,caddaddr,caddadr,caddar,caddddr,cadddr,caddr,cadr,car,cdaddr,cdadr,cdar,cddaddr,cddar,cdddaddr,cddddr,cdddr,cddr,cdr,ceiling,chainOfUserSymbolsNotFunctionsBeingEvaluated,charTabIndex,chartab,check_esc_flag,check_stack,check_tensor_dimensions,choose,choose_check_args,circexp,clearAlgebraEnvironment,clearRenamedVariablesToAvoidBindingToExternalScope,clear_symbols,clear_term,clockform,cmpGlyphs,cmp_args,cmp_expr,cmp_terms,codeGen,coeff,cofactor,collectLatexStringFromReturnValue,collectUserSymbols,combine_factors,combine_terms,compare_numbers,compare_rationals,compare_tensors,compatible,computeDependenciesFromAlgebra,computeResultsAndJavaScriptFromAlgebra,compute_fa,conjugate,cons,consCount,contract,convert_rational_to_double,copy_tensor,cosine,cosine_of_angle,cosine_of_angle_sum,count,countOccurrencesOfSymbol,count_denominators,counter,countsize,d_scalar_scalar,d_scalar_scalar_1,d_scalar_tensor,d_tensor_scalar,d_tensor_tensor,dabs,darccos,darccosh,darcsin,darcsinh,darctan,darctanh,dbesselj0,dbesseljn,dbessely0,dbesselyn,dcos,dcosh,dd,decomp,decomp_product,decomp_sum,defineSomeHandyConstants,define_user_function,defn,defn_str,degree,denominator,derf,derfc,derivative,derivative_of_integral,det,determinant,dfunction,dhermite,dirac,divide,divide_numbers,divisors,divisors_onstack,divpoly,dlog,do_clearPatterns,do_clearall,do_simplify_nested_radicals,dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication,dotprod_unicode,doubleToReasonableString,dpow,dpower,dproduct,dsgn,dsin,dsinh,dsum,dtan,dtanh,dupl,eigen,elelmIndex,elem,emit_denominator,emit_denominators,emit_expr,emit_factor,emit_factorial_function,emit_flat_tensor,emit_fraction,emit_function,emit_index_function,emit_multiply,emit_number,emit_numerators,emit_numerical_fraction,emit_power,emit_string,emit_subexpr,emit_symbol,emit_tensor,emit_tensor_inner,emit_term,emit_top_expr,emit_unsigned_expr,emit_x,equal,equaln,equalq,erfc,errorMessage,esc_flag,evaluatingAsFloats,evaluatingPolar,exec,expand,expand_get_A,expand_get_AF,expand_get_B,expand_get_C,expand_get_CF,expand_tensor,expanding,expcos,exponential,expr_level,expsin,f1,f10,f2,f3,f4,f5,f9,f_equals_a,factor,factor_a,factor_again,factor_b,factor_number,factor_small_number,factor_term,factorial,factorpoly,factors,filter,filter_main,filter_sum,filter_tensor,findDependenciesInScript,findPossibleClockForm,findPossibleExponentialForm,findroot,fixup_fraction,fixup_power,flag,floatToRatioRoutine,frame,functionInvokationsScanningStack,gamma,gamma_of_sum,gammaf,gcd,gcd_main,gcd_numbers,gcd_polys,gcd_powers_with_same_base,gcd_product_product,gcd_product_sum,gcd_sum,gcd_sum_product,gcd_sum_sum,gen,getSimpleRoots,get_binding,get_factor_from_complex_root,get_factor_from_real_root,get_innerprod_factors,get_next_token,get_printname,get_size,get_token,glyph,guess,hasImaginaryCoeff,hasNegativeRationalExponent,hash_addition,hash_function,hash_multiplication,hash_power,hashcode_values,hashed_itab,hermite,hilbert,i1,imag,imaginaryunit,index_function,init,initNRoots,inited,inner,inner_f,input_str,integral,integral_of_form,integral_of_product,integral_of_sum,inv,inverse,invert_number,invg,isNumberOneOverSomething,isNumericAtom,isNumericAtomOrTensor,isSimpleRoot,isSmall,isSymbolLeftOfAssignment,isSymbolReclaimable,isZeroAtom,isZeroAtomOrTensor,isZeroLikeOrNonZeroLikeOrUndetermined,isZeroTensor,is_denominator,is_factor,is_small_integer,is_usr_symbol,isadd,isalnumorunderscore,isalpha,isalphaOrUnderscore,iscomplexnumber,iscomplexnumberdouble,iscons,isdenominator,isdigit,isdouble,iseveninteger,isfactor,isfactorial,isfloating,isfraction,isidentitymatrix,isimaginarynumber,isimaginarynumberdouble,isimaginaryunit,isinnerordot,isinteger,isintegerfactor,isintegerorintegerfloat,isinv,iskeyword,isminusone,isminusoneoversqrttwo,isminusoneovertwo,isminussqrtthreeovertwo,ismultiply,isnegative,isnegativenumber,isnegativeterm,isnonnegativeinteger,isnpi,isone,isoneover,isoneoversqrttwo,isoneovertwo,isplusone,isplustwo,ispolyexpandedform,ispolyexpandedform_expr,ispolyexpandedform_factor,ispolyexpandedform_term,ispolyfactoredorexpandedform,ispolyfactoredorexpandedform_factor,ispolyfactoredorexpandedform_power,isposint,ispositivenumber,ispower,isquarterturn,isrational,isspace,issqrtthree,issqrtthreeovertwo,isstr,issymbol,issymbolic,istensor,istranspose,isunivarpolyfactoredorexpandedform,itab,italu_hashcode,j1,laguerre,laguerre2,lastFoundSymbol,latexErrorSign,lcm,leading,legendre,length,lessp,level,list,logarithm,lookupsTotal,lu_decomp,madd,makePositive,makeSignSameAs,make_hashed_itab,mcmp,mdiv,mdivrem,meta_mode,mgcd,mini_solve,mint,mmod,mmul,mod,monic,move,moveTos,mp_denominator,mp_numerator,mpow,mprime,mroot,msub,multinomial_sum,multiply,multiply_all,multiply_all_noexpand,multiply_consecutive_constants,multiply_denominators,multiply_denominators_factor,multiply_denominators_term,multiply_noexpand,multiply_numbers,n_factor_number,negate,negate_noexpand,negate_number,new_integer,new_string,newline_flag,nil_symbols,normaliseDots,normalisedCoeff,normalize_angle,nroots_a,nroots_b,nroots_c,nroots_df,nroots_dx,nroots_fa,nroots_fb,nroots_x,nroots_y,nterms,numerator,numericRootOfPolynomial,o,one,oneElement,one_as_double,outer,p0,p1,p2,p3,p4,p5,p6,p7,p8,p9,parse,parse_internal,parse_p1,parse_p2,parse_time_simplifications,partition,patternHasBeenFound,patternsinfo,polar,polarRectAMinusOneBase,polyform,pop,pop_double,pop_frame,pop_integer,power,power_str,power_sum,power_tensor,predefinedSymbolsInGlobalScope_doNotTrackInDependencies,prime,primetab,print2dascii,printMode,print_ABS_latex,print_ARCCOS_codegen,print_ARCSIN_codegen,print_ARCTAN_codegen,print_BINOMIAL_latex,print_COS_codegen,print_DEFINT_latex,print_DOT_codegen,print_DOT_latex,print_DO_codegen,print_FOR_codegen,print_INV_codegen,print_INV_latex,print_PRODUCT_codegen,print_PRODUCT_latex,print_SETQ_codegen,print_SIN_codegen,print_SQRT_latex,print_SUM_codegen,print_SUM_latex,print_TAN_codegen,print_TESTEQ_latex,print_TESTGE_latex,print_TESTGT_latex,print_TESTLE_latex,print_TESTLT_latex,print_TEST_codegen,print_TEST_latex,print_TRANSPOSE_codegen,print_TRANSPOSE_latex,print_UNIT_codegen,print_a_over_b,print_base_of_denom,print_char,print_denom,print_expo_of_denom,print_expr,print_factor,print_factorial_function,print_glyphs,print_index_function,print_list,print_multiply_sign,print_number,print_power,print_str,print_subexpr,print_tensor,print_tensor_inner,print_tensor_inner_latex,print_tensor_latex,print_term,printchar,printchar_nowrap,printline,promote_tensor,push,pushTryNotToDuplicate,push_double,push_factor,push_frame,push_integer,push_rational,push_symbol,push_term_factors,push_terms,push_zero_matrix,qadd,qdiv,qmul,qpow,qpowf,quickfactor,quickpower,rational,rationalize,rationalize_coefficients,real,reciprocate,rect,recursionLevelNestedRadicalsRemoval,recursiveDependencies,ref,ref1,rememberPrint,remove_negative_exponents,reset_after_error,restore,restoreMetaBindings,rewrite_args,rewrite_args_tensor,roots,roots2,roots3,run,runUserDefinedSimplifications,save,saveMetaBindings,scalar_times_tensor,scan,scan_error,scan_expression,scan_factor,scan_function_call_with_function_name,scan_function_call_without_function_name,scan_index,scan_meta,scan_power,scan_relation,scan_stmt,scan_str,scan_string,scan_subexpr,scan_symbol,scan_tensor,scan_term,scanned,scanningParameters,setM,setSignTo,set_binding,set_component,setq_indexed,sgn,shape,sign,sign_of_term,simfac,simfac_term,simpleComplexityMeasure,simplify,simplifyForCodeGeneration,simplify_1_in_products,simplify_main,simplify_nested_radicals,simplify_polar,simplify_polarRect,simplify_rational_expressions,simplify_rectToClock,simplify_tensor,simplify_trig,sine,sine_of_angle,sine_of_angle_sum,skipRootVariableToBeSolved,sort_stack,square,stack,stackAddsCount,std_symbol,step,step2,stop,strcmp,stringsEmittedByUserPrintouts,subst,subtract,swap,symbol,symbolsDependencies,symbolsHavingReassignments,symbolsInExpressionsWithoutAssignments,symbolsLeftOfAssignment,symbolsRightOfAssignment,symbolsinfo,symnum,symtab,take_care_of_nested_radicals,tangent,taylor,tensor,tensor_plus_tensor,tensor_times_scalar,testApprox,test_flag,token,token_buf,token_str,top,top_level_eval,tos,transform,transpose,transpose_unicode,trigmode,trivial_divide,try_kth_prime,turnErrorMessageToLatex,update_token_buf,userSimplificationsInListForm,userSimplificationsInStringForm,usr_symbol,version,will_be_displayed_as_fraction,ybinomial,ycosh,ydirac,yerf,yerfc,yfloor,yindex,yround,ysinh,yyarg,yybesselj,yybessely,yyceiling,yycondense,yycontract,yycosh,yydegree,yydetg,yydivpoly,yyerf,yyerfc,yyexpand,yyfactorpoly,yyfloat,yyfloor,yyhermite,yyhermite2,yyinvg,yylcm,yylog,yymultiply,yyouter,yypower,yyrationalize,yyround,yysgn,yysimfac,yysinh,yytangent,zero,zzfloat,hasProp={}.hasOwnProperty;for(bigInt=requireBigInteger(),version="1.4.0",NSYM=1e3,DEBUG=!1,PRINTOUTRESULT=!1,PRINTMODE_LATEX="PRINTMODE_LATEX",PRINTMODE_2DASCII="PRINTMODE_2DASCII",PRINTMODE_COMPUTER="PRINTMODE_COMPUTER",PRINTMODE_HUMAN="PRINTMODE_HUMAN",PRINTMODE_LIST="PRINTMODE_LIST",printMode=PRINTMODE_COMPUTER,dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication=!0,recursionLevelNestedRadicalsRemoval=0,do_simplify_nested_radicals=!0,avoidCalculatingPowersIntoArctans=!0,rational=(function(){class e{}return e.prototype.a=null,e.prototype.b=null,e}).call(this),U=(function(){class e{toString(){return print_expr(this)}toLatexString(){return collectLatexStringFromReturnValue(this)}constructor(){this.cons={},this.cons.car=null,this.cons.cdr=null,this.q=new rational}}return e.prototype.cons=null,e.prototype.printname="",e.prototype.str="",e.prototype.tensor=null,e.prototype.q=null,e.prototype.d=0,e.prototype.k=0,e.prototype.tag=0,e}).call(this),errorMessage="",CONS=0,NUM=1,DOUBLE=2,STR=3,TENSOR=4,SYM=5,counter=0,ABS=counter++,ADD=counter++,ADJ=counter++,AND=counter++,APPROXRATIO=counter++,ARCCOS=counter++,ARCCOSH=counter++,ARCSIN=counter++,ARCSINH=counter++,ARCTAN=counter++,ARCTANH=counter++,ARG=counter++,ATOMIZE=counter++,BESSELJ=counter++,BESSELY=counter++,BINDING=counter++,BINOMIAL=counter++,CEILING=counter++,CHECK=counter++,CHOOSE=counter++,CIRCEXP=counter++,CLEAR=counter++,CLEARALL=counter++,CLEARPATTERNS=counter++,CLOCK=counter++,COEFF=counter++,COFACTOR=counter++,CONDENSE=counter++,CONJ=counter++,CONTRACT=counter++,COS=counter++,COSH=counter++,DECOMP=counter++,DEFINT=counter++,DEGREE=counter++,DENOMINATOR=counter++,DERIVATIVE=counter++,DET=counter++,DIM=counter++,DIRAC=counter++,DIVISORS=counter++,DO=counter++,DOT=counter++,DRAW=counter++,DSOLVE=counter++,EIGEN=counter++,EIGENVAL=counter++,EIGENVEC=counter++,ERF=counter++,ERFC=counter++,EVAL=counter++,EXP=counter++,EXPAND=counter++,EXPCOS=counter++,EXPSIN=counter++,FACTOR=counter++,FACTORIAL=counter++,FACTORPOLY=counter++,FILTER=counter++,FLOATF=counter++,FLOOR=counter++,FOR=counter++,FUNCTION=counter++,GAMMA=counter++,GCD=counter++,HERMITE=counter++,HILBERT=counter++,IMAG=counter++,INDEX=counter++,INNER=counter++,INTEGRAL=counter++,INV=counter++,INVG=counter++,ISINTEGER=counter++,ISPRIME=counter++,LAGUERRE=counter++,LCM=counter++,LEADING=counter++,LEGENDRE=counter++,LOG=counter++,LOOKUP=counter++,MOD=counter++,MULTIPLY=counter++,NOT=counter++,NROOTS=counter++,NUMBER=counter++,NUMERATOR=counter++,OPERATOR=counter++,OR=counter++,OUTER=counter++,PATTERN=counter++,PATTERNSINFO=counter++,POLAR=counter++,POWER=counter++,PRIME=counter++,PRINT_LEAVE_E_ALONE=counter++,PRINT_LEAVE_X_ALONE=counter++,PRINT=counter++,PRINT2DASCII=counter++,PRINTFULL=counter++,PRINTLATEX=counter++,PRINTLIST=counter++,PRINTPLAIN=counter++,PRODUCT=counter++,QUOTE=counter++,QUOTIENT=counter++,RANK=counter++,RATIONALIZE=counter++,REAL=counter++,ROUND=counter++,YYRECT=counter++,ROOTS=counter++,SETQ=counter++,SGN=counter++,SILENTPATTERN=counter++,SIMPLIFY=counter++,SIN=counter++,SINH=counter++,SHAPE=counter++,SQRT=counter++,STOP=counter++,SUBST=counter++,SUM=counter++,SYMBOLSINFO=counter++,TAN=counter++,TANH=counter++,TAYLOR=counter++,TEST=counter++,TESTEQ=counter++,TESTGE=counter++,TESTGT=counter++,TESTLE=counter++,TESTLT=counter++,TRANSPOSE=counter++,UNIT=counter++,ZERO=counter++,NIL=counter++,LAST=counter++,LAST_PRINT=counter++,LAST_2DASCII_PRINT=counter++,LAST_FULL_PRINT=counter++,LAST_LATEX_PRINT=counter++,LAST_LIST_PRINT=counter++,LAST_PLAIN_PRINT=counter++,AUTOEXPAND=counter++,BAKE=counter++,ASSUME_REAL_VARIABLES=counter++,TRACE=counter++,FORCE_FIXED_PRINTOUT=counter++,MAX_FIXED_PRINTOUT_DIGITS=counter++,YYE=counter++,DRAWX=counter++,METAA=counter++,METAB=counter++,METAX=counter++,SECRETX=counter++,VERSION=counter++,PI=counter++,SYMBOL_A=counter++,SYMBOL_B=counter++,SYMBOL_C=counter++,SYMBOL_D=counter++,SYMBOL_I=counter++,SYMBOL_J=counter++,SYMBOL_N=counter++,SYMBOL_R=counter++,SYMBOL_S=counter++,SYMBOL_T=counter++,SYMBOL_X=counter++,SYMBOL_Y=counter++,SYMBOL_Z=counter++,SYMBOL_IDENTITY_MATRIX=counter++,SYMBOL_A_UNDERSCORE=counter++,SYMBOL_B_UNDERSCORE=counter++,SYMBOL_X_UNDERSCORE=counter++,C1=counter++,C2=counter++,C3=counter++,C4=counter++,C5=counter++,C6=counter++,counter++,E=YYE,TOS=1e5,MAXPRIMETAB=1e4,MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES=5,MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE=10,MAXDIM=24,symbolsDependencies={},symbolsHavingReassignments=[],symbolsInExpressionsWithoutAssignments=[],patternHasBeenFound=!1,predefinedSymbolsInGlobalScope_doNotTrackInDependencies=["rationalize","abs","e","i","pi","sin","ceiling","cos","roots","integral","derivative","defint","sqrt","eig","cov","deig","dcov","float","floor","product","root","round","sum","test","unit"],parse_time_simplifications=!0,chainOfUserSymbolsNotFunctionsBeingEvaluated=[],stringsEmittedByUserPrintouts="",tensor=(function(){class e{constructor(){this.dim=function(){var r,n,s;for(s=[],r=0,n=MAXDIM;0<=n?r<=n:r>=n;0<=n?r++:r--)s.push(0);return s}(),this.elem=[]}}return e.prototype.ndim=0,e.prototype.dim=null,e.prototype.nelem=0,e.prototype.elem=null,e}).call(this),(function(){class e{}return e.prototype.h=0,e.prototype.w=0,e.prototype.n=0,e.prototype.a=[],e}).call(this),(function(){class e{}return e.prototype.ascent=0,e.prototype.descent=0,e.prototype.width=0,e}).call(this),tos=0,expanding=0,evaluatingAsFloats=0,evaluatingPolar=0,primetab=function(){var e,t,r,n;for(n=[2],t=3;n.length<MAXPRIMETAB;){for(r=0,e=Math.sqrt(t);r<n.length&&n[r]<=e;){if(t%n[r]===0){r=-1;break}r++}r!==-1&&n.push(t),t+=2}return n[MAXPRIMETAB]=0,n}(),esc_flag=0,trigmode=0,symtab=[],binding=[],isSymbolReclaimable=[],stack=[],frame=0,p0=null,p1=null,p2=null,p3=null,p4=null,p5=null,p6=null,p7=null,p8=null,p9=null,zero=null,one=null,one_as_double=null,imaginaryunit=null,test_flag=0,codeGen=!1,userSimplificationsInListForm=[],userSimplificationsInStringForm=[],transpose_unicode=7488,dotprod_unicode=183,symbol=function(e){return symtab[e]},iscons=function(e){return e.k===CONS},isrational=function(e){return e.k===NUM},isdouble=function(e){return e.k===DOUBLE},isNumericAtom=function(e){return isrational(e)||isdouble(e)},isstr=function(e){return e.k===STR},istensor=function(e){if(e==null)debugger;else return e.k===TENSOR},isNumericAtomOrTensor=function(e){var t,r,n,s,i;if(isNumericAtom(e)||e===symbol(SYMBOL_IDENTITY_MATRIX))return 1;if(!istensor(e)&&!isNumericAtom(e))return 0;for(n=e.tensor.nelem,t=e.tensor.elem,r=s=0,i=n;0<=i?s<i:s>i;r=0<=i?++s:--s)if(!isNumericAtomOrTensor(t[r]))return 0;return 1},issymbol=function(e){return e.k===SYM},iskeyword=function(e){return issymbol(e)&&symnum(e)<NIL},car=function(e){return iscons(e)?e.cons.car:symbol(NIL)},cdr=function(e){return iscons(e)?e.cons.cdr:symbol(NIL)},caar=function(e){return car(car(e))},cadr=function(e){return car(cdr(e))},cdar=function(e){return cdr(car(e))},cddr=function(e){return cdr(cdr(e))},caadr=function(e){return car(car(cdr(e)))},caddr=function(e){return car(cdr(cdr(e)))},cadar=function(e){return car(cdr(car(e)))},cdadr=function(e){return cdr(car(cdr(e)))},cddar=function(e){return cdr(cdr(car(e)))},cdddr=function(e){return cdr(cdr(cdr(e)))},caaddr=function(e){return car(car(cdr(cdr(e))))},cadadr=function(e){return car(cdr(car(cdr(e))))},caddar=function(e){return car(cdr(cdr(car(e))))},cdaddr=function(e){return cdr(car(cdr(cdr(e))))},cadddr=function(e){return car(cdr(cdr(cdr(e))))},cddddr=function(e){return cdr(cdr(cdr(cdr(e))))},caddddr=function(e){return car(cdr(cdr(cdr(cdr(e)))))},cadaddr=function(e){return car(cdr(car(cdr(cdr(e)))))},cddaddr=function(e){return cdr(cdr(car(cdr(cdr(e)))))},caddadr=function(e){return car(cdr(cdr(car(cdr(e)))))},cdddaddr=function(e){return cdr(cdr(cdr(car(cdr(cdr(e))))))},caddaddr=function(e){return car(cdr(cdr(car(cdr(cdr(e))))))},isadd=function(e){return car(e)===symbol(ADD)},ismultiply=function(e){return car(e)===symbol(MULTIPLY)},ispower=function(e){return car(e)===symbol(POWER)},isfactorial=function(e){return car(e)===symbol(FACTORIAL)},isinnerordot=function(e){return car(e)===symbol(INNER)||car(e)===symbol(DOT)},istranspose=function(e){return car(e)===symbol(TRANSPOSE)},isinv=function(e){return car(e)===symbol(INV)},isidentitymatrix=function(e){return e===symbol(SYMBOL_IDENTITY_MATRIX)},MSIGN=function(e){return e.isPositive()?1:e.isZero()?0:-1},MZERO=function(e){return e.isZero()},MEQUAL=function(e,t){if(e==null)debugger;return e.equals(t)},reset_after_error=function(){return moveTos(0),esc_flag=0,frame=TOS,evaluatingAsFloats=0,evaluatingPolar=0},$=exports!==null?exports:this,$.version=version,$.isadd=isadd,$.ismultiply=ismultiply,$.ispower=ispower,$.isfactorial=isfactorial,$.car=car,$.cdr=cdr,$.caar=caar,$.cadr=cadr,$.cdar=cdar,$.cddr=cddr,$.caadr=caadr,$.caddr=caddr,$.cadar=cadar,$.cdadr=cdadr,$.cddar=cddar,$.cdddr=cdddr,$.caaddr=caaddr,$.cadadr=cadadr,$.caddar=caddar,$.cdaddr=cdaddr,$.cadddr=cadddr,$.cddddr=cddddr,$.caddddr=caddddr,$.cadaddr=cadaddr,$.cddaddr=cddaddr,$.caddadr=caddadr,$.cdddaddr=cdddaddr,$.caddaddr=caddaddr,$.symbol=symbol,$.iscons=iscons,$.isrational=isrational,$.isdouble=isdouble,$.isNumericAtom=isNumericAtom,$.isstr=isstr,$.istensor=istensor,$.issymbol=issymbol,$.iskeyword=iskeyword,$.CONS=CONS,$.NUM=NUM,$.DOUBLE=DOUBLE,$.STR=STR,$.TENSOR=TENSOR,$.SYM=SYM,DEBUG_ABS=!1,Eval_abs=function(){return push(cadr(p1)),Eval(),abs()},absValFloat=function(){return Eval(),absval(),Eval(),zzfloat()},abs=function(){var e;if(e=top(),DEBUG_ABS&&console.trace(">>>>  ABS of "+e),numerator(),DEBUG_ABS&&console.log("ABS numerator "+stack[tos-1]),absval(),DEBUG_ABS&&console.log("ABSVAL numerator: "+stack[tos-1]),push(e),denominator(),DEBUG_ABS&&console.log("ABS denominator: "+stack[tos-1]),absval(),DEBUG_ABS&&console.log("ABSVAL denominator: "+stack[tos-1]),divide(),DEBUG_ABS&&console.log("ABSVAL divided: "+stack[tos-1]),DEBUG_ABS)return console.log("<<<<<<<  ABS")},absval=function(){var e,t;if(save(),p1=pop(),t=p1,DEBUG_ABS&&console.log("ABS of "+p1),isZeroAtomOrTensor(p1)){DEBUG_ABS&&console.log(" abs: "+p1+" just zero"),push(zero),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(isnegativenumber(p1)){DEBUG_ABS&&console.log(" abs: "+p1+" just a negative"),push(p1),negate(),restore();return}if(ispositivenumber(p1)){DEBUG_ABS&&console.log(" abs: "+p1+" just a positive"),push(p1),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(p1===symbol(PI)){DEBUG_ABS&&console.log(" abs: "+p1+" of PI"),push(p1),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(car(p1)===symbol(ADD)&&(findPossibleClockForm(p1)||findPossibleExponentialForm(p1)||Find(p1,imaginaryunit))){DEBUG_ABS&&console.log(" abs: "+p1+" is a sum"),DEBUG_ABS&&console.log("abs of a sum"),push(p1),rect(),p1=pop(),push(p1),real(),push_integer(2),power(),push(p1),imag(),push_integer(2),power(),add(),push_rational(1,2),power(),simplify_trig(),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(car(p1)===symbol(POWER)&&equaln(cadr(p1),-1)){DEBUG_ABS&&console.log(" abs: "+p1+" is -1 to any power"),evaluatingAsFloats?(DEBUG_ABS&&console.log(" abs: numeric, so result is 1.0"),push_double(1)):(DEBUG_ABS&&console.log(" abs: symbolic, so result is 1"),push_integer(1)),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(car(p1)===symbol(POWER)&&ispositivenumber(caddr(p1))){DEBUG_ABS&&console.log(" abs: "+p1+" is something to the power of a positive number"),push(cadr(p1)),abs(),push(caddr(p1)),power(),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(car(p1)===symbol(POWER)&&cadr(p1)===symbol(E)){DEBUG_ABS&&console.log(" abs: "+p1+" is an exponential"),push(caddr(p1)),real(),exponential(),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(car(p1)===symbol(MULTIPLY)){for(DEBUG_ABS&&console.log(" abs: "+p1+" is a product"),e=!1,p1=cdr(p1);iscons(p1);)push(car(p1)),absval(),e&&multiply(),e=!0,p1=cdr(p1);DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(car(p1)===symbol(ABS)){DEBUG_ABS&&console.log(" abs: "+p1+" is abs of a abs"),push_symbol(ABS),push(cadr(p1)),list(2),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore();return}if(istensor(p1)){absval_tensor(),restore();return}return(isnegativeterm(p1)||car(p1)===symbol(ADD)&&isnegativeterm(cadr(p1)))&&(push(p1),negate(),p1=pop()),DEBUG_ABS&&console.log(" abs: "+p1+" is nothing decomposable"),push_symbol(ABS),push(p1),list(2),DEBUG_ABS&&console.log(" --> ABS of "+t+" : "+stack[tos-1]),restore()},absval_tensor=function(){return p1.tensor.ndim!==1&&stop("abs(tensor) with tensor rank > 1"),push(p1),push(p1),conjugate(),inner(),push_rational(1,2),power(),simplify(),Eval()},flag=0,Eval_add=function(){var e;for(e=tos,p1=cdr(p1);iscons(p1);)push(car(p1)),Eval(),p2=pop(),push_terms(p2),p1=cdr(p1);return add_terms(tos-e)},stackAddsCount=0,add_terms=function(e){var t,r,n,s,i,a,l,u,c;if(stackAddsCount++,r=0,t=tos-e,DEBUG&&console.log("stack before adding terms #"+stackAddsCount),DEBUG)for(r=i=0,a=tos;0<=a?i<a:i>a;r=0<=a?++i:--i)console.log(print_list(stack[r]));for(r=n=0;n<10&&!(e<2||(flag=0,c=stack.slice(t,t+e),c.sort(cmp_terms),stack=stack.slice(0,t).concat(c).concat(stack.slice(t+e)),flag===0));r=++n)e=combine_terms(t,e);switch(moveTos(t+e),e){case 0:evaluatingAsFloats?push_double(0):push(zero);break;case 1:break;default:list(e),p1=pop(),push_symbol(ADD),push(p1),cons()}if(DEBUG&&console.log("stack after adding terms #"+stackAddsCount),DEBUG){for(u=[],r=s=0,l=tos;0<=l?s<l:s>l;r=0<=l?++s:--s)u.push(console.log(print_list(stack[r])));return u}},cmp_terms=function(e,t){var r,n,s,i;if(r=0,isNumericAtom(e)&&isNumericAtom(t))return flag=1,0;if(istensor(e)&&istensor(t)){if(e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(r=n=0,s=e.tensor.ndim;0<=s?n<s:n>s;r=0<=s?++n:--n){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}return flag=1,0}return car(e)===symbol(MULTIPLY)&&(e=cdr(e),isNumericAtom(car(e))&&(e=cdr(e),cdr(e)===symbol(NIL)&&(e=car(e)))),car(t)===symbol(MULTIPLY)&&(t=cdr(t),isNumericAtom(car(t))&&(t=cdr(t),cdr(t)===symbol(NIL)&&(t=car(t)))),i=cmp_expr(e,t),i===0&&(flag=1),i},combine_terms=function(e,t){var r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C;for(r=0;r<t-1;){if(check_esc_flag(),p3=stack[e+r],p4=stack[e+r+1],istensor(p3)&&istensor(p4)){if(push(p3),push(p4),tensor_plus_tensor(),p1=pop(),p1!==symbol(NIL)){for(stack[e+r]=p1,s=u=c=r+1,f=t-1;c<=f?u<f:u>f;s=c<=f?++u:--u)stack[e+s]=stack[e+s+1];t--,r--}r++;continue}if(istensor(p3)||istensor(p4)){r++;continue}if(isNumericAtom(p3)&&isNumericAtom(p4)){if(push(p3),push(p4),add_numbers(),p1=pop(),isZeroAtomOrTensor(p1)){for(s=n=d=r,m=t-2;d<=m?n<m:n>m;s=d<=m?++n:--n)stack[e+s]=stack[e+s+2];t-=2}else{for(stack[e+r]=p1,s=i=g=r+1,S=t-1;g<=S?i<S:i>S;s=g<=S?++i:--i)stack[e+s]=stack[e+s+1];t--}r--,r++;continue}if(isNumericAtom(p3)||isNumericAtom(p4)){r++;continue}if(evaluatingAsFloats?(p1=one_as_double,p2=one_as_double):(p1=one,p2=one),C=0,car(p3)===symbol(MULTIPLY)&&(p3=cdr(p3),C=1,isNumericAtom(car(p3))&&(p1=car(p3),p3=cdr(p3),cdr(p3)===symbol(NIL)&&(p3=car(p3),C=0))),car(p4)===symbol(MULTIPLY)&&(p4=cdr(p4),isNumericAtom(car(p4))&&(p2=car(p4),p4=cdr(p4),cdr(p4)===symbol(NIL)&&(p4=car(p4)))),!equal(p3,p4)){r++;continue}if(push(p1),push(p2),add_numbers(),p1=pop(),isZeroAtomOrTensor(p1)){for(s=a=y=r,R=t-2;y<=R?a<R:a>R;s=y<=R?++a:--a)stack[e+s]=stack[e+s+2];t-=2,r--,r++;continue}for(push(p1),C?(push(symbol(MULTIPLY)),push(p3),cons()):push(p3),multiply(),stack[e+r]=pop(),s=l=w=r+1,P=t-1;w<=P?l<P:l>P;s=w<=P?++l:--l)stack[e+s]=stack[e+s+1];t--,r--,r++}return t},push_terms=function(e){var t;if(car(e)===symbol(ADD)){for(e=cdr(e),t=[];iscons(e);)push(car(e)),t.push(e=cdr(e));return t}else if(!isZeroAtom(e))return push(e)},add=function(){var e;return save(),p2=pop(),p1=pop(),e=tos,push_terms(p1),push_terms(p2),add_terms(tos-e),restore()},add_all=function(e){var t,r,n,s,i;for(r=0,save(),i=tos-e,t=tos,r=n=0,s=e;0<=s?n<s:n>s;r=0<=s?++n:--n)push_terms(stack[i+r]);return add_terms(tos-t),p1=pop(),moveTos(tos-e),push(p1),restore()},subtract=function(){return negate(),add()},Eval_adj=function(){return push(cadr(p1)),Eval(),adj()},adj=function(){var e,t,r,n,s,i,a;for(e=0,r=0,n=0,save(),p1=pop(),istensor(p1)&&p1.tensor.ndim===2&&p1.tensor.dim[0]===p1.tensor.dim[1]||stop("adj: square matrix expected"),n=p1.tensor.dim[0],p2=alloc_tensor(n*n),p2.tensor.ndim=2,p2.tensor.dim[0]=n,p2.tensor.dim[1]=n,e=s=0,i=n;0<=i?s<i:s>i;e=0<=i?++s:--s)for(r=t=0,a=n;0<=a?t<a:t>a;r=0<=a?++t:--t)cofactor(p1,n,e,r),p2.tensor.elem[n*r+e]=pop();return push(p2),restore()},Eval_approxratio=function(){var e;return e=cadr(p1),push(e),approxratioRecursive()},approxratioRecursive=function(){var e,t,r,n,s;if(e=0,save(),p1=pop(),istensor(p1)){for(p4=alloc_tensor(p1.tensor.nelem),p4.tensor.ndim=p1.tensor.ndim,e=r=0,n=p1.tensor.ndim;0<=n?r<n:r>n;e=0<=n?++r:--r)p4.tensor.dim[e]=p1.tensor.dim[e];for(e=t=0,s=p1.tensor.nelem;0<=s?t<s:t>s;e=0<=s?++t:--t)push(p1.tensor.elem[e]),approxratioRecursive(),p4.tensor.elem[e]=pop(),check_tensor_dimensions(p4);push(p4)}else p1.k===DOUBLE?(push(p1),approxOneRatioOnly()):iscons(p1)?(push(car(p1)),approxratioRecursive(),push(cdr(p1)),approxratioRecursive(),cons()):push(p1);return restore()},approxOneRatioOnly=function(){var e,t,r,n,s,i;if(zzfloat(),n=pop(),n.k===DOUBLE){s=n.d,r=s.toString().split("."),r.length===2?(e=r[1].length,t=1/Math.pow(10,e),i=floatToRatioRoutine(s,t),push_rational(i[0],i[1])):push_integer(s);return}return push_symbol(APPROXRATIO),push(theArgument),list(2)},floatToRatioRoutine=function(e,t){var r,n,s,i,a,l,u;if(s=void 0,n=void 0,r=void 0,l=void 0,i=void 0,a=void 0,u=[0,0],isNaN(e))return u;if(e===1/0)return u[0]=1,u[1]=0,u;if(e===-1/0)return u[0]=-1,u[1]=0,u;if(e<0?r=-1:r=1,e=Math.abs(e),Math.abs(e-Math.floor(e))<t)return s=e*r,n=1,u[0]=s,u[1]=n,u;if(e<1e-19)return s=r,n=1e19,u[0]=s,u[1]=n,u;if(e>1e19)return s=1e19*r,n=1,u[0]=s,u[1]=n,u;for(l=e,i=0,n=1;l=1/(l-Math.floor(l)),a=n,n=n*Math.floor(l)+i,i=a,s=Math.floor(e*n+.5),Math.abs(e-s/n)>t&&l!==Math.floor(l););return s=r*s,u[0]=s,u[1]=n,u},approx_just_an_integer=0,approx_sine_of_rational=1,approx_sine_of_pi_times_rational=2,approx_rationalOfPi=3,approx_radicalOfRatio=4,approx_ratioOfRadical=6,approx_rationalOfE=7,approx_logarithmsOfRationals=8,approx_rationalsOfLogarithms=9,approxRationalsOfRadicals=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w;if(w=e.toString().split("."),w.length===2)d=w[1].length,g=1/Math.pow(10,d);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+g),t=null,f=Number.MAX_VALUE,y=[2,3,5,6,7,8,10],m=0,u=y.length;m<u;m++)for(i=y[m],l=a=1;a<=10;l=++a)s=Math.sqrt(i)/l,Math.abs(s)>1e-10?(S=e/s,c=Math.round(S),n=Math.abs(1-S/c)):(S=1,c=1,n=Math.abs(e-s)),n<2*g&&(r=simpleComplexityMeasure(c,i,l),r<f&&(f=r,R=c+" * sqrt( "+i+" ) / "+l,t=[R,approx_ratioOfRadical,c,i,l]));return t},approxRadicalsOfRationals=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C;if(C=e.toString().split("."),C.length===2)m=C[1].length,S=1/Math.pow(10,m);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+S),t=null,d=Number.MAX_VALUE,R=[1,2,3,5,6,7,8,10],g=0,u=R.length;g<u;g++)for(i=R[g],w=[1,2,3,5,6,7,8,10],a=0,c=w.length;a<c;a++)l=w[a],s=Math.sqrt(i/l),Math.abs(s)>1e-10?(y=e/s,f=Math.round(y),n=Math.abs(1-y/f)):(y=1,f=1,n=Math.abs(e-s)),n<2*S&&(r=simpleComplexityMeasure(f,i,l),r<d&&(d=r,P=f+" * (sqrt( "+i+" / "+l+" )",t=[P,approx_radicalOfRatio,f,i,l]));return t},approxRadicals=function(e){var t,r,n,s,i;if(i=e.toString().split("."),i.length===2)n=i[1].length,s=1/Math.pow(10,n);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];return console.log("precision: "+s),r=approxRationalsOfRadicals(e),r??(t=approxRadicalsOfRationals(e),t??null)},approxLogs=function(e){var t,r,n,s,i;if(i=e.toString().split("."),i.length===2)n=i[1].length,s=1/Math.pow(10,n);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];return console.log("precision: "+s),r=approxRationalsOfLogs(e),r??(t=approxLogsOfRationals(e),t??null)},approxRationalsOfLogs=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y;if(y=e.toString().split("."),y.length===2)f=y[1].length,m=1/Math.pow(10,f);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+m),t=null,c=Number.MAX_VALUE,i=d=2;d<=5;i=++d)for(l=a=1;a<=5;l=++a)s=Math.log(i)/l,Math.abs(s)>1e-10?(g=e/s,u=Math.round(g),n=Math.abs(1-g/u)):(g=1,u=1,n=Math.abs(e-s)),!(u!==1&&Math.abs(Math.floor(u/l))===Math.abs(u/l))&&n<2.2*m&&(r=simpleComplexityMeasure(u,i,l),r<c&&(c=r,S=u+" * log( "+i+" ) / "+l,t=[S,approx_rationalsOfLogarithms,u,i,l]));return t},approxLogsOfRationals=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y;if(y=e.toString().split("."),y.length===2)f=y[1].length,m=1/Math.pow(10,f);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+m),t=null,c=Number.MAX_VALUE,i=d=1;d<=5;i=++d)for(l=a=1;a<=5;l=++a)s=Math.log(i/l),Math.abs(s)>1e-10?(g=e/s,u=Math.round(g),n=Math.abs(1-g/u)):(g=1,u=1,n=Math.abs(e-s)),n<1.96*m&&(r=simpleComplexityMeasure(u,i,l),r<c&&(c=r,S=u+" * log( "+i+" / "+l+" )",t=[S,approx_logarithmsOfRationals,u,i,l]));return t},approxRationalsOfPowersOfE=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y;if(y=e.toString().split("."),y.length===2)f=y[1].length,m=1/Math.pow(10,f);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+m),t=null,c=Number.MAX_VALUE,i=d=1;d<=2;i=++d)for(l=a=1;a<=12;l=++a)s=Math.pow(Math.E,i)/l,Math.abs(s)>1e-10?(g=e/s,u=Math.round(g),n=Math.abs(1-g/u)):(g=1,u=1,n=Math.abs(e-s)),n<2*m&&(r=simpleComplexityMeasure(u,i,l),r<c&&(c=r,S=u+" * (e ^ "+i+" ) / "+l,t=[S,approx_rationalOfE,u,i,l]));return t},approxRationalsOfPowersOfPI=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y;if(y=e.toString().split("."),y.length===2)f=y[1].length,m=1/Math.pow(10,f);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+m),t=null,c=Number.MAX_VALUE,i=d=1;d<=5;i=++d)for(l=a=1;a<=12;l=++a)s=Math.pow(Math.PI,i)/l,Math.abs(s)>1e-10?(g=e/s,u=Math.round(g),n=Math.abs(1-g/u)):(g=1,u=1,n=Math.abs(e-s)),n<2*m&&(r=simpleComplexityMeasure(u,i,l),r<c&&(c=r,S=u+" * (pi ^ "+i+" ) / "+l+" )",t=[S,approx_rationalOfPi,u,i,l]));return t},approxTrigonometric=function(e){var t,r,n,s,i;if(i=e.toString().split("."),i.length===2)n=i[1].length,s=1/Math.pow(10,n);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];return console.log("precision: "+s),r=approxSineOfRationals(e),r??(t=approxSineOfRationalMultiplesOfPI(e),t??null)},approxSineOfRationals=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R;if(R=e.toString().split("."),R.length===2)d=R[1].length,g=1/Math.pow(10,d);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+g),t=null,f=Number.MAX_VALUE,a=m=1;m<=4;a=++m)for(u=l=1;l<=4;u=++l)s=a/u,i=Math.sin(s),Math.abs(i)>1e-10?(S=e/i,c=Math.round(S),n=Math.abs(1-S/c)):(S=1,c=1,n=Math.abs(e-i)),n<2*g&&(r=simpleComplexityMeasure(c,a,u),r<f&&(f=r,y=c+" * sin( "+a+"/"+u+" )",t=[y,approx_sine_of_rational,c,a,u]));return t},approxSineOfRationalMultiplesOfPI=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R;if(R=e.toString().split("."),R.length===2)d=R[1].length,g=1/Math.pow(10,d);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];for(console.log("precision: "+g),t=null,f=Number.MAX_VALUE,a=m=1;m<=13;a=++m)for(u=l=1;l<=13;u=++l)s=a/u,i=Math.sin(Math.PI*s),Math.abs(i)>1e-10?(S=e/i,c=Math.round(S),n=Math.abs(1-S/c)):(S=1,c=1,n=Math.abs(e-i)),n<23*g&&(r=simpleComplexityMeasure(c,a,u),r<f&&(f=r,y=c+" * sin( "+a+"/"+u+" * pi )",t=[y,approx_sine_of_pi_times_rational,c,a,u]));return t},approxAll=function(e){var t,r,n,s,i,a,l,u,c,f,d,m;if(m=e.toString().split("."),m.length===2)f=m[1].length,d=1/Math.pow(10,f);else return[""+Math.floor(e),approx_just_an_integer,Math.floor(e),1,2];return console.log("precision: "+d),c=Number.MAX_VALUE,u=0,l=null,t=!0,n=approxRadicals(e),n!=null&&(u=simpleComplexityMeasure(n),u<c?(t&&console.log("better explanation by approxRadicals: "+n+" complexity: "+u),c=u,l=n):t&&console.log("subpar explanation by approxRadicals: "+n+" complexity: "+u)),r=approxLogs(e),r!=null&&(u=simpleComplexityMeasure(r),u<c?(t&&console.log("better explanation by approxLogs: "+r+" complexity: "+u),c=u,l=r):t&&console.log("subpar explanation by approxLogs: "+r+" complexity: "+u)),s=approxRationalsOfPowersOfE(e),s!=null&&(u=simpleComplexityMeasure(s),u<c?(t&&console.log("better explanation by approxRationalsOfPowersOfE: "+s+" complexity: "+u),c=u,l=s):t&&console.log("subpar explanation by approxRationalsOfPowersOfE: "+s+" complexity: "+u)),i=approxRationalsOfPowersOfPI(e),i!=null&&(u=simpleComplexityMeasure(i),u<c?(t&&console.log("better explanation by approxRationalsOfPowersOfPI: "+i+" complexity: "+u),c=u,l=i):t&&console.log("subpar explanation by approxRationalsOfPowersOfPI: "+i+" complexity: "+u)),a=approxTrigonometric(e),a!=null&&(u=simpleComplexityMeasure(a),u<c?(t&&console.log("better explanation by approxTrigonometric: "+a+" complexity: "+u),c=u,l=a):t&&console.log("subpar explanation by approxTrigonometric: "+a+" complexity: "+u)),l},simpleComplexityMeasure=function(e,t,r){var n;if(n=null,e instanceof Array){switch(e[1]){case approx_sine_of_pi_times_rational:n=4;break;case approx_rationalOfPi:n=Math.pow(4,Math.abs(e[3]))*Math.abs(e[2]);break;case approx_rationalOfE:n=Math.pow(3,Math.abs(e[3]))*Math.abs(e[2]);break;default:n=0}n+=Math.abs(e[2])*(Math.abs(e[3])+Math.abs(e[4]))}else n+=Math.abs(e)*(Math.abs(t)+Math.abs(r));return e[2]===1?n-=1:n+=1,e[3]===1?n-=1:n+=1,e[4]===1?n-=1:n+=1,n<0&&(n=0),n},testApprox=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re,ae,J,ie,ue,fe,Se,_e,me,de,be,ve,Ae,xe,Re,Ee,Te,Oe,T,z,Y,se,ye,v,A,k,q,j,F,I,ee,Q,W,le;for(be=[2,3,5,6,7,8,10],J=0,S=be.length;J<S;J++)for(r=be[J],ve=[2,3,5,6,7,8,10],n=0,y=ve.length;n<y;n++)a=ve[n],r!==a&&(console.log("testapproxRadicals testing: 1 * sqrt( "+r+" ) / "+a),t=r/a,I=Math.sqrt(r)/a,T=approxRadicals(I),Y=T[2]*Math.sqrt(T[3])/T[4],Math.abs(I-Y)>1e-15&&console.log("fail testapproxRadicals: 1 * sqrt( "+r+" ) / "+a+" . obtained: "+T));for(Ae=[2,3,5,6,7,8,10],l=0,R=Ae.length;l<R;l++)for(r=Ae[l],xe=[2,3,5,6,7,8,10],d=0,w=xe.length;d<w;d++)a=xe[d],r!==a&&(console.log("testapproxRadicals testing with 4 digits: 1 * sqrt( "+r+" ) / "+a),t=r/a,fe=Math.sqrt(r)/a,I=fe.toFixed(4),T=approxRadicals(I),Y=T[2]*Math.sqrt(T[3])/T[4],Math.abs(fe-Y)>1e-15&&console.log("fail testapproxRadicals with 4 digits: 1 * sqrt( "+r+" ) / "+a+" . obtained: "+T));for(Re=[2,3,5,6,7,8,10],te=0,P=Re.length;te<P;te++)for(r=Re[te],Ee=[2,3,5,6,7,8,10],re=0,C=Ee.length;re<C;re++)a=Ee[re],r!==a&&(console.log("testapproxRadicals testing: 1 * sqrt( "+r+" / "+a+" )"),t=r/a,I=Math.sqrt(r/a),T=approxRadicals(I),T!=null&&(Y=T[2]*Math.sqrt(T[3]/T[4]),T[1]===approx_radicalOfRatio&&Math.abs(I-Y)>1e-15&&console.log("fail testapproxRadicals: 1 * sqrt( "+r+" / "+a+" ) . obtained: "+T)));for(Te=[1,2,3,5,6,7,8,10],ie=0,B=Te.length;ie<B;ie++)for(r=Te[ie],Oe=[1,2,3,5,6,7,8,10],Se=0,H=Oe.length;Se<H;Se++)a=Oe[Se],!(r===1&&a===1)&&(console.log("testapproxRadicals testing with 4 digits:: 1 * sqrt( "+r+" / "+a+" )"),t=r/a,fe=Math.sqrt(r/a),I=fe.toFixed(4),T=approxRadicals(I),Y=T[2]*Math.sqrt(T[3]/T[4]),T[1]===approx_radicalOfRatio&&Math.abs(fe-Y)>1e-15&&console.log("fail testapproxRadicals with 4 digits:: 1 * sqrt( "+r+" / "+a+" ) . obtained: "+T));for(r=me=1;me<=5;r=++me)for(a=se=1;se<=5;a=++se)console.log("testApproxAll testing: 1 * log("+r+" ) / "+a),t=r/a,I=Math.log(r)/a,T=approxAll(I),Y=T[2]*Math.log(T[3])/T[4],Math.abs(I-Y)>1e-15&&console.log("fail testApproxAll: 1 * log("+r+" ) / "+a+" . obtained: "+T);for(r=v=1;v<=5;r=++v)for(a=k=1;k<=5;a=++k)console.log("testApproxAll testing with 4 digits: 1 * log("+r+" ) / "+a),t=r/a,fe=Math.log(r)/a,I=fe.toFixed(4),T=approxAll(I),Y=T[2]*Math.log(T[3])/T[4],Math.abs(fe-Y)>1e-15&&console.log("fail testApproxAll with 4 digits: 1 * log("+r+" ) / "+a+" . obtained: "+T);for(r=j=1;j<=5;r=++j)for(a=ee=1;ee<=5;a=++ee)console.log("testApproxAll testing: 1 * log("+r+" / "+a+" )"),t=r/a,I=Math.log(r/a),T=approxAll(I),Y=T[2]*Math.log(T[3]/T[4]),Math.abs(I-Y)>1e-15&&console.log("fail testApproxAll: 1 * log("+r+" / "+a+" ) . obtained: "+T);for(r=W=1;W<=5;r=++W)for(a=s=1;s<=5;a=++s)console.log("testApproxAll testing with 4 digits: 1 * log("+r+" / "+a+" )"),t=r/a,fe=Math.log(r/a),I=fe.toFixed(4),T=approxAll(I),Y=T[2]*Math.log(T[3]/T[4]),Math.abs(fe-Y)>1e-15&&console.log("fail testApproxAll with 4 digits: 1 * log("+r+" / "+a+" ) . obtained: "+T);for(r=u=1;u<=2;r=++u)for(a=m=1;m<=12;a=++m)console.log("testApproxAll testing: 1 * (e ^ "+r+" ) / "+a),t=r/a,I=Math.pow(Math.E,r)/a,T=approxAll(I),Y=T[2]*Math.pow(Math.E,T[3])/T[4],Math.abs(I-Y)>1e-15&&console.log("fail testApproxAll: 1 * (e ^ "+r+" ) / "+a+" . obtained: "+T);for(r=K=1;K<=2;r=++K)for(a=ae=1;ae<=12;a=++ae)console.log("approxRationalsOfPowersOfE testing with 4 digits: 1 * (e ^ "+r+" ) / "+a),t=r/a,fe=Math.pow(Math.E,r)/a,I=fe.toFixed(4),T=approxRationalsOfPowersOfE(I),Y=T[2]*Math.pow(Math.E,T[3])/T[4],Math.abs(fe-Y)>1e-15&&console.log("fail approxRationalsOfPowersOfE with 4 digits: 1 * (e ^ "+r+" ) / "+a+" . obtained: "+T);for(r=ue=1;ue<=2;r=++ue)for(a=_e=1;_e<=12;a=++_e)console.log("testApproxAll testing: 1 * pi ^ "+r+" / "+a),t=r/a,I=Math.pow(Math.PI,r)/a,T=approxAll(I),Y=T[2]*Math.pow(Math.PI,T[3])/T[4],Math.abs(I-Y)>1e-15&&console.log("fail testApproxAll: 1 * pi ^ "+r+" / "+a+" ) . obtained: "+T);for(r=de=1;de<=2;r=++de)for(a=ye=1;ye<=12;a=++ye)console.log("approxRationalsOfPowersOfPI testing with 4 digits: 1 * pi ^ "+r+" / "+a),t=r/a,fe=Math.pow(Math.PI,r)/a,I=fe.toFixed(4),T=approxRationalsOfPowersOfPI(I),Y=T[2]*Math.pow(Math.PI,T[3])/T[4],Math.abs(fe-Y)>1e-15&&console.log("fail approxRationalsOfPowersOfPI with 4 digits: 1 * pi ^ "+r+" / "+a+" ) . obtained: "+T);for(r=A=1;A<=4;r=++A)for(a=q=1;q<=4;a=++q)console.log("testApproxAll testing: 1 * sin( "+r+"/"+a+" )"),t=r/a,I=Math.sin(t),T=approxAll(I),z=T[3]/T[4],Y=T[2]*Math.sin(z),Math.abs(I-Y)>1e-15&&console.log("fail testApproxAll: 1 * sin( "+r+"/"+a+" ) . obtained: "+T);for(r=F=1;F<=4;r=++F)for(a=Q=1;Q<=4;a=++Q)console.log("testApproxAll testing with 5 digits: 1 * sin( "+r+"/"+a+" )"),t=r/a,fe=Math.sin(t),I=fe.toFixed(5),T=approxAll(I),T==null&&console.log("fail testApproxAll with 5 digits: 1 * sin( "+r+"/"+a+" ) . obtained:  undefined "),z=T[3]/T[4],Y=T[2]*Math.sin(z),e=Math.abs(fe-Y),e>1e-14&&console.log("fail testApproxAll with 5 digits: 1 * sin( "+r+"/"+a+" ) . obtained: "+T+" error: "+e);for(r=le=1;le<=4;r=++le)for(a=i=1;i<=4;a=++i)console.log("testApproxAll testing with 4 digits: 1 * sin( "+r+"/"+a+" )"),t=r/a,fe=Math.sin(t),I=fe.toFixed(4),T=approxAll(I),T==null&&console.log("fail testApproxAll with 4 digits: 1 * sin( "+r+"/"+a+" ) . obtained:  undefined "),z=T[3]/T[4],Y=T[2]*Math.sin(z),e=Math.abs(fe-Y),e>1e-14&&console.log("fail testApproxAll with 4 digits: 1 * sin( "+r+"/"+a+" ) . obtained: "+T+" error: "+e);for(I=0,approxAll(I)[0]!=="0"&&console.log("fail testApproxAll: 0"),I=0,approxAll(I)[0]!=="0"&&console.log("fail testApproxAll: 0.0"),I=0,approxAll(I)[0]!=="0"&&console.log("fail testApproxAll: 0.00"),I=0,approxAll(I)[0]!=="0"&&console.log("fail testApproxAll: 0.000"),I=0,approxAll(I)[0]!=="0"&&console.log("fail testApproxAll: 0.0000"),I=1,approxAll(I)[0]!=="1"&&console.log("fail testApproxAll: 1"),I=1,approxAll(I)[0]!=="1"&&console.log("fail testApproxAll: 1.0"),I=1,approxAll(I)[0]!=="1"&&console.log("fail testApproxAll: 1.00"),I=1,approxAll(I)[0]!=="1"&&console.log("fail testApproxAll: 1.000"),I=1,approxAll(I)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),I=1,approxAll(I)[0]!=="1"&&console.log("fail testApproxAll: 1.00000"),I=Math.sqrt(2),approxAll(I)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(2)"),I=1.41,approxAll(I)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail testApproxAll: 1.41"),I=1.4,approxRadicals(I)[0]!=="1 * sqrt( 2 ) / 1"&&console.log("fail approxRadicals: 1.4"),I=.6,approxLogs(I)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.6"),I=.69,approxLogs(I)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.69"),I=.7,approxLogs(I)[0]!=="1 * log( 2 ) / 1"&&console.log("fail approxLogs: 0.7"),I=1.09,approxLogs(I)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxLogs: 1.09"),I=1.09,approxAll(I)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.09"),I=1.098,approxAll(I)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.098"),I=1.1,approxAll(I)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.1"),I=1.11,approxAll(I)[0]!=="1 * log( 3 ) / 1"&&console.log("fail approxAll: 1.11"),I=Math.sqrt(3),approxAll(I)[0]!=="1 * sqrt( 3 ) / 1"&&console.log("fail testApproxAll: Math.sqrt(3)"),I=1,approxAll(I)[0]!=="1"&&console.log("fail testApproxAll: 1.0000"),I=3.141592,approxAll(I)[0]!=="1 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 3.141592"),I=31.41592,approxAll(I)[0]!=="10 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31.41592"),I=314.1592,approxAll(I)[0]!=="100 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 314.1592"),I=3141592653589793e-8,approxAll(I)[0]!=="10000000 * (pi ^ 1 ) / 1 )"&&console.log("fail testApproxAll: 31415926.53589793"),I=Math.sqrt(2),approxTrigonometric(I)[0]!=="2 * sin( 1/4 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(2)"),I=Math.sqrt(3),approxTrigonometric(I)[0]!=="2 * sin( 1/3 * pi )"&&console.log("fail approxTrigonometric: Math.sqrt(3)"),I=(Math.sqrt(6)-Math.sqrt(2))/4,approxAll(I)[0]!=="1 * sin( 1/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) - Math.sqrt(2))/4"),I=Math.sqrt(2-Math.sqrt(2))/2,approxAll(I)[0]!=="1 * sin( 1/8 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 - Math.sqrt(2))/2"),I=(Math.sqrt(6)+Math.sqrt(2))/4,approxAll(I)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(6) + Math.sqrt(2))/4"),I=Math.sqrt(2+Math.sqrt(3))/2,approxAll(I)[0]!=="1 * sin( 5/12 * pi )"&&console.log("fail testApproxAll: Math.sqrt(2 + Math.sqrt(3))/2"),I=(Math.sqrt(5)-1)/4,approxAll(I)[0]!=="1 * sin( 1/10 * pi )"&&console.log("fail testApproxAll: (Math.sqrt(5) - 1)/4"),I=Math.sqrt(10-2*Math.sqrt(5))/4,approxAll(I)[0]!=="1 * sin( 1/5 * pi )"&&console.log("fail testApproxAll: Math.sqrt(10 - 2*Math.sqrt(5))/4"),I=Math.sin(Math.PI/7),approxAll(I)[0]!=="1 * sin( 1/7 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/7)"),I=Math.sin(Math.PI/9),approxAll(I)[0]!=="1 * sin( 1/9 * pi )"&&console.log("fail testApproxAll: Math.sin(Math.PI/9)"),I=1836.15267,approxRationalsOfPowersOfPI(I)[0]!=="6 * (pi ^ 5 ) / 1 )"&&console.log("fail approxRationalsOfPowersOfPI: 1836.15267"),r=c=1;c<=13;r=++c)for(a=f=1;f<=13;a=++f)console.log("approxTrigonometric testing: 1 * sin( "+r+"/"+a+" * pi )"),t=r/a,I=Math.sin(Math.PI*t),T=approxTrigonometric(I),z=T[3]/T[4],Y=T[2]*Math.sin(Math.PI*z),Math.abs(I-Y)>1e-15&&console.log("fail approxTrigonometric: 1 * sin( "+r+"/"+a+" * pi ) . obtained: "+T);for(r=g=1;g<=13;r=++g)for(a=oe=1;oe<=13;a=++oe)r===5&&a===11||r===6&&a===11||(console.log("approxTrigonometric testing with 4 digits: 1 * sin( "+r+"/"+a+" * pi )"),t=r/a,fe=Math.sin(Math.PI*t),I=fe.toFixed(4),T=approxTrigonometric(I),z=T[3]/T[4],Y=T[2]*Math.sin(Math.PI*z),e=Math.abs(fe-Y),e>1e-14&&console.log("fail approxTrigonometric with 4 digits: 1 * sin( "+r+"/"+a+" * pi ) . obtained: "+T+" error: "+e));return console.log("testApprox done")},$.approxRadicals=approxRadicals,$.approxRationalsOfLogs=approxRationalsOfLogs,$.approxAll=approxAll,$.testApprox=testApprox,Eval_arccos=function(){return push(cadr(p1)),Eval(),arccos()},arccos=function(){var e,t,r;if(r=0,e=0,save(),p1=pop(),car(p1)===symbol(COS)){push(cadr(p1)),restore();return}if(isdouble(p1)){t=0,e=Math.acos(p1.d),t&&stop("arccos function argument is not in the interval [-1,1]"),push_double(e),restore();return}if(isoneoversqrttwo(p1)||car(p1)===symbol(MULTIPLY)&&equalq(car(cdr(p1)),1,2)&&car(car(cdr(cdr(p1))))===symbol(POWER)&&equaln(car(cdr(car(cdr(cdr(p1))))),2)&&equalq(car(cdr(cdr(car(cdr(cdr(p1)))))),1,2)){evaluatingAsFloats?push_double(Math.PI/4):(push_rational(1,4),push_symbol(PI),multiply()),restore();return}if(isminusoneoversqrttwo(p1)||car(p1)===symbol(MULTIPLY)&&equalq(car(cdr(p1)),-1,2)&&car(car(cdr(cdr(p1))))===symbol(POWER)&&equaln(car(cdr(car(cdr(cdr(p1))))),2)&&equalq(car(cdr(cdr(car(cdr(cdr(p1)))))),1,2)){evaluatingAsFloats?push_double(Math.PI*3/4):(push_rational(3,4),push_symbol(PI),multiply()),restore();return}if(issqrtthreeovertwo(p1)){evaluatingAsFloats?push_double(Math.PI/6):(push_rational(1,6),push_symbol(PI),multiply()),restore();return}if(isminussqrtthreeovertwo(p1)){evaluatingAsFloats?push_double(5*Math.PI/6):(push_rational(5,6),push_symbol(PI),multiply()),restore();return}if(!isrational(p1)){push_symbol(ARCCOS),push(p1),list(2),restore();return}switch(push(p1),push_integer(2),multiply(),r=pop_integer(),r){case-2:evaluatingAsFloats?push_double(Math.PI):push_symbol(PI);break;case-1:evaluatingAsFloats?push_double(Math.PI*2/3):(push_rational(2,3),push_symbol(PI),multiply());break;case 0:evaluatingAsFloats?push_double(Math.PI/2):(push_rational(1,2),push_symbol(PI),multiply());break;case 1:evaluatingAsFloats?push_double(Math.PI/3):(push_rational(1,3),push_symbol(PI),multiply());break;case 2:evaluatingAsFloats?push_double(0):push(zero);break;default:push_symbol(ARCCOS),push(p1),list(2)}return restore()},Eval_arccosh=function(){return push(cadr(p1)),Eval(),arccosh()},arccosh=function(){var e;if(e=0,save(),p1=pop(),car(p1)===symbol(COSH)){push(cadr(p1)),restore();return}if(isdouble(p1)){e=p1.d,e<1&&stop("arccosh function argument is less than 1.0"),e=Math.log(e+Math.sqrt(e*e-1)),push_double(e),restore();return}if(isplusone(p1)){push(zero),restore();return}return push_symbol(ARCCOSH),push(p1),list(2),restore()},Eval_arcsin=function(){return push(cadr(p1)),Eval(),arcsin()},arcsin=function(){var e,t,r;if(r=0,e=0,save(),p1=pop(),car(p1)===symbol(SIN)){push(cadr(p1)),restore();return}if(isdouble(p1)){t=0,e=Math.asin(p1.d),t&&stop("arcsin function argument is not in the interval [-1,1]"),push_double(e),restore();return}if(isoneoversqrttwo(p1)||car(p1)===symbol(MULTIPLY)&&equalq(car(cdr(p1)),1,2)&&car(car(cdr(cdr(p1))))===symbol(POWER)&&equaln(car(cdr(car(cdr(cdr(p1))))),2)&&equalq(car(cdr(cdr(car(cdr(cdr(p1)))))),1,2)){push_rational(1,4),push_symbol(PI),multiply(),restore();return}if(isminusoneoversqrttwo(p1)||car(p1)===symbol(MULTIPLY)&&equalq(car(cdr(p1)),-1,2)&&car(car(cdr(cdr(p1))))===symbol(POWER)&&equaln(car(cdr(car(cdr(cdr(p1))))),2)&&equalq(car(cdr(cdr(car(cdr(cdr(p1)))))),1,2)){evaluatingAsFloats?push_double(-Math.PI/4):(push_rational(-1,4),push_symbol(PI),multiply()),restore();return}if(issqrtthreeovertwo(p1)){evaluatingAsFloats?push_double(Math.PI/3):(push_rational(1,3),push_symbol(PI),multiply()),restore();return}if(isminussqrtthreeovertwo(p1)){evaluatingAsFloats?push_double(-Math.PI/3):(push_rational(-1,3),push_symbol(PI),multiply()),restore();return}if(!isrational(p1)){push_symbol(ARCSIN),push(p1),list(2),restore();return}switch(push(p1),push_integer(2),multiply(),r=pop_integer(),r){case-2:evaluatingAsFloats?push_double(-Math.PI/2):(push_rational(-1,2),push_symbol(PI),multiply());break;case-1:evaluatingAsFloats?push_double(-Math.PI/6):(push_rational(-1,6),push_symbol(PI),multiply());break;case 0:evaluatingAsFloats?push_double(0):push(zero);break;case 1:evaluatingAsFloats?push_double(Math.PI/6):(push_rational(1,6),push_symbol(PI),multiply());break;case 2:evaluatingAsFloats?push_double(Math.PI/2):(push_rational(1,2),push_symbol(PI),multiply());break;default:push_symbol(ARCSIN),push(p1),list(2)}return restore()},Eval_arcsinh=function(){return push(cadr(p1)),Eval(),arcsinh()},arcsinh=function(){var e;if(e=0,save(),p1=pop(),car(p1)===symbol(SINH)){push(cadr(p1)),restore();return}if(isdouble(p1)){e=p1.d,e=Math.log(e+Math.sqrt(e*e+1)),push_double(e),restore();return}if(isZeroAtomOrTensor(p1)){push(zero),restore();return}return push_symbol(ARCSINH),push(p1),list(2),restore()},Eval_arctan=function(){return push(cadr(p1)),Eval(),arctan()},arctan=function(){var e,t;if(e=0,save(),p1=pop(),car(p1)===symbol(TAN)){push(cadr(p1)),restore();return}if(isdouble(p1)){t=0,e=Math.atan(p1.d),t&&stop("arctan function error"),push_double(e),restore();return}if(isZeroAtomOrTensor(p1)){push(zero),restore();return}if(isnegative(p1)){push(p1),negate(),arctan(),negate(),restore();return}if(Find(p1,symbol(SIN))&&Find(p1,symbol(COS))&&(push(p1),numerator(),p2=pop(),push(p1),denominator(),p3=pop(),car(p2)===symbol(SIN)&&car(p3)===symbol(COS)&&equal(cadr(p2),cadr(p3)))){push(cadr(p2)),restore();return}if(car(p1)===symbol(POWER)&&equaln(cadr(p1),3)&&equalq(caddr(p1),-1,2)||car(p1)===symbol(MULTIPLY)&&equalq(car(cdr(p1)),1,3)&&car(car(cdr(cdr(p1))))===symbol(POWER)&&equaln(car(cdr(car(cdr(cdr(p1))))),3)&&equalq(car(cdr(cdr(car(cdr(cdr(p1)))))),1,2)){push_rational(1,6),evaluatingAsFloats?push_double(Math.PI):push(symbol(PI)),multiply(),restore();return}if(equaln(p1,1)){push_rational(1,4),evaluatingAsFloats?push_double(Math.PI):push(symbol(PI)),multiply(),restore();return}if(car(p1)===symbol(POWER)&&equaln(cadr(p1),3)&&equalq(caddr(p1),1,2)){push_rational(1,3),evaluatingAsFloats?push_double(Math.PI):push(symbol(PI)),multiply(),restore();return}return push_symbol(ARCTAN),push(p1),list(2),restore()},Eval_arctanh=function(){return push(cadr(p1)),Eval(),arctanh()},arctanh=function(){var e;if(e=0,save(),p1=pop(),car(p1)===symbol(TANH)){push(cadr(p1)),restore();return}if(isdouble(p1)){e=p1.d,(e<-1||e>1)&&stop("arctanh function argument is not in the interval [-1,1]"),e=Math.log((1+e)/(1-e))/2,push_double(e),restore();return}if(isZeroAtomOrTensor(p1)){push(zero),restore();return}return push_symbol(ARCTANH),push(p1),list(2),restore()},DEBUG_ARG=!1,Eval_arg=function(){return push(cadr(p1)),Eval(),arg()},arg=function(){return save(),p1=pop(),push(p1),numerator(),yyarg(),push(p1),denominator(),yyarg(),subtract(),restore()},yyarg=function(){if(save(),p1=pop(),ispositivenumber(p1)||p1===symbol(PI))isdouble(p1)||evaluatingAsFloats?push_double(0):push_integer(0);else if(isnegativenumber(p1))isdouble(p1)||evaluatingAsFloats?push_double(Math.PI):push(symbol(PI)),negate();else if(issymbol(p1))push_symbol(ARG),push(p1),list(2);else if(car(p1)===symbol(POWER)&&equaln(cadr(p1),-1))evaluatingAsFloats?push_double(Math.PI):push(symbol(PI)),push(caddr(p1)),multiply();else if(car(p1)===symbol(POWER)&&cadr(p1)===symbol(E))push(caddr(p1)),imag();else if(car(p1)===symbol(POWER)&&isoneovertwo(caddr(p1))){if(DEBUG_ARG&&console.log("arg of a sqrt: "+p1),DEBUG_ARG)debugger;push(cadr(p1)),arg(),DEBUG_ARG&&console.log(" = 1/2 * "+stack[tos-1]),push(caddr(p1)),multiply()}else if(car(p1)===symbol(MULTIPLY))for(push_integer(0),p1=cdr(p1);iscons(p1);)push(car(p1)),arg(),add(),p1=cdr(p1);else car(p1)===symbol(ADD)?(push(p1),rect(),p1=pop(),push(p1),real(),p2=pop(),push(p1),imag(),p3=pop(),isZeroAtomOrTensor(p2)?(evaluatingAsFloats?push_double(Math.PI):push(symbol(PI)),isnegative(p3)&&negate()):(push(p3),push(p2),divide(),arctan(),isnegative(p2)&&(evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),isnegative(p3)?subtract():add()))):isZeroAtomOrTensor(get_binding(symbol(ASSUME_REAL_VARIABLES)))?(push_symbol(ARG),push(p1),list(2)):push_integer(0);return restore()},bake=function(){var e,t,r,n,s,i;if(e=0,t=0,r=0,n=0,s=0,i=0,expanding++,save(),p1=pop(),t=ispolyexpandedform(p1,symbol(SYMBOL_S)),r=ispolyexpandedform(p1,symbol(SYMBOL_T)),n=ispolyexpandedform(p1,symbol(SYMBOL_X)),s=ispolyexpandedform(p1,symbol(SYMBOL_Y)),i=ispolyexpandedform(p1,symbol(SYMBOL_Z)),t===1&&r===0&&n===0&&s===0&&i===0)p2=symbol(SYMBOL_S),bake_poly();else if(t===0&&r===1&&n===0&&s===0&&i===0)p2=symbol(SYMBOL_T),bake_poly();else if(t===0&&r===0&&n===1&&s===0&&i===0)p2=symbol(SYMBOL_X),bake_poly();else if(t===0&&r===0&&n===0&&s===1&&i===0)p2=symbol(SYMBOL_Y),bake_poly();else if(t===0&&r===0&&n===0&&s===0&&i===1)p2=symbol(SYMBOL_Z),bake_poly();else if(iscons(p1)&&car(p1)!==symbol(FOR)){for(e=tos,push(car(p1)),p1=cdr(p1);iscons(p1);)push(car(p1)),bake(),p1=cdr(p1);list(tos-e)}else push(p1);return restore(),expanding--},polyform=function(){var e;if(e=0,save(),p2=pop(),p1=pop(),ispolyexpandedform(p1,p2))bake_poly();else if(iscons(p1)){for(e=tos,push(car(p1)),p1=cdr(p1);iscons(p1);)push(car(p1)),push(p2),polyform(),p1=cdr(p1);list(tos-e)}else push(p1);return restore()},bake_poly=function(){var e,t,r,n,s,i;for(t=0,r=0,n=0,s=0,e=tos,n=coeff(p2,p1),t=tos,r=i=n-1;i>=0;r=i+=-1)p1=stack[e+r],bake_poly_term(r);return s=tos-t,s>1&&(list(s),push(symbol(ADD)),swap(),cons()),p1=pop(),moveTos(tos-n),push(p1)},bake_poly_term=function(e){var t,r;if(t=0,r=0,!isZeroAtomOrTensor(p1)){if(e===0){if(car(p1)===symbol(ADD))for(p1=cdr(p1);iscons(p1);)push(car(p1)),p1=cdr(p1);else push(p1);return}if(t=tos,car(p1)===symbol(MULTIPLY))for(p1=cdr(p1);iscons(p1);)push(car(p1)),p1=cdr(p1);else equaln(p1,1)||push(p1);if(e===1?push(p2):(push(symbol(POWER)),push(p2),push_integer(e),list(3)),r=tos-t,r>1)return list(r),push(symbol(MULTIPLY)),swap(),cons()}},Eval_besselj=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),besselj()},besselj=function(){return save(),yybesselj(),restore()},yybesselj=function(){var e,t;if(e=0,t=0,p2=pop(),p1=pop(),push(p2),t=pop_integer(),isdouble(p1)&&!isNaN(t)){e=jn(t,p1.d),push_double(e);return}if(isZeroAtomOrTensor(p1)&&isZeroAtomOrTensor(p2)){push_integer(1);return}if(isZeroAtomOrTensor(p1)&&!isNaN(t)){push_integer(0);return}if(p2.k===NUM&&MEQUAL(p2.q.b,2)){if(MEQUAL(p2.q.a,1)){evaluatingAsFloats?push_double(2/Math.PI):(push_integer(2),push_symbol(PI),divide()),push(p1),divide(),push_rational(1,2),power(),push(p1),sine(),multiply();return}if(MEQUAL(p2.q.a,-1)){evaluatingAsFloats?push_double(2/Math.PI):(push_integer(2),push_symbol(PI),divide()),push(p1),divide(),push_rational(1,2),power(),push(p1),cosine(),multiply();return}push_integer(MSIGN(p2.q.a)),p3=pop(),push_integer(2),push(p1),divide(),push(p2),push(p3),subtract(),multiply(),push(p1),push(p2),push(p3),subtract(),besselj(),multiply(),push(p1),push(p2),push_integer(2),push(p3),multiply(),subtract(),besselj(),subtract();return}if(isnegativeterm(p1)){push(p1),negate(),push(p2),power(),push(p1),push(p2),negate(),power(),multiply(),push_symbol(BESSELJ),push(p1),negate(),push(p2),list(3),multiply();return}if(isnegativeterm(p2)){push_integer(-1),push(p2),power(),push_symbol(BESSELJ),push(p1),push(p2),negate(),list(3),multiply();return}return push(symbol(BESSELJ)),push(p1),push(p2),list(3)},Eval_bessely=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),bessely()},bessely=function(){return save(),yybessely(),restore()},yybessely=function(){var e,t;if(e=0,t=0,p2=pop(),p1=pop(),push(p2),t=pop_integer(),isdouble(p1)&&!isNaN(t)){e=yn(t,p1.d),push_double(e);return}if(isnegativeterm(p2)){push_integer(-1),push(p2),power(),push_symbol(BESSELY),push(p1),push(p2),negate(),list(3),multiply();return}push_symbol(BESSELY),push(p1),push(p2),list(3)},mint=function(e){return bigInt(e)},isSmall=function(e){return e.geq(Number.MIN_SAFE_INTEGER)&&e.leq(Number.MAX_SAFE_INTEGER)},setSignTo=function(e,t){if(e.isPositive()){if(t<0)return e.multiply(bigInt(-1))}else if(t>0)return e.multiply(bigInt(-1));return e},makeSignSameAs=function(e,t){if(e.isPositive()){if(t.isNegative())return e.multiply(bigInt(-1))}else if(t.isPositive())return e.multiply(bigInt(-1));return e},makePositive=function(e){return e.isNegative()?e.multiply(bigInt(-1)):e},add_numbers=function(){var e,t,r;if(e=1,t=1,isrational(stack[tos-1])&&isrational(stack[tos-2])){qadd();return}return save(),p2=pop(),p1=pop(),isdouble(p1)?e=p1.d:e=convert_rational_to_double(p1),isdouble(p2)?t=p2.d:t=convert_rational_to_double(p2),r=e+t,push_double(r),restore()},multiply_numbers=function(){var e,t;if(e=0,t=0,isrational(stack[tos-1])&&isrational(stack[tos-2])){qmul();return}return save(),p2=pop(),p1=pop(),isdouble(p1)?e=p1.d:e=convert_rational_to_double(p1),isdouble(p2)?t=p2.d:t=convert_rational_to_double(p2),push_double(e*t),restore()},divide_numbers=function(){var e,t;if(e=0,t=0,isrational(stack[tos-1])&&isrational(stack[tos-2])){qdiv();return}return save(),p2=pop(),p1=pop(),isZeroAtomOrTensor(p2)&&stop("divide by zero"),isdouble(p1)?e=p1.d:e=convert_rational_to_double(p1),isdouble(p2)?t=p2.d:t=convert_rational_to_double(p2),push_double(e/t),restore()},invert_number=function(){var e,t;if(save(),p1=pop(),isZeroAtomOrTensor(p1)&&stop("divide by zero"),isdouble(p1)){push_double(1/p1.d),restore();return}return e=bigInt(p1.q.a),t=bigInt(p1.q.b),t=makeSignSameAs(t,e),e=setSignTo(e,1),p1=new U,p1.k=NUM,p1.q.a=t,p1.q.b=e,push(p1),restore()},compare_rationals=function(e,t){var r,n,s;return s=0,r=mmul(e.q.a,t.q.b),n=mmul(e.q.b,t.q.a),s=mcmp(r,n),s},compare_numbers=function(e,t){var r,n;return r=0,n=0,isrational(e)&&isrational(t)?compare_rationals(e,t):(isdouble(e)?r=e.d:r=convert_rational_to_double(e),isdouble(t)?n=t.d:n=convert_rational_to_double(t),r<n?-1:r>n?1:0)},negate_number=function(){if(save(),p1=pop(),isZeroAtomOrTensor(p1)){push(p1),restore();return}switch(p1.k){case NUM:p2=new U,p2.k=NUM,p2.q.a=bigInt(p1.q.a.multiply(bigInt.minusOne)),p2.q.b=bigInt(p1.q.b),push(p2);break;case DOUBLE:push_double(-p1.d);break;default:stop("bug caught in mp_negate_number")}return restore()},bignum_truncate=function(){var e;return save(),p1=pop(),e=mdiv(p1.q.a,p1.q.b),p1=new U,p1.k=NUM,p1.q.a=e,p1.q.b=bigInt(1),push(p1),restore()},mp_numerator=function(){if(save(),p1=pop(),p1.k!==NUM){push(one),restore();return}return p2=new U,p2.k=NUM,p2.q.a=bigInt(p1.q.a),p2.q.b=bigInt(1),push(p2),restore()},mp_denominator=function(){if(save(),p1=pop(),p1.k!==NUM){push(one),restore();return}return p2=new U,p2.k=NUM,p2.q.a=bigInt(p1.q.b),p2.q.b=bigInt(1),push(p2),restore()},bignum_power_number=function(e){var t,r,n;return save(),p1=pop(),t=mpow(p1.q.a,Math.abs(e)),r=mpow(p1.q.b,Math.abs(e)),e<0&&(n=t,t=r,r=n,t=makeSignSameAs(t,r),r=setSignTo(r,1)),p1=new U,p1.k=NUM,p1.q.a=t,p1.q.b=r,push(p1),restore()},convert_rational_to_double=function(e){var t,r;if(e.q==null)debugger;return t=e.q.a.divmod(e.q.b),r=t.quotient+t.remainder/e.q.b.toJSNumber(),r},new_integer=function(e){var t;return t=new U,t.k=NUM,t.q.a=bigInt(e),t.q.b=bigInt(1),t},push_integer=function(e){return DEBUG&&console.log("pushing integer "+e),push(new_integer(e))},push_double=function(e){return save(),p1=new U,p1.k=DOUBLE,p1.d=e,push(p1),restore()},push_rational=function(e,t){var r;return r=new U,r.k=NUM,r.q.a=bigInt(e),r.q.b=bigInt(t),push(r)},pop_integer=function(){var e;switch(e=NaN,save(),p1=pop(),p1.k){case NUM:isinteger(p1)&&isSmall(p1.q.a)&&(e=p1.q.a.toJSNumber());break;case DOUBLE:DEBUG&&console.log("popping integer but double is found"),Math.floor(p1.d)===p1.d&&(DEBUG&&console.log("...altough it's an integer"),e=p1.d)}return restore(),e},bignum_scan_integer=function(e){var t,r,n;return save(),r=0,n=e[r],(n==="+"||n==="-")&&r++,t=bigInt(e.substring(r)),p1=new U,p1.k=NUM,p1.q.a=t,p1.q.b=bigInt(1),push(p1),n==="-"&&negate(),restore()},bignum_scan_float=function(e){return push_double(parseFloat(e))},print_number=function(e,t){var r,n,s;switch(n="",s="",e.k){case NUM:r=e.q.a.toString(),t||r[0]==="-"&&(r=r.substring(1)),printMode===PRINTMODE_LATEX&&isfraction(e)&&(r="\\frac{"+r+"}{"),n+=r,isfraction(e)&&(printMode!==PRINTMODE_LATEX&&(n+="/"),s=e.q.b.toString(),printMode===PRINTMODE_LATEX&&(s+="}"),n+=s);break;case DOUBLE:r=doubleToReasonableString(e.d),t||r[0]==="-"&&(r=r.substring(1)),n+=r}return n},gcd_numbers=function(){return save(),p2=pop(),p1=pop(),p3=new U,p3.k=NUM,p3.q.a=mgcd(p1.q.a,p2.q.a),p3.q.b=mgcd(p1.q.b,p2.q.b),p3.q.a=setSignTo(p3.q.a,1),push(p3),restore()},pop_double=function(){var e;switch(e=0,save(),p1=pop(),p1.k){case NUM:e=convert_rational_to_double(p1);break;case DOUBLE:e=p1.d;break;default:e=0}return restore(),e},bignum_float=function(){var e;return e=0,e=convert_rational_to_double(pop()),push_double(e)},bignum_factorial=function(e){return save(),p1=new U,p1.k=NUM,p1.q.a=__factorial(e),p1.q.b=bigInt(1),push(p1),restore()},__factorial=function(e){var t,r,n,s,i,a;if(n=0,e===0||e===1)return t=bigInt(1),t;if(t=bigInt(2),r=bigInt(0),3<=e)for(n=s=3,i=e;3<=i?s<=i:s>=i;n=3<=i?++s:--s)r=bigInt(n),a=mmul(t,r),t=a;return t},Eval_binomial=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),binomial()},binomial=function(){return save(),ybinomial(),restore()},ybinomial=function(){if(p2=pop(),p1=pop(),BINOM_check_args()===0){push(zero);return}return push(p1),factorial(),push(p2),factorial(),divide(),push(p1),push(p2),subtract(),factorial(),divide()},BINOM_check_args=function(){return isNumericAtom(p1)&&lessp(p1,zero)||isNumericAtom(p2)&&lessp(p2,zero)||isNumericAtom(p1)&&isNumericAtom(p2)&&lessp(p1,p2)?0:1},Eval_ceiling=function(){return push(cadr(p1)),Eval(),ceiling()},ceiling=function(){return save(),yyceiling(),restore()},yyceiling=function(){var e;if(e=0,p1=pop(),!isNumericAtom(p1)){push_symbol(CEILING),push(p1),list(2);return}if(isdouble(p1)){e=Math.ceil(p1.d),push_double(e);return}if(isinteger(p1)){push(p1);return}return p3=new U,p3.k=NUM,p3.q.a=mdiv(p1.q.a,p1.q.b),p3.q.b=mint(1),push(p3),isnegativenumber(p1)?1:(push_integer(1),add())},Eval_choose=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),choose()},choose=function(){if(save(),p2=pop(),p1=pop(),choose_check_args()===0){push_integer(0),restore();return}return push(p1),factorial(),push(p2),factorial(),divide(),push(p1),push(p2),subtract(),factorial(),divide(),restore()},choose_check_args=function(){return isNumericAtom(p1)&&lessp(p1,zero)||isNumericAtom(p2)&&lessp(p2,zero)||isNumericAtom(p1)&&isNumericAtom(p2)&&lessp(p1,p2)?0:1},Eval_circexp=function(){return push(cadr(p1)),Eval(),circexp(),Eval()},circexp=function(){var e,t,r,n;if(t=0,e=0,save(),p1=pop(),car(p1)===symbol(COS)){push(cadr(p1)),expcos(),restore();return}if(car(p1)===symbol(SIN)){push(cadr(p1)),expsin(),restore();return}if(car(p1)===symbol(TAN)){p1=cadr(p1),push(imaginaryunit),push(p1),multiply(),exponential(),p2=pop(),push(imaginaryunit),push(p1),multiply(),negate(),exponential(),p3=pop(),push(p3),push(p2),subtract(),push(imaginaryunit),multiply(),push(p2),push(p3),add(),divide(),restore();return}if(car(p1)===symbol(COSH)){p1=cadr(p1),push(p1),exponential(),push(p1),negate(),exponential(),add(),push_rational(1,2),multiply(),restore();return}if(car(p1)===symbol(SINH)){p1=cadr(p1),push(p1),exponential(),push(p1),negate(),exponential(),subtract(),push_rational(1,2),multiply(),restore();return}if(car(p1)===symbol(TANH)){p1=cadr(p1),push(p1),push_integer(2),multiply(),exponential(),p1=pop(),push(p1),push_integer(1),subtract(),push(p1),push_integer(1),add(),divide(),restore();return}if(iscons(p1)){for(e=tos;iscons(p1);)push(car(p1)),circexp(),p1=cdr(p1);list(tos-e),restore();return}if(p1.k===TENSOR){for(push(p1),copy_tensor(),p1=pop(),t=r=0,n=p1.tensor.nelem;0<=n?r<n:r>n;t=0<=n?++r:--r)push(p1.tensor.elem[t]),circexp(),p1.tensor.elem[t]=pop();push(p1),restore();return}return push(p1),restore()},Eval_clearall=function(){return do_clearall(),push(symbol(NIL))},do_clearall=function(){return test_flag===0&&clear_term(),do_clearPatterns(),clear_symbols(),defn(),codeGen=!1},clearRenamedVariablesToAvoidBindingToExternalScope=function(){var e,t,r,n;for(n=[],e=t=0,r=symtab.length;0<=r?t<r:t>r;e=0<=r?++t:--t)symtab[e].printname.indexOf("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE")!==-1?(symtab[e].k=SYM,symtab[e].printname="",binding[e]=symtab[e],n.push(isSymbolReclaimable[e]=!0)):n.push(void 0);return n},Eval_clear=function(){var e,t;for(p2=cdr(p1);iscons(p2);)t=car(p2),t.k!==SYM&&stop("symbol error"),e=symtab.indexOf(t),symtab[e].k=SYM,symtab[e].printname="",binding[e]=symtab[e],isSymbolReclaimable[e]=!0,p2=cdr(p2);return push(symbol(NIL))},DEBUG_CLOCKFORM=!1,Eval_clock=function(){return push(cadr(p1)),Eval(),clockform()},clockform=function(){return save(),p1=pop(),push(p1),abs(),DEBUG_CLOCKFORM&&console.log("clockform: abs of "+p1+" : "+stack[tos-1]),push_symbol(POWER),push_integer(-1),push(p1),arg(),DEBUG_CLOCKFORM&&console.log("clockform: arg of "+p1+" : "+stack[tos-1]),evaluatingAsFloats?push_double(Math.PI):push(symbol(PI)),divide(),DEBUG_CLOCKFORM&&console.log("clockform: divide : "+stack[tos-1]),list(3),DEBUG_CLOCKFORM&&console.log("clockform: power : "+stack[tos-1]),multiply(),DEBUG_CLOCKFORM&&console.log("clockform: multiply : "+stack[tos-1]),restore()},Eval_coeff=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),push(cadddr(p1)),Eval(),p3=pop(),p2=pop(),p1=pop(),p3===symbol(NIL)&&(p3=p2,p2=symbol(SYMBOL_X)),push(p1),push(p2),push(p3),power(),divide(),push(p2),filter()},coeff=function(e,t){var r,n,s,i;for(DEBUG&&console.log("coeff: "+e+" "+t),r=0;;){if(push(t),push(e),push(zero),subst(),Eval(),n=pop(),push(n),r++,push(t),push(n),subtract(),s=pop(),equal(s,zero))return DEBUG&&console.log("coeff: result: "+r),r;push(s),push(e),i=expanding,expanding=1,divide(),expanding=i,t=pop()}},Eval_cofactor=function(){var e,t,r;return e=0,t=0,r=0,push(cadr(p1)),Eval(),p2=pop(),istensor(p2)&&p2.tensor.ndim===2&&p2.tensor.dim[0]===p2.tensor.dim[1]||stop("cofactor: 1st arg: square matrix expected"),r=p2.tensor.dim[0],push(caddr(p1)),Eval(),e=pop_integer(),(e<1||e>r)&&stop("cofactor: 2nd arg: row index expected"),push(cadddr(p1)),Eval(),t=pop_integer(),(t<1||t>r)&&stop("cofactor: 3rd arg: column index expected"),cofactor(p2,r,e-1,t-1)},cofactor=function(e,t,r,n){var s,i,a,l,u,c;for(s=0,a=0,s=l=0,u=t;0<=u?l<u:l>u;s=0<=u?++l:--l)for(a=i=0,c=t;0<=c?i<c:i>c;a=0<=c?++i:--i)s!==r&&a!==n&&push(e.tensor.elem[t*s+a]);if(determinant(t-1),(r+n)%2)return negate()},Eval_condense=function(){return push(cadr(p1)),Eval(),Condense()},Condense=function(){var e;return e=expanding,expanding=0,save(),yycondense(),restore(),expanding=e},yycondense=function(){if(p1=pop(),car(p1)!==symbol(ADD)){push(p1);return}for(p3=cdr(p1),push(car(p3)),p3=cdr(p3);iscons(p3);)push(car(p3)),DEBUG&&console.log("calculating gcd between: "+stack[tos-1]+" and "+stack[tos-2]),gcd(),DEBUG&&console.log("partial gcd: "+stack[tos-1]),p3=cdr(p3);for(DEBUG&&console.log("condense: this is the gcd of all the terms: "+stack[tos-1]),inverse(),p2=pop(),push(zero),p3=cdr(p1);iscons(p3);)push(p2),push(car(p3)),multiply_noexpand(),add(),p3=cdr(p3);return yyexpand(),push(p2),divide()},Eval_conj=function(){return push(cadr(p1)),Eval(),p1=pop(),push(p1),Find(p1,imaginaryunit)?conjugate():(polar(),conjugate(),clockform())},conjugate=function(){return push(imaginaryunit),push(imaginaryunit),negate(),subst(),Eval()},consCount=0,cons=function(){var e;if(consCount++,DEBUG&&console.log("cons tos: "+tos+" # "+consCount),e=new U,e.k=CONS,e.cons.cdr=pop(),e===e.cons.cdr){debugger;console.log("something wrong p == its cdr")}return e.cons.car=pop(),push(e)},Eval_contract=function(){return push(cadr(p1)),Eval(),cddr(p1)===symbol(NIL)?(push_integer(1),push_integer(2)):(push(caddr(p1)),Eval(),push(cadddr(p1)),Eval()),contract()},contract=function(){return save(),yycontract(),restore()},yycontract=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re,ae;if(s=0,i=0,l=0,c=0,f=0,m=0,S=0,R=0,w=0,t=[],r=[],p3=pop(),p2=pop(),p1=pop(),!istensor(p1)){isZeroAtomOrTensor(p1)||stop("contract: tensor expected, 1st arg is not a tensor"),push(zero);return}for(push(p2),f=pop_integer(),push(p3),m=pop_integer(),R=p1.tensor.ndim,(f<1||f>R||m<1||m>R||f===m||p1.tensor.dim[f-1]!==p1.tensor.dim[m-1])&&stop("contract: index out of range"),f--,m--,S=p1.tensor.dim[f],w=1,i=P=0,B=R;0<=B?P<B:P>B;i=0<=B?++P:--P)i!==f&&i!==m&&(w*=p1.tensor.dim[i]);for(p2=alloc_tensor(w),p2.tensor.ndim=R-2,l=0,i=a=0,H=R;0<=H?a<H:a>H;i=0<=H?++a:--a)i!==f&&i!==m&&(p2.tensor.dim[l++]=p1.tensor.dim[i]);for(e=p1.tensor.elem,n=p2.tensor.elem,i=u=0,te=R;0<=te?u<te:u>te;i=0<=te?++u:--u)t[i]=0,r[i]=p1.tensor.dim[i];for(i=d=0,K=w;0<=K?d<K:d>K;i=0<=K?++d:--d){for(push(zero),l=g=0,oe=S;0<=oe?g<oe:g>oe;l=0<=oe?++g:--g){for(t[f]=l,t[m]=l,s=0,c=y=0,re=R;0<=re?y<re:y>re;c=0<=re?++y:--y)s=s*r[c]+t[c];push(e[s]),add()}for(n[i]=pop(),l=C=ae=R-1;ae<=0?C<=0:C>=0;l=ae<=0?++C:--C)if(!(l===f||l===m)){if(++t[l]<r[l])break;t[l]=0}}return push(w===1?n[0]:p2)},Eval_cos=function(){return push(cadr(p1)),Eval(),cosine()},cosine=function(){return save(),p1=pop(),car(p1)===symbol(ADD)?cosine_of_angle_sum():cosine_of_angle(),restore()},cosine_of_angle_sum=function(){for(p2=cdr(p1);iscons(p2);){if(p4=car(p2),isnpi(p4)){push(p1),push(p4),subtract(),p3=pop(),push(p3),cosine(),push(p4),cosine(),multiply(),push(p3),sine(),push(p4),sine(),multiply(),subtract();return}p2=cdr(p2)}return cosine_of_angle()},cosine_of_angle=function(){var e,t;if(car(p1)===symbol(ARCCOS)){push(cadr(p1));return}if(isdouble(p1)){e=Math.cos(p1.d),Math.abs(e)<1e-10&&(e=0),push_double(e);return}if(isnegative(p1)&&(push(p1),negate(),p1=pop()),car(p1)===symbol(ARCTAN)){push_integer(1),push(cadr(p1)),push_integer(2),power(),add(),push_rational(-1,2),power();return}if(push(p1),push_integer(180),multiply(),evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),divide(),t=pop_integer(),t<0||isNaN(t)){push(symbol(COS)),push(p1),list(2);return}switch(t%360){case 90:case 270:return push_integer(0);case 60:case 300:return push_rational(1,2);case 120:case 240:return push_rational(-1,2);case 45:case 315:return push_rational(1,2),push_integer(2),push_rational(1,2),power(),multiply();case 135:case 225:return push_rational(-1,2),push_integer(2),push_rational(1,2),power(),multiply();case 30:case 330:return push_rational(1,2),push_integer(3),push_rational(1,2),power(),multiply();case 150:case 210:return push_rational(-1,2),push_integer(3),push_rational(1,2),power(),multiply();case 0:return push_integer(1);case 180:return push_integer(-1);default:return push(symbol(COS)),push(p1),list(2)}},Eval_cosh=function(){return push(cadr(p1)),Eval(),ycosh()},ycosh=function(){return save(),yycosh(),restore()},yycosh=function(){var e;if(e=0,p1=pop(),car(p1)===symbol(ARCCOSH)){push(cadr(p1));return}if(isdouble(p1)){e=Math.cosh(p1.d),Math.abs(e)<1e-10&&(e=0),push_double(e);return}if(isZeroAtomOrTensor(p1)){push(one);return}return push_symbol(COSH),push(p1),list(2)},Eval_decomp=function(){var e;return save(),console.log("Eval_decomp is being called!!!!!!!!!!!!!!!!!!!!"),e=tos,push(symbol(NIL)),push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),p1=pop(),p1===symbol(NIL)?guess():push(p1),decomp(!1),list(tos-e),restore()},pushTryNotToDuplicate=function(e){if(tos>0&&(DEBUG&&console.log("comparing "+e+" to: "+stack[tos-1]),equal(e,stack[tos-1]))){DEBUG&&console.log("skipping "+e+" because it's already on stack ");return}return push(e)},decomp=function(e){if(save(),p2=pop(),p1=pop(),DEBUG&&console.log("DECOMPOSING "+p1),e){if(!iscons(p1)){DEBUG&&console.log(" ground thing: "+p1),pushTryNotToDuplicate(p1),restore();return}}else if(Find(p1,p2)===0){DEBUG&&console.log(" entire expression is constant"),pushTryNotToDuplicate(p1),restore();return}if(isadd(p1)){decomp_sum(e),restore();return}if(ismultiply(p1)){decomp_product(e),restore();return}for(DEBUG&&console.log(" naive decomp"),p3=cdr(p1),DEBUG&&console.log("startig p3: "+p3);iscons(p3);)e&&push(car(p3)),DEBUG&&console.log("recursive decomposition"),push(car(p3)),DEBUG&&console.log("car(p3): "+car(p3)),push(p2),DEBUG&&console.log("p2: "+p2),decomp(e),p3=cdr(p3);return restore()},decomp_sum=function(e){var t;for(DEBUG&&console.log(" decomposing the sum "),t=0,p3=cdr(p1);iscons(p3);)(Find(car(p3),p2)||e)&&(push(car(p3)),push(p2),decomp(e)),p3=cdr(p3);for(t=tos,p3=cdr(p1);iscons(p3);)Find(car(p3),p2)===0&&pushTryNotToDuplicate(car(p3)),p3=cdr(p3);if(tos-t)return add_all(tos-t),p3=pop(),pushTryNotToDuplicate(p3),push(p3),negate()},decomp_product=function(e){var t;for(DEBUG&&console.log(" decomposing the product "),t=0,p3=cdr(p1);iscons(p3);)(Find(car(p3),p2)||e)&&(push(car(p3)),push(p2),decomp(e)),p3=cdr(p3);for(t=tos,p3=cdr(p1);iscons(p3);)Find(car(p3),p2)===0&&pushTryNotToDuplicate(car(p3)),p3=cdr(p3);if(tos-t)return multiply_all(tos-t)},define_user_function=function(){return p3=caadr(p1),p4=cdadr(p1),p5=caddr(p1),issymbol(p3)||stop("function name?"),car(p5)===symbol(EVAL)&&(push(cadr(p5)),Eval(),p5=pop()),push_symbol(FUNCTION),push(p5),push(p4),list(3),p5=pop(),set_binding(p3,p5),push_symbol(NIL)},Eval_function_reference=function(){return push(p1)},Eval_defint=function(){for(push(cadr(p1)),Eval(),p2=pop(),p1=cddr(p1);iscons(p1);)push(car(p1)),p1=cdr(p1),Eval(),p3=pop(),push(car(p1)),p1=cdr(p1),Eval(),p4=pop(),push(car(p1)),p1=cdr(p1),Eval(),p5=pop(),push(p2),push(p3),integral(),p2=pop(),push(p2),push(p3),push(p5),subst(),Eval(),push(p2),push(p3),push(p4),subst(),Eval(),subtract(),p2=pop();return push(p2)},Eval_degree=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),p1=pop(),p1===symbol(NIL)?guess():push(p1),degree()},degree=function(){return save(),p2=pop(),p1=pop(),p3=zero,yydegree(p1),push(p3),restore()},yydegree=function(e){var t;if(equal(e,p2)){if(isZeroAtomOrTensor(p3))return p3=one}else if(car(e)===symbol(POWER)){if(equal(cadr(e),p2)&&isNumericAtom(caddr(e))&&lessp(p3,caddr(e)))return p3=caddr(e)}else if(iscons(e)){for(e=cdr(e),t=[];iscons(e);)yydegree(car(e)),t.push(e=cdr(e));return t}},Eval_denominator=function(){return push(cadr(p1)),Eval(),denominator()},denominator=function(){var e,t;if(e=0,t=pop(),car(t)===symbol(ADD)&&(push(t),rationalize(),t=pop()),car(t)===symbol(MULTIPLY)&&!isplusone(car(cdr(t)))){for(e=tos,t=cdr(t);iscons(t);)push(car(t)),denominator(),t=cdr(t);return multiply_all(tos-e)}else return isrational(t)?(push(t),mp_denominator()):car(t)===symbol(POWER)&&isnegativeterm(caddr(t))?(push(t),reciprocate()):push(one)},Eval_derivative=function(){var e,t,r,n,s;for(p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),push(car(p1)),Eval(),p2=pop(),p2===symbol(NIL)?(guess(),push(symbol(NIL))):isNumericAtom(p2)?(guess(),push(p2)):(push(p2),p1=cdr(p1),push(car(p1)),Eval()),p5=pop(),p4=pop(),p3=pop();;){if(isNumericAtom(p5)?(push(p5),t=pop_integer(),isNaN(t)&&stop("nth derivative: check n")):t=1,push(p3),t>=0)for(r=0,n=t;0<=n?r<n:r>n;0<=n?++r:--r)push(p4),derivative();else for(t=-t,e=0,s=t;0<=s?e<s:e>s;0<=s?++e:--e)push(p4),integral();if(p3=pop(),p5===symbol(NIL))break;if(isNumericAtom(p5)){if(p1=cdr(p1),push(car(p1)),Eval(),p5=pop(),p5===symbol(NIL))break;isNumericAtom(p5)||(p4=p5,p1=cdr(p1),push(car(p1)),Eval(),p5=pop())}else p4=p5,p1=cdr(p1),push(car(p1)),Eval(),p5=pop()}return push(p3)},derivative=function(){return save(),p2=pop(),p1=pop(),isNumericAtom(p2)&&stop("undefined function"),istensor(p1)?istensor(p2)?d_tensor_tensor():d_tensor_scalar():istensor(p2)?d_scalar_tensor():d_scalar_scalar(),restore()},d_scalar_scalar=function(){return issymbol(p2)?d_scalar_scalar_1():(push(p1),push(p2),push(symbol(SECRETX)),subst(),push(symbol(SECRETX)),derivative(),push(symbol(SECRETX)),push(p2),subst())},d_scalar_scalar_1=function(){if(equal(p1,p2)){push(one);return}if(!iscons(p1)){push(zero);return}if(isadd(p1)){dsum();return}if(car(p1)===symbol(MULTIPLY)){dproduct();return}if(car(p1)===symbol(POWER)){dpower();return}if(car(p1)===symbol(DERIVATIVE)){dd();return}if(car(p1)===symbol(LOG)){dlog();return}if(car(p1)===symbol(SIN)){dsin();return}if(car(p1)===symbol(COS)){dcos();return}if(car(p1)===symbol(TAN)){dtan();return}if(car(p1)===symbol(ARCSIN)){darcsin();return}if(car(p1)===symbol(ARCCOS)){darccos();return}if(car(p1)===symbol(ARCTAN)){darctan();return}if(car(p1)===symbol(SINH)){dsinh();return}if(car(p1)===symbol(COSH)){dcosh();return}if(car(p1)===symbol(TANH)){dtanh();return}if(car(p1)===symbol(ARCSINH)){darcsinh();return}if(car(p1)===symbol(ARCCOSH)){darccosh();return}if(car(p1)===symbol(ARCTANH)){darctanh();return}if(car(p1)===symbol(ABS)){dabs();return}if(car(p1)===symbol(SGN)){dsgn();return}if(car(p1)===symbol(HERMITE)){dhermite();return}if(car(p1)===symbol(ERF)){derf();return}if(car(p1)===symbol(ERFC)){derfc();return}if(car(p1)===symbol(BESSELJ)){isZeroAtomOrTensor(caddr(p1))?dbesselj0():dbesseljn();return}if(car(p1)===symbol(BESSELY)){isZeroAtomOrTensor(caddr(p1))?dbessely0():dbesselyn();return}if(car(p1)===symbol(INTEGRAL)&&caddr(p1)===p2){derivative_of_integral();return}return dfunction()},dsum=function(){var e;for(e=tos,p1=cdr(p1);iscons(p1);)push(car(p1)),push(p2),derivative(),p1=cdr(p1);return add_all(tos-e)},dproduct=function(){var e,t,r,n,s,i,a;for(e=0,r=0,n=0,n=length(p1)-1,e=s=0,i=n;0<=i?s<i:s>i;e=0<=i?++s:--s){for(p3=cdr(p1),r=t=0,a=n;0<=a?t<a:t>a;r=0<=a?++t:--t)push(car(p3)),e===r&&(push(p2),derivative()),p3=cdr(p3);multiply_all(n)}return add_all(n)},dpower=function(){return push(caddr(p1)),push(cadr(p1)),divide(),push(cadr(p1)),push(p2),derivative(),multiply(),push(cadr(p1)),logarithm(),push(caddr(p1)),push(p2),derivative(),multiply(),add(),push(p1),multiply()},dlog=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),divide()},dd=function(){return push(cadr(p1)),push(p2),derivative(),p3=pop(),car(p3)===symbol(DERIVATIVE)?(push_symbol(DERIVATIVE),push_symbol(DERIVATIVE),push(cadr(p3)),lessp(caddr(p3),caddr(p1))?(push(caddr(p3)),list(3),push(caddr(p1))):(push(caddr(p1)),list(3),push(caddr(p3))),list(3)):(push(p3),push(caddr(p1)),derivative())},dfunction=function(){return p3=cdr(p1),p3===symbol(NIL)||Find(p3,p2)?(push_symbol(DERIVATIVE),push(p1),push(p2),list(3)):push(zero)},dsin=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),cosine(),multiply()},dcos=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),sine(),multiply(),negate()},dtan=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),cosine(),push_integer(-2),power(),multiply()},darcsin=function(){return push(cadr(p1)),push(p2),derivative(),push_integer(1),push(cadr(p1)),push_integer(2),power(),subtract(),push_rational(-1,2),power(),multiply()},darccos=function(){return push(cadr(p1)),push(p2),derivative(),push_integer(1),push(cadr(p1)),push_integer(2),power(),subtract(),push_rational(-1,2),power(),multiply(),negate()},darctan=function(){return push(cadr(p1)),push(p2),derivative(),push_integer(1),push(cadr(p1)),push_integer(2),power(),add(),inverse(),multiply(),simplify()},dsinh=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),ycosh(),multiply()},dcosh=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),ysinh(),multiply()},dtanh=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),ycosh(),push_integer(-2),power(),multiply()},darcsinh=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),push_integer(2),power(),push_integer(1),add(),push_rational(-1,2),power(),multiply()},darccosh=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),push_integer(2),power(),push_integer(-1),add(),push_rational(-1,2),power(),multiply()},darctanh=function(){return push(cadr(p1)),push(p2),derivative(),push_integer(1),push(cadr(p1)),push_integer(2),power(),subtract(),inverse(),multiply()},dabs=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),sgn(),multiply()},dsgn=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),dirac(),multiply(),push_integer(2),multiply()},dhermite=function(){return push(cadr(p1)),push(p2),derivative(),push_integer(2),push(caddr(p1)),multiply(),multiply(),push(cadr(p1)),push(caddr(p1)),push_integer(-1),add(),hermite(),multiply()},derf=function(){return push(cadr(p1)),push_integer(2),power(),push_integer(-1),multiply(),exponential(),evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),push_rational(-1,2),power(),multiply(),push_integer(2),multiply(),push(cadr(p1)),push(p2),derivative(),multiply()},derfc=function(){return push(cadr(p1)),push_integer(2),power(),push_integer(-1),multiply(),exponential(),evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),push_rational(-1,2),power(),multiply(),push_integer(-2),multiply(),push(cadr(p1)),push(p2),derivative(),multiply()},dbesselj0=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),push_integer(1),besselj(),multiply(),push_integer(-1),multiply()},dbesseljn=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),push(caddr(p1)),push_integer(-1),add(),besselj(),push(caddr(p1)),push_integer(-1),multiply(),push(cadr(p1)),divide(),push(cadr(p1)),push(caddr(p1)),besselj(),multiply(),add(),multiply()},dbessely0=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),push_integer(1),besselj(),multiply(),push_integer(-1),multiply()},dbesselyn=function(){return push(cadr(p1)),push(p2),derivative(),push(cadr(p1)),push(caddr(p1)),push_integer(-1),add(),bessely(),push(caddr(p1)),push_integer(-1),multiply(),push(cadr(p1)),divide(),push(cadr(p1)),push(caddr(p1)),bessely(),multiply(),add(),multiply()},derivative_of_integral=function(){return push(cadr(p1))},DET_check_arg=function(){return istensor(p1)?p1.tensor.ndim!==2||p1.tensor.dim[0]!==p1.tensor.dim[1]?0:1:0},det=function(){var e,t,r,n,s,i,a;if(t=0,n=0,save(),p1=pop(),DET_check_arg()===0){push_symbol(DET),push(p1),list(2),restore();return}for(n=p1.tensor.nelem,e=p1.tensor.elem,t=s=0,i=n;(0<=i?s<i:s>i)&&isNumericAtom(e[t]);t=0<=i?++s:--s);if(t===n)yydetg();else{for(t=r=0,a=p1.tensor.nelem;0<=a?r<a:r>a;t=0<=a?++r:--r)push(p1.tensor.elem[t]);determinant(p1.tensor.dim[0])}return restore()},determinant=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S;for(n=0,s=0,a=0,l=0,c=0,m=0,g=0,S=0,t=[],n=tos-e*e,s=u=0,f=e;0<=f?u<f:u>f;s=0<=f?++u:--u)t[s]=s,t[s+e]=0,t[s+e+e]=1;for(g=1,push(zero);;){for(push_integer(g===1?1:-1),s=i=0,d=e;0<=d?i<d:i>d;s=0<=d?++i:--i)l=e*t[s]+s,push(stack[n+l]),multiply();for(add(),a=e-1,m=0,r=!1;;){if(c=t[e+a]+t[e+e+a],c<0){t[e+e+a]=-t[e+e+a],a--;continue}if(c===a+1){if(a===0){r=!0;break}m++,t[e+e+a]=-t[e+e+a],a--;continue}break}if(r)break;S=t[a-t[e+a]+m],t[a-t[e+a]+m]=t[a-c+m],t[a-c+m]=S,t[e+a]=c,g=-g}return stack[n]=stack[tos-1],moveTos(n+1)},yydetg=function(){var e,t,r,n;for(e=0,t=0,t=p1.tensor.dim[0],e=r=0,n=t*t;0<=n?r<n:r>n;e=0<=n?++r:--r)push(p1.tensor.elem[e]);return lu_decomp(t),moveTos(tos-t*t),push(p1)},M=function(e,t,r,n){return stack[e+t*r+n]},setM=function(e,t,r,n,s){return stack[e+t*r+n]=s},lu_decomp=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P;for(t=0,r=0,n=0,i=0,r=tos-e*e,p1=one,t=c=0,f=e-1;0<=f?c<f:c>f;t=0<=f?++c:--c){if(equal(M(r,e,t,t),zero)){for(n=s=d=t+1,m=e;(d<=m?s<m:s>m)&&equal(M(r,e,n,t),zero);n=d<=m?++s:--s);if(n===e){p1=zero;break}for(i=a=g=t,S=e;g<=S?a<S:a>S;i=g<=S?++a:--a)p2=M(r,e,t,i),setM(r,e,t,i,M(r,e,n,i)),setM(r,e,n,i,p2);push(p1),negate(),p1=pop()}for(push(p1),push(M(r,e,t,t)),multiply(),p1=pop(),n=l=y=t+1,R=e;y<=R?l<R:l>R;n=y<=R?++l:--l)for(push(M(r,e,n,t)),push(M(r,e,t,t)),divide(),negate(),p2=pop(),setM(r,e,n,t,zero),i=u=w=t+1,P=e;w<=P?u<P:u>P;i=w<=P?++u:--u)push(M(r,e,t,i)),push(p2),multiply(),push(M(r,e,n,i)),add(),setM(r,e,n,i,pop())}return push(p1),push(M(r,e,e-1,e-1)),multiply(),p1=pop()},Eval_dirac=function(){return push(cadr(p1)),Eval(),dirac()},dirac=function(){return save(),ydirac(),restore()},ydirac=function(){if(p1=pop(),isdouble(p1))if(p1.d===0){push_integer(1);return}else{push_integer(0);return}if(isrational(p1))if(MZERO(mmul(p1.q.a,p1.q.b))){push_integer(1);return}else{push_integer(0);return}if(car(p1)===symbol(POWER)){push_symbol(DIRAC),push(cadr(p1)),list(2);return}if(isnegativeterm(p1)){push_symbol(DIRAC),push(p1),negate(),list(2);return}return(isnegativeterm(p1)||car(p1)===symbol(ADD)&&isnegativeterm(cadr(p1)))&&(push(p1),negate(),p1=pop()),push_symbol(DIRAC),push(p1),list(2)},divisors=function(){var e,t,r,n,s,i;for(t=0,e=0,r=0,save(),e=tos-1,divisors_onstack(),r=tos-e,i=stack.slice(e,e+r),i.sort(cmp_expr),stack=stack.slice(0,e).concat(i).concat(stack.slice(e+r)),p1=alloc_tensor(r),p1.tensor.ndim=1,p1.tensor.dim[0]=r,t=n=0,s=r;0<=s?n<s:n>s;t=0<=s?++n:--n)p1.tensor.elem[t]=stack[e+t];return moveTos(e),push(p1),restore()},divisors_onstack=function(){var e,t,r,n,s,i;if(e=0,t=0,r=0,n=0,save(),p1=pop(),e=tos,isNumericAtom(p1))push(p1),factor_small_number();else if(car(p1)===symbol(ADD))push(p1),__factor_add();else if(car(p1)===symbol(MULTIPLY))for(p1=cdr(p1),isNumericAtom(car(p1))&&(push(car(p1)),factor_small_number(),p1=cdr(p1));iscons(p1);)p2=car(p1),car(p2)===symbol(POWER)?(push(cadr(p2)),push(caddr(p2))):(push(p2),push(one)),p1=cdr(p1);else car(p1)===symbol(POWER)?(push(cadr(p1)),push(caddr(p1))):(push(p1),push(one));for(r=tos,push(one),gen(e,r),n=tos-r,t=s=0,i=n;0<=i?s<i:s>i;t=0<=i?++s:--s)stack[e+t]=stack[r+t];return moveTos(e+n),restore()},gen=function(e,t){var r,n,s,i;if(r=0,n=0,save(),p1=pop(),e===t){push(p1),restore();return}if(p2=stack[e+0],p3=stack[e+1],push(p3),r=pop_integer(),!isNaN(r))for(n=s=0,i=Math.abs(r);0<=i?s<=i:s>=i;n=0<=i?++s:--s)push(p1),push(p2),push_integer(sign(r)*n),power(),multiply(),gen(e+2,t);return restore()},__factor_add=function(){for(save(),p1=pop(),p3=cdr(p1),push(car(p3)),p3=cdr(p3);iscons(p3);)push(car(p3)),gcd(),p3=cdr(p3);if(p2=pop(),isplusone(p2)){push(p1),push(one),restore();return}if(isNumericAtom(p2))push(p2),factor_small_number();else if(car(p2)===symbol(MULTIPLY))for(p3=cdr(p2),isNumericAtom(car(p3))?(push(car(p3)),factor_small_number()):(push(car(p3)),push(one)),p3=cdr(p3);iscons(p3);)push(car(p3)),push(one),p3=cdr(p3);else push(p2),push(one);for(push(p2),inverse(),p2=pop(),push(zero),p3=cdr(p1);iscons(p3);)push(p2),push(car(p3)),multiply(),add(),p3=cdr(p3);return push(one),restore()},dpow=function(){var e,t,r,n,s,i;if(e=0,t=0,r=0,n=0,s=0,i=0,n=pop_double(),r=pop_double(),r===0&&n<0&&stop("divide by zero"),r>=0||n%1===0){s=Math.pow(r,n),push_double(s);return}return s=Math.pow(Math.abs(r),n),i=Math.PI*n,n%.5===0?(e=0,t=Math.sin(i)):(e=Math.cos(i),t=Math.sin(i)),push_double(e*s),push_double(t*s),push(imaginaryunit),multiply(),add()},EIG_N=0,EIG_yydd=[],EIG_yyqq=[],Eval_eigen=function(){return EIG_check_arg()===0&&stop("eigen: argument is not a square matrix"),eigen(EIGEN),p1=usr_symbol("D"),set_binding(p1,p2),p1=usr_symbol("Q"),set_binding(p1,p3),push(symbol(NIL))},Eval_eigenval=function(){if(EIG_check_arg()===0){push_symbol(EIGENVAL),push(p1),list(2);return}return eigen(EIGENVAL),push(p2)},Eval_eigenvec=function(){if(EIG_check_arg()===0){push_symbol(EIGENVEC),push(p1),list(2);return}return eigen(EIGENVEC),push(p3)},EIG_check_arg=function(){var e,t,r,n,s,i,a,l,u,c,f;if(e=0,r=0,push(cadr(p1)),Eval(),yyfloat(),Eval(),p1=pop(),!istensor(p1))return 0;for((p1.tensor.ndim!==2||p1.tensor.dim[0]!==p1.tensor.dim[1])&&stop("eigen: argument is not a square matrix"),EIG_N=p1.tensor.dim[0],e=i=0,a=EIG_N;0<=a?i<a:i>a;e=0<=a?++i:--i)for(r=t=0,l=EIG_N;0<=l?t<l:t>l;r=0<=l?++t:--t)isdouble(p1.tensor.elem[EIG_N*e+r])||stop("eigen: matrix is not numerical");for(e=n=0,u=EIG_N-1;0<=u?n<u:n>u;e=0<=u?++n:--n)for(r=s=c=e+1,f=EIG_N;c<=f?s<f:s>f;r=c<=f?++s:--s)Math.abs(p1.tensor.elem[EIG_N*e+r].d-p1.tensor.elem[EIG_N*r+e].d)>1e-10&&stop("eigen: matrix is not symmetrical");return 1},eigen=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe;for(t=0,n=0,t=u=0,m=EIG_N*EIG_N;0<=m?u<m:u>m;t=0<=m?++u:--u)EIG_yydd[t]=0;for(t=r=0,g=EIG_N*EIG_N;0<=g?r<g:r>g;t=0<=g?++r:--r)EIG_yyqq[t]=0;for(t=s=0,y=EIG_N;0<=y?s<y:s>y;t=0<=y?++s:--s)for(EIG_yydd[EIG_N*t+t]=p1.tensor.elem[EIG_N*t+t].d,n=i=R=t+1,w=EIG_N;R<=w?i<w:i>w;n=R<=w?++i:--i)EIG_yydd[EIG_N*t+n]=p1.tensor.elem[EIG_N*t+n].d,EIG_yydd[EIG_N*n+t]=p1.tensor.elem[EIG_N*t+n].d;for(t=a=0,P=EIG_N;0<=P?a<P:a>P;t=0<=P?++a:--a)for(EIG_yyqq[EIG_N*t+t]=1,n=l=C=t+1,B=EIG_N;C<=B?l<B:l>B;n=C<=B?++l:--l)EIG_yyqq[EIG_N*t+n]=0,EIG_yyqq[EIG_N*n+t]=0;for(t=c=0;c<100&&step()!==0;t=++c);if(t===100&&printstr(`
note: eigen did not converge
`),e===EIGEN||e===EIGENVAL)for(push(p1),copy_tensor(),p2=pop(),t=f=0,H=EIG_N;0<=H?f<H:f>H;t=0<=H?++f:--f)for(n=d=0,te=EIG_N;0<=te?d<te:d>te;n=0<=te?++d:--d)push_double(EIG_yydd[EIG_N*t+n]),p2.tensor.elem[EIG_N*t+n]=pop();if(e===EIGEN||e===EIGENVEC){for(push(p1),copy_tensor(),p3=pop(),K=[],t=oe=0,S=EIG_N;0<=S?oe<S:oe>S;t=0<=S?++oe:--oe)K.push(function(){var re,ae,J;for(ae=[],n=J=0,re=EIG_N;0<=re?J<re:J>re;n=0<=re?++J:--J)push_double(EIG_yyqq[EIG_N*t+n]),ae.push(p3.tensor.elem[EIG_N*t+n]=pop());return ae}());return K}},step=function(){var e,t,r,n,s,i,a,l;for(t=0,n=0,e=0,t=s=0,i=EIG_N-1;0<=i?s<i:s>i;t=0<=i?++s:--s)for(n=r=a=t+1,l=EIG_N;a<=l?r<l:r>l;n=a<=l?++r:--r)EIG_yydd[EIG_N*t+n]!==0&&(step2(t,n),e++);return e},step2=function(e,t){var r,n,s,i,a,l,u,c,f,d,m,g,S;for(a=0,g=0,S=0,r=0,n=0,d=0,m=0,S=.5*(EIG_yydd[EIG_N*e+e]-EIG_yydd[EIG_N*t+t])/EIG_yydd[EIG_N*e+t],g=1/(Math.abs(S)+Math.sqrt(S*S+1)),S<0&&(g=-g),r=1/Math.sqrt(g*g+1),d=g*r,a=l=0,u=EIG_N;0<=u?l<u:l>u;a=0<=u?++l:--l)n=EIG_yydd[EIG_N*e+a],m=EIG_yydd[EIG_N*t+a],EIG_yydd[EIG_N*e+a]=r*n+d*m,EIG_yydd[EIG_N*t+a]=r*m-d*n;for(a=s=0,c=EIG_N;0<=c?s<c:s>c;a=0<=c?++s:--s)n=EIG_yydd[EIG_N*a+e],m=EIG_yydd[EIG_N*a+t],EIG_yydd[EIG_N*a+e]=r*n+d*m,EIG_yydd[EIG_N*a+t]=r*m-d*n;for(a=i=0,f=EIG_N;0<=f?i<f:i>f;a=0<=f?++i:--i)n=EIG_yyqq[EIG_N*e+a],m=EIG_yyqq[EIG_N*t+a],EIG_yyqq[EIG_N*e+a]=r*n+d*m,EIG_yyqq[EIG_N*t+a]=r*m-d*n;return EIG_yydd[EIG_N*e+t]=0,EIG_yydd[EIG_N*t+e]=0},Eval_erf=function(){return push(cadr(p1)),Eval(),yerf()},yerf=function(){return save(),yyerf(),restore()},yyerf=function(){var e;if(e=0,p1=pop(),isdouble(p1)){e=1-erfc(p1.d),push_double(e);return}if(isZeroAtomOrTensor(p1)){push(zero);return}if(isnegativeterm(p1)){push_symbol(ERF),push(p1),negate(),list(2),negate();return}push_symbol(ERF),push(p1),list(2)},Eval_erfc=function(){return push(cadr(p1)),Eval(),yerfc()},yerfc=function(){return save(),yyerfc(),restore()},yyerfc=function(){var e;if(e=0,p1=pop(),isdouble(p1)){e=erfc(p1.d),push_double(e);return}if(isZeroAtomOrTensor(p1)){push(one);return}push_symbol(ERFC),push(p1),list(2)},erfc=function(e){var t,r,n;return e===0?1:(r=0,n=0,t=0,n=Math.abs(e),r=1/(1+.5*n),t=r*Math.exp(-n*n-1.26551223+r*(1.00002368+r*(.37409196+r*(.09678418+r*(-.18628806+r*(.27886807+r*(-1.13520398+r*(1.48851587+r*(-.82215223+r*.17087277))))))))),e>=0?t:2-t)},Eval=function(){var e;if(check_esc_flag(),save(),p1=pop(),p1==null)debugger;switch(!evaluatingAsFloats&&isfloating(p1)&&(e=!0,evaluatingAsFloats++),p1.k){case CONS:Eval_cons();break;case NUM:evaluatingAsFloats?push_double(convert_rational_to_double(p1)):push(p1);break;case DOUBLE:case STR:push(p1);break;case TENSOR:Eval_tensor();break;case SYM:Eval_sym();break;default:stop("atom?")}return e&&evaluatingAsFloats--,restore()},Eval_sym=function(){var e,t,r,n,s,i;if(iskeyword(p1)){push(p1),push(symbol(LAST)),list(2),Eval();return}else if(p1===symbol(PI)&&evaluatingAsFloats){push_double(Math.PI);return}if(p2=get_binding(p1),DEBUG&&console.log("looked up: "+p1+" which contains: "+p2),push(p2),p1!==p2){if(n=chainOfUserSymbolsNotFunctionsBeingEvaluated.indexOf(p1),n!==-1){for(e="",t=r=s=n,i=chainOfUserSymbolsNotFunctionsBeingEvaluated.length;s<=i?r<i:r>i;t=s<=i?++r:--r)e+=chainOfUserSymbolsNotFunctionsBeingEvaluated[t].printname+" -> ";e+=p1.printname,stop("recursive evaluation of symbols: "+e);return}return chainOfUserSymbolsNotFunctionsBeingEvaluated.push(p1),Eval(),chainOfUserSymbolsNotFunctionsBeingEvaluated.pop()}},Eval_cons=function(){var e;if(e=car(p1),car(e)===symbol(EVAL)){Eval_user_function();return}switch(issymbol(e)||stop("cons?"),symnum(e)){case ABS:return Eval_abs();case ADD:return Eval_add();case ADJ:return Eval_adj();case AND:return Eval_and();case ARCCOS:return Eval_arccos();case ARCCOSH:return Eval_arccosh();case ARCSIN:return Eval_arcsin();case ARCSINH:return Eval_arcsinh();case ARCTAN:return Eval_arctan();case ARCTANH:return Eval_arctanh();case ARG:return Eval_arg();case ATOMIZE:return Eval_atomize();case BESSELJ:return Eval_besselj();case BESSELY:return Eval_bessely();case BINDING:return Eval_binding();case BINOMIAL:return Eval_binomial();case CEILING:return Eval_ceiling();case CHECK:return Eval_check();case CHOOSE:return Eval_choose();case CIRCEXP:return Eval_circexp();case CLEAR:return Eval_clear();case CLEARALL:return Eval_clearall();case CLEARPATTERNS:return Eval_clearpatterns();case CLOCK:return Eval_clock();case COEFF:return Eval_coeff();case COFACTOR:return Eval_cofactor();case CONDENSE:return Eval_condense();case CONJ:return Eval_conj();case CONTRACT:return Eval_contract();case COS:return Eval_cos();case COSH:return Eval_cosh();case DECOMP:return Eval_decomp();case DEGREE:return Eval_degree();case DEFINT:return Eval_defint();case DENOMINATOR:return Eval_denominator();case DERIVATIVE:return Eval_derivative();case DET:return Eval_det();case DIM:return Eval_dim();case DIRAC:return Eval_dirac();case DIVISORS:return Eval_divisors();case DO:return Eval_do();case DOT:return Eval_inner();case DRAW:return Eval_draw();case DSOLVE:return Eval_dsolve();case EIGEN:return Eval_eigen();case EIGENVAL:return Eval_eigenval();case EIGENVEC:return Eval_eigenvec();case ERF:return Eval_erf();case ERFC:return Eval_erfc();case EVAL:return Eval_Eval();case EXP:return Eval_exp();case EXPAND:return Eval_expand();case EXPCOS:return Eval_expcos();case EXPSIN:return Eval_expsin();case FACTOR:return Eval_factor();case FACTORIAL:return Eval_factorial();case FACTORPOLY:return Eval_factorpoly();case FILTER:return Eval_filter();case FLOATF:return Eval_float();case APPROXRATIO:return Eval_approxratio();case FLOOR:return Eval_floor();case FOR:return Eval_for();case FUNCTION:return Eval_function_reference();case GAMMA:return Eval_gamma();case GCD:return Eval_gcd();case HERMITE:return Eval_hermite();case HILBERT:return Eval_hilbert();case IMAG:return Eval_imag();case INDEX:return Eval_index();case INNER:return Eval_inner();case INTEGRAL:return Eval_integral();case INV:return Eval_inv();case INVG:return Eval_invg();case ISINTEGER:return Eval_isinteger();case ISPRIME:return Eval_isprime();case LAGUERRE:return Eval_laguerre();case LCM:return Eval_lcm();case LEADING:return Eval_leading();case LEGENDRE:return Eval_legendre();case LOG:return Eval_log();case LOOKUP:return Eval_lookup();case MOD:return Eval_mod();case MULTIPLY:return Eval_multiply();case NOT:return Eval_not();case NROOTS:return Eval_nroots();case NUMBER:return Eval_number();case NUMERATOR:return Eval_numerator();case OPERATOR:return Eval_operator();case OR:return Eval_or();case OUTER:return Eval_outer();case PATTERN:return Eval_pattern();case PATTERNSINFO:return Eval_patternsinfo();case POLAR:return Eval_polar();case POWER:return Eval_power();case PRIME:return Eval_prime();case PRINT:return Eval_print();case PRINT2DASCII:return Eval_print2dascii();case PRINTFULL:return Eval_printcomputer();case PRINTLATEX:return Eval_printlatex();case PRINTLIST:return Eval_printlist();case PRINTPLAIN:return Eval_printhuman();case PRODUCT:return Eval_product();case QUOTE:return Eval_quote();case QUOTIENT:return Eval_quotient();case RANK:return Eval_rank();case RATIONALIZE:return Eval_rationalize();case REAL:return Eval_real();case ROUND:return Eval_round();case YYRECT:return Eval_rect();case ROOTS:return Eval_roots();case SETQ:return Eval_setq();case SGN:return Eval_sgn();case SILENTPATTERN:return Eval_silentpattern();case SIMPLIFY:return Eval_simplify();case SIN:return Eval_sin();case SINH:return Eval_sinh();case SHAPE:return Eval_shape();case SQRT:return Eval_sqrt();case STOP:return Eval_stop();case SUBST:return Eval_subst();case SUM:return Eval_sum();case SYMBOLSINFO:return Eval_symbolsinfo();case TAN:return Eval_tan();case TANH:return Eval_tanh();case TAYLOR:return Eval_taylor();case TEST:return Eval_test();case TESTEQ:return Eval_testeq();case TESTGE:return Eval_testge();case TESTGT:return Eval_testgt();case TESTLE:return Eval_testle();case TESTLT:return Eval_testlt();case TRANSPOSE:return Eval_transpose();case UNIT:return Eval_unit();case ZERO:return Eval_zero();default:return Eval_user_function()}},Eval_binding=function(){return push(get_binding(cadr(p1)))},Eval_check=function(){var e;return e=isZeroLikeOrNonZeroLikeOrUndetermined(cadr(p1)),e==null?push(p1):push_integer(e)},Eval_det=function(){return push(cadr(p1)),Eval(),det()},Eval_dim=function(){var e;return push(cadr(p1)),Eval(),p2=pop(),iscons(cddr(p1))?(push(caddr(p1)),Eval(),e=pop_integer()):e=1,istensor(p2)?e<1||e>p2.tensor.ndim?push(p1):push_integer(p2.tensor.dim[e-1]):push_integer(1)},Eval_divisors=function(){return push(cadr(p1)),Eval(),divisors()},Eval_do=function(){var e;for(push(car(p1)),p1=cdr(p1),e=[];iscons(p1);)pop(),push(car(p1)),Eval(),e.push(p1=cdr(p1));return e},Eval_dsolve=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),push(cadddr(p1)),Eval(),dsolve()},Eval_Eval=function(){for(push(cadr(p1)),Eval(),p1=cddr(p1);iscons(p1);)push(car(p1)),Eval(),push(cadr(p1)),Eval(),subst(),p1=cddr(p1);return Eval()},Eval_exp=function(){return push(cadr(p1)),Eval(),exponential()},Eval_factorial=function(){return push(cadr(p1)),Eval(),factorial()},Eval_factorpoly=function(){var e;for(p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),push(car(p1)),Eval(),factorpoly(),p1=cdr(p1),e=[];iscons(p1);)push(car(p1)),Eval(),factorpoly(),e.push(p1=cdr(p1));return e},Eval_hermite=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),hermite()},Eval_hilbert=function(){return push(cadr(p1)),Eval(),hilbert()},Eval_index=function(){var e,t,r;if(e=tos,t=p1,p1=cdr(p1),push(car(p1)),Eval(),r=stack[tos-1],isNumericAtom(r)&&stop("trying to access a scalar as a tensor"),!istensor(r)){moveTos(e),push(t);return}for(p1=cdr(p1);iscons(p1);){if(push(car(p1)),Eval(),!isintegerorintegerfloat(stack[tos-1])){moveTos(e),push(t);return}p1=cdr(p1)}return index_function(tos-e)},Eval_inv=function(){return push(cadr(p1)),Eval(),inv()},Eval_invg=function(){return push(cadr(p1)),Eval(),invg()},Eval_isinteger=function(){var e;if(push(cadr(p1)),Eval(),p1=pop(),isrational(p1)){isinteger(p1)?push(one):push(zero);return}if(isdouble(p1)){e=Math.floor(p1.d),e===p1.d?push(one):push(zero);return}return push_symbol(ISINTEGER),push(p1),list(2)},Eval_number=function(){return push(cadr(p1)),Eval(),p1=pop(),p1.k===NUM||p1.k===DOUBLE?push_integer(1):push_integer(0)},Eval_operator=function(){var e;for(e=tos,push_symbol(OPERATOR),p1=cdr(p1);iscons(p1);)push(car(p1)),Eval(),p1=cdr(p1);return list(tos-e)},Eval_quote=function(){return push(cadr(p1))},Eval_rank=function(){return push(cadr(p1)),Eval(),p1=pop(),istensor(p1)?push_integer(p1.tensor.ndim):push(zero)},Eval_setq=function(){if(caadr(p1)===symbol(INDEX)){setq_indexed();return}if(iscons(cadr(p1))){define_user_function();return}return issymbol(cadr(p1))||stop("symbol assignment: error in symbol"),push(caddr(p1)),Eval(),p2=pop(),set_binding(cadr(p1),p2),push(symbol(NIL))},setq_indexed=function(){var e;for(p4=cadadr(p1),issymbol(p4)||stop("indexed assignment: expected a symbol name"),e=tos,push(caddr(p1)),Eval(),p2=cdadr(p1);iscons(p2);)push(car(p2)),Eval(),p2=cdr(p2);return set_component(tos-e),p3=pop(),set_binding(p4,p3),push(symbol(NIL))},Eval_sqrt=function(){return push(cadr(p1)),Eval(),push_rational(1,2),power()},Eval_stop=function(){return stop("user stop")},Eval_subst=function(){return push(cadddr(p1)),Eval(),push(caddr(p1)),Eval(),push(cadr(p1)),Eval(),subst(),Eval()},Eval_unit=function(){var e,t,r,n;if(e=0,t=0,push(cadr(p1)),Eval(),t=pop_integer(),isNaN(t)){push(p1);return}if(t<1){push(p1);return}for(p1=alloc_tensor(t*t),p1.tensor.ndim=2,p1.tensor.dim[0]=t,p1.tensor.dim[1]=t,e=r=0,n=t;0<=n?r<n:r>n;e=0<=n?++r:--r)p1.tensor.elem[t*e+e]=one;return check_tensor_dimensions(p1),push(p1)},Eval_predicate=function(){return save(),p1=top(),car(p1)===symbol(SETQ)&&(pop(),push_symbol(TESTEQ),push(cadr(p1)),push(caddr(p1)),list(3)),Eval(),restore()},Eval_expand=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),p2=pop(),p2===symbol(NIL)?guess():push(p2),expand()},expand=function(){var e;if(save(),p9=pop(),p5=pop(),istensor(p5)){expand_tensor(),restore();return}if(car(p5)===symbol(ADD)){for(push_integer(0),p1=cdr(p5);iscons(p1);)push(car(p1)),push(p9),expand(),add(),p1=cdr(p1);restore();return}if(push(p5),numerator(),p3=pop(),push(p5),denominator(),p2=pop(),remove_negative_exponents(),push(p3),push(p2),push(p9),(isone(p3)||isone(p2))&&(!ispolyexpandedform(p2,p9)||isone(p2))){pop(),pop(),pop(),push(p5),restore();return}if(divpoly(),p7=pop(),push(p3),push(p2),push(p7),multiply(),subtract(),p3=pop(),isZeroAtomOrTensor(p3)){push(p7),restore();return}return push(p2),push(p9),factorpoly(),p2=pop(),expand_get_C(),expand_get_B(),expand_get_A(),istensor(p4)?(push(p4),e=expanding,expanding=1,inv(),expanding=e,push(p3),inner(),push(p2),inner()):(push(p3),push(p4),e=expanding,expanding=1,divide(),expanding=e,push(p2),multiply()),push(p7),add(),restore()},expand_tensor=function(){var e,t,r;for(e=0,push(p5),copy_tensor(),p5=pop(),e=t=0,r=p5.tensor.nelem;0<=r?t<r:t>r;e=0<=r?++t:--t)push(p5.tensor.elem[e]),push(p9),expand(),p5.tensor.elem[e]=pop();return push(p5)},remove_negative_exponents=function(){var e,t,r,n,s,i,a;for(e=0,t=0,r=0,n=0,s=0,e=tos,factors(p2),factors(p3),s=tos-e,r=0,t=i=0,a=s;0<=a?i<a:i>a;t=0<=a?++i:--i)p1=stack[e+t],car(p1)===symbol(POWER)&&cadr(p1)===p9&&(push(caddr(p1)),n=pop_integer(),!isNaN(n)&&n<r&&(r=n));if(moveTos(e),r!==0)return push(p2),push(p9),push_integer(-r),power(),multiply(),p2=pop(),push(p3),push(p9),push_integer(-r),power(),multiply(),p3=pop()},expand_get_C=function(){var e,t,r,n,s,i,a,l,u,c;if(t=0,r=0,s=0,i=0,t=tos,car(p2)===symbol(MULTIPLY))for(p1=cdr(p2);iscons(p1);)p5=car(p1),expand_get_CF(),p1=cdr(p1);else p5=p2,expand_get_CF();if(i=tos-t,i===1){p4=pop();return}for(p4=alloc_tensor(i*i),p4.tensor.ndim=2,p4.tensor.dim[0]=i,p4.tensor.dim[1]=i,e=t,r=a=0,u=i;0<=u?a<u:a>u;r=0<=u?++a:--a)for(s=n=0,c=i;0<=c?n<c:n>c;s=0<=c?++n:--n)push(stack[e+s]),push(p9),push_integer(r),power(),l=expanding,expanding=1,divide(),expanding=l,push(p9),filter(),p4.tensor.elem[i*r+s]=pop();return moveTos(tos-i)},expand_get_CF=function(){var e,t,r,n,s,i,a,l;if(e=0,t=0,r=0,n=0,!!Find(p5,p9)){for(i=expanding,expanding=1,trivial_divide(),expanding=i,car(p5)===symbol(POWER)?(push(caddr(p5)),n=pop_integer(),p6=cadr(p5)):(n=1,p6=p5),push(p6),push(p9),degree(),e=pop_integer(),l=[],t=s=0,a=n;0<=a?s<a:s>a;t=0<=a?++s:--s)l.push(function(){var u,c,f;for(f=[],r=u=0,c=e;0<=c?u<c:u>c;r=0<=c?++u:--u)push(p8),push(p6),push_integer(t),power(),i=expanding,expanding=1,multiply(),expanding=i,push(p9),push_integer(r),power(),i=expanding,expanding=1,multiply(),f.push(expanding=i);return f}());return l}},trivial_divide=function(){var e;if(e=0,car(p2)===symbol(MULTIPLY)){for(e=tos,p0=cdr(p2);iscons(p0);)equal(car(p0),p5)||(push(car(p0)),Eval()),p0=cdr(p0);multiply_all(tos-e)}else push_integer(1);return p8=pop()},expand_get_B=function(){var e,t,r,n,s;if(e=0,t=0,!!istensor(p4)){for(t=p4.tensor.dim[0],p8=alloc_tensor(t),p8.tensor.ndim=1,p8.tensor.dim[0]=t,e=r=0,s=t;0<=s?r<s:r>s;e=0<=s?++r:--r)push(p3),push(p9),push_integer(e),power(),n=expanding,expanding=1,divide(),expanding=n,push(p9),filter(),p8.tensor.elem[e]=pop();return p3=p8}},expand_get_A=function(){var e,t,r,n,s;if(e=0,t=0,r=0,!istensor(p4)){push(p2),reciprocate(),p2=pop();return}if(e=tos,car(p2)===symbol(MULTIPLY))for(p8=cdr(p2);iscons(p8);)p5=car(p8),expand_get_AF(),p8=cdr(p8);else p5=p2,expand_get_AF();for(r=tos-e,p8=alloc_tensor(r),p8.tensor.ndim=1,p8.tensor.dim[0]=r,t=n=0,s=r;0<=s?n<s:n>s;t=0<=s?++n:--n)p8.tensor.elem[t]=stack[e+t];return moveTos(e),p2=p8},expand_get_AF=function(){var e,t,r,n,s,i,a;if(e=0,t=0,r=0,n=1,!!Find(p5,p9)){for(car(p5)===symbol(POWER)&&(push(caddr(p5)),n=pop_integer(),p5=cadr(p5)),push(p5),push(p9),degree(),e=pop_integer(),a=[],t=s=i=n;i<=0?s<0:s>0;t=i<=0?++s:--s)a.push(function(){var l,u,c;for(c=[],r=l=0,u=e;0<=u?l<u:l>u;r=0<=u?++l:--l)push(p5),push_integer(t),power(),reciprocate(),push(p9),push_integer(r),power(),c.push(multiply());return c}());return a}},Eval_expcos=function(){return push(cadr(p1)),Eval(),expcos()},expcos=function(){return save(),p1=pop(),push(imaginaryunit),push(p1),multiply(),exponential(),push_rational(1,2),multiply(),push(imaginaryunit),negate(),push(p1),multiply(),exponential(),push_rational(1,2),multiply(),add(),restore()},Eval_expsin=function(){return push(cadr(p1)),Eval(),expsin()},expsin=function(){return save(),p1=pop(),push(imaginaryunit),push(p1),multiply(),exponential(),push(imaginaryunit),divide(),push_rational(1,2),multiply(),push(imaginaryunit),negate(),push(p1),multiply(),exponential(),push(imaginaryunit),divide(),push_rational(1,2),multiply(),subtract(),restore()},Eval_factor=function(){var e;for(push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),p2=pop(),p2===symbol(NIL)?guess():push(p2),factor(),p1=cdddr(p1),e=[];iscons(p1);)push(car(p1)),Eval(),factor_again(),e.push(p1=cdr(p1));return e},factor_again=function(){var e,t;if(save(),p2=pop(),p1=pop(),e=tos,car(p1)===symbol(MULTIPLY))for(p1=cdr(p1);iscons(p1);)push(car(p1)),push(p2),factor_term(),p1=cdr(p1);else push(p1),push(p2),factor_term();return t=tos-e,t>1&&multiply_all_noexpand(t),restore()},factor_term=function(){if(save(),factorpoly(),p1=pop(),car(p1)===symbol(MULTIPLY))for(p1=cdr(p1);iscons(p1);)push(car(p1)),p1=cdr(p1);else push(p1);return restore()},factor=function(){return save(),p2=pop(),p1=pop(),isinteger(p1)?(push(p1),factor_number()):(push(p1),push(p2),factorpoly()),restore()},factor_small_number=function(){var e,t,r,n,s,i;for(r=0,save(),n=pop_integer(),isNaN(n)&&stop("number too big to factor"),n<0&&(n=-n),r=s=0,i=MAXPRIMETAB;(0<=i?s<i:s>i)&&(e=primetab[r],!(e>n/e));r=0<=i?++s:--s){for(t=0;n%e===0;)n/=e,t++;t&&(push_integer(e),push_integer(t))}return n>1&&(push_integer(n),push_integer(1)),restore()},factorial=function(){var e;if(e=0,save(),p1=pop(),push(p1),e=pop_integer(),e<0||isNaN(e)){push_symbol(FACTORIAL),push(p1),list(2),restore();return}return bignum_factorial(e),restore()},factorpoly=function(){var e,t;return DEBUG&&console.log("factorpoly: "+stack[tos-1].toString()+" "+stack[tos-2].toString()),save(),t=pop(),e=pop(),!Find(e,t)||!ispolyexpandedform(e,t)||!issymbol(t)?push(e):yyfactorpoly(t,e),restore()},yyfactorpoly=function(e,t){var r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re,ae,J,ie;for(DEBUG&&(u=e,J=t,console.log("yyfactorpoly: "+u+" "+J)),save(),d=tos,isfloating(t)&&stop("floating point numbers in polynomial"),P=tos,l=coeff(e,t)-1,DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" factpoly_expo before rationalize_coefficients: "+l),w=rationalize_coefficients(d),DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" factpoly_expo  after rationalize_coefficients: "+l),ie="real",re=null;l>0;)if(DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" factpoly_expo inside while loop: "+l),isZeroAtomOrTensor(stack[P+0])?(DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" isZeroAtomOrTensor"),r=one,s=zero):ie==="real"?[f,r,s]=get_factor_from_real_root(e,l,P):ie==="complex"&&([c,r]=get_factor_from_complex_root(re,l,P)),ie==="real")if(f===0){ie="complex";continue}else{for(push(r),push(e),multiply(),push(s),add(),n=pop(),DEBUG&&console.log("yyfactorpoly: "+u+" "+J+` success
FACTOR=`+n),push(w),push(n),multiply_noexpand(),w=pop(),yydivpoly(l,P,r,s);l&&isZeroAtomOrTensor(stack[P+l]);)l--;for(push(zero),m=R=0,H=l;0<=H?R<=H:R>=H;m=0<=H?++R:--R)push(stack[P+m]),push(e),push_integer(m),power(),multiply(),add();re=pop()}else if(ie==="complex"){if(c===0)break;if(push(r),push(e),subtract(),push(r),conjugate(),push(e),subtract(),multiply(),ae=pop(),DEBUG&&console.log("yyfactorpoly: "+u+" "+J+` success
FACTOR=`+ae),push(w),B=pop(),push(w),push(ae),multiply_noexpand(),w=pop(),re==null){for(push(zero),m=g=0,te=l;0<=te?g<=te:g>=te;m=0<=te?++g:--g)push(stack[P+m]),push(e),push_integer(m),power(),multiply(),add();re=pop()}if(a=re,push(a),push(ae),push(e),divpoly(),re=pop(),push(re),push(ae),multiply(),i=pop(),!equal(i,a)){DEBUG&&console.log("we found a polynomial based on complex root and its conj but it doesn't divide the poly, quitting"),DEBUG&&console.log("so just returning previousFactorisation times dividend: "+B+" * "+a),push(B),push(a),C=expanding,expanding=0,yycondense(),expanding=C,multiply_noexpand(),w=pop(),stack[d]=w,moveTos(d+1),restore();return}for(m=S=0,K=l;0<=K?S<=K:S>=K;m=0<=K?++S:--S)pop();coeff(e,re),l-=2}for(DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" building the remaining unfactored part of the polynomial"),push(zero),m=y=0,oe=l;0<=oe?y<=oe:y>=oe;m=0<=oe?++y:--y)push(stack[P+m]),push(e),push_integer(m),power(),multiply(),add();return t=pop(),DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" remaining unfactored part of the polynomial: "+t.toString()),push(t),C=expanding,expanding=0,yycondense(),expanding=C,t=pop(),DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" new poly with extracted common factor: "+t.toString()),l>0&&isnegativeterm(stack[P+l])&&(push(t),negate(),t=pop(),push(w),negate_noexpand(),w=pop()),push(w),push(t),multiply_noexpand(),w=pop(),DEBUG&&console.log("yyfactorpoly: "+u+" "+J+" result: "+w),stack[d]=w,moveTos(d+1),restore()},rationalize_coefficients=function(e){var t,r,n,s,i,a,l,u,c;for(s=one,t=n=a=e,l=tos;a<=l?n<l:n>l;t=a<=l?++n:--n)push(stack[t]),denominator(),push(s),lcm(),s=pop();for(t=r=u=e,c=tos;u<=c?r<c:r>c;t=u<=c?++r:--r)push(s),push(stack[t]),multiply(),stack[t]=pop();return push(s),reciprocate(),i=pop(),DEBUG&&console.log("rationalize_coefficients result: "+i.toString()),i},get_factor_from_real_root=function(e,t,r){var n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re;if(DEBUG&&console.log("get_factor_from_real_root"),l=0,a=0,n=0,s=0,m=0,g=0,DEBUG){for(push(zero),l=S=0,R=t;0<=R?S<=R:S>=R;l=0<=R?++S:--S)push(stack[r+l]),push(e),push_integer(l),power(),multiply(),add();y=pop(),console.log("POLY="+y)}if(a=tos,s=tos,push(stack[r+t]),divisors_onstack(),g=tos-s,n=tos,push(stack[r+0]),divisors_onstack(),m=tos-n,DEBUG){for(console.log("divisors of base term"),l=u=0,w=m;0<=w?u<w:u>w;l=0<=w?++u:--u)console.log(", "+stack[n+l]);for(console.log("divisors of leading term"),l=c=0,P=g;0<=P?c<P:c>P;l=0<=P?++c:--c)console.log(", "+stack[s+l])}for(H=f=0,C=g;0<=C?f<C:f>C;H=0<=C?++f:--f)for(te=d=0,B=m;0<=B?d<B:d>B;te=0<=B?++d:--d){if(oe=stack[s+H],K=stack[n+te],push(K),push(oe),divide(),negate(),re=pop(),i=Evalpoly(t,r,re),DEBUG&&(console.log("try A="+oe),console.log(", B="+K),console.log(", root "+e),console.log("=-B/A="+re),console.log(", POLY("+re),console.log(")="+i)),isZeroAtomOrTensor(i))return moveTos(a),DEBUG&&console.log("get_factor_from_real_root returning 1"),[1,oe,K];if(push(K),negate(),K=pop(),push(re),negate(),re=pop(),i=Evalpoly(t,r,re),DEBUG&&(console.log("try A="+oe),console.log(", B="+K),console.log(", root "+e),console.log("=-B/A="+re),console.log(", POLY("+re),console.log(")="+i)),isZeroAtomOrTensor(i))return moveTos(a),DEBUG&&console.log("get_factor_from_real_root returning 1"),[1,oe,K]}return moveTos(a),DEBUG&&console.log("get_factor_from_real_root returning"),[0,null,null]},get_factor_from_complex_root=function(e,t,r){var n,s,i,a,l,u,c;if(s=0,t<=2)return DEBUG&&console.log("no more factoring via complex roots to be found in polynomial of degree <= 2"),[0,null];if(DEBUG&&console.log("complex root finding for POLY="+e),s=tos,push_integer(-1),push_rational(2,3),power(),rect(),c=pop(),DEBUG&&console.log("complex root finding: trying with "+c),push(c),n=Evalpoly(t,r,c),DEBUG&&console.log("complex root finding result: "+n),isZeroAtomOrTensor(n))return moveTos(s),DEBUG&&console.log("get_factor_from_complex_root returning 1"),[1,c];if(push_integer(1),push_rational(2,3),power(),rect(),c=pop(),DEBUG&&console.log("complex root finding: trying with "+c),push(c),n=Evalpoly(t,r,c),DEBUG&&console.log("complex root finding result: "+n),isZeroAtomOrTensor(n))return moveTos(s),DEBUG&&console.log("get_factor_from_complex_root returning 1"),[1,c];for(l=a=-10;a<=10;l=++a)for(u=i=1;i<=5;u=++i)if(push_integer(l),push_integer(u),push(imaginaryunit),multiply(),add(),rect(),c=pop(),DEBUG&&console.log("complex root finding: trying simple complex combination "+c),push(c),n=Evalpoly(t,r,c),isZeroAtomOrTensor(n))return moveTos(s),DEBUG&&console.log("found complex root: "+n),[1,c];return moveTos(s),DEBUG&&console.log("get_factor_from_complex_root returning 0"),[0,null]},yydivpoly=function(e,t,r,n){var s,i,a,l;for(s=zero,i=a=l=e;l<=0?a<0:a>0;i=l<=0?++a:--a)push(stack[t+i]),stack[t+i]=s,push(r),divide(),s=pop(),push(stack[t+i-1]),push(s),push(n),multiply(),subtract(),stack[t+i-1]=pop();if(stack[t+0]=s,DEBUG)return console.log("yydivpoly Q: "+s.toString())},Evalpoly=function(e,t,r){var n,s,i;for(push(zero),n=s=i=e;i<=0?s<=0:s>=0;n=i<=0?++s:--s)push(r),multiply(),push(stack[t+n]),add();return pop()},factors=function(e){var t;if(t=tos,car(e)===symbol(ADD))for(e=cdr(e);iscons(e);)push_term_factors(car(e)),e=cdr(e);else push_term_factors(e);return tos-t},push_term_factors=function(e){var t;if(car(e)===symbol(MULTIPLY)){for(e=cdr(e),t=[];iscons(e);)push(car(e)),t.push(e=cdr(e));return t}else return push(e)},Eval_filter=function(){var e;for(p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),e=[];iscons(p1);)push(car(p1)),Eval(),filter(),e.push(p1=cdr(p1));return e},filter=function(){return save(),p2=pop(),p1=pop(),filter_main(),restore()},filter_main=function(){return car(p1)===symbol(ADD)?filter_sum():istensor(p1)?filter_tensor():Find(p1,p2)?push_integer(0):push(p1)},filter_sum=function(){var e;for(push_integer(0),p1=cdr(p1),e=[];iscons(p1);)push(car(p1)),push(p2),filter(),add(),e.push(p1=cdr(p1));return e},filter_tensor=function(){var e,t,r,n,s,i;for(e=0,r=0,r=p1.tensor.nelem,p3=alloc_tensor(r),p3.tensor.ndim=p1.tensor.ndim,e=n=0,s=p1.tensor.ndim;0<=s?n<s:n>s;e=0<=s?++n:--n)p3.tensor.dim[e]=p1.tensor.dim[e];for(e=t=0,i=r;0<=i?t<i:t>i;e=0<=i?++t:--t)push(p1.tensor.elem[e]),push(p2),filter(),p3.tensor.elem[e]=pop();return push(p3)},Eval_float=function(){return evaluatingAsFloats++,push(cadr(p1)),Eval(),yyfloat(),Eval(),evaluatingAsFloats--},zzfloat=function(){return save(),evaluatingAsFloats++,Eval(),yyfloat(),Eval(),evaluatingAsFloats--,restore()},yyfloat=function(){var e,t,r,n;if(t=0,e=0,evaluatingAsFloats++,save(),p1=pop(),iscons(p1)){for(e=tos;iscons(p1);)push(car(p1)),yyfloat(),p1=cdr(p1);list(tos-e)}else if(p1.k===TENSOR){for(push(p1),copy_tensor(),p1=pop(),t=r=0,n=p1.tensor.nelem;0<=n?r<n:r>n;t=0<=n?++r:--r)push(p1.tensor.elem[t]),yyfloat(),p1.tensor.elem[t]=pop();push(p1)}else p1.k===NUM?(push(p1),bignum_float()):p1===symbol(PI)?push_double(Math.PI):p1===symbol(E)?push_double(Math.E):push(p1);return restore(),evaluatingAsFloats--},Eval_floor=function(){return push(cadr(p1)),Eval(),yfloor()},yfloor=function(){return save(),yyfloor(),restore()},yyfloor=function(){var e;if(e=0,p1=pop(),!isNumericAtom(p1)){push_symbol(FLOOR),push(p1),list(2);return}if(isdouble(p1)){e=Math.floor(p1.d),push_double(e);return}if(isinteger(p1)){push(p1);return}if(p3=new U,p3.k=NUM,p3.q.a=mdiv(p1.q.a,p1.q.b),p3.q.b=mint(1),push(p3),isnegativenumber(p1))return push_integer(-1),add()},Eval_for=function(){var e,t,r,n,s,i,a;if(e=0,t=0,r=0,n=caddr(p1),issymbol(n)||stop("for: 2nd arg should be the variable to loop over"),push(cadddr(p1)),Eval(),t=pop_integer(),isNaN(t)){push(p1);return}if(push(caddddr(p1)),Eval(),r=pop_integer(),isNaN(r)){push(p1);return}for(p4=get_binding(n),e=s=i=t,a=r;i<=a?s<=a:s>=a;e=i<=a?++s:--s)push_integer(e),p5=pop(),set_binding(n,p5),push(cadr(p1)),Eval(),pop();return set_binding(n,p4),push_symbol(NIL)},Eval_gamma=function(){return push(cadr(p1)),Eval(),gamma()},gamma=function(){return save(),gammaf(),restore()},gammaf=function(){if(p1=pop(),isrational(p1)&&MEQUAL(p1.q.a,1)&&MEQUAL(p1.q.b,2)){evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),push_rational(1,2),power();return}if(isrational(p1)&&MEQUAL(p1.q.a,3)&&MEQUAL(p1.q.b,2)){evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),push_rational(1,2),power(),push_rational(1,2),multiply();return}if(isnegativeterm(p1)){evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),push_integer(-1),multiply(),evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),push(p1),multiply(),sine(),push(p1),multiply(),push(p1),negate(),gamma(),multiply(),divide();return}if(car(p1)===symbol(ADD)){gamma_of_sum();return}push_symbol(GAMMA),push(p1),list(2)},gamma_of_sum=function(){if(p3=cdr(p1),isrational(car(p3))&&MEQUAL(car(p3).q.a,1)&&MEQUAL(car(p3).q.b,1))return push(cadr(p3)),push(cadr(p3)),gamma(),multiply();if(isrational(car(p3))&&MEQUAL(car(p3).q.a,-1)&&MEQUAL(car(p3).q.b,1))return push(cadr(p3)),gamma(),push(cadr(p3)),push_integer(-1),add(),divide();push_symbol(GAMMA),push(p1),list(2)},Eval_gcd=function(){var e;for(p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),e=[];iscons(p1);)push(car(p1)),Eval(),gcd(),e.push(p1=cdr(p1));return e},gcd=function(){var e;return e=expanding,save(),gcd_main(),restore(),expanding=e},gcd_main=function(){var e;if(expanding=1,p2=pop(),p1=pop(),DEBUG&&console.log("gcd_main: p1: "+p1+" p2: "+p2),equal(p1,p2)){push(p1);return}if(isrational(p1)&&isrational(p2)){push(p1),push(p2),gcd_numbers();return}if(e=areunivarpolysfactoredorexpandedform(p1,p2)){gcd_polys(e);return}if(car(p1)===symbol(ADD)&&car(p2)===symbol(ADD)){gcd_sum_sum();return}if(car(p1)===symbol(ADD)&&(gcd_sum(p1),p1=pop()),car(p2)===symbol(ADD)&&(gcd_sum(p2),p2=pop()),car(p1)===symbol(MULTIPLY)){gcd_sum_product();return}if(car(p2)===symbol(MULTIPLY)){gcd_product_sum();return}if(car(p1)===symbol(MULTIPLY)&&car(p2)===symbol(MULTIPLY)){gcd_product_product();return}return gcd_powers_with_same_base()},areunivarpolysfactoredorexpandedform=function(e,t){var r;return DEBUG&&console.log("areunivarpolysfactoredorexpandedform: p1: "+e+" p2: "+t),(r=isunivarpolyfactoredorexpandedform(e))&&isunivarpolyfactoredorexpandedform(t,r)?r:!1},gcd_polys=function(e){if(DEBUG&&console.log("gcd_polys: p1: "+p1+" polyVar: "+e),push(p1),push(e),factorpoly(),p1=pop(),push(p2),push(e),factorpoly(),p2=pop(),DEBUG&&console.log("GCD: factored polys:"),DEBUG&&console.log("  p1:"+p1.toString()),DEBUG&&console.log("  p2:"+p2.toString()),(car(p1)===symbol(MULTIPLY)||car(p2)===symbol(MULTIPLY))&&(car(p1)!==symbol(MULTIPLY)&&(push_symbol(MULTIPLY),push(p1),push(one),list(3),p1=pop()),car(p2)!==symbol(MULTIPLY)&&(push_symbol(MULTIPLY),push(p2),push(one),list(3),p2=pop())),car(p1)===symbol(MULTIPLY)&&car(p2)===symbol(MULTIPLY)){gcd_product_product();return}return gcd_powers_with_same_base(),!0},gcd_product_product=function(){var e;for(push(one),p3=cdr(p1),e=[];iscons(p3);){for(p4=cdr(p2);iscons(p4);)push(car(p3)),push(car(p4)),gcd(),multiply(),p4=cdr(p4);e.push(p3=cdr(p3))}return e},gcd_powers_with_same_base=function(){if(car(p1)===symbol(POWER)?(p3=caddr(p1),p1=cadr(p1)):p3=one,car(p2)===symbol(POWER)?(p4=caddr(p2),p2=cadr(p2)):p4=one,!equal(p1,p2)){push(one);return}if(isNumericAtom(p3)&&isNumericAtom(p4)){push(p1),lessp(p3,p4)?push(p3):push(p4),power();return}if(push(p3),push(p4),divide(),p5=pop(),isNumericAtom(p5)){push(p1),car(p3)===symbol(MULTIPLY)&&isNumericAtom(cadr(p3))?p5=cadr(p3):p5=one,car(p4)===symbol(MULTIPLY)&&isNumericAtom(cadr(p4))?p6=cadr(p4):p6=one,lessp(p5,p6)?push(p3):push(p4),power();return}if(push(p3),push(p4),subtract(),p5=pop(),!isNumericAtom(p5)){push(one);return}return push(p1),isnegativenumber(p5)?push(p3):push(p4),power()},gcd_sum_sum=function(){if(length(p1)!==length(p2)){push(one);return}for(p3=cdr(p1),push(car(p3)),p3=cdr(p3);iscons(p3);)push(car(p3)),gcd(),p3=cdr(p3);for(p3=pop(),p4=cdr(p2),push(car(p4)),p4=cdr(p4);iscons(p4);)push(car(p4)),gcd(),p4=cdr(p4);return p4=pop(),push(p1),push(p3),divide(),p5=pop(),push(p2),push(p4),divide(),p6=pop(),equal(p5,p6)?(push(p5),push(p3),push(p4),gcd(),multiply()):push(one)},gcd_sum=function(e){var t;for(e=cdr(e),push(car(e)),e=cdr(e),t=[];iscons(e);)push(car(e)),gcd(),t.push(e=cdr(e));return t},gcd_sum_product=function(){var e;for(push(one),p3=cdr(p1),e=[];iscons(p3);)push(car(p3)),push(p2),gcd(),multiply(),e.push(p3=cdr(p3));return e},gcd_product_sum=function(){var e;for(push(one),p4=cdr(p2),e=[];iscons(p4);)push(p1),push(car(p4)),gcd(),multiply(),e.push(p4=cdr(p4));return e},guess=function(){var e;return e=pop(),push(e),Find(e,symbol(SYMBOL_X))?push_symbol(SYMBOL_X):Find(e,symbol(SYMBOL_Y))?push_symbol(SYMBOL_Y):Find(e,symbol(SYMBOL_Z))?push_symbol(SYMBOL_Z):Find(e,symbol(SYMBOL_T))?push_symbol(SYMBOL_T):Find(e,symbol(SYMBOL_S))?push_symbol(SYMBOL_S):push_symbol(SYMBOL_X)},hermite=function(){return save(),yyhermite(),restore()},yyhermite=function(){var e;if(e=0,p2=pop(),p1=pop(),push(p2),e=pop_integer(),e<0||isNaN(e)){push_symbol(HERMITE),push(p1),push(p2),list(3);return}return issymbol(p1)?yyhermite2(e):(p3=p1,p1=symbol(SECRETX),yyhermite2(e),p1=p3,push(symbol(SECRETX)),push(p1),subst(),Eval())},yyhermite2=function(e){var t,r,n,s;for(t=0,push_integer(1),push_integer(0),p4=pop(),s=[],t=r=0,n=e;0<=n?r<n:r>n;t=0<=n?++r:--r)p5=p4,p4=pop(),push(p1),push(p4),multiply(),push_integer(t),push(p5),multiply(),subtract(),push_integer(2),s.push(multiply());return s},hilbert=function(){var e,t,r,n,s,i,a;if(e=0,r=0,n=0,save(),p2=pop(),push(p2),n=pop_integer(),n<2){push_symbol(HILBERT),push(p2),list(2),restore();return}for(push_zero_matrix(n,n),p1=pop(),e=s=0,i=n;0<=i?s<i:s>i;e=0<=i?++s:--s)for(r=t=0,a=n;0<=a?t<a:t>a;r=0<=a?++t:--t)push_integer(e+r+1),inverse(),p1.tensor.elem[e*n+r]=pop();return push(p1),restore()},DEBUG_IMAG=!1,Eval_imag=function(){return push(cadr(p1)),Eval(),imag()},imag=function(){return save(),rect(),p1=pop(),DEBUG_IMAG&&console.log("IMAGE of "+p1),push(p1),push(p1),conjugate(),DEBUG_IMAG&&console.log(" image: conjugate result: "+stack[tos-1]),subtract(),push_integer(2),divide(),DEBUG_IMAG&&console.log(" image: 1st divide result: "+stack[tos-1]),push(imaginaryunit),divide(),DEBUG_IMAG&&console.log(" image: 2nd divide result: "+stack[tos-1]),restore()},index_function=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B;for(t=0,s=0,a=0,u=0,c=0,B=0,save(),C=tos-e,p1=stack[C],u=p1.tensor.ndim,a=e-1,a>u&&stop("too many indices for tensor"),s=0,t=f=0,d=a;0<=d?f<d:f>d;t=0<=d?++f:--f)push(stack[C+t+1]),B=pop_integer(),(B<1||B>p1.tensor.dim[t])&&stop("index out of range"),s=s*p1.tensor.dim[t]+B-1;if(u===a){moveTos(tos-e),push(p1.tensor.elem[s]),restore();return}for(t=r=m=a,g=u;m<=g?r<g:r>g;t=m<=g?++r:--r)s=s*p1.tensor.dim[t]+0;for(c=1,t=n=S=a,y=u;S<=y?n<y:n>y;t=S<=y?++n:--n)c*=p1.tensor.dim[t];for(p2=alloc_tensor(c),p2.tensor.ndim=u-a,t=i=R=a,w=u;R<=w?i<w:i>w;t=R<=w?++i:--i)p2.tensor.dim[t-a]=p1.tensor.dim[t];for(t=l=0,P=c;0<=P?l<P:l>P;t=0<=P?++l:--l)p2.tensor.elem[t]=p1.tensor.elem[s+t];return check_tensor_dimensions(p1),check_tensor_dimensions(p2),moveTos(tos-e),push(p2),restore()},set_component=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C;for(t=0,s=0,a=0,c=0,C=0,save(),e<3&&stop("error in indexed assign"),P=tos-e,p2=stack[P],p1=stack[P+1],istensor(p1)||stop("error in indexed assign: assigning to something that is not a tensor"),c=p1.tensor.ndim,a=e-2,a>c&&stop("error in indexed assign"),s=0,t=f=0,d=a;0<=d?f<d:f>d;t=0<=d?++f:--f)push(stack[P+t+2]),C=pop_integer(),(C<1||C>p1.tensor.dim[t])&&stop(`error in indexed assign
`),s=s*p1.tensor.dim[t]+C-1;for(t=r=m=a,g=c;m<=g?r<g:r>g;t=m<=g?++r:--r)s=s*p1.tensor.dim[t]+0;for(p3=alloc_tensor(p1.tensor.nelem),p3.tensor.ndim=p1.tensor.ndim,t=n=0,S=p1.tensor.ndim;0<=S?n<S:n>S;t=0<=S?++n:--n)p3.tensor.dim[t]=p1.tensor.dim[t];for(t=i=0,y=p1.tensor.nelem;0<=y?i<y:i>y;t=0<=y?++i:--i)p3.tensor.elem[t]=p1.tensor.elem[t];if(check_tensor_dimensions(p1),check_tensor_dimensions(p3),p1=p3,c===a){istensor(p2)&&stop("error in indexed assign"),p1.tensor.elem[s]=p2,check_tensor_dimensions(p1),moveTos(tos-e),push(p1),restore();return}for(istensor(p2)||stop("error in indexed assign"),c-a!==p2.tensor.ndim&&stop("error in indexed assign"),t=l=0,R=p2.tensor.ndim;0<=R?l<R:l>R;t=0<=R?++l:--l)p1.tensor.dim[a+t]!==p2.tensor.dim[t]&&stop("error in indexed assign");for(t=u=0,w=p2.tensor.nelem;0<=w?u<w:u>w;t=0<=w?++u:--u)p1.tensor.elem[s+t]=p2.tensor.elem[t];return check_tensor_dimensions(p1),check_tensor_dimensions(p2),moveTos(tos-e),push(p1),restore()},Eval_inner=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R;for(R=[],R.push(car(cdr(p1))),S=car(cdr(cdr(p1))),S===symbol(NIL)&&stop("pattern needs at least a template and a transformed version"),i=cdr(cdr(p1));i!==symbol(NIL);)R.push(car(i)),i=cdr(i);if(R.length>2){for(push_symbol(INNER),push(R[R.length-2]),push(R[R.length-1]),list(3),t=a=2,u=R.length;2<=u?a<u:a>u;t=2<=u?++a:--a)push_symbol(INNER),swap(),push(R[R.length-t-1]),swap(),list(3);p1=pop(),Eval_inner();return}for(l=[],get_innerprod_factors(p1,l),m=[],t=r=0,c=l.length;0<=c?r<c:r>c;t=0<=c?++r:--r)l[t]!==symbol(SYMBOL_IDENTITY_MATRIX)&&m.push(l[t]);if(l=m,m=[],l.length>1){for(y=0,t=n=0,f=l.length;(0<=f?n<f:n>f)&&t+y+1<=l.length-1;t=0<=f?++n:--n){isNumericAtomOrTensor(l[t+y])||isNumericAtomOrTensor(l[t+y+1])?m.push(l[t+y]):(push(l[t+y]),Eval(),inv(),push(l[t+y+1]),Eval(),subtract(),e=pop(),isZeroAtomOrTensor(e)?y+=1:m.push(l[t+y]));if(t+y===l.length-2&&m.push(l[l.length-1]),t+y>=l.length-1)break}l=m}if(push(symbol(INNER)),l.length>0)for(t=s=0,d=l.length;0<=d?s<d:s>d;t=0<=d?++s:--s)push(l[t]);else{pop(),push(symbol(SYMBOL_IDENTITY_MATRIX));return}for(list(l.length+1),p1=pop(),p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),g=[];iscons(p1);)push(car(p1)),Eval(),inner(),g.push(p1=cdr(p1));return g},inner=function(){var e,t,r,n;if(save(),p2=pop(),p1=pop(),isnegativeterm(p2)&&isnegativeterm(p1)&&(push(p2),negate(),p2=pop(),push(p1),negate(),p1=pop()),isinnerordot(p1)&&(e=car(cdr(p1)),t=car(cdr(cdr(p1))),r=p2,p1=e,push(t),push(r),inner(),p2=pop()),p1===symbol(SYMBOL_IDENTITY_MATRIX)){push(p2),restore();return}else if(p2===symbol(SYMBOL_IDENTITY_MATRIX)){push(p1),restore();return}if(istensor(p1)&&istensor(p2))inner_f();else{if(!(isNumericAtomOrTensor(p1)||isNumericAtomOrTensor(p2))&&(push(p1),push(p2),inv(),subtract(),n=pop(),isZeroAtomOrTensor(n))){push_symbol(SYMBOL_IDENTITY_MATRIX),restore();return}if(expanding&&isadd(p1)){for(p1=cdr(p1),push(zero);iscons(p1);)push(car(p1)),push(p2),inner(),add(),p1=cdr(p1);restore();return}if(expanding&&isadd(p2)){for(p2=cdr(p2),push(zero);iscons(p2);)push(p1),push(car(p2)),inner(),add(),p2=cdr(p2);restore();return}if(push(p1),push(p2),istensor(p1)&&isNumericAtom(p2))tensor_times_scalar();else if(isNumericAtom(p1)&&istensor(p2))scalar_times_tensor();else if(isNumericAtom(p1)||isNumericAtom(p2))multiply();else{pop(),pop(),push_symbol(INNER),push(p1),push(p2),list(3),restore();return}}return restore()},inner_f=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K;if(i=0,m=p1.tensor.dim[p1.tensor.ndim-1],m!==p2.tensor.dim[0]){debugger;stop("inner: tensor dimension check")}for(S=p1.tensor.ndim+p2.tensor.ndim-2,S>MAXDIM&&stop("inner: rank of result exceeds maximum"),e=p1.tensor.elem,r=p2.tensor.elem,t=1,i=y=0,w=p1.tensor.ndim-1;0<=w?y<w:y>w;i=0<=w?++y:--y)t*=p1.tensor.dim[i];for(n=1,i=a=1,P=p2.tensor.ndim;1<=P?a<P:a>P;i=1<=P?++a:--a)n*=p2.tensor.dim[i];for(p3=alloc_tensor(t*n),s=p3.tensor.elem,i=u=0,C=t;0<=C?u<C:u>C;i=0<=C?++u:--u)for(l=f=0,B=m;0<=B?f<B:f>B;l=0<=B?++f:--f)if(!isZeroAtomOrTensor(e[i*m+l]))for(c=d=0,H=n;0<=H?d<H:d>H;c=0<=H?++d:--d)push(e[i*m+l]),push(r[l*n+c]),multiply(),push(s[i*n+c]),add(),s[i*n+c]=pop();if(S===0)return push(p3.tensor.elem[0]);for(p3.tensor.ndim=S,l=0,i=g=0,te=p1.tensor.ndim-1;0<=te?g<te:g>te;i=0<=te?++g:--g)p3.tensor.dim[i]=p1.tensor.dim[i];for(l=p1.tensor.ndim-1,i=R=0,K=p2.tensor.ndim-1;0<=K?R<K:R>K;i=0<=K?++R:--R)p3.tensor.dim[l+i]=p2.tensor.dim[i+1];return push(p3)},get_innerprod_factors=function(e,t){if(!iscons(e)){add_factor_to_accumulator(e,t);return}if(cdr(e)===symbol(NIL)){e=get_innerprod_factors(car(e),t);return}if(isinnerordot(e)){get_innerprod_factors(car(cdr(e)),t),get_innerprod_factors(cdr(cdr(e)),t);return}return add_factor_to_accumulator(e,t)},add_factor_to_accumulator=function(e,t){if(e!==symbol(NIL))return t.push(e)},itab=["f(a,a*x)","f(1/x,log(x))","f(x^a,x^(a+1)/(a+1))","f(x^(-2),-x^(-1))","f(x^(-1/2),2*x^(1/2))","f(x^(1/2),2/3*x^(3/2))","f(x,x^2/2)","f(x^2,x^3/3)","f(exp(a*x),1/a*exp(a*x))","f(exp(a*x+b),1/a*exp(a*x+b))","f(x*exp(a*x^2),exp(a*x^2)/(2*a))","f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))","f(log(a*x),x*log(a*x)-x)","f(a^x,a^x/log(a),or(not(number(a)),a>0))","f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/(a+b*x),1/b*log(a+b*x))","f(1/(a+b*x)^2,-1/(b*(a+b*x)))","f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)","f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)","f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))","f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))","f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))","f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))","f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))","f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))","f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))","f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))","f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))","f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))","f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))","f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))","f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))","f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))","f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))","f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))","f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))","f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))","f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))","f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))","f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)","f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)","f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))","f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)","f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)","f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)","f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))","f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))","f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))","f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))","f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))","f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))","f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))","f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))","f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))","f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))","f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))","f(x/sqrt(a-x^2),-sqrt(a-x^2))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))","f(sin(a*x),-cos(a*x)/a)","f(cos(a*x),sin(a*x)/a)","f(tan(a*x),-log(cos(a*x))/a)","f(1/tan(a*x),log(sin(a*x))/a)","f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)","f(1/sin(a*x),log(tan(a*x/2))/a)","f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))","f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))","f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))","f(1/sin(a*x)^2,-1/(a*tan(a*x)))","f(1/cos(a*x)^2,tan(a*x)/a)","f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))","f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)","f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))","f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)","f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))","f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)","f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)","f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)","f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))","f(sin(a+b*x),-cos(a+b*x)/b)","f(cos(a+b*x),sin(a+b*x)/b)","f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)","f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)","f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)","f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)","f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)","f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)","f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)","f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)","f(x*log(a*x),x^2*log(a*x)/2-x^2/4)","f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)","f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)","f(1/x*1/(a+log(x)),log(a+log(x)))","f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)","f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)","f(sinh(x),cosh(x))","f(cosh(x),sinh(x))","f(tanh(x),log(cosh(x)))","f(x*sinh(x),x*cosh(x)-sinh(x))","f(x*cosh(x),x*sinh(x)-cosh(x))","f(sinh(x)^2,sinh(2*x)/4-x/2)","f(tanh(x)^2,x-tanh(x))","f(cosh(x)^2,sinh(2*x)/4+x/2)","f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)","f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)","f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)","f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))","f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)","f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)","f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))","f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))","f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))","f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))","f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))",0],Eval_integral=function(){var e,t,r,n,s;for(t=0,p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),push(car(p1)),Eval(),p2=pop(),p2===symbol(NIL)?(guess(),push(symbol(NIL))):isNumericAtom(p2)?(guess(),push(p2)):(push(p2),p1=cdr(p1),push(car(p1)),Eval()),p5=pop(),p4=pop(),p3=pop();;){if(isNumericAtom(p5)?(push(p5),t=pop_integer(),isNaN(t)&&stop("nth integral: check n")):t=1,push(p3),t>=0)for(r=0,n=t;0<=n?r<n:r>n;0<=n?++r:--r)push(p4),integral();else for(t=-t,e=0,s=t;0<=s?e<s:e>s;0<=s?++e:--e)push(p4),derivative();if(p3=pop(),p5===symbol(NIL))break;if(isNumericAtom(p5)){if(p1=cdr(p1),push(car(p1)),Eval(),p5=pop(),p5===symbol(NIL))break;isNumericAtom(p5)||(p4=p5,p1=cdr(p1),push(car(p1)),Eval(),p5=pop())}else p4=p5,p1=cdr(p1),push(car(p1)),Eval(),p5=pop()}return push(p3)},integral=function(){return save(),p2=pop(),p1=pop(),car(p1)===symbol(ADD)?integral_of_sum():car(p1)===symbol(MULTIPLY)?integral_of_product():integral_of_form(),p1=pop(),Find(p1,symbol(INTEGRAL))&&stop("integral: sorry, could not find a solution"),push(p1),simplify(),Eval(),restore()},integral_of_sum=function(){var e;for(p1=cdr(p1),push(car(p1)),push(p2),integral(),p1=cdr(p1),e=[];iscons(p1);)push(car(p1)),push(p2),integral(),add(),e.push(p1=cdr(p1));return e},integral_of_product=function(){return push(p1),push(p2),partition(),p1=pop(),integral_of_form(),multiply()},integral_of_form=function(){var e,t;if(e=italu_hashcode(p1,p2).toFixed(6),t=hashed_itab[e],!t){push_symbol(INTEGRAL),push(p1),push(p2),list(3);return}return push(p1),push(p2),transform(t,!1),p3=pop(),p3===symbol(NIL)?(push_symbol(INTEGRAL),push(p1),push(p2),list(3)):push(p3)},hashcode_values={x:.95532,constexp:1.43762,constant:1.1441659362941434,constbase:1.2036412230421882,sin:1.7330548251830322,arcsin:1.6483368529465805,cos:1.0586721236863401,arccos:1.8405225918106694,tan:1.1224943776292506,arctan:1.1297397925394963,sinh:1.8176164926060079,cosh:1.9404934661708022,tanh:1.6421307715103122,log:1.477443701354924,erf:1.0825269225702916},italu_hashcode=function(e,t){var r;if(issymbol(e))return equal(e,t)?hashcode_values.x:hashcode_values.constant;if(iscons(e))switch(symnum(car(e))){case ADD:return hash_addition(cdr(e),t);case MULTIPLY:return hash_multiplication(cdr(e),t);case POWER:return hash_power(cadr(e),caddr(e),t);case EXP:return hash_power(symbol(E),cadr(e),t);case SQRT:return push_double(.5),r=pop(),hash_power(cadr(e),r,t);default:return hash_function(e,t)}return hashcode_values.constant},hash_function=function(e,t){var r,n,s;if(!Find(cadr(e),t))return hashcode_values.constant;if(s=car(e),r=italu_hashcode(cadr(e),t),n=hashcode_values[s.printname],!n)throw new Error("Unsupported function "+s.printname);return Math.pow(n,r)},hash_addition=function(e,t){var r,n,s,i,a;for(a={};iscons(e);)s=car(e),e=cdr(e),i=0,Find(s,t)?i=italu_hashcode(s,t):i=hashcode_values.constant,a[i.toFixed(6)]=!0;n=0;for(r in a)hasProp.call(a,r)&&(a[r],n=n+parseFloat(r,10));return n},hash_multiplication=function(e,t){var r,n;for(r=1;iscons(e);)n=car(e),e=cdr(e),Find(n,t)&&(r=r*italu_hashcode(n,t));return r},hash_power=function(e,t,r){var n,s;if(n=hashcode_values.constant,s=hashcode_values.constexp,Find(e,r)&&(n=italu_hashcode(e,r)),Find(t,r))s=italu_hashcode(t,r);else{if(n===hashcode_values.constant)return hashcode_values.constant;isminusone(t)?s=-1:isoneovertwo(t)?s=.5:isminusoneovertwo(t)?s=-.5:equalq(t,2,1)?s=2:equalq(t,-2,1)&&(s=-2)}return Math.pow(n,s)},make_hashed_itab=function(){var e,t,r,n,s,i,a,l;for(a={},s=0,n=itab.length;s<n&&(i=itab[s],!!i);s++)scan_meta(i),e=pop(),l=cadr(e),t=italu_hashcode(l,symbol(METAX)),r=t.toFixed(6),a[r]||(a[r]=[]),a[r].push(i);return console.log("hashed_itab = "+JSON.stringify(a,null,2)),a},$.make_hashed_itab=make_hashed_itab,hashed_itab={"1.144166":["f(a,a*x)"],"1.046770":["f(1/x,log(x))"],"0.936400":["f(x^a,x^(a+1)/(a+1))"],"1.095727":["f(x^(-2),-x^(-1))"],"1.023118":["f(x^(-1/2),2*x^(1/2))"],"0.977405":["f(x^(1/2),2/3*x^(3/2))"],"0.955320":["f(x,x^2/2)"],"0.912636":["f(x^2,x^3/3)"],"1.137302":["f(exp(a*x),1/a*exp(a*x))","f(a^x,a^x/log(a),or(not(number(a)),a>0))"],"1.326774":["f(exp(a*x+b),1/a*exp(a*x+b))"],"1.080259":["f(x*exp(a*x^2),exp(a*x^2)/(2*a))"],"1.260228":["f(x*exp(a*x^2+b),exp(a*x^2+b)/(2*a))"],"1.451902":["f(log(a*x),x*log(a*x)-x)"],"0.486192":["f(1/(a+x^2),1/sqrt(a)*arctan(x/sqrt(a)),or(not(number(a)),a>0))","f(1/(a-x^2),1/sqrt(a)*arctanh(x/sqrt(a)))","f(1/(a+b*x^2),1/sqrt(a*b)*arctan(x*sqrt(a*b)/a),or(not(number(a*b)),a*b>0))","f(1/(a+b*x^2),1/(2*sqrt(-a*b))*log((a+x*sqrt(-a*b))/(a-x*sqrt(-a*b))),or(not(number(a*b)),a*b<0))"],"0.697274":["f(1/sqrt(a-x^2),arcsin(x/(sqrt(a))))","f(1/sqrt(a+x^2),log(x+sqrt(a+x^2)))","f(1/sqrt(x^2+a),log(x+sqrt(x^2+a)))"],"0.476307":["f(1/(a+b*x),1/b*log(a+b*x))"],"0.226868":["f(1/(a+b*x)^2,-1/(b*(a+b*x)))"],"2.904531":["f(1/(a+b*x)^3,-1/(2*b)*1/(a+b*x)^2)"],"0.455026":["f(x/(a+b*x),x/b-a*log(a+b*x)/b/b)"],"0.216732":["f(x/(a+b*x)^2,1/b^2*(log(a+b*x)+a/(a+b*x)))"],"0.434695":["f(x^2/(a+b*x),1/b^2*(1/2*(a+b*x)^2-2*a*(a+b*x)+a^2*log(a+b*x)))"],"0.207048":["f(x^2/(a+b*x)^2,1/b^3*(a+b*x-2*a*log(a+b*x)-a^2/(a+b*x)))"],"2.650781":["f(x^2/(a+b*x)^3,1/b^3*(log(a+b*x)+2*a/(a+b*x)-1/2*a^2/(a+b*x)^2))"],"0.498584":["f(1/x*1/(a+b*x),-1/a*log((a+b*x)/x))"],"0.237479":["f(1/x*1/(a+b*x)^2,1/a*1/(a+b*x)-1/a^2*log((a+b*x)/x))"],"3.040375":["f(1/x*1/(a+b*x)^3,1/a^3*(1/2*((2*a+b*x)/(a+b*x))^2+log(x/(a+b*x))))"],"0.521902":["f(1/x^2*1/(a+b*x),-1/(a*x)+b/a^2*log((a+b*x)/x))"],"0.446014":["f(1/x^3*1/(a+b*x),(2*b*x-a)/(2*a^2*x^2)+b^2/a^3*log(x/(a+b*x)))"],"0.248586":["f(1/x^2*1/(a+b*x)^2,-(a+2*b*x)/(a^2*x*(a+b*x))+2*b/a^3*log((a+b*x)/x))"],"0.464469":["f(x/(a+b*x^2),1/2*1/b*log(a+b*x^2))"],"0.443716":["f(x^2/(a+b*x^2),x/b-a/b*integral(1/(a+b*x^2),x))"],"0.236382":["f(1/(a+b*x^2)^2,x/(2*a*(a+b*x^2))+1/2*1/a*integral(1/(a+b*x^2),x))"],"0.508931":["f(1/x*1/(a+b*x^2),1/2*1/a*log(x^2/(a+b*x^2)))"],"0.532733":["f(1/x^2*1/(a+b*x^2),-1/(a*x)-b/a*integral(1/(a+b*x^2),x))"],"0.480638":["f(1/(a+b*x^3),1/3*1/a*(a/b)^(1/3)*(1/2*log(((a/b)^(1/3)+x)^3/(a+b*x^3))+sqrt(3)*arctan((2*x-(a/b)^(1/3))*(a/b)^(-1/3)/sqrt(3))))"],"0.438648":["f(x^2/(a+b*x^3),1/3*1/b*log(a+b*x^3))"],"0.459164":["f(x/(a+b*x^4),1/2*sqrt(b/a)/b*arctan(x^2*sqrt(b/a)),or(not(number(a*b)),a*b>0))","f(x/(a+b*x^4),1/4*sqrt(-b/a)/b*log((x^2-sqrt(-a/b))/(x^2+sqrt(-a/b))),or(not(number(a*b)),a*b<0))"],"0.450070":["f(x^3/(a+b*x^4),1/4*1/b*log(a+b*x^4))"],"1.448960":["f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))"],"1.384221":["f(x*sqrt(a+b*x),-2*(2*a-3*b*x)*sqrt((a+b*x)^3)/15/b^2)"],"1.322374":["f(x^2*sqrt(a+b*x),2*(8*a^2-12*a*b*x+15*b^2*x^2)*sqrt((a+b*x)^3)/105/b^3)"],"1.516728":["f(sqrt(a+b*x)/x,2*sqrt(a+b*x)+a*integral(1/x*1/sqrt(a+b*x),x))"],"1.587665":["f(sqrt(a+b*x)/x^2,-sqrt(a+b*x)/x+b/2*integral(1/x*1/sqrt(a+b*x),x))"],"0.690150":["f(1/sqrt(a+b*x),2*sqrt(a+b*x)/b)"],"0.659314":["f(x/sqrt(a+b*x),-2/3*(2*a-b*x)*sqrt(a+b*x)/b^2)"],"0.629856":["f(x^2/sqrt(a+b*x),2/15*(8*a^2-4*a*b*x+3*b^2*x^2)*sqrt(a+b*x)/b^3)"],"0.722428":["f(1/x*1/sqrt(a+b*x),1/sqrt(a)*log((sqrt(a+b*x)-sqrt(a))/(sqrt(a+b*x)+sqrt(a))),or(not(number(a)),a>0))","f(1/x*1/sqrt(a+b*x),2/sqrt(-a)*arctan(sqrt(-(a+b*x)/a)),or(not(number(a)),a<0))"],"0.756216":["f(1/x^2*1/sqrt(a+b*x),-sqrt(a+b*x)/a/x-1/2*b/a*integral(1/x*1/sqrt(a+b*x),x))"],"1.434156":["f(sqrt(x^2+a),1/2*(x*sqrt(x^2+a)+a*log(x+sqrt(x^2+a))))","f(sqrt(a-x^2),1/2*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(abs(a)))))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*log(x*sqrt(a)+sqrt(a*x^2+b))/2/sqrt(a),and(number(a),a>0))","f(sqrt(a*x^2+b),x*sqrt(a*x^2+b)/2+b*arcsin(x*sqrt(-a/b))/2/sqrt(-a),and(number(a),a<0))"],"0.729886":["f(1/x*1/sqrt(x^2+a),arcsec(x/sqrt(-a))/sqrt(-a),or(not(number(a)),a<0))","f(1/x*1/sqrt(x^2+a),-1/sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(1/x*1/sqrt(a-x^2),-1/sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"1.501230":["f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(a)*log((sqrt(a)+sqrt(x^2+a))/x),or(not(number(a)),a>0))","f(sqrt(x^2+a)/x,sqrt(x^2+a)-sqrt(-a)*arcsec(x/sqrt(-a)),or(not(number(a)),a<0))","f(sqrt(a-x^2)/x,sqrt(a-x^2)-sqrt(a)*log((sqrt(a)+sqrt(a-x^2))/x),or(not(number(a)),a>0))"],"0.666120":["f(x/sqrt(x^2+a),sqrt(x^2+a))","f(x/sqrt(a-x^2),-sqrt(a-x^2))"],"1.370077":["f(x*sqrt(x^2+a),1/3*sqrt((x^2+a)^3))","f(x*sqrt(a-x^2),-1/3*sqrt((a-x^2)^3))"],"1.730087":["f(sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2+a^(1/3))^3)+3/2*a^(1/3)*x*sqrt(x^2+a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2+a^(1/3)))))","f(sqrt(-a+x^6-3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/4*(x*sqrt((x^2-a^(1/3))^3)-3/2*a^(1/3)*x*sqrt(x^2-a^(1/3))+3/2*a^(2/3)*log(x+sqrt(x^2-a^(1/3)))))"],"0.578006":["f(1/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),x/a^(1/3)/sqrt(x^2+a^(1/3)))"],"0.552180":["f(x/sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),-1/sqrt(x^2+a^(1/3)))"],"1.652787":["f(x*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/5*sqrt((x^2+a^(1/3))^5))"],"1.308862":["f(x^2*sqrt(x^2+a),1/4*x*sqrt((x^2+a)^3)-1/8*a*x*sqrt(x^2+a)-1/8*a^2*log(x+sqrt(x^2+a)))","f(x^2*sqrt(a-x^2),-x/4*sqrt((a-x^2)^3)+1/8*a*(x*sqrt(a-x^2)+a*arcsin(x/sqrt(a))),or(not(number(a)),a>0))"],"1.342944":["f(x^3*sqrt(x^2+a),(1/5*x^2-2/15*a)*sqrt((x^2+a)^3),and(number(a),a>0))","f(x^3*sqrt(x^2+a),sqrt((x^2+a)^5)/5-a*sqrt((x^2+a)^3)/3,and(number(a),a<0))","f(x^3*sqrt(a-x^2),(-1/5*x^2-2/15*a)*sqrt((a-x^2)^3),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^3,-1/2*sqrt(a-x^2)/x^2+1/2*log((sqrt(a)+sqrt(a-x^2))/x)/sqrt(a),or(not(number(a)),a>0))","f(sqrt(a-x^2)/x^4,-1/3*sqrt((a-x^2)^3)/a/x^3,or(not(number(a)),a>0))"],"0.636358":["f(x^2/sqrt(x^2+a),1/2*x*sqrt(x^2+a)-1/2*a*log(x+sqrt(x^2+a)))","f(x^2/sqrt(a-x^2),-x/2*sqrt(a-x^2)+a/2*arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"0.652928":["f(x^3/sqrt(x^2+a),1/3*sqrt((x^2+a)^3)-a*sqrt(x^2+a))","f(1/x^3*1/sqrt(x^2+a),-1/2*sqrt(x^2+a)/a/x^2+1/2*log((sqrt(a)+sqrt(x^2+a))/x)/a^(3/2),or(not(number(a)),a>0))","f(1/x^3*1/sqrt(x^2-a),1/2*sqrt(x^2-a)/a/x^2+1/2*1/(a^(3/2))*arcsec(x/(a^(1/2))),or(not(number(a)),a>0))"],"0.764022":["f(1/x^2*1/sqrt(x^2+a),-sqrt(x^2+a)/a/x)","f(1/x^2*1/sqrt(a-x^2),-sqrt(a-x^2)/a/x,or(not(number(a)),a>0))"],"1.578940":["f(x^2*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/6*x*sqrt((x^2+a^(1/3))^5)-1/24*a^(1/3)*x*sqrt((x^2+a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2+a^(1/3))-1/16*a*log(x+sqrt(x^2+a^(1/3))),or(not(number(a)),a>0))","f(x^2*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/6*x*sqrt((x^2-a^(1/3))^5)+1/24*a^(1/3)*x*sqrt((x^2-a^(1/3))^3)-1/16*a^(2/3)*x*sqrt(x^2-a^(1/3))+1/16*a*log(x+sqrt(x^2-a^(1/3))),or(not(number(a)),a>0))"],"1.620055":["f(x^3*sqrt(a+x^6+3*a^(1/3)*x^4+3*a^(2/3)*x^2),1/7*sqrt((x^2+a^(1/3))^7)-1/5*a^(1/3)*sqrt((x^2+a^(1/3))^5),or(not(number(a)),a>0))","f(x^3*sqrt(-a-3*a^(1/3)*x^4+3*a^(2/3)*x^2+x^6),1/7*sqrt((x^2-a^(1/3))^7)+1/5*a^(1/3)*sqrt((x^2-a^(1/3))^5),or(not(number(a)),a>0))"],"0.332117":["f(1/(x-a)/sqrt(x^2-a^2),-sqrt(x^2-a^2)/a/(x-a))","f(1/(x+a)/sqrt(x^2-a^2),sqrt(x^2-a^2)/a/(x+a))"],"1.571443":["f(sqrt(a-x^2)/x^2,-sqrt(a-x^2)/x-arcsin(x/sqrt(a)),or(not(number(a)),a>0))"],"1.690994":["f(sin(a*x),-cos(a*x)/a)"],"1.055979":["f(cos(a*x),sin(a*x)/a)"],"1.116714":["f(tan(a*x),-log(cos(a*x))/a)"],"0.895484":["f(1/tan(a*x),log(sin(a*x))/a)"],"0.946989":["f(1/cos(a*x),log(tan(pi/4+a*x/2))/a)"],"0.591368":["f(1/sin(a*x),log(tan(a*x/2))/a)"],"2.859462":["f(sin(a*x)^2,x/2-sin(2*a*x)/(4*a))"],"2.128050":["f(sin(a*x)^3,-cos(a*x)*(sin(a*x)^2+2)/(3*a))","f(sin(a*x)^4,3/8*x-sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"1.115091":["f(cos(a*x)^2,x/2+sin(2*a*x)/(4*a))"],"1.081452":["f(cos(a*x)^3,sin(a*x)*(cos(a*x)^2+2)/(3*a))","f(cos(a*x)^4,3/8*x+sin(2*a*x)/(4*a)+sin(4*a*x)/(32*a))"],"0.349716":["f(1/sin(a*x)^2,-1/(a*tan(a*x)))"],"0.896788":["f(1/cos(a*x)^2,tan(a*x)/a)"],"1.785654":["f(sin(a*x)*cos(a*x),sin(a*x)^2/(2*a))"],"3.188560":["f(sin(a*x)^2*cos(a*x)^2,-sin(4*a*x)/(32*a)+x/8)"],"1.516463":["f(sin(a*x)/cos(a*x)^2,1/(a*cos(a*x)))"],"2.707879":["f(sin(a*x)^2/cos(a*x),(log(tan(pi/4+a*x/2))-sin(a*x))/a)"],"0.369293":["f(cos(a*x)/sin(a*x)^2,-1/(a*sin(a*x)))"],"0.560019":["f(1/(sin(a*x)*cos(a*x)),log(tan(a*x))/a)"],"0.530332":["f(1/(sin(a*x)*cos(a*x)^2),(1/cos(a*x)+log(tan(a*x/2)))/a)"],"0.331177":["f(1/(sin(a*x)^2*cos(a*x)),(log(tan(pi/4+a*x/2))-1/sin(a*x))/a)"],"0.313621":["f(1/(sin(a*x)^2*cos(a*x)^2),-2/(a*tan(2*a*x)))"],"3.172365":["f(sin(a+b*x),-cos(a+b*x)/b)"],"1.127162":["f(cos(a+b*x),sin(a+b*x)/b)"],"0.352714":["f(1/(b+b*sin(a*x)),-tan(pi/4-a*x/2)/a/b)","f(1/(b-b*sin(a*x)),tan(pi/4+a*x/2)/a/b)","f(1/(a+b*sin(x)),1/sqrt(b^2-a^2)*log((a*tan(x/2)+b-sqrt(b^2-a^2))/(a*tan(x/2)+b+sqrt(b^2-a^2))),b^2-a^2)"],"0.454515":["f(1/(b+b*cos(a*x)),tan(a*x/2)/a/b)","f(1/(b-b*cos(a*x)),-1/tan(a*x/2)/a/b)","f(1/(a+b*cos(x)),1/sqrt(b^2-a^2)*log((sqrt(b^2-a^2)*tan(x/2)+a+b)/(sqrt(b^2-a^2)*tan(x/2)-a-b)),b^2-a^2)"],"1.615441":["f(x*sin(a*x),sin(a*x)/a^2-x*cos(a*x)/a)"],"1.543263":["f(x^2*sin(a*x),2*x*sin(a*x)/a^2-(a^2*x^2-2)*cos(a*x)/a^3)"],"1.008798":["f(x*cos(a*x),cos(a*x)/a^2+x*sin(a*x)/a)"],"0.963724":["f(x^2*cos(a*x),2*x*cos(a*x)/a^2+(a^2*x^2-2)*sin(a*x)/a^3)"],"1.611938":["f(arcsin(a*x),x*arcsin(a*x)+sqrt(1-a^2*x^2)/a)"],"1.791033":["f(arccos(a*x),x*arccos(a*x)-sqrt(1-a^2*x^2)/a)"],"1.123599":["f(arctan(a*x),x*arctan(a*x)-1/2*log(1+a^2*x^2)/a)"],"1.387031":["f(x*log(a*x),x^2*log(a*x)/2-x^2/4)"],"1.325058":["f(x^2*log(a*x),x^3*log(a*x)/3-1/9*x^3)"],"2.108018":["f(log(x)^2,x*log(x)^2-2*x*log(x)+2*x)"],"0.403214":["f(1/x*1/(a+log(x)),log(a+log(x)))"],"2.269268":["f(log(a*x+b),(a*x+b)*log(a*x+b)/a-x)"],"2.486498":["f(log(a*x+b)/x^2,a/b*log(x)-(a*x+b)*log(a*x+b)/b/x)"],"1.769733":["f(sinh(x),cosh(x))"],"1.883858":["f(cosh(x),sinh(x))"],"1.606140":["f(tanh(x),log(cosh(x)))"],"1.690661":["f(x*sinh(x),x*cosh(x)-sinh(x))"],"1.799688":["f(x*cosh(x),x*sinh(x)-cosh(x))"],"3.131954":["f(sinh(x)^2,sinh(2*x)/4-x/2)"],"2.579685":["f(tanh(x)^2,x-tanh(x))"],"3.548923":["f(cosh(x)^2,sinh(2*x)/4+x/2)"],"1.058866":["f(x^3*exp(a*x^2),exp(a*x^2)*(x^2/a-1/(a^2))/2)"],"1.235270":["f(x^3*exp(a*x^2+b),exp(a*x^2)*exp(b)*(x^2/a-1/(a^2))/2)"],"1.130783":["f(exp(a*x^2),-i*sqrt(pi)*erf(i*sqrt(a)*x)/sqrt(a)/2)"],"1.078698":["f(erf(a*x),x*erf(a*x)+exp(-a^2*x^2)/a/sqrt(pi))"],"2.573650":["f(x^2*(1-x^2)^(3/2),(x*sqrt(1-x^2)*(-8*x^4+14*x^2-3)+3*arcsin(x))/48)","f(x^2*(1-x^2)^(5/2),(x*sqrt(1-x^2)*(48*x^6-136*x^4+118*x^2-15)+15*arcsin(x))/384)"],"2.640666":["f(x^4*(1-x^2)^(3/2),(-x*sqrt(1-x^2)*(16*x^6-24*x^4+2*x^2+3)+3*arcsin(x))/128)"],"1.086487":["f(x*exp(a*x),exp(a*x)*(a*x-1)/(a^2))"],"1.267493":["f(x*exp(a*x+b),exp(a*x+b)*(a*x-1)/(a^2))"],"1.037943":["f(x^2*exp(a*x),exp(a*x)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.210862":["f(x^2*exp(a*x+b),exp(a*x+b)*(a^2*x^2-2*a*x+2)/(a^3))"],"1.064970":["f(x^3*exp(a*x),exp(a*x)*x^3/a-3/a*integral(x^2*exp(a*x),x))"],"1.242392":["f(x^3*exp(a*x+b),exp(a*x+b)*x^3/a-3/a*integral(x^2*exp(a*x+b),x))"]},INV_check_arg=function(){return istensor(p1)?p1.tensor.ndim!==2||p1.tensor.dim[0]!==p1.tensor.dim[1]?0:1:0},inv=function(){var e,t,r,n;if(save(),p1=pop(),isinv(p1)){push(car(cdr(p1))),restore();return}if(isidentitymatrix(p1)){push(p1),restore();return}if(expanding&&isinnerordot(p1)){for(p1=cdr(p1),e=[];iscons(p1);)e.push(car(p1)),p1=cdr(p1);for(t=r=n=e.length-1;n<=0?r<=0:r>=0;t=n<=0?++r:--r)push(e[t]),inv(),t!==e.length-1&&inner();restore();return}if(INV_check_arg()===0){push_symbol(INV),push(p1),list(2),restore();return}return isNumericAtomOrTensor(p1)?yyinvg():(push(p1),adj(),push(p1),det(),p2=pop(),isZeroAtomOrTensor(p2)&&stop("inverse of singular matrix"),push(p2),divide()),restore()},invg=function(){if(save(),p1=pop(),INV_check_arg()===0){push_symbol(INVG),push(p1),list(2),restore();return}return yyinvg(),restore()},yyinvg=function(){var e,t,r,n,s,i,a,l,u,c,f,d;for(e=0,t=0,n=0,a=0,a=p1.tensor.dim[0],e=tos,t=l=0,u=a;0<=u?l<u:l>u;t=0<=u?++l:--l)for(n=r=0,c=a;0<=c?r<c:r>c;n=0<=c?++r:--r)push(t===n?one:zero);for(t=s=0,f=a*a;0<=f?s<f:s>f;t=0<=f?++s:--s)push(p1.tensor.elem[t]);for(INV_decomp(a),p1=alloc_tensor(a*a),p1.tensor.ndim=2,p1.tensor.dim[0]=a,p1.tensor.dim[1]=a,t=i=0,d=a*a;0<=d?i<d:i>d;t=0<=d?++i:--i)p1.tensor.elem[t]=stack[e+t];return moveTos(tos-2*a*a),push(p1)},INV_decomp=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y;for(t=0,r=0,n=0,i=0,y=0,t=tos-e*e,y=t-e*e,S=[],r=u=0,c=e;0<=c?u<c:u>c;r=0<=c?++u:--u){if(equal(stack[t+e*r+r],zero)){for(n=s=f=r+1,d=e;(f<=d?s<d:s>d)&&equal(stack[t+e*n+r],zero);n=f<=d?++s:--s);for(n===e&&stop("inverse of singular matrix"),i=a=0,m=e;0<=m?a<m:a>m;i=0<=m?++a:--a)p2=stack[t+e*r+i],stack[t+e*r+i]=stack[t+e*n+i],stack[t+e*n+i]=p2,p2=stack[y+e*r+i],stack[y+e*r+i]=stack[y+e*n+i],stack[y+e*n+i]=p2}for(p2=stack[t+e*r+r],i=l=0,g=e;0<=g?l<g:l>g;i=0<=g?++l:--l)i>r&&(push(stack[t+e*r+i]),push(p2),divide(),stack[t+e*r+i]=pop()),push(stack[y+e*r+i]),push(p2),divide(),stack[y+e*r+i]=pop();S.push(function(){var R,w,P;for(P=[],n=R=0,w=e;0<=w?R<w:R>w;n=0<=w?++R:--R)n!==r&&(p2=stack[t+e*n+r],P.push(function(){var C,B,H;for(H=[],i=C=0,B=e;0<=B?C<B:C>B;i=0<=B?++C:--C)i>r&&(push(stack[t+e*n+i]),push(stack[t+e*r+i]),push(p2),multiply(),subtract(),stack[t+e*n+i]=pop()),push(stack[y+e*n+i]),push(stack[y+e*r+i]),push(p2),multiply(),subtract(),H.push(stack[y+e*n+i]=pop());return H}()));return P}())}return S},DEBUG_IS=!1,isZeroAtom=function(e){switch(e.k){case NUM:return MZERO(e.q.a);case DOUBLE:return e.d===0;default:return!1}},isZeroTensor=function(e){var t,r,n;if(e.k!==TENSOR)return 0;for(t=r=0,n=e.tensor.nelem;0<=n?r<n:r>n;t=0<=n?++r:--r)if(!isZeroAtomOrTensor(e.tensor.elem[t]))return 0;return 1},isZeroAtomOrTensor=function(e){return isZeroAtom(e)||isZeroTensor(e)},isZeroLikeOrNonZeroLikeOrUndetermined=function(e){var t;if(push(e),Eval_predicate(),t=pop(),isZeroAtomOrTensor(t))return 0;if(isNumericAtomOrTensor(t))return 1;if(push(t),zzfloat(),t=pop(),isZeroAtomOrTensor(t))return 0;if(isNumericAtomOrTensor(t))return 1;if(Find(t,imaginaryunit)){if(push(t),absValFloat(),Eval_predicate(),t=pop(),isZeroAtomOrTensor(t))return 0;if(isNumericAtomOrTensor(t))return 1}return null},isnegativenumber=function(e){switch(e.k){case NUM:if(MSIGN(e.q.a)===-1)return 1;break;case DOUBLE:if(e.d<0)return 1}return 0},ispositivenumber=function(e){switch(e.k){case NUM:if(MSIGN(e.q.a)===1)return 1;break;case DOUBLE:if(e.d>0)return 1}return 0},isplustwo=function(e){switch(e.k){case NUM:if(MEQUAL(e.q.a,2)&&MEQUAL(e.q.b,1))return 1;break;case DOUBLE:if(e.d===2)return 1}return 0},isplusone=function(e){switch(e.k){case NUM:if(MEQUAL(e.q.a,1)&&MEQUAL(e.q.b,1))return 1;break;case DOUBLE:if(e.d===1)return 1}return 0},isminusone=function(e){switch(e.k){case NUM:if(MEQUAL(e.q.a,-1)&&MEQUAL(e.q.b,1))return 1;break;case DOUBLE:if(e.d===-1)return 1}return 0},isone=function(e){return isplusone(e)||isminusone(e)},isinteger=function(e){return e.k===NUM&&MEQUAL(e.q.b,1)?1:0},isintegerorintegerfloat=function(e){return e.k===DOUBLE?e.d===Math.round(e.d)?1:0:isinteger(e)},isnonnegativeinteger=function(e){return isrational(e)&&MEQUAL(e.q.b,1)&&MSIGN(e.q.a)===1?1:0},isposint=function(e){return isinteger(e)&&MSIGN(e.q.a)===1?1:0},isunivarpolyfactoredorexpandedform=function(e,t){return DEBUG&&console.log("isunivarpolyfactoredorexpandedform: p: "+e+" x: "+t),t==null&&(push(e),guess(),t=pop(),pop()),ispolyfactoredorexpandedform(e,t)&&Find(e,symbol(SYMBOL_X))+Find(e,symbol(SYMBOL_Y))+Find(e,symbol(SYMBOL_Z))===1?t:0},ispolyfactoredorexpandedform=function(e,t){return ispolyfactoredorexpandedform_factor(e,t)},ispolyfactoredorexpandedform_factor=function(e,t){if(car(e)===symbol(MULTIPLY)){for(e=cdr(e);iscons(e);){if(DEBUG&&console.log("ispolyfactoredorexpandedform_factor testing "+car(e)),!ispolyfactoredorexpandedform_power(car(e),t))return DEBUG&&console.log("... tested negative:"+car(e)),0;e=cdr(e)}return 1}else return ispolyfactoredorexpandedform_power(e,t)},ispolyfactoredorexpandedform_power=function(e,t){return car(e)===symbol(POWER)?(DEBUG&&console.log("ispolyfactoredorexpandedform_power (isposint(caddr(p)) "+(isposint(caddr(e)),DEBUG?console.log("ispolyfactoredorexpandedform_power ispolyexpandedform_expr(cadr(p), x)) "+ispolyexpandedform_expr(cadr(e),t)):void 0)),isposint(caddr(e))&&ispolyexpandedform_expr(cadr(e),t)):(DEBUG&&console.log("ispolyfactoredorexpandedform_power not a power, testing if this is exp form: "+e),ispolyexpandedform_expr(e,t))},ispolyexpandedform=function(e,t){return Find(e,t)?ispolyexpandedform_expr(e,t):0},ispolyexpandedform_expr=function(e,t){if(car(e)===symbol(ADD)){for(e=cdr(e);iscons(e);){if(!ispolyexpandedform_term(car(e),t))return 0;e=cdr(e)}return 1}else return ispolyexpandedform_term(e,t)},ispolyexpandedform_term=function(e,t){if(car(e)===symbol(MULTIPLY)){for(e=cdr(e);iscons(e);){if(!ispolyexpandedform_factor(car(e),t))return 0;e=cdr(e)}return 1}else return ispolyexpandedform_factor(e,t)},ispolyexpandedform_factor=function(e,t){return equal(e,t)?1:car(e)===symbol(POWER)&&equal(cadr(e),t)?isposint(caddr(e))?1:0:Find(e,t)?0:1},isnegativeterm=function(e){return isnegativenumber(e)||car(e)===symbol(MULTIPLY)&&isnegativenumber(cadr(e))?1:0},hasNegativeRationalExponent=function(e){return car(e)===symbol(POWER)&&isrational(car(cdr(cdr(e))))&&isnegativenumber(car(cdr(e)))?(DEBUG_IS&&console.log("hasNegativeRationalExponent: "+e.toString()+" has imaginary component"),1):(DEBUG_IS&&console.log("hasNegativeRationalExponent: "+e.toString()+" has NO imaginary component"),0)},isimaginarynumberdouble=function(e){return car(e)===symbol(MULTIPLY)&&length(e)===3&&isdouble(cadr(e))&&hasNegativeRationalExponent(caddr(e))||equal(e,imaginaryunit)?1:0},isimaginarynumber=function(e){return car(e)===symbol(MULTIPLY)&&length(e)===3&&isNumericAtom(cadr(e))&&equal(caddr(e),imaginaryunit)||equal(e,imaginaryunit)||hasNegativeRationalExponent(caddr(e))?(DEBUG_IS&&console.log("isimaginarynumber: "+e.toString()+" is imaginary number"),1):(DEBUG_IS&&console.log("isimaginarynumber: "+e.toString()+" isn't an imaginary number"),0)},iscomplexnumberdouble=function(e){return car(e)===symbol(ADD)&&length(e)===3&&isdouble(cadr(e))&&isimaginarynumberdouble(caddr(e))||isimaginarynumberdouble(e)?1:0},iscomplexnumber=function(e){if(DEBUG_IS)debugger;return car(e)===symbol(ADD)&&length(e)===3&&isNumericAtom(cadr(e))&&isimaginarynumber(caddr(e))||isimaginarynumber(e)?(DEBUG&&console.log("iscomplexnumber: "+e.toString()+" is imaginary number"),1):(DEBUG&&console.log("iscomplexnumber: "+e.toString()+" is imaginary number"),0)},iseveninteger=function(e){return isinteger(e)&&e.q.a.isEven()?1:0},isnegative=function(e){return car(e)===symbol(ADD)&&isnegativeterm(cadr(e))||isnegativeterm(e)?1:0},issymbolic=function(e){if(issymbol(e))return 1;for(;iscons(e);){if(issymbolic(car(e)))return 1;e=cdr(e)}return 0},isintegerfactor=function(e){return isinteger(e)||car(e)===symbol(POWER)&&isinteger(cadr(e))&&isinteger(caddr(e))},isNumberOneOverSomething=function(e){return isfraction(e)&&MEQUAL(e.q.a.abs(),1)},isoneover=function(e){return car(e)===symbol(POWER)&&isminusone(caddr(e))},isfraction=function(e){return e.k===NUM&&!MEQUAL(e.q.b,1)},equaln=function(e,t){switch(e.k){case NUM:return MEQUAL(e.q.a,t)&&MEQUAL(e.q.b,1);case DOUBLE:return e.d===t;default:return!1}},equalq=function(e,t,r){switch(e.k){case NUM:return MEQUAL(e.q.a,t)&&MEQUAL(e.q.b,r);case DOUBLE:return e.d===t/r;default:return!1}},isoneovertwo=function(e){return equalq(e,1,2)},isminusoneovertwo=function(e){return equalq(e,-1,2)},isoneoversqrttwo=function(e){return car(e)===symbol(POWER)&&equaln(cadr(e),2)&&equalq(caddr(e),-1,2)},isminusoneoversqrttwo=function(e){return car(e)===symbol(MULTIPLY)&&equaln(cadr(e),-1)&&isoneoversqrttwo(caddr(e))&&length(e)===3},issqrtthreeovertwo=function(e){return car(e)===symbol(MULTIPLY)&&isoneovertwo(cadr(e))&&issqrtthree(caddr(e))&&length(e)===3},isminussqrtthreeovertwo=function(e){return car(e)===symbol(MULTIPLY)&&isminusoneovertwo(cadr(e))&&issqrtthree(caddr(e))&&length(e)===3},issqrtthree=function(e){return car(e)===symbol(POWER)&&equaln(cadr(e),3)&&isoneovertwo(caddr(e))},isfloating=function(e){if(e.k===DOUBLE||e===symbol(FLOATF))return 1;for(;iscons(e);){if(isfloating(car(e)))return 1;e=cdr(e)}return 0},isimaginaryunit=function(e){return equal(e,imaginaryunit)?1:0},isquarterturn=function(e){var t,r;if(r=0,t=0,car(e)!==symbol(MULTIPLY))return 0;if(equal(cadr(e),imaginaryunit))return caddr(e)!==symbol(PI)||length(e)!==3?0:2;if(!isNumericAtom(cadr(e))||!equal(caddr(e),imaginaryunit)||cadddr(e)!==symbol(PI)||length(e)!==4||(push(cadr(e)),push_integer(2),multiply(),r=pop_integer(),isNaN(r)))return 0;switch(r<1&&(t=1,r=-r),r%4){case 0:r=1;break;case 1:t?r=4:r=3;break;case 2:r=2;break;case 3:t?r=3:r=4}return r},isnpi=function(e){var t;return t=0,e===symbol(PI)?2:!(car(e)===symbol(MULTIPLY)&&isNumericAtom(cadr(e))&&caddr(e)===symbol(PI)&&length(e)===3)||(push(cadr(e)),push_integer(2),multiply(),t=pop_integer(),isNaN(t))?0:(t<0?t=4- -t%4:t=1+(t-1)%4,t)},$.isZeroAtomOrTensor=isZeroAtomOrTensor,$.isnegativenumber=isnegativenumber,$.isplusone=isplusone,$.isminusone=isminusone,$.isinteger=isinteger,$.isnonnegativeinteger=isnonnegativeinteger,$.isposint=isposint,$.isnegativeterm=isnegativeterm,$.isimaginarynumber=isimaginarynumber,$.iscomplexnumber=iscomplexnumber,$.iseveninteger=iseveninteger,$.isnegative=isnegative,$.issymbolic=issymbolic,$.isintegerfactor=isintegerfactor,$.isoneover=isoneover,$.isfraction=isfraction,$.isoneoversqrttwo=isoneoversqrttwo,$.isminusoneoversqrttwo=isminusoneoversqrttwo,$.isfloating=isfloating,$.isimaginaryunit=isimaginaryunit,$.isquarterturn=isquarterturn,$.isnpi=isnpi,Eval_isprime=function(){return push(cadr(p1)),Eval(),p1=pop(),isnonnegativeinteger(p1)&&mprime(p1.q.a)?push_integer(1):push_integer(0)},Eval_laguerre=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),push(cadddr(p1)),Eval(),p2=pop(),p2===symbol(NIL)?push_integer(0):push(p2),laguerre()},laguerre=function(){var e;if(e=0,save(),p3=pop(),p2=pop(),p1=pop(),push(p2),e=pop_integer(),e<0||isNaN(e)){push_symbol(LAGUERRE),push(p1),push(p2),push(p3),list(4),restore();return}return issymbol(p1)?laguerre2(e):(p4=p1,p1=symbol(SECRETX),laguerre2(e),p1=p4,push(symbol(SECRETX)),push(p1),subst(),Eval()),restore()},laguerre2=function(e){var t,r,n,s;for(t=0,push_integer(1),push_integer(0),p6=pop(),s=[],t=r=0,n=e;0<=n?r<n:r>n;t=0<=n?++r:--r)p5=p6,p6=pop(),push_integer(2*t+1),push(p1),subtract(),push(p3),add(),push(p6),multiply(),push_integer(t),push(p3),add(),push(p5),multiply(),subtract(),push_integer(t+1),s.push(divide());return s},Eval_lcm=function(){var e;for(p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),e=[];iscons(p1);)push(car(p1)),Eval(),lcm(),e.push(p1=cdr(p1));return e},lcm=function(){var e;return e=expanding,save(),yylcm(),restore(),expanding=e},yylcm=function(){return expanding=1,p2=pop(),p1=pop(),push(p1),push(p2),gcd(),push(p1),divide(),push(p2),divide(),inverse()},Eval_leading=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),p1=pop(),p1===symbol(NIL)?guess():push(p1),leading()},leading=function(){return save(),p2=pop(),p1=pop(),push(p1),push(p2),degree(),p3=pop(),push(p1),push(p2),push(p3),power(),divide(),push(p2),filter(),restore()},Eval_legendre=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),push(cadddr(p1)),Eval(),p2=pop(),p2===symbol(NIL)?push_integer(0):push(p2),legendre()},legendre=function(){return save(),__legendre(),restore()},__legendre=function(){var e,t;if(e=0,t=0,p3=pop(),p2=pop(),p1=pop(),push(p2),t=pop_integer(),push(p3),e=pop_integer(),t<0||isNaN(t)||e<0||isNaN(e)){push_symbol(LEGENDRE),push(p1),push(p2),push(p3),list(4);return}return issymbol(p1)?__legendre2(t,e):(p4=p1,p1=symbol(SECRETX),__legendre2(t,e),p1=p4,push(symbol(SECRETX)),push(p1),subst(),Eval()),__legendre3(e)},__legendre2=function(e,t){var r,n,s,i,a,l;for(r=0,push_integer(1),push_integer(0),p6=pop(),r=s=0,i=e;0<=i?s<i:s>i;r=0<=i?++s:--s)p5=p6,p6=pop(),push_integer(2*r+1),push(p1),multiply(),push(p6),multiply(),push_integer(r),push(p5),multiply(),subtract(),push_integer(r+1),divide();for(l=[],r=n=0,a=t;0<=a?n<a:n>a;r=0<=a?++n:--n)push(p1),l.push(derivative());return l},__legendre3=function(e){if(e!==0&&(car(p1)===symbol(COS)?(push(cadr(p1)),sine(),square()):car(p1)===symbol(SIN)?(push(cadr(p1)),cosine(),square()):(push_integer(1),push(p1),square(),subtract()),push_integer(e),push_rational(1,2),multiply(),power(),multiply(),e%2))return negate()},list=function(e){var t,r,n;for(push(symbol(NIL)),n=[],t=0,r=e;0<=r?t<r:t>r;0<=r?++t:--t)n.push(cons());return n},Eval_log=function(){return push(cadr(p1)),Eval(),logarithm()},logarithm=function(){return save(),yylog(),restore()},yylog=function(){var e;if(e=0,p1=pop(),p1===symbol(E)){push_integer(1);return}if(equaln(p1,1)){push_integer(0);return}if(isnegativenumber(p1)){push(p1),negate(),logarithm(),push(imaginaryunit),evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),multiply(),add();return}if(isdouble(p1)){e=Math.log(p1.d),push_double(e);return}if(isfraction(p1)){push(p1),numerator(),logarithm(),push(p1),denominator(),logarithm(),subtract();return}if(car(p1)===symbol(POWER)){push(caddr(p1)),push(cadr(p1)),logarithm(),multiply();return}if(car(p1)===symbol(MULTIPLY)){for(push_integer(0),p1=cdr(p1);iscons(p1);)push(car(p1)),logarithm(),add(),p1=cdr(p1);return}return push_symbol(LOG),push(p1),list(2)},Eval_lookup=function(){return p1=cadr(p1),!iscons(p1)&&cadr(p1).k===SYM&&(p1=get_binding(p1)),push(p1)},madd=function(e,t){return e.add(t)},msub=function(e,t){return e.subtract(t)},mgcd=function(e,t){return bigInt.gcd(e,t)},new_string=function(e){var t;return t=new U,t.k=STR,t.str=e,t},push_zero_matrix=function(e,t){return push(alloc_tensor(e*t)),stack[tos-1].tensor.ndim=2,stack[tos-1].tensor.dim[0]=e,stack[tos-1].tensor.dim[1]=t},equal=function(e,t){return cmp_expr(e,t)===0?1:0},lessp=function(e,t){return cmp_expr(e,t)<0?1:0},sign=function(e){return e<0?-1:e>0?1:0},cmp_expr=function(e,t){var r;if(r=0,e===t)return 0;if(e===symbol(NIL))return-1;if(t===symbol(NIL))return 1;if(isNumericAtom(e)&&isNumericAtom(t))return sign(compare_numbers(e,t));if(isNumericAtom(e))return-1;if(isNumericAtom(t))return 1;if(isstr(e)&&isstr(t))return sign(strcmp(e.str,t.str));if(isstr(e))return-1;if(isstr(t))return 1;if(issymbol(e)&&issymbol(t))return sign(strcmp(get_printname(e),get_printname(t)));if(issymbol(e))return-1;if(issymbol(t))return 1;if(istensor(e)&&istensor(t))return compare_tensors(e,t);if(istensor(e))return-1;if(istensor(t))return 1;for(;iscons(e)&&iscons(t);){if(r=cmp_expr(car(e),car(t)),r!==0)return r;e=cdr(e),t=cdr(t)}return iscons(t)?-1:iscons(e)?1:0},length=function(e){var t;for(t=0;iscons(e);)e=cdr(e),t++;return t},yyexpand=function(){var e;return e=expanding,expanding=1,Eval(),expanding=e},exponential=function(){return push_symbol(E),swap(),power()},square=function(){return push_integer(2),power()},sort_stack=function(e){var t,r;return t=tos-e,r=stack.slice(t,t+e),r.sort(cmp_expr),stack=stack.slice(0,t).concat(r).concat(stack.slice(t+e))},$.equal=equal,$.length=length,mmul=function(e,t){return e.multiply(t)},mdiv=function(e,t){return e.divide(t)},mmod=function(e,t){return e.mod(t)},mdivrem=function(e,t){var r;return r=e.divmod(t),[r.quotient,r.remainder]},Eval_mod=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),mod()},mod=function(){var e;if(e=0,save(),p2=pop(),p1=pop(),isZeroAtomOrTensor(p2)&&stop("mod function: divide by zero"),!isNumericAtom(p1)||!isNumericAtom(p2)){push_symbol(MOD),push(p1),push(p2),list(3),restore();return}return isdouble(p1)&&(push(p1),e=pop_integer(),isNaN(e)&&stop("mod function: cannot convert float value to integer"),push_integer(e),p1=pop()),isdouble(p2)&&(push(p2),e=pop_integer(),isNaN(e)&&stop("mod function: cannot convert float value to integer"),push_integer(e),p2=pop()),(!isinteger(p1)||!isinteger(p2))&&stop("mod function: integer arguments expected"),p3=new U,p3.k=NUM,p3.q.a=mmod(p1.q.a,p2.q.a),p3.q.b=mint(1),push(p3),restore()},mpow=function(e,t){return e.pow(t)},mprime=function(e){return e.isProbablePrime()},mroot=function(e,t){var r,n,s,i,a,l,u;for(e=e.abs(),r=0,n=0,s=0,t===0&&stop("root index is zero"),s=0;e.shiftRight(s)>0;)s++;if(s===0)return mint(0);for(s=Math.floor((s-1)/t),n=Math.floor(s/32+1),l=bigInt(n),r=i=0,a=n;0<=a?i<a:i>a;r=0<=a?++i:--i)l=l.and(bigInt(1).shiftLeft(r).not());for(;s>=0;){switch(l=l.or(bigInt(1).shiftLeft(s)),u=mpow(l,t),mcmp(u,e)){case 0:return l;case 1:l=l.and(bigInt(1).shiftLeft(s).not())}s--}return 0},DEBUG_MULTIPLY=!1,Eval_multiply=function(){var e;for(push(cadr(p1)),Eval(),p1=cddr(p1),e=[];iscons(p1);)push(car(p1)),Eval(),multiply(),e.push(p1=cdr(p1));return e},multiply=function(){return esc_flag&&stop("escape key stop"),isNumericAtom(stack[tos-2])&&isNumericAtom(stack[tos-1])?multiply_numbers():(save(),yymultiply(),restore())},yymultiply=function(){var e,t,r,n,s,i;if(e=0,t=0,r=0,p2=pop(),p1=pop(),e=tos,isZeroAtom(p1)||isZeroAtom(p2)){evaluatingAsFloats?push_double(0):push(zero);return}if(expanding&&isadd(p1)){for(p1=cdr(p1),evaluatingAsFloats?push_double(0):push(zero);iscons(p1);)push(car(p1)),push(p2),multiply(),add(),p1=cdr(p1);return}if(expanding&&isadd(p2)){for(p2=cdr(p2),evaluatingAsFloats?push_double(0):push(zero);iscons(p2);)push(p1),push(car(p2)),multiply(),add(),p2=cdr(p2);return}if(!istensor(p1)&&istensor(p2)){push(p1),push(p2),scalar_times_tensor();return}if(istensor(p1)&&!istensor(p2)){push(p1),push(p2),tensor_times_scalar();return}for(car(p1)===symbol(MULTIPLY)?p1=cdr(p1):(push(p1),list(1),p1=pop()),car(p2)===symbol(MULTIPLY)?p2=cdr(p2):(push(p2),list(1),p2=pop()),isNumericAtom(car(p1))&&isNumericAtom(car(p2))?(push(car(p1)),push(car(p2)),multiply_numbers(),p1=cdr(p1),p2=cdr(p2)):isNumericAtom(car(p1))?(push(car(p1)),p1=cdr(p1)):isNumericAtom(car(p2))?(push(car(p2)),p2=cdr(p2)):evaluatingAsFloats?push_double(1):push(one),parse_p1(),parse_p2();iscons(p1)&&iscons(p2);){if(caar(p1)===symbol(OPERATOR)&&caar(p2)===symbol(OPERATOR)){push_symbol(OPERATOR),push(cdar(p1)),push(cdar(p2)),append(),cons(),p1=cdr(p1),p2=cdr(p2),parse_p1(),parse_p2();continue}switch(cmp_expr(p3,p4)){case-1:push(car(p1)),p1=cdr(p1),parse_p1();break;case 1:push(car(p2)),p2=cdr(p2),parse_p2();break;case 0:combine_factors(e),p1=cdr(p1),p2=cdr(p2),parse_p1(),parse_p2();break;default:stop("internal error 2")}}for(;iscons(p1);)push(car(p1)),p1=cdr(p1);for(;iscons(p2);)push(car(p2)),p2=cdr(p2);if(__normalize_radical_factors(e),expanding){for(t=n=s=e,i=tos;s<=i?n<i:n>i;t=s<=i?++n:--n)if(isadd(stack[t])){multiply_all(tos-e);return}}if(r=tos-e,r!==1){if(isrational(stack[e])&&equaln(stack[e],1)){r===2?(p7=pop(),pop(),push(p7)):(stack[e]=symbol(MULTIPLY),list(r));return}return list(r),p7=pop(),push_symbol(MULTIPLY),push(p7),cons()}},parse_p1=function(){if(p3=car(p1),p5=evaluatingAsFloats?one_as_double:one,car(p3)===symbol(POWER))return p5=caddr(p3),p3=cadr(p3)},parse_p2=function(){if(p4=car(p2),p6=evaluatingAsFloats?one_as_double:one,car(p4)===symbol(POWER))return p6=caddr(p4),p4=cadr(p4)},combine_factors=function(e){return push(p4),push(p5),push(p6),add(),power(),p7=pop(),isNumericAtom(p7)?(push(stack[e]),push(p7),multiply_numbers(),stack[e]=pop()):car(p7)===symbol(MULTIPLY)&&isNumericAtom(cadr(p7))&&cdddr(p7)===symbol(NIL)?(push(stack[e]),push(cadr(p7)),multiply_numbers(),stack[e]=pop(),push(caddr(p7))):push(p7)},multiply_noexpand=function(){var e;return e=expanding,expanding=0,multiply(),expanding=e},multiply_all=function(e){var t,r,n,s;if(r=0,e!==1){if(e===0){push(evaluatingAsFloats?one_as_double:one);return}for(t=tos-e,push(stack[t]),r=n=1,s=e;1<=s?n<s:n>s;r=1<=s?++n:--n)push(stack[t+r]),multiply();return stack[t]=pop(),moveTos(t+1)}},multiply_all_noexpand=function(e){var t;return t=expanding,expanding=0,multiply_all(e),expanding=t},divide=function(){return isNumericAtom(stack[tos-2])&&isNumericAtom(stack[tos-1])?divide_numbers():(inverse(),multiply())},inverse=function(){return isNumericAtom(stack[tos-1])?invert_number():(push_integer(-1),power())},reciprocate=function(){return inverse()},negate=function(){return isNumericAtom(stack[tos-1])?negate_number():(evaluatingAsFloats?push_double(-1):push_integer(-1),multiply())},negate_noexpand=function(){var e;return e=expanding,expanding=0,negate(),expanding=e},__normalize_radical_factors=function(e){var t,r,n,s,i,a,l,u,c,f;if(t=0,!(isplusone(stack[e])||isminusone(stack[e])||isdouble(stack[e]))){for(t=s=i=e+1,a=tos;(i<=a?s<a:s>a)&&!__is_radical_number(stack[t]);t=i<=a?++s:--s);if(t!==tos){for(save(),push(stack[e]),mp_numerator(),DEBUG_MULTIPLY&&console.log("__normalize_radical_factors numerator: "+stack[tos-1]),p1=pop(),t=r=l=e+1,u=tos;(l<=u?r<u:r>u)&&!(isplusone(p1)||isminusone(p1));t=l<=u?++r:--r)__is_radical_number(stack[t])&&(p3=cadr(stack[t]),p4=caddr(stack[t]),isnegativenumber(p4)&&(push(p1),push(p3),divide(),p5=pop(),isinteger(p5)&&(p1=p5,push_symbol(POWER),push(p3),push(evaluatingAsFloats?one_as_double:one),push(p4),add(),list(3),stack[t]=pop())));for(push(stack[e]),mp_denominator(),DEBUG_MULTIPLY&&console.log("__normalize_radical_factors denominator: "+stack[tos-1]),p2=pop(),t=n=c=e+1,f=tos;(c<=f?n<f:n>f)&&!isplusone(p2);t=c<=f?++n:--n)if(__is_radical_number(stack[t])&&(p3=cadr(stack[t]),p4=caddr(stack[t]),!isnegativenumber(p4)&&(push(p2),push(p3),divide(),p5=pop(),!!isinteger(p5)))){if(DEBUG_MULTIPLY&&console.log("__new radical p5: "+p5.toString()),DEBUG_MULTIPLY&&console.log("__new radical top stack: "+stack[tos-1]),p2=p5,push_symbol(POWER),push(p3),push(p4),DEBUG_MULTIPLY&&console.log("__new radical p3: "+p3.toString()),DEBUG_MULTIPLY&&console.log("__new radical p4: "+p4.toString()),push(one),subtract(),dontCreateNewRadicalsInDenominatorWhenEvalingMultiplication&&isinteger(p3)&&!isinteger(stack[tos-1])&&isnegativenumber(stack[tos-1])){pop(),pop(),pop(),push(p1),push(p3),divide(),p1=pop();break}DEBUG_MULTIPLY&&console.log("__new radical exponent: "+stack[tos-1]),list(3),stack[t]=pop()}return push(p1),push(p2),divide(),stack[e]=pop(),restore()}}},__is_radical_number=function(e){return car(e)===symbol(POWER)&&isNumericAtom(cadr(e))&&isfraction(caddr(e))&&!isminusone(cadr(e))},NROOTS_YMAX=101,NROOTS_DELTA=1e-6,NROOTS_EPSILON=1e-9,NROOTS_ABS=function(e){return Math.sqrt(e.r*e.r+e.i*e.i)},NROOTS_RANDOM=function(){return 4*Math.random()-2},numericRootOfPolynomial=(function(){class e{}return e.prototype.r=0,e.prototype.i=0,e}).call(this),nroots_a=new numericRootOfPolynomial,nroots_b=new numericRootOfPolynomial,nroots_x=new numericRootOfPolynomial,nroots_y=new numericRootOfPolynomial,nroots_fa=new numericRootOfPolynomial,nroots_fb=new numericRootOfPolynomial,nroots_dx=new numericRootOfPolynomial,nroots_df=new numericRootOfPolynomial,nroots_c=[],initNRoots=o=0,ref=NROOTS_YMAX;0<=ref?o<ref:o>ref;initNRoots=0<=ref?++o:--o)nroots_c[initNRoots]=new numericRootOfPolynomial;for(Eval_nroots=function(){var e,t,r,n,s,i,a,l,u;for(e=0,t=0,s=0,a=0,push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),p2=pop(),p2===symbol(NIL)?guess():push(p2),p2=pop(),p1=pop(),ispolyexpandedform(p1,p2)||stop("nroots: polynomial?"),e=tos,a=coeff(p2,p1),a>NROOTS_YMAX&&stop("nroots: degree?"),t=r=0,l=a;0<=l?r<l:r>l;t=0<=l?++r:--r)push(stack[e+t]),real(),yyfloat(),Eval(),p1=pop(),push(stack[e+t]),imag(),yyfloat(),Eval(),p2=pop(),(!isdouble(p1)||!isdouble(p2))&&stop("nroots: coefficients?"),nroots_c[t].r=p1.d,nroots_c[t].i=p2.d;for(moveTos(e),monic(a),s=n=a;n>1;s=n+=-1)findroot(s),Math.abs(nroots_a.r)<NROOTS_DELTA&&(nroots_a.r=0),Math.abs(nroots_a.i)<NROOTS_DELTA&&(nroots_a.i=0),push_double(nroots_a.r),push_double(nroots_a.i),push(imaginaryunit),multiply(),add(),NROOTS_divpoly(s);if(a=tos-e,a>1){for(sort_stack(a),p1=alloc_tensor(a),p1.tensor.ndim=1,p1.tensor.dim[0]=a,t=i=0,u=a;0<=u?i<u:i>u;t=0<=u?++i:--i)p1.tensor.elem[t]=stack[e+t];return moveTos(e),push(p1)}},monic=function(e){var t,r,n,s;for(r=0,s=0,nroots_y.r=nroots_c[e-1].r,nroots_y.i=nroots_c[e-1].i,s=nroots_y.r*nroots_y.r+nroots_y.i*nroots_y.i,r=t=0,n=e-1;0<=n?t<n:t>n;r=0<=n?++t:--t)nroots_c[r].r=(nroots_c[r].r*nroots_y.r+nroots_c[r].i*nroots_y.i)/s,nroots_c[r].i=(nroots_c[r].i*nroots_y.r-nroots_c[r].r*nroots_y.i)/s;return nroots_c[e-1].r=1,nroots_c[e-1].i=0},findroot=function(e){var t,r,n,s;if(s=0,NROOTS_ABS(nroots_c[0])<NROOTS_DELTA){nroots_a.r=0,nroots_a.i=0;return}for(t=0;t<100;++t)for(nroots_a.r=NROOTS_RANDOM(),nroots_a.i=NROOTS_RANDOM(),compute_fa(e),nroots_b.r=nroots_a.r,nroots_b.i=nroots_a.i,nroots_fb.r=nroots_fa.r,nroots_fb.i=nroots_fa.i,nroots_a.r=NROOTS_RANDOM(),nroots_a.i=NROOTS_RANDOM(),r=0;r<1e3;++r){if(compute_fa(e),n=NROOTS_ABS(nroots_fa),DEBUG&&console.log("nrabs: "+n),n<NROOTS_EPSILON)return;if(NROOTS_ABS(nroots_fa)<NROOTS_ABS(nroots_fb)&&(nroots_x.r=nroots_a.r,nroots_x.i=nroots_a.i,nroots_a.r=nroots_b.r,nroots_a.i=nroots_b.i,nroots_b.r=nroots_x.r,nroots_b.i=nroots_x.i,nroots_x.r=nroots_fa.r,nroots_x.i=nroots_fa.i,nroots_fa.r=nroots_fb.r,nroots_fa.i=nroots_fb.i,nroots_fb.r=nroots_x.r,nroots_fb.i=nroots_x.i),nroots_dx.r=nroots_b.r-nroots_a.r,nroots_dx.i=nroots_b.i-nroots_a.i,nroots_df.r=nroots_fb.r-nroots_fa.r,nroots_df.i=nroots_fb.i-nroots_fa.i,s=nroots_df.r*nroots_df.r+nroots_df.i*nroots_df.i,s===0)break;nroots_y.r=(nroots_dx.r*nroots_df.r+nroots_dx.i*nroots_df.i)/s,nroots_y.i=(nroots_dx.i*nroots_df.r-nroots_dx.r*nroots_df.i)/s,nroots_a.r=nroots_b.r-(nroots_y.r*nroots_fb.r-nroots_y.i*nroots_fb.i),nroots_a.i=nroots_b.i-(nroots_y.r*nroots_fb.i+nroots_y.i*nroots_fb.r)}return stop("nroots: convergence error")},compute_fa=function(e){var t,r,n,s,i;for(r=0,i=0,nroots_x.r=nroots_a.r,nroots_x.i=nroots_a.i,nroots_fa.r=nroots_c[0].r+nroots_c[1].r*nroots_x.r-nroots_c[1].i*nroots_x.i,nroots_fa.i=nroots_c[0].i+nroots_c[1].r*nroots_x.i+nroots_c[1].i*nroots_x.r,s=[],r=t=2,n=e;2<=n?t<n:t>n;r=2<=n?++t:--t)i=nroots_a.r*nroots_x.r-nroots_a.i*nroots_x.i,nroots_x.i=nroots_a.r*nroots_x.i+nroots_a.i*nroots_x.r,nroots_x.r=i,nroots_fa.r+=nroots_c[r].r*nroots_x.r-nroots_c[r].i*nroots_x.i,s.push(nroots_fa.i+=nroots_c[r].r*nroots_x.i+nroots_c[r].i*nroots_x.r);return s},NROOTS_divpoly=function(e){var t,r,n,s,i,a;for(n=0,n=t=s=e-1;s<=0?t<0:t>0;n=s<=0?++t:--t)nroots_c[n-1].r+=nroots_c[n].r*nroots_a.r-nroots_c[n].i*nroots_a.i,nroots_c[n-1].i+=nroots_c[n].i*nroots_a.r+nroots_c[n].r*nroots_a.i;for(NROOTS_ABS(nroots_c[0])>NROOTS_DELTA&&stop("nroots: residual error"),a=[],n=r=0,i=e-1;0<=i?r<i:r>i;n=0<=i?++r:--r)nroots_c[n].r=nroots_c[n+1].r,a.push(nroots_c[n].i=nroots_c[n+1].i);return a},Eval_numerator=function(){return push(cadr(p1)),Eval(),numerator()},numerator=function(){var e,t;if(e=0,t=pop(),car(t)===symbol(ADD)&&(push(t),rationalize(),t=pop()),car(t)===symbol(MULTIPLY)&&!isplusone(car(cdr(t)))){for(e=tos,t=cdr(t);iscons(t);)push(car(t)),numerator(),t=cdr(t);return multiply_all(tos-e)}else return isrational(t)?(push(t),mp_numerator()):car(t)===symbol(POWER)&&isnegativeterm(caddr(t))?push(one):push(t)},Eval_outer=function(){var e;for(p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),e=[];iscons(p1);)push(car(p1)),Eval(),outer(),e.push(p1=cdr(p1));return e},outer=function(){return save(),p2=pop(),p1=pop(),istensor(p1)&&istensor(p2)?yyouter():(push(p1),push(p2),istensor(p1)?tensor_times_scalar():istensor(p2)?scalar_times_tensor():multiply()),restore()},yyouter=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m;for(e=0,r=0,s=0,l=0,u=0,l=p1.tensor.ndim+p2.tensor.ndim,l>MAXDIM&&stop("outer: rank of result exceeds maximum"),u=p1.tensor.nelem*p2.tensor.nelem,p3=alloc_tensor(u),p3.tensor.ndim=l,e=t=0,c=p1.tensor.ndim;0<=c?t<c:t>c;e=0<=c?++t:--t)p3.tensor.dim[e]=p1.tensor.dim[e];for(r=e,e=n=0,f=p2.tensor.ndim;0<=f?n<f:n>f;e=0<=f?++n:--n)p3.tensor.dim[r+e]=p2.tensor.dim[e];for(s=0,e=i=0,d=p1.tensor.nelem;0<=d?i<d:i>d;e=0<=d?++i:--i)for(r=a=0,m=p2.tensor.nelem;0<=m?a<m:a>m;r=0<=m?++a:--a)push(p1.tensor.elem[e]),push(p2.tensor.elem[r]),multiply(),p3.tensor.elem[s++]=pop();return push(p3)},partition=function(){for(save(),p2=pop(),p1=pop(),push_integer(1),p3=pop(),p4=p3,p1=cdr(p1);iscons(p1);)Find(car(p1),p2)?(push(p4),push(car(p1)),multiply(),p4=pop()):(push(p3),push(car(p1)),multiply(),p3=pop()),p1=cdr(p1);return push(p3),push(p4),restore()},Eval_silentpattern=function(){return Eval_pattern(),pop(),push_symbol(NIL)},Eval_pattern=function(){var e,t,r,n,s;return iscons(cdr(p1))||stop("pattern needs at least a template and a transformed version"),e=car(cdr(p1)),r=car(cdr(cdr(p1))),r===symbol(NIL)&&stop("pattern needs at least a template and a transformed version"),iscons(cdr(cdr(p1)))?s=car(cdr(cdr(cdr(p1)))):s=symbol(NIL),equal(e,r)&&stop("recursive pattern"),n="template: "+print_list(e),n+=" tests: "+print_list(s),DEBUG&&console.log("pattern stringkey: "+n),t=userSimplificationsInStringForm.indexOf(n),t===-1?(userSimplificationsInStringForm.push(n),userSimplificationsInListForm.push(cdr(p1))):(DEBUG&&console.log("pattern already exists, replacing. "+cdr(p1)),userSimplificationsInStringForm[t]=n,userSimplificationsInListForm[t]=cdr(p1)),push_symbol(PATTERN),push(cdr(p1)),list(2)},do_clearPatterns=function(){return userSimplificationsInListForm=[],userSimplificationsInStringForm=[]},Eval_clearpatterns=function(){return do_clearPatterns(),push_symbol(NIL)},Eval_patternsinfo=function(){var e;return e=patternsinfo(),e!==""?push(new_string(e)):push_symbol(NIL)},patternsinfo=function(){var e,t,r;for(r="",e=0,t=userSimplificationsInListForm.length;e<t;e++)userSimplificationsInListForm[e],r+=userSimplificationsInListForm+`
`;return r},Eval_polar=function(){return push(cadr(p1)),Eval(),polar()},polar=function(){return evaluatingPolar++,save(),p1=pop(),push(p1),abs(),push(imaginaryunit),push(p1),arg(),multiply(),exponential(),multiply(),evaluatingPolar--,restore()},n_factor_number=0,factor_number=function(){var e;if(e=0,save(),p1=pop(),equaln(p1,0)||equaln(p1,1)||equaln(p1,-1)){push(p1),restore();return}return n_factor_number=p1.q.a,e=tos,factor_a(),tos-e>1&&(list(tos-e),push_symbol(MULTIPLY),swap(),cons()),restore()},factor_a=function(){var e,t;for(t=0,n_factor_number.isNegative()&&(n_factor_number=setSignTo(n_factor_number,1),push_integer(-1)),t=e=0;e<1e4;t=++e)if(try_kth_prime(t),n_factor_number.compare(1)===0)return;return factor_b()},try_kth_prime=function(e){var t,r,n,s;for(t=0,r=mint(primetab[e]),t=0;;){if(n_factor_number.compare(1)===0){t&&push_factor(r,t);return}if([n,s]=mdivrem(n_factor_number,r),s.isZero())t++,n_factor_number=n;else break}if(t&&push_factor(r,t),mcmp(n,r)===-1)return push_factor(n_factor_number,1),n_factor_number=mint(1)},factor_b=function(){var e,t,r,n,s,i,a;for(r=0,n=0,e=mint(1),i=mint(5),a=mint(2),r=1,n=1;;){if(mprime(n_factor_number))return push_factor(n_factor_number,1),0;for(;;){if(esc_flag&&stop("esc"),s=msub(a,i),s=setSignTo(s,1),t=mgcd(s,n_factor_number),MEQUAL(t,1)){--r===0&&(a=i,n*=2,r=n),s=mmul(i,i),i=madd(s,e),s=mmod(i,n_factor_number),i=s;continue}if(push_factor(t,1),mcmp(t,n_factor_number)===0)return-1;s=mdiv(n_factor_number,t),n_factor_number=s,s=mmod(i,n_factor_number),i=s,s=mmod(a,n_factor_number),a=s;break}}},push_factor=function(e,t){if(p1=new U,p1.k=NUM,p1.q.a=e,p1.q.b=mint(1),push(p1),t>1)return push_symbol(POWER),swap(),p1=new U,p1.k=NUM,p1.q.a=mint(t),p1.q.b=mint(1),push(p1),list(3)},DEBUG_POWER=!1,Eval_power=function(){if(DEBUG_POWER)debugger;return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),power()},power=function(){return save(),yypower(),restore()},yypower=function(){var e,t,r,n,s,i,a;if(DEBUG_POWER)debugger;if(a=0,p2=pop(),p1=pop(),n=p2,r=p1,DEBUG_POWER&&console.log("POWER: "+p1+" ^ "+p2),equal(p1,one)||isZeroAtomOrTensor(p2)){evaluatingAsFloats?push_double(1):push(one),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(equal(p2,one)){push(p1),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(isminusone(p1)&&isminusone(p2)){evaluatingAsFloats?push_double(1):push(one),negate(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(isminusone(p1)&&isoneovertwo(p2)){push(imaginaryunit),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(isminusone(p1)&&isminusoneovertwo(p2)){push(imaginaryunit),negate(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(isminusone(p1)&&!isdouble(p1)&&isrational(p2)&&!isinteger(p2)&&ispositivenumber(p2)&&!evaluatingAsFloats){DEBUG_POWER&&console.log("   power: -1 ^ rational"),DEBUG_POWER&&console.log(" trick: p2.q.a , p2.q.b "+p2.q.a+" , "+p2.q.b),p2.q.a<p2.q.b?(push_symbol(POWER),push(p1),push(p2),list(3)):(push_symbol(MULTIPLY),push(p1),push_symbol(POWER),push(p1),push_rational(p2.q.a.mod(p2.q.b),p2.q.b),list(3),list(3),DEBUG_POWER&&console.log(" trick applied : "+stack[tos-1])),rect(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(isrational(p1)&&isrational(p2)){DEBUG_POWER&&console.log("   power: isrational(p1) && isrational(p2)"),push(p1),push(p2),qpow(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(isNumericAtom(p1)&&isNumericAtom(p2)){DEBUG_POWER&&console.log("   power: both base and exponent are either rational or double "),DEBUG_POWER&&console.log("POWER - isNumericAtom(p1) && isNumericAtom(p2)"),push(p1),push(p2),dpow(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(istensor(p1)){DEBUG_POWER&&console.log("   power: istensor(p1) "),power_tensor(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(car(p1)===symbol(ABS)&&iseveninteger(p2)&&!isZeroAtomOrTensor(get_binding(symbol(ASSUME_REAL_VARIABLES)))){DEBUG_POWER&&console.log("   power: even power of absolute of real value "),push(cadr(p1)),push(p2),power(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(p1===symbol(E)&&car(p2)===symbol(LOG)){push(cadr(p2)),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(p1===symbol(E)&&isdouble(p2)){DEBUG_POWER&&console.log("   power: p1 == symbol(E) && isdouble(p2) "),push_double(Math.exp(p2.d)),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(p1===symbol(E)&&Find(p2,imaginaryunit)!==0&&Find(p2,symbol(PI))!==0&&!evaluatingPolar&&(push_symbol(POWER),push(p1),push(p2),list(3),DEBUG_POWER&&console.log("   power: turning complex exponential to rect: "+stack[tos-1]),rect(),t=pop(),Find(t,symbol(PI))===0)){DEBUG_POWER&&console.log("   power: turned complex exponential to rect: "+t),push(t);return}if(car(p1)===symbol(MULTIPLY)&&isinteger(p2)){for(DEBUG_POWER&&console.log("   power: (a * b) ^ c  ->  (a ^ c) * (b ^ c) "),p1=cdr(p1),push(car(p1)),push(p2),power(),p1=cdr(p1);iscons(p1);)push(car(p1)),push(p2),power(),multiply(),p1=cdr(p1);DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(i=!1,isNumericAtom(cadr(p1))&&(i=sign(compare_numbers(cadr(p1),zero))),car(p1)===symbol(POWER)&&(isinteger(p2)||i)){push(cadr(p1)),push(caddr(p1)),push(p2),multiply(),power(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(e=!1,iseveninteger(caddr(p1))&&(push(caddr(p1)),push(p2),multiply(),s=pop(),isone(s)&&(e=!0)),car(p1)===symbol(POWER)&&e){DEBUG_POWER&&console.log("   power: car(p1) == symbol(POWER) && b_isEven_and_c_isItsInverse "),push(cadr(p1)),abs(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(expanding&&isadd(p1)&&isNumericAtom(p2)&&(push(p2),a=pop_integer(),a>1&&!isNaN(a))){DEBUG_POWER&&console.log("   power: expanding && isadd(p1) && isNumericAtom(p2) "),power_sum(a),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(trigmode===1&&car(p1)===symbol(SIN)&&iseveninteger(p2)){DEBUG_POWER&&console.log("   power: trigmode == 1 && car(p1) == symbol(SIN) && iseveninteger(p2) "),push_integer(1),push(cadr(p1)),cosine(),push_integer(2),power(),subtract(),push(p2),push_rational(1,2),multiply(),power(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(trigmode===2&&car(p1)===symbol(COS)&&iseveninteger(p2)){DEBUG_POWER&&console.log("   power: trigmode == 2 && car(p1) == symbol(COS) && iseveninteger(p2) "),push_integer(1),push(cadr(p1)),sine(),push_integer(2),power(),subtract(),push(p2),push_rational(1,2),multiply(),power(),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(iscomplexnumber(p1)){if(DEBUG_POWER&&console.log(" power - handling the case (a + ib) ^ n"),isinteger(p2)){push(p1),conjugate(),p3=pop(),push(p3),push(p3),push(p1),multiply(),divide(),isone(p2)||(push(p2),negate(),power()),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}if(isNumericAtom(p2)){push(p1),abs(),push(p2),power(),push_integer(-1),push(p1),arg(),push(p2),multiply(),evaluatingAsFloats||iscomplexnumberdouble(p1)&&isdouble(p2)?push_double(Math.PI):push(symbol(PI)),divide(),power(),multiply(),avoidCalculatingPowersIntoArctans&&Find(stack[tos-1],symbol(ARCTAN))&&(pop(),push_symbol(POWER),push(p1),push(p2),list(3)),DEBUG_POWER&&console.log("   power of "+r+" ^ "+n+": "+stack[tos-1]);return}}if(simplify_polar()){DEBUG_POWER&&console.log("   power: using simplify_polar");return}if(DEBUG_POWER&&console.log("   power: nothing can be done "),push_symbol(POWER),push(p1),push(p2),list(3),DEBUG_POWER)return console.log("   power of "+r+" ^ "+n+": "+stack[tos-1])},power_sum=function(e){var t,r,n,s,i,a,l,u,c,f;for(t=[],r=0,s=0,a=0,a=length(p1)-1,push_frame(a*(e+1)),p1=cdr(p1),r=n=0,u=a;0<=u?n<u:n>u;r=0<=u?++n:--n){for(s=i=0,c=e;0<=c?i<=c:i>=c;s=0<=c?++i:--i)push(car(p1)),push_integer(s),power(),stack[frame+r*(e+1)+s]=pop();p1=cdr(p1)}for(push_integer(e),factorial(),p1=pop(),r=l=0,f=a;0<=f?l<f:l>f;r=0<=f?++l:--l)t[r]=0;return push(zero),multinomial_sum(a,e,t,0,e),pop_frame(a*(e+1))},multinomial_sum=function(e,t,r,n,s){var i,a,l,u,c,f,d;if(a=0,n<e-1){for(a=i=0,c=s;0<=c?i<=c:i>=c;a=0<=c?++i:--i)r[n]=a,multinomial_sum(e,t,r,n+1,s-a);return}for(r[n]=s,push(p1),a=l=0,f=e;0<=f?l<f:l>f;a=0<=f?++l:--l)push_integer(r[a]),factorial(),divide();for(a=u=0,d=e;0<=d?u<d:u>d;a=0<=d?++u:--u)push(stack[frame+a*(t+1)+r[a]]),multiply();return add()},simplify_polar=function(){var e;switch(e=0,e=isquarterturn(p2),e){case 0:break;case 1:return push_integer(1),1;case 2:return push_integer(-1),1;case 3:return push(imaginaryunit),1;case 4:return push(imaginaryunit),negate(),1}if(car(p2)===symbol(ADD)){for(p3=cdr(p2);iscons(p3)&&(e=isquarterturn(car(p3)),!e);)p3=cdr(p3);switch(e){case 0:return 0;case 1:push_integer(1);break;case 2:push_integer(-1);break;case 3:push(imaginaryunit);break;case 4:push(imaginaryunit),negate()}return push(p2),push(car(p3)),subtract(),exponential(),multiply(),1}return 0},Eval_prime=function(){return push(cadr(p1)),Eval(),prime()},prime=function(){var e;return e=0,e=pop_integer(),(e<1||e>MAXPRIMETAB)&&stop("prime: Argument out of range."),e=primetab[e-1],push_integer(e)},power_str="^",codeGen=!1,Eval_print=function(){return stringsEmittedByUserPrintouts+=_print(cdr(p1),printMode),push(symbol(NIL))},Eval_print2dascii=function(){return stringsEmittedByUserPrintouts+=_print(cdr(p1),PRINTMODE_2DASCII),push(symbol(NIL))},Eval_printcomputer=function(){return stringsEmittedByUserPrintouts+=_print(cdr(p1),PRINTMODE_COMPUTER),push(symbol(NIL))},Eval_printlatex=function(){return stringsEmittedByUserPrintouts+=_print(cdr(p1),PRINTMODE_LATEX),push(symbol(NIL))},Eval_printhuman=function(){var e;return e=test_flag,test_flag=0,stringsEmittedByUserPrintouts+=_print(cdr(p1),PRINTMODE_HUMAN),test_flag=e,push(symbol(NIL))},Eval_printlist=function(){var e;return e=_print(cdr(p1),PRINTMODE_LIST),stringsEmittedByUserPrintouts+=e,push(symbol(NIL))},_print=function(e,t){var r,n;for(r="";iscons(e);)push(car(e)),Eval(),p2=pop(),n=printMode,t===PRINTMODE_COMPUTER?(printMode=PRINTMODE_COMPUTER,r=printline(p2),rememberPrint(r,LAST_FULL_PRINT)):t===PRINTMODE_HUMAN?(printMode=PRINTMODE_HUMAN,r=printline(p2),rememberPrint(r,LAST_PLAIN_PRINT)):t===PRINTMODE_2DASCII?(printMode=PRINTMODE_2DASCII,r=print2dascii(p2),rememberPrint(r,LAST_2DASCII_PRINT)):t===PRINTMODE_LATEX?(printMode=PRINTMODE_LATEX,r=printline(p2),rememberPrint(r,LAST_LATEX_PRINT)):t===PRINTMODE_LIST&&(printMode=PRINTMODE_LIST,r=print_list(p2),rememberPrint(r,LAST_LIST_PRINT)),printMode=n,e=cdr(e);return DEBUG&&console.log("emttedString from display: "+stringsEmittedByUserPrintouts),r},rememberPrint=function(e,t){var r;return scan('"'+e+'"'),r=pop(),set_binding(symbol(t),r)},print_str=function(e){return DEBUG&&console.log("emttedString from print_str: "+stringsEmittedByUserPrintouts),e},print_char=function(e){return e},collectLatexStringFromReturnValue=function(e){var t,r,n;return t=printMode,printMode=PRINTMODE_LATEX,r=codeGen,codeGen=!1,n=print_expr(e),n=n.replace(/_/g,"\\_"),printMode=t,codeGen=r,DEBUG&&console.log("emttedString from collectLatexStringFromReturnValue: "+stringsEmittedByUserPrintouts),n},printline=function(e){var t;return t="",t+=print_expr(e),t},print_base_of_denom=function(e){var t;return t="",isfraction(e)||car(e)===symbol(ADD)||car(e)===symbol(MULTIPLY)||car(e)===symbol(POWER)||lessp(e,zero)?(t+=print_char("("),t+=print_expr(e),t+=print_char(")")):t+=print_expr(e),t},print_expo_of_denom=function(e){var t;return t="",isfraction(e)||car(e)===symbol(ADD)||car(e)===symbol(MULTIPLY)||car(e)===symbol(POWER)?(t+=print_char("("),t+=print_expr(e),t+=print_char(")")):t+=print_expr(e),t},print_denom=function(e,t){var r;return r="",save(),p1=cadr(e),p2=caddr(e),isminusone(p2)?(r+=print_base_of_denom(p1),restore(),r):(t===1&&(r+=print_char("(")),push(p2),negate(),p2=pop(),r+=print_power(p1,p2),t===1&&(r+=print_char(")")),restore(),r)},print_a_over_b=function(e){var t,r,n;for(t="",flag=0,n=0,r=0,save(),n=0,r=0,p1=cdr(e),p2=car(p1),isrational(p2)?(push(p2),mp_numerator(),absval(),p3=pop(),push(p2),mp_denominator(),p4=pop(),isplusone(p3)||n++,isplusone(p4)||r++,p1=cdr(p1)):(p3=one,p4=one);iscons(p1);)p2=car(p1),is_denominator(p2)?r++:n++,p1=cdr(p1);if(printMode===PRINTMODE_LATEX&&(t+=print_str("\\frac{")),n===0)t+=print_char("1");else for(flag=0,p1=cdr(e),isrational(car(p1))&&(p1=cdr(p1)),isplusone(p3)||(t+=print_factor(p3),flag=1);iscons(p1);)p2=car(p1),is_denominator(p2)||(flag&&(t+=print_multiply_sign()),t+=print_factor(p2),flag=1),p1=cdr(p1);for(printMode===PRINTMODE_LATEX?t+=print_str("}{"):printMode===PRINTMODE_HUMAN&&!test_flag?t+=print_str(" / "):t+=print_str("/"),r>1&&printMode!==PRINTMODE_LATEX&&(t+=print_char("(")),flag=0,p1=cdr(e),isrational(car(p1))&&(p1=cdr(p1)),isplusone(p4)||(t+=print_factor(p4),flag=1);iscons(p1);)p2=car(p1),is_denominator(p2)&&(flag&&(t+=print_multiply_sign()),t+=print_denom(p2,r),flag=1),p1=cdr(p1);return r>1&&printMode!==PRINTMODE_LATEX&&(t+=print_char(")")),printMode===PRINTMODE_LATEX&&(t+=print_str("}")),restore(),t},print_expr=function(e){var t;if(t="",isadd(e))for(e=cdr(e),sign_of_term(car(e))==="-"&&(t+=print_str("-")),t+=print_term(car(e)),e=cdr(e);iscons(e);)sign_of_term(car(e))==="+"?printMode===PRINTMODE_HUMAN&&!test_flag?t+=print_str(" + "):t+=print_str("+"):printMode===PRINTMODE_HUMAN&&!test_flag?t+=print_str(" - "):t+=print_str("-"),t+=print_term(car(e)),e=cdr(e);else sign_of_term(e)==="-"&&(t+=print_str("-")),t+=print_term(e);return t},sign_of_term=function(e){var t;return t="",car(e)===symbol(MULTIPLY)&&isNumericAtom(cadr(e))&&lessp(cadr(e),zero)||isNumericAtom(e)&&lessp(e,zero)?t+="-":t+="+",t},print_term=function(e){var t,r,n,s,i;if(t="",car(e)===symbol(MULTIPLY)&&any_denominators(e))return t+=print_a_over_b(e),t;if(car(e)===symbol(MULTIPLY)){for(e=cdr(e),isminusone(car(e))&&(e=cdr(e)),i=!1,isNumericAtom(car(e))&&(i=!0),n=!1,printMode===PRINTMODE_LATEX&&iscons(cdr(e))&&isNumberOneOverSomething(car(e))&&(n=!0,r=car(e).q.b.toString()),n?(s=t,t=""):t+=print_factor(car(e)),e=cdr(e);iscons(e);)printMode===PRINTMODE_LATEX&&i&&caar(e)===symbol(POWER)&&isNumericAtom(car(cdr(car(e))))&&(isfraction(car(cdr(cdr(car(e)))))||(t+=" \\cdot ")),t+=print_multiply_sign(),t+=print_factor(car(e),!1,!0),i=!1,isNumericAtom(car(e))&&(i=!0),e=cdr(e);n&&(t=s+"\\frac{"+t+"}{"+r+"}")}else t+=print_factor(e);return t},print_subexpr=function(e){var t;return t="",t+=print_char("("),t+=print_expr(e),t+=print_char(")"),t},print_factorial_function=function(e){var t;return t="",e=cadr(e),isfraction(e)||car(e)===symbol(ADD)||car(e)===symbol(MULTIPLY)||car(e)===symbol(POWER)||car(e)===symbol(FACTORIAL)?t+=print_subexpr(e):t+=print_expr(e),t+=print_char("!"),t},print_ABS_latex=function(e){var t;return t="",t+=print_str("\\left |"),t+=print_expr(cadr(e)),t+=print_str(" \\right |"),t},print_BINOMIAL_latex=function(e){var t;return t="",t+=print_str("\\binom{"),t+=print_expr(cadr(e)),t+=print_str("}{"),t+=print_expr(caddr(e)),t+=print_str("} "),t},print_DOT_latex=function(e){var t;return t="",t+=print_expr(cadr(e)),t+=print_str(" \\cdot "),t+=print_expr(caddr(e)),t},print_DOT_codegen=function(e){var t;return t="dot(",t+=print_expr(cadr(e)),t+=", ",t+=print_expr(caddr(e)),t+=")",t},print_SIN_codegen=function(e){var t;return t="Math.sin(",t+=print_expr(cadr(e)),t+=")",t},print_COS_codegen=function(e){var t;return t="Math.cos(",t+=print_expr(cadr(e)),t+=")",t},print_TAN_codegen=function(e){var t;return t="Math.tan(",t+=print_expr(cadr(e)),t+=")",t},print_ARCSIN_codegen=function(e){var t;return t="Math.asin(",t+=print_expr(cadr(e)),t+=")",t},print_ARCCOS_codegen=function(e){var t;return t="Math.acos(",t+=print_expr(cadr(e)),t+=")",t},print_ARCTAN_codegen=function(e){var t;return t="Math.atan(",t+=print_expr(cadr(e)),t+=")",t},print_SQRT_latex=function(e){var t;return t="",t+=print_str("\\sqrt{"),t+=print_expr(cadr(e)),t+=print_str("} "),t},print_TRANSPOSE_latex=function(e){var t;return t="",t+=print_str("{"),iscons(cadr(e))&&(t+=print_str("(")),t+=print_expr(cadr(e)),iscons(cadr(e))&&(t+=print_str(")")),t+=print_str("}"),t+=print_str("^T"),t},print_TRANSPOSE_codegen=function(e){var t;return t="",t+=print_str("transpose("),t+=print_expr(cadr(e)),t+=print_str(")"),t},print_UNIT_codegen=function(e){var t;return t="",t+=print_str("identity("),t+=print_expr(cadr(e)),t+=print_str(")"),t},print_INV_latex=function(e){var t;return t="",t+=print_str("{"),iscons(cadr(e))&&(t+=print_str("(")),t+=print_expr(cadr(e)),iscons(cadr(e))&&(t+=print_str(")")),t+=print_str("}"),t+=print_str("^{-1}"),t},print_INV_codegen=function(e){var t;return t="",t+=print_str("inv("),t+=print_expr(cadr(e)),t+=print_str(")"),t},print_DEFINT_latex=function(e){var t,r,n,s,i,a,l,u,c;for(t="",r=car(cdr(e)),e=cdr(e),a=e,i=0;iscons(cdr(cdr(e)));)i++,u=cdr(cdr(e)),t+=print_str("\\int^{"),t+=print_expr(car(cdr(u))),t+=print_str("}_{"),t+=print_expr(car(u)),t+=print_str("} \\! "),e=cdr(u);for(t+=print_expr(r),t+=print_str(" \\,"),e=a,n=s=1,l=i;1<=l?s<=l:s>=l;n=1<=l?++s:--s)c=cdr(e),t+=print_str(" \\mathrm{d} "),t+=print_expr(car(c)),n<i&&(t+=print_str(" \\, ")),e=cdr(cdr(c));return t},print_tensor=function(e){var t;return t="",t+=print_tensor_inner(e,0,0)[1],t},print_tensor_inner=function(e,t,r){var n,s,i,a,l,u,c;if(n="",n+=print_str("["),t<e.tensor.ndim-1)for(s=i=0,l=e.tensor.dim[t];0<=l?i<l:i>l;s=0<=l?++i:--i)[r,c]=print_tensor_inner(e,t+1,r),n+=c,s!==e.tensor.dim[t]-1&&(n+=print_str(","));else for(s=a=0,u=e.tensor.dim[t];0<=u?a<u:a>u;s=0<=u?++a:--a)n+=print_expr(e.tensor.elem[r]),s!==e.tensor.dim[t]-1&&(n+=print_str(",")),r++;return n+=print_str("]"),[r,n]},print_tensor_latex=function(e){var t;return t="",e.tensor.ndim<=2&&(t+=print_tensor_inner_latex(!0,e,0,0)[1]),t},print_tensor_inner_latex=function(e,t,r,n){var s,i,a,l,u,c,f;if(s="",e&&(s+="\\begin{bmatrix} "),r<t.tensor.ndim-1)for(i=a=0,u=t.tensor.dim[r];0<=u?a<u:a>u;i=0<=u?++a:--a)[n,f]=print_tensor_inner_latex(0,t,r+1,n),s+=f,i!==t.tensor.dim[r]-1&&(s+=print_str(" \\\\ "));else for(i=l=0,c=t.tensor.dim[r];0<=c?l<c:l>c;i=0<=c?++l:--l)s+=print_expr(t.tensor.elem[n]),i!==t.tensor.dim[r]-1&&(s+=print_str(" & ")),n++;return e&&(s+=" \\end{bmatrix}"),[n,s]},print_SUM_latex=function(e){var t;return t="\\sum_{",t+=print_expr(caddr(e)),t+="=",t+=print_expr(cadddr(e)),t+="}^{",t+=print_expr(caddddr(e)),t+="}{",t+=print_expr(cadr(e)),t+="}",t},print_SUM_codegen=function(e){var t,r,n,s,i;return r=cadr(e),i=caddr(e),n=cadddr(e),s=caddddr(e),t="(function(){ var "+i+";  var holderSum = 0;  var lowerlimit = "+print_expr(n)+";  var upperlimit = "+print_expr(s)+";  for ("+i+" = lowerlimit; "+i+" < upperlimit; "+i+"++) {    holderSum += "+print_expr(r)+"; }  return holderSum;})()",t},print_TEST_latex=function(e){var t;for(t="\\left\\{ \\begin{array}{ll}",e=cdr(e);iscons(e);){if(cdr(e)===symbol(NIL)){t+="{",t+=print_expr(car(e)),t+="} & otherwise ",t+=" \\\\\\\\";break}t+="{",t+=print_expr(cadr(e)),t+="} & if & ",t+=print_expr(car(e)),t+=" \\\\\\\\",e=cddr(e)}return t=t.substring(0,t.length-4),t+="\\end{array} \\right."},print_TEST_codegen=function(e){var t,r;for(t="(function(){",e=cdr(e),r=0;iscons(e);){if(cdr(e)===symbol(NIL)){t+="else {",t+="return ("+print_expr(car(e))+");",t+="}";break}r&&(t+=" else "),t+="if ("+print_expr(car(e))+"){",t+="return ("+print_expr(cadr(e))+");",t+="}",r++,e=cddr(e)}return t+="})()",t},print_TESTLT_latex=function(e){var t;return t="{",t+=print_expr(cadr(e)),t+="}",t+=" < ",t+="{",t+=print_expr(caddr(e)),t+="}"},print_TESTLE_latex=function(e){var t;return t="{",t+=print_expr(cadr(e)),t+="}",t+=" \\leq ",t+="{",t+=print_expr(caddr(e)),t+="}"},print_TESTGT_latex=function(e){var t;return t="{",t+=print_expr(cadr(e)),t+="}",t+=" > ",t+="{",t+=print_expr(caddr(e)),t+="}"},print_TESTGE_latex=function(e){var t;return t="{",t+=print_expr(cadr(e)),t+="}",t+=" \\geq ",t+="{",t+=print_expr(caddr(e)),t+="}"},print_TESTEQ_latex=function(e){var t;return t="{",t+=print_expr(cadr(e)),t+="}",t+=" = ",t+="{",t+=print_expr(caddr(e)),t+="}"},print_FOR_codegen=function(e){var t,r,n,s,i;return r=cadr(e),i=caddr(e),n=cadddr(e),s=caddddr(e),t="(function(){ var "+i+";  var lowerlimit = "+print_expr(n)+";  var upperlimit = "+print_expr(s)+";  for ("+i+" = lowerlimit; "+i+" < upperlimit; "+i+"++) {    "+print_expr(r)+" } })()",t},print_DO_codegen=function(e){var t;for(t="",e=cdr(e);iscons(e);)t+=print_expr(car(e)),e=cdr(e);return t},print_SETQ_codegen=function(e){var t;return t="",t+=print_expr(cadr(e)),t+=" = ",t+=print_expr(caddr(e)),t+="; ",t},print_PRODUCT_latex=function(e){var t;return t="\\prod_{",t+=print_expr(caddr(e)),t+="=",t+=print_expr(cadddr(e)),t+="}^{",t+=print_expr(caddddr(e)),t+="}{",t+=print_expr(cadr(e)),t+="}",t},print_PRODUCT_codegen=function(e){var t,r,n,s,i;return r=cadr(e),i=caddr(e),n=cadddr(e),s=caddddr(e),t="(function(){ var "+i+";  var holderProduct = 1;  var lowerlimit = "+print_expr(n)+";  var upperlimit = "+print_expr(s)+";  for ("+i+" = lowerlimit; "+i+" < upperlimit; "+i+"++) {    holderProduct *= "+print_expr(r)+"; }  return holderProduct;})()",t},print_power=function(e,t){var r,n,s,i;if(r="",DEBUG&&console.log("power base: "+e+"  exponent: "+t),isoneovertwo(t))if(equaln(e,2)){if(codeGen)return r+=print_str("Math.SQRT2"),r}else{if(printMode===PRINTMODE_LATEX)return r+=print_str("\\sqrt{"),r+=print_expr(e),r+=print_str("}"),r;if(codeGen)return r+=print_str("Math.sqrt("),r+=print_expr(e),r+=print_str(")"),r}if(equaln(get_binding(symbol(PRINT_LEAVE_E_ALONE)),1)&&e===symbol(E))return codeGen?(r+=print_str("Math.exp("),r+=print_expo_of_denom(t),r+=print_str(")"),r):(printMode===PRINTMODE_LATEX?(r+=print_str("e^{"),r+=print_expr(t),r+=print_str("}")):(r+=print_str("exp("),r+=print_expr(t),r+=print_str(")")),r);if(codeGen)return r+=print_str("Math.pow("),r+=print_base_of_denom(e),r+=print_str(", "),r+=print_expo_of_denom(t),r+=print_str(")"),r;if(equaln(get_binding(symbol(PRINT_LEAVE_X_ALONE)),0)||e.printname!=="x"){if(e!==symbol(E)){if(isminusone(t))return printMode===PRINTMODE_LATEX?r+=print_str("\\frac{1}{"):printMode===PRINTMODE_HUMAN&&!test_flag?r+=print_str("1 / "):r+=print_str("1/"),iscons(e)&&printMode!==PRINTMODE_LATEX?(r+=print_str("("),r+=print_expr(e),r+=print_str(")")):r+=print_expr(e),printMode===PRINTMODE_LATEX&&(r+=print_str("}")),r;if(isnegativeterm(t))return printMode===PRINTMODE_LATEX?r+=print_str("\\frac{1}{"):printMode===PRINTMODE_HUMAN&&!test_flag?r+=print_str("1 / "):r+=print_str("1/"),push(t),push_integer(-1),multiply(),s=pop(),iscons(e)&&printMode!==PRINTMODE_LATEX?(r+=print_str("("),r+=print_power(e,s),r+=print_str(")")):r+=print_power(e,s),printMode===PRINTMODE_LATEX&&(r+=print_str("}")),r}if(isfraction(t)&&printMode===PRINTMODE_LATEX)return r+=print_str("\\sqrt"),push(t),denominator(),n=pop(),isplustwo(n)||(r+=print_str("["),r+=print_expr(n),r+=print_str("]")),r+=print_str("{"),push(t),numerator(),i=pop(),t=i,r+=print_power(e,t),r+=print_str("}"),r}return printMode===PRINTMODE_LATEX&&isplusone(t)?r+=print_expr(e):(isadd(e)||isnegativenumber(e)?(r+=print_str("("),r+=print_expr(e),r+=print_str(")")):car(e)===symbol(MULTIPLY)||car(e)===symbol(POWER)?(printMode!==PRINTMODE_LATEX&&(r+=print_str("(")),r+=print_factor(e,!0),printMode!==PRINTMODE_LATEX&&(r+=print_str(")"))):isNumericAtom(e)&&(lessp(e,zero)||isfraction(e))?(r+=print_str("("),r+=print_factor(e),r+=print_str(")")):r+=print_factor(e),printMode===PRINTMODE_HUMAN&&!test_flag?r+=print_str(power_str):r+=print_str("^"),printMode===PRINTMODE_LATEX?print_expr(t).length>1?(r+=print_str("{"),r+=print_expr(t),r+=print_str("}")):r+=print_expr(t):iscons(t)||isfraction(t)||isNumericAtom(t)&&lessp(t,zero)?(r+=print_str("("),r+=print_expr(t),r+=print_str(")")):r+=print_factor(t)),r},print_index_function=function(e){var t;if(t="",e=cdr(e),caar(e)===symbol(ADD)||caar(e)===symbol(MULTIPLY)||caar(e)===symbol(POWER)||caar(e)===symbol(FACTORIAL)?t+=print_subexpr(car(e)):t+=print_expr(car(e)),t+=print_str("["),e=cdr(e),iscons(e))for(t+=print_expr(car(e)),e=cdr(e);iscons(e);)t+=print_str(","),t+=print_expr(car(e)),e=cdr(e);return t+=print_str("]"),t},print_factor=function(e,t,r){var n,s,i,a,l,u;if(n="",isNumericAtom(e))return r&&lessp(e,zero)&&(n+="("),n+=print_number(e,r),r&&lessp(e,zero)&&(n+=")"),n;if(isstr(e))return n+=print_str('"'),n+=print_str(e.str),n+=print_str('"'),n;if(istensor(e))return printMode===PRINTMODE_LATEX?n+=print_tensor_latex(e):n+=print_tensor(e),n;if(car(e)===symbol(MULTIPLY))return t||(sign_of_term(e)==="-"||printMode!==PRINTMODE_LATEX)&&(printMode===PRINTMODE_LATEX?n+=print_str(" \\left ("):n+=print_str("(")),n+=print_expr(e),t||(sign_of_term(e)==="-"||printMode!==PRINTMODE_LATEX)&&(printMode===PRINTMODE_LATEX?n+=print_str(" \\right ) "):n+=print_str(")")),n;if(isadd(e))return t||(n+=print_str("(")),n+=print_expr(e),t||(n+=print_str(")")),n;if(car(e)===symbol(POWER))return s=cadr(e),i=caddr(e),n+=print_power(s,i),n;if(car(e)===symbol(FUNCTION))return a=cadr(e),codeGen||(l=caddr(e),n+=print_str("function "),DEBUG&&console.log("emittedString from print_factor "+stringsEmittedByUserPrintouts),u=print_list(l),n+=u,n+=print_str(" -> ")),n+=print_expr(a),n;if(car(e)===symbol(PATTERN))return n+=print_expr(caadr(e)),printMode===PRINTMODE_LATEX?n+=print_str(" \\rightarrow "):printMode===PRINTMODE_HUMAN&&!test_flag?n+=print_str(" -> "):n+=print_str("->"),n+=print_expr(car(cdr(cadr(e)))),n;if(car(e)===symbol(INDEX)&&issymbol(cadr(e)))return n+=print_index_function(e),n;if(car(e)===symbol(FACTORIAL))return n+=print_factorial_function(e),n;if(car(e)===symbol(ABS)&&printMode===PRINTMODE_LATEX)return n+=print_ABS_latex(e),n;if(car(e)===symbol(SQRT)&&printMode===PRINTMODE_LATEX)return n+=print_SQRT_latex(e),n;if(car(e)===symbol(TRANSPOSE)){if(printMode===PRINTMODE_LATEX)return n+=print_TRANSPOSE_latex(e),n;if(codeGen)return n+=print_TRANSPOSE_codegen(e),n}else if(car(e)===symbol(UNIT)){if(codeGen)return n+=print_UNIT_codegen(e),n}else if(car(e)===symbol(INV)){if(printMode===PRINTMODE_LATEX)return n+=print_INV_latex(e),n;if(codeGen)return n+=print_INV_codegen(e),n}else{if(car(e)===symbol(BINOMIAL)&&printMode===PRINTMODE_LATEX)return n+=print_BINOMIAL_latex(e),n;if(car(e)===symbol(DEFINT)&&printMode===PRINTMODE_LATEX)return n+=print_DEFINT_latex(e),n;if(isinnerordot(e)){if(printMode===PRINTMODE_LATEX)return n+=print_DOT_latex(e),n;if(codeGen)return n+=print_DOT_codegen(e),n}else if(car(e)===symbol(SIN)){if(codeGen)return n+=print_SIN_codegen(e),n}else if(car(e)===symbol(COS)){if(codeGen)return n+=print_COS_codegen(e),n}else if(car(e)===symbol(TAN)){if(codeGen)return n+=print_TAN_codegen(e),n}else if(car(e)===symbol(ARCSIN)){if(codeGen)return n+=print_ARCSIN_codegen(e),n}else if(car(e)===symbol(ARCCOS)){if(codeGen)return n+=print_ARCCOS_codegen(e),n}else if(car(e)===symbol(ARCTAN)){if(codeGen)return n+=print_ARCTAN_codegen(e),n}else if(car(e)===symbol(SUM)){if(printMode===PRINTMODE_LATEX)return n+=print_SUM_latex(e),n;if(codeGen)return n+=print_SUM_codegen(e),n}else if(car(e)===symbol(PRODUCT)){if(printMode===PRINTMODE_LATEX)return n+=print_PRODUCT_latex(e),n;if(codeGen)return n+=print_PRODUCT_codegen(e),n}else if(car(e)===symbol(FOR)){if(codeGen)return n+=print_FOR_codegen(e),n}else if(car(e)===symbol(DO)){if(codeGen)return n+=print_DO_codegen(e),n}else if(car(e)===symbol(TEST)){if(codeGen)return n+=print_TEST_codegen(e),n;if(printMode===PRINTMODE_LATEX)return n+=print_TEST_latex(e),n}else if(car(e)===symbol(TESTLT)){if(codeGen)return n+="(("+print_expr(cadr(e))+") < ("+print_expr(caddr(e))+"))",n;if(printMode===PRINTMODE_LATEX)return n+=print_TESTLT_latex(e),n}else if(car(e)===symbol(TESTLE)){if(codeGen)return n+="(("+print_expr(cadr(e))+") <= ("+print_expr(caddr(e))+"))",n;if(printMode===PRINTMODE_LATEX)return n+=print_TESTLE_latex(e),n}else if(car(e)===symbol(TESTGT)){if(codeGen)return n+="(("+print_expr(cadr(e))+") > ("+print_expr(caddr(e))+"))",n;if(printMode===PRINTMODE_LATEX)return n+=print_TESTGT_latex(e),n}else if(car(e)===symbol(TESTGE)){if(codeGen)return n+="(("+print_expr(cadr(e))+") >= ("+print_expr(caddr(e))+"))",n;if(printMode===PRINTMODE_LATEX)return n+=print_TESTGE_latex(e),n}else if(car(e)===symbol(TESTEQ)){if(codeGen)return n+="(("+print_expr(cadr(e))+") === ("+print_expr(caddr(e))+"))",n;if(printMode===PRINTMODE_LATEX)return n+=print_TESTEQ_latex(e),n}else if(car(e)===symbol(FLOOR)){if(codeGen)return n+="Math.floor("+print_expr(cadr(e))+")",n;if(printMode===PRINTMODE_LATEX)return n+=" \\lfloor {"+print_expr(cadr(e))+"} \\rfloor ",n}else if(car(e)===symbol(CEILING)){if(codeGen)return n+="Math.ceiling("+print_expr(cadr(e))+")",n;if(printMode===PRINTMODE_LATEX)return n+=" \\lceil {"+print_expr(cadr(e))+"} \\rceil ",n}else if(car(e)===symbol(ROUND)){if(codeGen)return n+="Math.round("+print_expr(cadr(e))+")",n}else if(car(e)===symbol(SETQ))return codeGen?(n+=print_SETQ_codegen(e),n):(n+=print_expr(cadr(e)),n+=print_str("="),n+=print_expr(caddr(e)),n)}if(iscons(e)){if(n+=print_factor(car(e)),e=cdr(e),t||(n+=print_str("(")),iscons(e))for(n+=print_expr(car(e)),e=cdr(e);iscons(e);)n+=print_str(","),n+=print_expr(car(e)),e=cdr(e);return t||(n+=print_str(")")),n}return e===symbol(DERIVATIVE)?n+=print_char("d"):e===symbol(E)?codeGen?n+=print_str("Math.E"):n+=print_str("e"):e===symbol(PI)?printMode===PRINTMODE_LATEX?n+=print_str("\\pi"):n+=print_str("pi"):n+=print_str(get_printname(e)),n},print_list=function(e){var t;switch(t="",e.k){case CONS:if(t+="(",t+=print_list(car(e)),e===cdr(e)&&e!==symbol(NIL)){console.log("oh no recursive!");debugger}for(e=cdr(e);iscons(e);)if(t+=" ",t+=print_list(car(e)),e=cdr(e),e===cdr(e)&&e!==symbol(NIL)){console.log("oh no recursive!");debugger}e!==symbol(NIL)&&(t+=" . ",t+=print_list(e)),t+=")";break;case STR:t+=e.str;break;case NUM:case DOUBLE:t+=print_number(e,!0);break;case SYM:t+=get_printname(e);break;default:t+="<tensor>"}return t},print_multiply_sign=function(){var e;if(e="",printMode===PRINTMODE_LATEX)if(printMode===PRINTMODE_HUMAN&&!test_flag)e+=print_str(" ");else return e;return printMode===PRINTMODE_HUMAN&&!test_flag&&!codeGen?e+=print_str(" "):e+=print_str("*"),e},is_denominator=function(e){return car(e)===symbol(POWER)&&cadr(e)!==symbol(E)&&isnegativeterm(caddr(e))?1:0},any_denominators=function(e){var t;for(e=cdr(e);iscons(e);){if(t=car(e),is_denominator(t))return 1;e=cdr(e)}return 0},YMAX=1e4,glyph=(function(){class e{}return e.prototype.c=0,e.prototype.x=0,e.prototype.y=0,e}).call(this),chartab=[],charTabIndex=i1=0,ref1=YMAX;0<=ref1?i1<ref1:i1>ref1;charTabIndex=0<=ref1?++i1:--i1)chartab[charTabIndex]=new glyph;for(yindex=0,level=0,emit_x=0,expr_level=0,printchar_nowrap=function(e){var t;return t="",t+=e,t},printchar=function(e){return printchar_nowrap(e)},print2dascii=function(e){var t,r,n,s;if(r=0,n=0,s=0,save(),yindex=0,level=0,emit_x=0,emit_top_expr(e),[r,n,s]=get_size(0,yindex),n>100){printline(e),restore();return}return t=print_glyphs(),restore(),t},emit_top_expr=function(e){if(car(e)===symbol(SETQ)){emit_expr(cadr(e)),__emit_str(" = "),emit_expr(caddr(e));return}return istensor(e)?emit_tensor(e):emit_expr(e)},will_be_displayed_as_fraction=function(e){if(level>0)return 0;if(isfraction(e))return 1;if(car(e)!==symbol(MULTIPLY))return 0;if(isfraction(cadr(e)))return 1;for(;iscons(e);){if(isdenominator(car(e)))return 1;e=cdr(e)}return 0},emit_expr=function(e){if(expr_level++,car(e)===symbol(ADD))for(e=cdr(e),__is_negative(car(e))&&(__emit_char("-"),will_be_displayed_as_fraction(car(e))&&__emit_char(" ")),emit_term(car(e)),e=cdr(e);iscons(e);)__is_negative(car(e))?(__emit_char(" "),__emit_char("-"),__emit_char(" ")):(__emit_char(" "),__emit_char("+"),__emit_char(" ")),emit_term(car(e)),e=cdr(e);else __is_negative(e)&&(__emit_char("-"),will_be_displayed_as_fraction(e)&&__emit_char(" ")),emit_term(e);return expr_level--},emit_unsigned_expr=function(e){var t;if(car(e)===symbol(ADD)){for(e=cdr(e),emit_term(car(e)),e=cdr(e),t=[];iscons(e);)__is_negative(car(e))?(__emit_char(" "),__emit_char("-"),__emit_char(" ")):(__emit_char(" "),__emit_char("+"),__emit_char(" ")),emit_term(car(e)),t.push(e=cdr(e));return t}else return emit_term(e)},__is_negative=function(e){return isnegativenumber(e)||car(e)===symbol(MULTIPLY)&&isnegativenumber(cadr(e))?1:0},emit_term=function(e){var t;return car(e)===symbol(MULTIPLY)?(t=count_denominators(e),t&&level===0?emit_fraction(e,t):emit_multiply(e,t)):emit_factor(e)},isdenominator=function(e){return car(e)===symbol(POWER)&&cadr(e)!==symbol(E)&&__is_negative(caddr(e))?1:0},count_denominators=function(e){var t,r;for(t=0,e=cdr(e);iscons(e);)r=car(e),isdenominator(r)&&t++,e=cdr(e);return t},emit_multiply=function(e,t){var r;if(t===0){for(e=cdr(e),(isplusone(car(e))||isminusone(car(e)))&&(e=cdr(e)),emit_factor(car(e)),e=cdr(e),r=[];iscons(e);)__emit_char(" "),emit_factor(car(e)),r.push(e=cdr(e));return r}else return emit_numerators(e),__emit_char("/"),t>1||isfraction(cadr(e))?(__emit_char("("),emit_denominators(e),__emit_char(")")):emit_denominators(e)},emit_fraction=function(e,t){var r,n,s,i,a;for(r=0,n=0,s=0,i=0,a=0,save(),p3=one,p4=one,isrational(cadr(e))&&(push(cadr(e)),mp_numerator(),absval(),p3=pop(),push(cadr(e)),mp_denominator(),p4=pop()),isdouble(cadr(e))&&(push(cadr(e)),absval(),p3=pop()),isplusone(p3)?i=0:i=1,p1=cdr(e),isNumericAtom(car(p1))&&(p1=cdr(p1));iscons(p1);)p2=car(p1),isdenominator(p2)||i++,p1=cdr(p1);for(a=emit_x,n=yindex,r=0,isplusone(p3)||(emit_number(p3,0),r++),p1=cdr(e),isNumericAtom(car(p1))&&(p1=cdr(p1));iscons(p1);)p2=car(p1),isdenominator(p2)||(r>0&&__emit_char(" "),i===1?emit_expr(p2):emit_factor(p2),r++),p1=cdr(p1);for(r===0&&__emit_char("1"),s=yindex,r=0,isplusone(p4)||(emit_number(p4,0),r++,t++),p1=cdr(e),isrational(car(p1))&&(p1=cdr(p1));iscons(p1);)p2=car(p1),isdenominator(p2)&&(r>0&&__emit_char(" "),emit_denominator(p2,t),r++),p1=cdr(p1);return fixup_fraction(a,n,s),restore()},emit_numerators=function(e){var t;for(save(),t=0,p1=one,e=cdr(e),isrational(car(e))?(push(car(e)),mp_numerator(),absval(),p1=pop(),e=cdr(e)):isdouble(car(e))&&(push(car(e)),absval(),p1=pop(),e=cdr(e)),t=0,isplusone(p1)||(emit_number(p1,0),t++);iscons(e);)isdenominator(car(e))||(t>0&&__emit_char(" "),emit_factor(car(e)),t++),e=cdr(e);return t===0&&__emit_char("1"),restore()},emit_denominators=function(e){var t;for(save(),t=0,e=cdr(e),isfraction(car(e))&&(push(car(e)),mp_denominator(),p1=pop(),emit_number(p1,0),t++,e=cdr(e));iscons(e);)isdenominator(car(e))&&(t>0&&__emit_char(" "),emit_denominator(car(e),0),t++),e=cdr(e);return restore()},emit_factor=function(e){if(istensor(e)){emit_flat_tensor(e);return}if(isdouble(e)){emit_number(e,0);return}if(car(e)===symbol(ADD)||car(e)===symbol(MULTIPLY)){emit_subexpr(e);return}if(car(e)===symbol(POWER)){emit_power(e);return}if(iscons(e)){emit_function(e);return}if(isNumericAtom(e)){level===0?emit_numerical_fraction(e):emit_number(e,0);return}if(issymbol(e)){emit_symbol(e);return}isstr(e)&&emit_string(e)},emit_numerical_fraction=function(e){var t,r,n;if(t=0,r=0,n=0,save(),push(e),mp_numerator(),absval(),p3=pop(),push(e),mp_denominator(),p4=pop(),isplusone(p4)){emit_number(p3,0),restore();return}return n=emit_x,t=yindex,emit_number(p3,0),r=yindex,emit_number(p4,0),fixup_fraction(n,t,r),restore()},isfactor=function(e){return iscons(e)&&car(e)!==symbol(ADD)&&car(e)!==symbol(MULTIPLY)&&car(e)!==symbol(POWER)||issymbol(e)?1:isfraction(e)||isnegativenumber(e)?0:isNumericAtom(e)?1:0},emit_power=function(e){var t,r,n;if(t=0,r=0,n=0,cadr(e)===symbol(E)){__emit_str("exp("),emit_expr(caddr(e)),__emit_char(")");return}if(level>0){isminusone(caddr(e))?(__emit_char("1"),__emit_char("/"),isfactor(cadr(e))?emit_factor(cadr(e)):emit_subexpr(cadr(e))):(isfactor(cadr(e))?emit_factor(cadr(e)):emit_subexpr(cadr(e)),__emit_char("^"),isfactor(caddr(e))?emit_factor(caddr(e)):emit_subexpr(caddr(e)));return}if(__is_negative(caddr(e))){n=emit_x,t=yindex,__emit_char("1"),r=yindex,emit_denominator(e,1),fixup_fraction(n,t,r);return}return t=yindex,isfactor(cadr(e))?emit_factor(cadr(e)):emit_subexpr(cadr(e)),r=yindex,level++,emit_expr(caddr(e)),level--,fixup_power(t,r)},emit_denominator=function(e,t){var r,n;if(r=0,n=0,isminusone(caddr(e))){t===1?emit_expr(cadr(e)):emit_factor(cadr(e));return}return r=yindex,isfactor(cadr(e))?emit_factor(cadr(e)):emit_subexpr(cadr(e)),n=yindex,level++,emit_unsigned_expr(caddr(e)),level--,fixup_power(r,n)},emit_function=function(e){if(car(e)===symbol(INDEX)&&issymbol(cadr(e))){emit_index_function(e);return}if(car(e)===symbol(FACTORIAL)){emit_factorial_function(e);return}if(car(e)===symbol(DERIVATIVE)?__emit_char("d"):emit_symbol(car(e)),__emit_char("("),e=cdr(e),iscons(e))for(emit_expr(car(e)),e=cdr(e);iscons(e);)__emit_char(","),emit_expr(car(e)),e=cdr(e);return __emit_char(")")},emit_index_function=function(e){if(e=cdr(e),caar(e)===symbol(ADD)||caar(e)===symbol(MULTIPLY)||caar(e)===symbol(POWER)||caar(e)===symbol(FACTORIAL)?emit_subexpr(car(e)):emit_expr(car(e)),__emit_char("["),e=cdr(e),iscons(e))for(emit_expr(car(e)),e=cdr(e);iscons(e);)__emit_char(","),emit_expr(car(e)),e=cdr(e);return __emit_char("]")},emit_factorial_function=function(e){return e=cadr(e),isfraction(e)||car(e)===symbol(ADD)||car(e)===symbol(MULTIPLY)||car(e)===symbol(POWER)||car(e)===symbol(FACTORIAL)?emit_subexpr(e):emit_expr(e),__emit_char("!")},emit_subexpr=function(e){return __emit_char("("),emit_expr(e),__emit_char(")")},emit_symbol=function(e){var t,r,n,s,i;if(t=0,e===symbol(E)){__emit_str("exp(1)");return}for(n=get_printname(e),i=[],t=r=0,s=n.length;0<=s?r<s:r>s;t=0<=s?++r:--r)i.push(__emit_char(n[t]));return i},emit_string=function(e){var t,r,n,s;for(t=0,n=e.str,__emit_char('"'),t=r=0,s=n.length;0<=s?r<s:r>s;t=0<=s?++r:--r)__emit_char(n[t]);return __emit_char('"')},fixup_fraction=function(e,t,r){var n,s,i,a,l,u,c,f,d,m,g,S,y;for(n=0,s=0,f=0,g=0,i=0,d=0,S=0,a=0,m=0,y=0,[i,d,S]=get_size(t,r),[a,m,y]=get_size(r,yindex),m>d?n=(m-d)/2:n=0,n++,g=S+i-1,s=-g-1,move(t,r,n,s),m>d?n=-d:n=-d+(d-m)/2,n++,s=-y+1,move(r,yindex,n,s),m>d?f=m:f=d,f+=2,emit_x=e,c=[],l=0,u=f;0<=u?l<u:l>u;0<=u?++l:--l)c.push(__emit_char("-"));return c},fixup_power=function(e,t){var r,n,s,i,a,l,u;return r=0,n=0,i=0,l=0,s=0,a=0,u=0,[n,i,l]=get_size(e,t),[s,a,u]=get_size(t,yindex),r=-u-s+1,r+=l-1,move(t,yindex,0,r)},move=function(e,t,r,n){var s,i,a,l,u;for(s=0,u=[],s=i=a=e,l=t;a<=l?i<l:i>l;s=a<=l?++i:--i)chartab[s].x+=r,u.push(chartab[s].y+=n);return u},get_size=function(e,t){var r,n,s,i,a,l,u,c,f,d,m;for(n=0,l=chartab[e].x,i=chartab[e].x,u=chartab[e].y,a=chartab[e].y,n=s=c=e+1,f=t;c<=f?s<f:s>f;n=c<=f?++s:--s)chartab[n].x<l&&(l=chartab[n].x),chartab[n].x>i&&(i=chartab[n].x),chartab[n].y<u&&(u=chartab[n].y),chartab[n].y>a&&(a=chartab[n].y);return r=a-u+1,d=i-l+1,m=u,[r,d,m]},__emit_char=function(e){if(yindex!==YMAX){if(chartab[yindex]==null)debugger;return chartab[yindex].c=e,chartab[yindex].x=emit_x,chartab[yindex].y=0,yindex++,emit_x++}},__emit_str=function(e){var t,r,n,s;for(t=0,s=[],t=r=0,n=e.length;0<=n?r<n:r>n;t=0<=n?++r:--r)s.push(__emit_char(e[t]));return s},emit_number=function(e,t){var r,n,s,i,a,l,u,c,f,d;switch(d="",r=0,e.k){case NUM:for(d=e.q.a.toString(),d[0]==="-"&&t===0&&(d=d.substring(1)),r=n=0,a=d.length;0<=a?n<a:n>a;r=0<=a?++n:--n)__emit_char(d[r]);if(d=e.q.b.toString(),d==="1")break;for(__emit_char("/"),c=[],r=s=0,l=d.length;0<=l?s<l:s>l;r=0<=l?++s:--s)c.push(__emit_char(d[r]));return c;case DOUBLE:for(d=doubleToReasonableString(e.d),d[0]==="-"&&t===0&&(d=d.substring(1)),f=[],r=i=0,u=d.length;0<=u?i<u:i>u;r=0<=u?++i:--i)f.push(__emit_char(d[r]));return f}},cmpGlyphs=function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0},print_glyphs=function(){var e,t,r,n,s,i,a;for(t=0,e="",s=chartab.slice(0,yindex),s.sort(cmpGlyphs),chartab=[].concat(s).concat(chartab.slice(yindex)),i=0,a=chartab[0].y,t=r=0,n=yindex;0<=n?r<n:r>n;t=0<=n?++r:--r){for(;chartab[t].y>a;)e+=printchar(`
`),i=0,a++;for(;chartab[t].x>i;)e+=printchar_nowrap(" "),i++;e+=printchar_nowrap(chartab[t].c),i++}return e},N=100,oneElement=(function(){class e{}return e.prototype.x=0,e.prototype.y=0,e.prototype.h=0,e.prototype.w=0,e.prototype.index=0,e.prototype.count=0,e}).call(this),elem=[],elelmIndex=j1=0;j1<1e4;elelmIndex=++j1)elem[elelmIndex]=new oneElement;SPACE_BETWEEN_COLUMNS=3,SPACE_BETWEEN_ROWS=1,emit_tensor=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te;if(l=0,f=0,g=0,m=0,H=0,te=0,a=0,B=0,r=0,n=0,s=0,i=0,C=0,t=0,e.tensor.ndim>2){emit_flat_tensor(e);return}if(g=e.tensor.dim[0],e.tensor.ndim===2?m=e.tensor.dim[1]:m=1,f=g*m,f>N){emit_flat_tensor(e);return}for(H=emit_x,l=u=0,y=f;0<=y?u<y:u>y;l=0<=y?++u:--u)elem[l].index=yindex,elem[l].x=emit_x,emit_expr(e.tensor.elem[l]),elem[l].count=yindex-elem[l].index,[elem[l].h,elem[l].w,elem[l].y]=get_size(elem[l].index,yindex);for(s=0,i=0,l=c=0,R=f;0<=R?c<R:c>R;l=0<=R?++c:--c)elem[l].h>s&&(s=elem[l].h),elem[l].w>i&&(i=elem[l].w);for(a=g*s+(g-1)*SPACE_BETWEEN_ROWS,B=m*i+(m-1)*SPACE_BETWEEN_COLUMNS,te=-(a/2),C=d=0,w=g;0<=w?d<w:d>w;C=0<=w?++d:--d)for(t=S=0,P=m;0<=P?S<P:S>P;t=0<=P?++S:--S)l=C*m+t,r=H-elem[l].x,n=te-elem[l].y,move(elem[l].index,elem[l].index+elem[l].count,r,n),r=0,t>0&&(r=t*(i+SPACE_BETWEEN_COLUMNS)),n=0,C>0&&(n=C*(s+SPACE_BETWEEN_ROWS)),r+=(i-elem[l].w)/2,n+=(s-elem[l].h)/2,move(elem[l].index,elem[l].index+elem[l].count,r,n);return emit_x=H+B},emit_flat_tensor=function(e){return emit_tensor_inner(e,0,0)},emit_tensor_inner=function(e,t,r){var n,s,i;for(n=0,__emit_char("("),n=s=0,i=e.tensor.dim[t];0<=i?s<i:s>i;n=0<=i?++s:--s)t+1===e.tensor.ndim?(emit_expr(e.tensor.elem[r]),r=r+1):r=emit_tensor_inner(e,t+1,r),n+1<e.tensor.dim[t]&&__emit_char(",");return __emit_char(")"),r},Eval_product=function(){var e,t,r,n,s,i,a,l,u;if(t=0,n=0,s=0,e=cadr(p1),r=caddr(p1),issymbol(r)||stop("sum: 2nd arg?"),push(cadddr(p1)),Eval(),n=pop_integer(),isNaN(n)){push(p1);return}if(push(caddddr(p1)),Eval(),s=pop_integer(),isNaN(s)){push(p1);return}for(a=get_binding(r),push_integer(1),t=i=l=n,u=s;l<=u?i<=u:i>=u;t=l<=u?++i:--i)push_integer(t),p5=pop(),set_binding(r,p5),push(e),Eval(),DEBUG&&(console.log("product - factor 1: "+stack[tos-1].toString()),console.log("product - factor 2: "+stack[tos-2].toString())),multiply(),DEBUG&&console.log("product - result: "+stack[tos-1].toString());return set_binding(r,a)},qadd=function(){var e,t,r,n,s,i,a,l;if(i=pop(),s=pop(),t=mmul(s.q.a,i.q.b),r=mmul(s.q.b,i.q.a),a=madd(t,r),MZERO(a)){push(zero);return}return n=mmul(s.q.b,i.q.b),e=mgcd(a,n),e=makeSignSameAs(e,n),l=new U,l.k=NUM,l.q.a=mdiv(a,e),l.q.b=mdiv(n,e),push(l)},qdiv=function(){var e,t,r;if(save(),p2=pop(),p1=pop(),MZERO(p2.q.a)&&stop("divide by zero"),MZERO(p1.q.a)){push(zero),restore();return}return e=mmul(p1.q.a,p2.q.b),t=mmul(p1.q.b,p2.q.a),r=mgcd(e,t),r=makeSignSameAs(r,t),p1=new U,p1.k=NUM,p1.q.a=mdiv(e,r),p1.q.b=mdiv(t,r),push(p1),restore()},qmul=function(){var e,t,r;if(save(),p2=pop(),p1=pop(),MZERO(p1.q.a)||MZERO(p2.q.a)){push(zero),restore();return}return e=mmul(p1.q.a,p2.q.a),t=mmul(p1.q.b,p2.q.b),r=mgcd(e,t),r=makeSignSameAs(r,t),p1=new U,p1.k=NUM,p1.q.a=mdiv(e,r),p1.q.b=mdiv(t,r),push(p1),restore()},qpow=function(){return save(),qpowf(),restore()},qpowf=function(){var e,t,r,n,s,i;if(r=0,p2=pop(),p1=pop(),isplusone(p1)||isZeroAtomOrTensor(p2)){push_integer(1);return}if(isminusone(p1)&&isoneovertwo(p2)){push(imaginaryunit);return}if(isZeroAtomOrTensor(p1)){isnegativenumber(p2)&&stop("divide by zero"),push(zero);return}if(isplusone(p2)){push(p1);return}if(isinteger(p2)){if(push(p2),r=pop_integer(),isNaN(r)){push_symbol(POWER),push(p1),push(p2),list(3);return}s=mpow(p1.q.a,Math.abs(r)),i=mpow(p1.q.b,Math.abs(r)),r<0&&(n=s,s=i,i=n,s=makeSignSameAs(s,i),i=makePositive(i)),p3=new U,p3.k=NUM,p3.q.a=s,p3.q.b=i,push(p3);return}if(isminusone(p1)){push(p2),normalize_angle();return}if(isnegativenumber(p1)){push(p1),negate(),push(p2),qpow(),push_integer(-1),push(p2),qpow(),multiply();return}if(!isinteger(p1)){push(p1),mp_numerator(),push(p2),qpow(),push(p1),mp_denominator(),push(p2),negate(),qpow(),multiply();return}if(is_small_integer(p1)){push(p1),push(p2),quickfactor();return}if(!isSmall(p2.q.a)||!isSmall(p2.q.b)){push_symbol(POWER),push(p1),push(p2),list(3);return}if(e=p2.q.a,t=p2.q.b,s=mroot(p1.q.a,t),s===0){push_symbol(POWER),push(p1),push(p2),list(3);return}return i=mpow(s,e),p3=new U,p3.k=NUM,p2.q.a.isNegative()?(p3.q.a=bigInt(1),p3.q.b=i):(p3.q.a=i,p3.q.b=bigInt(1)),push(p3)},normalize_angle=function(){if(save(),p1=pop(),isinteger(p1)){p1.q.a.isOdd()?push_integer(-1):push_integer(1),restore();return}return push(p1),bignum_truncate(),p2=pop(),isnegativenumber(p1)&&(push(p2),push_integer(-1),add(),p2=pop()),push(p1),push(p2),subtract(),p3=pop(),push_symbol(POWER),push_integer(-1),push(p3),list(3),p2.q.a.isOdd()&&negate(),restore()},is_small_integer=function(e){return isSmall(e.q.a)},quickfactor=function(){var e,t,r,n,s,i;for(t=0,save(),p2=pop(),p1=pop(),e=tos,push(p1),factor_small_number(),n=tos-e,i=e,t=r=0,s=n;r<s;t=r+=2)push(stack[i+t]),push(stack[i+t+1]),push(p2),multiply(),quickpower();return multiply_all(tos-e-n),p1=pop(),moveTos(e),push(p1),restore()},quickpower=function(){var e;if(e=0,save(),p2=pop(),p1=pop(),push(p2),bignum_truncate(),p3=pop(),push(p2),push(p3),subtract(),p4=pop(),isZeroAtomOrTensor(p4)||(push_symbol(POWER),push(p1),push(p4),list(3)),push(p3),e=pop_integer(),isNaN(e)){push_symbol(POWER),push(p1),push(p3),list(3),restore();return}if(e===0){restore();return}return push(p1),bignum_power_number(e),restore()},Eval_quotient=function(){return push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),push(cadddr(p1)),Eval(),p1=pop(),p1===symbol(NIL)&&(p1=symbol(SYMBOL_X)),push(p1),divpoly()},divpoly=function(){var e,t,r,n,s,i,a,l,u;for(r=0,n=0,i=0,a=0,u=0,save(),p3=pop(),p2=pop(),p1=pop(),r=tos,e=tos,i=coeff(p3,p1)-1,t=tos,a=coeff(p3,p2)-1,u=i-a,push_integer(0),p5=pop();u>=0;){for(push(stack[e+i]),push(stack[t+a]),divide(),p4=pop(),n=s=0,l=a;0<=l?s<=l:s>=l;n=0<=l?++s:--s)push(stack[e+u+n]),push(stack[t+n]),push(p4),multiply(),subtract(),stack[e+u+n]=pop();push(p5),push(p4),push(p3),push_integer(u),power(),multiply(),add(),p5=pop(),i--,u--}return moveTos(r),push(p5),restore()},DEBUG_RATIONALIZE=!1,Eval_rationalize=function(){return push(cadr(p1)),Eval(),rationalize()},rationalize=function(){var e;return e=expanding,yyrationalize(),expanding=e},yyrationalize=function(){var e,t,r;if(r=pop(),istensor(r)){__rationalize_tensor(r);return}if(expanding=0,car(r)!==symbol(ADD)){push(r);return}for(DEBUG_RATIONALIZE&&console.log("rationalize: this is the input expr: "+r),push(one),multiply_denominators(r),e=pop(),DEBUG_RATIONALIZE&&console.log("rationalize: this is the new denominator: "+e),push(zero),t=cdr(r);iscons(t);)DEBUG_RATIONALIZE&&console.log("term: "+car(t)),push(e),push(car(t)),multiply(),add(),t=cdr(t);if(DEBUG_RATIONALIZE&&console.log("rationalize: original terms times new denominator: "+stack[tos-1]),Condense(),DEBUG_RATIONALIZE&&console.log("rationalize: after factoring: "+stack[tos-1]),push(e),divide(),DEBUG_RATIONALIZE)return console.log("rationalize: after dividing by new denom. (and we're done): "+stack[tos-1])},multiply_denominators=function(e){var t;if(car(e)===symbol(ADD)){for(e=cdr(e),t=[];iscons(e);)multiply_denominators_term(car(e)),t.push(e=cdr(e));return t}else return multiply_denominators_term(e)},multiply_denominators_term=function(e){var t;if(car(e)===symbol(MULTIPLY)){for(e=cdr(e),t=[];iscons(e);)multiply_denominators_factor(car(e)),t.push(e=cdr(e));return t}else return multiply_denominators_factor(e)},multiply_denominators_factor=function(e){if(car(e)===symbol(POWER)){if(push(e),e=caddr(e),isnegativenumber(e)){inverse(),__lcm();return}if(car(e)===symbol(MULTIPLY)&&isnegativenumber(cadr(e))){inverse(),__lcm();return}return pop()}},__rationalize_tensor=function(e){var t,r,n,s;if(t=0,push(e),Eval(),e=pop(),!istensor(e)){push(e);return}for(n=e.tensor.nelem,t=r=0,s=n;0<=s?r<s:r>s;t=0<=s?++r:--r)push(e.tensor.elem[t]),rationalize(),e.tensor.elem[t]=pop();return check_tensor_dimensions(e),push(e)},__lcm=function(){return save(),p1=pop(),p2=pop(),push(p1),push(p2),multiply(),push(p1),push(p2),gcd(),divide(),restore()},Eval_real=function(){return push(cadr(p1)),Eval(),real()},real=function(){return save(),rect(),p1=pop(),push(p1),push(p1),conjugate(),add(),push_integer(2),divide(),restore()},DEBUG_RECT=!1,Eval_rect=function(){return push(cadr(p1)),Eval(),rect()},rect=function(){var e;if(save(),p1=pop(),e=p1,DEBUG_RECT&&console.log("RECT of "+e),DEBUG_RECT&&console.log("any clock forms in : "+e+" ? "+findPossibleClockForm(e)),issymbol(p1))DEBUG_RECT&&console.log(" rect: simple symbol: "+e),isZeroAtomOrTensor(get_binding(symbol(ASSUME_REAL_VARIABLES)))?(push_symbol(YYRECT),push(p1),list(2)):push(p1);else if(!isZeroAtomOrTensor(get_binding(symbol(ASSUME_REAL_VARIABLES)))&&!findPossibleExponentialForm(p1)&&!findPossibleClockForm(p1)&&!(Find(p1,symbol(SIN))&&Find(p1,symbol(COS))&&Find(p1,imaginaryunit)))DEBUG_RECT&&console.log(" rect: simple symbol: "+e),push(p1);else if(car(p1)===symbol(MULTIPLY)&&isimaginaryunit(cadr(p1))&&!isZeroAtomOrTensor(get_binding(symbol(ASSUME_REAL_VARIABLES))))push(p1);else if(car(p1)===symbol(ADD))for(DEBUG_RECT&&console.log(" rect - "+e+" is a sum "),push_integer(0),p1=cdr(p1);iscons(p1);)push(car(p1)),rect(),add(),p1=cdr(p1);else DEBUG_RECT&&console.log(" rect - "+e+" is NOT a sum "),push(p1),abs(),DEBUG_RECT&&console.log(" rect - "+e+" abs: "+stack[tos-1].toString()),push(p1),arg(),DEBUG_RECT&&console.log(" rect - "+e+" arg of "+p1+" : "+stack[tos-1].toString()),p1=pop(),push(p1),cosine(),DEBUG_RECT&&console.log(" rect - "+e+" cosine: "+stack[tos-1].toString()),push(imaginaryunit),push(p1),sine(),DEBUG_RECT&&console.log(" rect - "+e+" sine: "+stack[tos-1].toString()),multiply(),DEBUG_RECT&&console.log(" rect - "+e+" i * sine: "+stack[tos-1].toString()),add(),DEBUG_RECT&&console.log(" rect - "+e+" cos + i * sine: "+stack[tos-1].toString()),multiply();if(restore(),DEBUG_RECT)return console.log("rect of "+e+" : "+stack[tos-1])},Eval_roots=function(){return p2=cadr(p1),car(p2)===symbol(SETQ)||car(p2)===symbol(TESTEQ)?(push(cadr(p2)),Eval(),push(caddr(p2)),Eval(),subtract()):(push(p2),Eval(),p2=pop(),car(p2)===symbol(SETQ)||car(p2)===symbol(TESTEQ)?(push(cadr(p2)),Eval(),push(caddr(p2)),Eval(),subtract()):push(p2)),push(caddr(p1)),Eval(),p2=pop(),p2===symbol(NIL)?guess():push(p2),p2=pop(),p1=pop(),ispolyexpandedform(p1,p2)||stop("roots: 1st argument is not a polynomial in the variable "+p2),push(p1),push(p2),roots()},hasImaginaryCoeff=function(e){var t,r,n;for(r=!1,t=n=e;n>0;t=n+=-1)if(iscomplexnumber(stack[tos-t])){r=!0;break}return r},isSimpleRoot=function(e){var t,r,n;if(e>2){for(r=!0,isZeroAtomOrTensor(stack[tos-e])&&(r=!1),t=n=e-1;n>1;t=n+=-1)if(!isZeroAtomOrTensor(stack[tos-t])){r=!1;break}}else r=!1;return r},normalisedCoeff=function(e,t){var r,n,s,i,a,l,u,c;for(s=coeff(e,t),r=stack[tos-1],l=[],n=i=1,u=s;1<=u?i<=u:i>=u;n=1<=u?++i:--i)l.push(pop());for(n=a=c=s-1;c<=0?a<=0:a>=0;n=c<=0?++a:--a)push(l[n]),push(r),divide();return s},roots=function(){var e,t,r,n,s,i,a,l;if(e=0,t=0,a=0,DEBUG&&console.log("roots: "+stack[tos-1].toString()+" "+stack[tos-2].toString()),save(),recursionLevelNestedRadicalsRemoval>1){pop(),pop(),push(symbol(NIL)),restore();return}if(e=tos-2,DEBUG&&console.log("roots checking if "+stack[tos-1].toString()+" is a case of simple roots"),p2=pop(),p1=pop(),push(p1),push(p2),r=normalisedCoeff(p2,p1),isSimpleRoot(r)?(DEBUG&&console.log("yes, "+stack[tos-1].toString()+" is a case of simple roots"),s=stack[tos-r],i=stack[tos-1],moveTos(tos-r),pop(),pop(),getSimpleRoots(r,i,s)):(moveTos(tos-r),roots2()),a=tos-e,a===0&&stop("roots: the polynomial is not factorable, try nroots"),a===1){restore();return}for(sort_stack(a),p1=alloc_tensor(a),p1.tensor.ndim=1,p1.tensor.dim[0]=a,t=n=0,l=a;0<=l?n<l:n>l;t=0<=l?++n:--n)p1.tensor.elem[t]=stack[e+t];return moveTos(e),push(p1),restore(),!1},getSimpleRoots=function(e,t,r){var n,s,i,a,l,u,c;if(DEBUG&&console.log("getSimpleRoots"),save(),e=e-1,push(r),push_rational(1,e),power(),push(t),push_rational(1,e),power(),divide(),s=pop(),e%2===0)for(c=i=1,l=e;i<=l;c=i+=2)push(s),push_integer(-1),push_rational(c,e),power(),multiply(),n=pop(),push(n),push(n),negate();else for(c=a=1,u=e;1<=u?a<=u:a>=u;c=1<=u?++a:--a)push(s),push_integer(-1),push_rational(c,e),power(),multiply(),c%2===0&&negate();return restore()},roots2=function(){var e;if(save(),DEBUG&&console.log("roots2: "+stack[tos-1].toString()+" "+stack[tos-2].toString()),p2=pop(),p1=pop(),push(p1),push(p2),e=normalisedCoeff(p2,p1),hasImaginaryCoeff(e)?(moveTos(tos-e),pop(),pop()):(moveTos(tos-e),factorpoly(),p1=pop()),car(p1)===symbol(MULTIPLY))for(p1=cdr(p1);iscons(p1);)push(car(p1)),push(p2),roots3(),p1=cdr(p1);else push(p1),push(p2),roots3();return restore()},roots3=function(){var e;return save(),p2=pop(),p1=pop(),car(p1)===symbol(POWER)&&ispolyexpandedform(cadr(p1),p2)&&isposint(caddr(p1))?(e=normalisedCoeff(p2,cadr(p1)),mini_solve(e)):ispolyexpandedform(p1,p2)&&(e=normalisedCoeff(p2,p1),mini_solve(e)),restore()},mini_solve=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re,ae,J,ie,ue,fe,Se,_e,me,de,be,ve,Ae,xe,Re,Ee,Te,Oe,T,z,Y,se,ye,v,A,k,q,j,F,I,ee,Q,W,le,ne,X,ce,_,b,x,O,D,L;if(save(),e===2){p3=pop(),p4=pop(),push(p4),push(p3),divide(),negate(),restore();return}if(e===3){p3=pop(),p4=pop(),p5=pop(),push(p4),push_integer(2),power(),push_integer(4),push(p3),multiply(),push(p5),multiply(),subtract(),push_rational(1,2),power(),p6=pop(),push(p6),push(p4),subtract(),push(p3),push_integer(2),multiply(),divide(),push(p6),push(p4),add(),negate(),push(p3),divide(),push_rational(1,2),multiply(),restore();return}if(e===4||e===5){if(p3=pop(),p4=pop(),p5=pop(),p6=pop(),push(p5),push(p5),multiply(),ie=pop(),push(ie),push(p5),multiply(),ue=pop(),push(p4),push(p4),multiply(),oe=pop(),push(oe),push(p4),multiply(),ae=pop(),push(ae),push(p6),multiply(),J=pop(),push(J),push_integer(-4),multiply(),Ae=pop(),push(ae),push_integer(2),multiply(),s=pop(),push(p3),push(p3),multiply(),w=pop(),push(w),push(p3),multiply(),B=pop(),push_integer(3),push(p3),multiply(),i=pop(),push(w),push(p6),multiply(),P=pop(),push(P),push(p6),multiply(),C=pop(),push(P),push_integer(27),multiply(),n=pop(),push(C),push_integer(-27),multiply(),be=pop(),push(i),push_integer(2),multiply(),pop(),push(p3),push(p5),multiply(),K=pop(),push(K),push(p4),multiply(),H=pop(),push(H),push(p6),multiply(),te=pop(),push(K),push_integer(3),multiply(),l=pop(),push_integer(-4),push(p3),push(ue),multiply(),multiply(),ve=pop(),push(H),push_integer(9),multiply(),negate(),xe=pop(),push(te),push_integer(18),multiply(),r=pop(),push(oe),push(l),subtract(),g=pop(),push(oe),push(ie),multiply(),re=pop(),push(p4),negate(),push(i),divide(),Re=pop(),e===4){if(DEBUG&&console.log(">>>>>>>>>>>>>>>> actually using cubic formula <<<<<<<<<<<<<<< "),DEBUG&&console.log("cubic: D0: "+g.toString()),push(g),push_integer(3),power(),push_integer(4),multiply(),u=pop(),push(g),simplify(),absValFloat(),S=pop(),DEBUG&&console.log("cubic: D0 as float: "+S.toString()),push(r),push(Ae),push(re),push(ve),push(be),add(),add(),add(),add(),simplify(),absValFloat(),Se=pop(),DEBUG&&console.log("cubic: DETERMINANT: "+Se.toString()),push(s),push(xe),push(n),add(),add(),y=pop(),DEBUG&&console.log("cubic: D1: "+y.toString()),push(y),push_integer(2),power(),push(u),subtract(),push_rational(1,2),power(),simplify(),R=pop(),isZeroAtomOrTensor(Se))if(isZeroAtomOrTensor(S)){DEBUG&&console.log(" cubic: DETERMINANT IS ZERO and delta0 is zero"),push(Re),restore();return}else{DEBUG&&console.log(" cubic: DETERMINANT IS ZERO and delta0 is not zero"),push(p3),push(p6),push_integer(9),multiply(),multiply(),push(p4),push(p5),multiply(),subtract(),push(g),push_integer(2),multiply(),divide(),O=pop(),push(O),push(O),push(H),push_integer(4),multiply(),push(p3),push(p3),push(p6),push_integer(9),multiply(),multiply(),multiply(),negate(),push(ae),negate(),add(),add(),push(p3),push(g),multiply(),divide(),restore();return}for(t=!1,q=!1;!t;)push(R),q&&negate(),push(y),add(),push_rational(1,2),multiply(),push_rational(1,3),power(),simplify(),f=pop(),DEBUG&&console.log("cubic: C: "+f.toString()),push(f),simplify(),absValFloat(),m=pop(),DEBUG&&console.log("cubic: C as absval and float: "+m.toString()),isZeroAtomOrTensor(m)?(DEBUG&&console.log(" cubic: C IS ZERO flipping the sign"),q=!0):t=!0;push(f),push(i),multiply(),a=pop(),push(a),push_integer(2),multiply(),c=pop(),push(imaginaryunit),push_integer(3),push_rational(1,2),power(),multiply(),j=pop(),push_integer(1),push(j),add(),X=pop(),push_integer(1),push(j),subtract(),ne=pop(),push(f),push(i),divide(),d=pop(),push(Re),push(d),negate(),push(g),push(a),divide(),negate(),add(),add(),simplify(),push(Re),push(d),push(X),multiply(),push_integer(2),divide(),push(ne),push(g),multiply(),push(c),divide(),add(),add(),simplify(),push(Re),push(d),push(ne),multiply(),push_integer(2),divide(),push(X),push(g),multiply(),push(c),divide(),add(),add(),simplify(),restore();return}if(e===5){if(DEBUG&&console.log(">>>>>>>>>>>>>>>> actually using quartic formula <<<<<<<<<<<<<<< "),p7=pop(),isZeroAtomOrTensor(p4)&&isZeroAtomOrTensor(p6)&&!isZeroAtomOrTensor(p5)&&!isZeroAtomOrTensor(p7)){for(DEBUG&&console.log("biquadratic case"),push(p3),push(symbol(SECRETX)),push_integer(2),power(),multiply(),push(p5),push(symbol(SECRETX)),multiply(),push(p7),add(),add(),push(symbol(SECRETX)),roots(),Y=pop(),ce=Y.tensor.elem,F=0,I=ce.length;F<I;F++)k=ce[F],push(k),push_rational(1,2),power(),simplify(),push(k),push_rational(1,2),power(),negate(),simplify();restore();return}if(push(p6),push(p6),multiply(),fe=pop(),push(p7),push(p7),multiply(),_e=pop(),push(_e),push(p7),multiply(),me=pop(),push_integer(256),push(B),push(me),multiply(),multiply(),push_integer(-192),push(P),push(_e),push(p4),multiply(),multiply(),multiply(),push_integer(-128),push(w),push(ie),push(_e),multiply(),multiply(),multiply(),push_integer(144),push(C),push(p5),push(p7),multiply(),multiply(),multiply(),push(be),push(fe),multiply(),push_integer(144),push(H),push(p4),push(_e),multiply(),multiply(),multiply(),push_integer(-6),push(p3),push(oe),push(fe),push(p7),multiply(),multiply(),multiply(),multiply(),push_integer(-80),push(te),push(p5),push(p7),multiply(),multiply(),multiply(),push_integer(18),push(te),push(fe),multiply(),multiply(),push_integer(16),push(K),push(ue),push(p7),multiply(),multiply(),multiply(),push_integer(-4),push(K),push(ie),push(fe),multiply(),multiply(),multiply(),push_integer(-27),push(ae),push(p4),push(_e),multiply(),multiply(),multiply(),push_integer(18),push(J),push(p5),push(p7),multiply(),multiply(),multiply(),push(Ae),push(fe),multiply(),push_integer(-4),push(re),push(p5),push(p7),multiply(),multiply(),multiply(),push(re),push(fe),multiply(),add(),add(),add(),add(),add(),add(),add(),add(),add(),add(),add(),add(),add(),add(),add(),Se=pop(),DEBUG&&console.log("R_determinant: "+Se.toString()),push(ie),push_integer(-3),push(p4),push(p6),multiply(),multiply(),push_integer(12),push(p3),push(p7),multiply(),multiply(),add(),add(),g=pop(),DEBUG&&console.log("R_DELTA0: "+g.toString()),push_integer(2),push(ue),multiply(),push_integer(-9),push(p4),push(p5),push(p6),multiply(),multiply(),multiply(),push_integer(27),push(oe),push(p7),multiply(),multiply(),push_integer(27),push(p3),push(fe),multiply(),multiply(),push_integer(-72),push(K),push(p7),multiply(),multiply(),add(),add(),add(),add(),y=pop(),DEBUG&&console.log("R_DELTA1: "+y.toString()),push_integer(8),push(K),multiply(),push_integer(-3),push(oe),multiply(),add(),push_integer(8),push(w),multiply(),divide(),Ee=pop(),DEBUG&&console.log("p: "+Ee.toString()),push(ae),push_integer(-4),push(H),multiply(),push_integer(8),push(P),multiply(),add(),add(),push_integer(8),push(B),multiply(),divide(),Te=pop(),DEBUG&&console.log("q: "+Te.toString()),DEBUG&&console.log("tos 1 "+tos),isZeroAtomOrTensor(p4)){for(Ee=p5,Te=p6,Oe=p7,push_rational(5,2),push(Ee),multiply(),se=pop(),push_integer(2),push(Ee),push_integer(2),power(),multiply(),push(Oe),subtract(),ye=pop(),push(Ee),push_integer(3),power(),push_integer(2),divide(),push_rational(-1,2),push(Ee),push(Oe),multiply(),multiply(),push_rational(-1,8),push(Te),push_integer(2),power(),multiply(),add(),add(),v=pop(),push(symbol(SECRETX)),push_integer(3),power(),push(se),push(symbol(SECRETX)),push_integer(2),power(),multiply(),push(ye),push(symbol(SECRETX)),multiply(),push(v),add(),add(),add(),DEBUG&&console.log("resolventCubic: "+stack[tos-1].toString()),push(symbol(SECRETX)),roots(),x=pop(),DEBUG&&console.log("resolventCubicSolutions: "+x),de=null,b=x.tensor.elem,le=0,Q=b.length;le<Q;le++)if(k=b[le],DEBUG&&console.log("examining solution: "+k),push(k),push_integer(2),multiply(),push(Ee),add(),absValFloat(),L=pop(),DEBUG&&console.log("abs value is: "+k),!isZeroAtomOrTensor(L)){de=k;break}DEBUG&&console.log("chosen solution: "+de),push(de),push_integer(2),multiply(),push(Ee),add(),push_rational(1,2),power(),simplify(),D=pop(),push(Te),push_integer(2),multiply(),push(D),divide(),simplify(),z=pop(),push(Ee),push_integer(3),multiply(),push(de),push_integer(2),multiply(),add(),T=pop(),push(D),push(T),push(z),add(),negate(),push_rational(1,2),power(),simplify(),add(),push_integer(2),divide(),push(D),push(T),push(z),add(),negate(),push_rational(1,2),power(),simplify(),subtract(),push_integer(2),divide(),push(D),negate(),push(T),push(z),subtract(),negate(),push_rational(1,2),power(),simplify(),add(),push_integer(2),divide(),push(D),negate(),push(T),push(z),subtract(),negate(),push_rational(1,2),power(),simplify(),subtract(),push_integer(2),divide(),restore();return}else{for(DEBUG&&console.log("tos 2 "+tos),push_integer(8),push(p5),push(p3),multiply(),multiply(),push_integer(-3),push(p4),push_integer(2),power(),multiply(),add(),push_integer(8),push(p3),push_integer(2),power(),multiply(),divide(),Ee=pop(),DEBUG&&console.log("p for depressed quartic: "+Ee.toString()),push(p4),push_integer(3),power(),push_integer(-4),push(p3),push(p4),push(p5),multiply(),multiply(),multiply(),push_integer(8),push(p6),push(p3),push_integer(2),power(),multiply(),multiply(),add(),add(),push_integer(8),push(p3),push_integer(3),power(),multiply(),divide(),Te=pop(),DEBUG&&console.log("q for depressed quartic: "+Te.toString()),push(p4),push_integer(4),power(),push_integer(-3),multiply(),push_integer(256),push(B),push(p7),multiply(),multiply(),push_integer(-64),push(P),push(p4),multiply(),multiply(),push_integer(16),push(oe),push(p3),push(p5),multiply(),multiply(),multiply(),add(),add(),add(),push_integer(256),push(p3),push_integer(4),power(),multiply(),divide(),Oe=pop(),DEBUG&&console.log("r for depressed quartic: "+Oe.toString()),DEBUG&&console.log("tos 4 "+tos),push(symbol(SECRETX)),push_integer(4),power(),DEBUG&&console.log("4 * x^4: "+stack[tos-1].toString()),push(Ee),push(symbol(SECRETX)),push_integer(2),power(),multiply(),DEBUG&&console.log("R_p * x^2: "+stack[tos-1].toString()),push(Te),push(symbol(SECRETX)),multiply(),DEBUG&&console.log("R_q * x: "+stack[tos-1].toString()),push(Oe),DEBUG&&console.log("R_r: "+stack[tos-1].toString()),add(),add(),add(),simplify(),DEBUG&&console.log("solving depressed quartic: "+stack[tos-1].toString()),push(symbol(SECRETX)),roots(),A=pop(),DEBUG&&console.log("depressedSolutions: "+A),_=A.tensor.elem,W=0,ee=_.length;W<ee;W++)k=_[W],push(k),push(p4),push_integer(4),push(p3),multiply(),divide(),subtract(),simplify(),DEBUG&&console.log("solution from depressed: "+stack[tos-1].toString());restore();return}}}return moveTos(tos-e),restore()},Eval_round=function(){return push(cadr(p1)),Eval(),yround()},yround=function(){return save(),yyround(),restore()},yyround=function(){var e;if(e=0,p1=pop(),!isNumericAtom(p1)){push_symbol(ROUND),push(p1),list(2);return}if(isdouble(p1)){e=Math.round(p1.d),push_double(e);return}if(isinteger(p1)){push(p1);return}return push(p1),yyfloat(),p1=pop(),push_integer(Math.round(p1.d))},T_INTEGER=1001,T_DOUBLE=1002,T_SYMBOL=1003,T_FUNCTION=1004,T_NEWLINE=1006,T_STRING=1007,T_GTEQ=1008,T_LTEQ=1009,T_EQ=1010,T_NEQ=1011,T_QUOTASSIGN=1012,token="",newline_flag=0,meta_mode=0,input_str=0,scan_str=0,token_str=0,token_buf=0,lastFoundSymbol=null,symbolsRightOfAssignment=null,symbolsLeftOfAssignment=null,isSymbolLeftOfAssignment=null,scanningParameters=null,functionInvokationsScanningStack=null,skipRootVariableToBeSolved=!1,assignmentFound=null,scanned="",scan=function(e){return DEBUG&&console.log("#### scanning "+e),lastFoundSymbol=null,symbolsRightOfAssignment=[],symbolsLeftOfAssignment=[],isSymbolLeftOfAssignment=!0,scanningParameters=[],functionInvokationsScanningStack=[""],assignmentFound=!1,scanned=e,meta_mode=0,expanding++,input_str=0,scan_str=0,get_next_token(),token===""?(push(symbol(NIL)),expanding--,0):(scan_stmt(),expanding--,assignmentFound||(symbolsInExpressionsWithoutAssignments=symbolsInExpressionsWithoutAssignments.concat(symbolsLeftOfAssignment)),token_str-input_str)},scan_meta=function(e){return scanned=e,meta_mode=1,expanding++,input_str=0,scan_str=0,get_next_token(),token===""?(push(symbol(NIL)),expanding--,0):(scan_stmt(),expanding--,token_str-input_str)},scan_stmt=function(){var e,t,r,n,s,i,a,l,u;if(scan_relation(),e=!1,token===T_QUOTASSIGN&&(e=!0),(token===T_QUOTASSIGN||token==="=")&&(u=lastFoundSymbol,DEBUG&&console.log("assignment!"),assignmentFound=!0,isSymbolLeftOfAssignment=!1,get_next_token(),push_symbol(SETQ),swap(),e&&push_symbol(QUOTE),scan_relation(),e&&list(2),list(3),isSymbolLeftOfAssignment=!0,codeGen)){if(n=symbolsRightOfAssignment.indexOf(u),n!==-1&&(symbolsRightOfAssignment.splice(n,1),symbolsHavingReassignments.push(u)),DEBUG)for(console.log("locally, "+u+" depends on: "),s=0,i=symbolsRightOfAssignment.length;s<i;s++)r=symbolsRightOfAssignment[s],console.log("  "+r);for(symbolsDependencies[u]==null&&(symbolsDependencies[u]=[]),t=symbolsDependencies[u],l=0,a=symbolsRightOfAssignment.length;l<a;l++)r=symbolsRightOfAssignment[l],t.indexOf(r)===-1&&t.push(r);return symbolsRightOfAssignment=[]}},scan_relation=function(){switch(scan_expression(),token){case T_EQ:return push_symbol(TESTEQ),swap(),get_next_token(),scan_expression(),list(3);case T_NEQ:return push_symbol(NOT),swap(),push_symbol(TESTEQ),swap(),get_next_token(),scan_expression(),list(3),list(2);case T_LTEQ:return push_symbol(TESTLE),swap(),get_next_token(),scan_expression(),list(3);case T_GTEQ:return push_symbol(TESTGE),swap(),get_next_token(),scan_expression(),list(3);case"<":return push_symbol(TESTLT),swap(),get_next_token(),scan_expression(),list(3);case">":return push_symbol(TESTGT),swap(),get_next_token(),scan_expression(),list(3)}},scan_expression=function(){var e;switch(e=tos,token){case"+":get_next_token(),scan_term();break;case"-":get_next_token(),scan_term(),negate();break;default:scan_term()}for(;newline_flag===0&&(token==="+"||token==="-");)token==="+"?(get_next_token(),scan_term()):(get_next_token(),scan_term(),negate());if(tos-e>1)return list(tos-e),push_symbol(ADD),swap(),cons()},is_factor=function(){if((typeof token.charCodeAt=="function"?token.charCodeAt(0):void 0)===dotprod_unicode)return 1;switch(token){case"*":case"/":return 1;case"(":case T_SYMBOL:case T_FUNCTION:case T_INTEGER:case T_DOUBLE:case T_STRING:return newline_flag?(scan_str=token_str,0):1}return 0},simplify_1_in_products=function(e,t){if(e>t&&isrational(stack[e-1])&&equaln(stack[e-1],1))return pop()},multiply_consecutive_constants=function(e,t){if(e>t+1&&isNumericAtom(stack[e-2])&&isNumericAtom(stack[e-1]))return multiply()},scan_term=function(){var e;for(e=tos,scan_factor(),parse_time_simplifications&&simplify_1_in_products(tos,e);is_factor();)token==="*"?(get_next_token(),scan_factor()):token==="/"?(simplify_1_in_products(tos,e),get_next_token(),scan_factor(),inverse()):(typeof token.charCodeAt=="function"?token.charCodeAt(0):void 0)===dotprod_unicode?(get_next_token(),push_symbol(INNER),swap(),scan_factor(),list(3)):scan_factor(),parse_time_simplifications&&(multiply_consecutive_constants(tos,e),simplify_1_in_products(tos,e));if(e===tos)return push_integer(1);if(tos-e>1)return list(tos-e),push_symbol(MULTIPLY),swap(),cons()},scan_power=function(){if(token==="^")return get_next_token(),push_symbol(POWER),swap(),scan_factor(),list(3)},scan_index=function(e){for(get_next_token(),push_symbol(INDEX),swap(),scan_expression();token===",";)get_next_token(),scan_expression();return token!=="]"&&scan_error("] expected"),get_next_token(),list(tos-e)},scan_factor=function(){var e,t;for(t=tos,e=!1,token==="("?scan_subexpr():token===T_SYMBOL?scan_symbol():token===T_FUNCTION?scan_function_call_with_function_name():token==="["?scan_tensor():token===T_INTEGER?(e=!0,bignum_scan_integer(token_buf),get_next_token()):token===T_DOUBLE?(e=!0,bignum_scan_float(token_buf),get_next_token()):token===T_STRING?scan_string():scan_error("syntax error");token==="["||token==="("&&newline_flag===0&&!e;)token==="["?scan_index(t):token==="("&&scan_function_call_without_function_name();for(;token==="!";)get_next_token(),push_symbol(FACTORIAL),swap(),list(2);for(;(typeof token.charCodeAt=="function"?token.charCodeAt(0):void 0)===transpose_unicode;)get_next_token(),push_symbol(TRANSPOSE),swap(),list(2);return scan_power()},addSymbolRightOfAssignment=function(e){var t,r,n,s;if(predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&symbolsRightOfAssignment.indexOf(e)===-1&&symbolsRightOfAssignment.indexOf("'"+e)===-1&&!skipRootVariableToBeSolved){for(DEBUG&&console.log("... adding symbol: "+e+" to the set of the symbols right of assignment"),n="",t=r=1,s=functionInvokationsScanningStack.length;1<=s?r<s:r>s;t=1<=s?++r:--r)functionInvokationsScanningStack[t]!==""&&(n+=functionInvokationsScanningStack[t]+"_"+t+"_");return e=n+e,symbolsRightOfAssignment.push(e)}},addSymbolLeftOfAssignment=function(e){var t,r,n,s;if(predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(e)===-1&&symbolsLeftOfAssignment.indexOf(e)===-1&&symbolsLeftOfAssignment.indexOf("'"+e)===-1&&!skipRootVariableToBeSolved){for(DEBUG&&console.log("... adding symbol: "+e+" to the set of the symbols left of assignment"),n="",t=r=1,s=functionInvokationsScanningStack.length;1<=s?r<s:r>s;t=1<=s?++r:--r)functionInvokationsScanningStack[t]!==""&&(n+=functionInvokationsScanningStack[t]+"_"+t+"_");return e=n+e,symbolsLeftOfAssignment.push(e)}},scan_symbol=function(){if(token!==T_SYMBOL&&scan_error("symbol expected"),meta_mode&&token_buf.length===1)switch(token_buf[0]){case"a":push(symbol(METAA));break;case"b":push(symbol(METAB));break;case"x":push(symbol(METAX));break;default:push(usr_symbol(token_buf))}else push(usr_symbol(token_buf));return scanningParameters.length===0?(DEBUG&&console.log("out of scanning parameters, processing "+token_buf),lastFoundSymbol=token_buf,isSymbolLeftOfAssignment&&addSymbolLeftOfAssignment(token_buf)):(DEBUG&&console.log("still scanning parameters, skipping "+token_buf),isSymbolLeftOfAssignment&&addSymbolRightOfAssignment("'"+token_buf)),DEBUG&&console.log("found symbol: "+token_buf+" left of assignment: "+isSymbolLeftOfAssignment),isSymbolLeftOfAssignment||addSymbolRightOfAssignment(token_buf),get_next_token()},scan_string=function(){return push(new_string(token_buf)),get_next_token()},scan_function_call_with_function_name=function(){var e,t,r,n,s,i;if(DEBUG&&console.log("-- scan_function_call_with_function_name start"),n=1,s=new U,s=usr_symbol(token_buf),push(s),e=token_buf,(e==="roots"||e==="defint"||e==="sum"||e==="product"||e==="for")&&functionInvokationsScanningStack.push(token_buf),lastFoundSymbol=token_buf,isSymbolLeftOfAssignment||addSymbolRightOfAssignment(token_buf),get_next_token(),get_next_token(),scanningParameters.push(!0),token!==")"){for(scan_stmt(),n++;token===",";)get_next_token(),n===2&&functionInvokationsScanningStack[functionInvokationsScanningStack.length-1].indexOf("roots")!==-1&&(symbolsRightOfAssignment=symbolsRightOfAssignment.filter(function(a){return!new RegExp("roots_"+(functionInvokationsScanningStack.length-1)+"_"+token_buf).test(a)}),skipRootVariableToBeSolved=!0),n===2&&functionInvokationsScanningStack[functionInvokationsScanningStack.length-1].indexOf("sum")!==-1&&(symbolsRightOfAssignment=symbolsRightOfAssignment.filter(function(a){return!new RegExp("sum_"+(functionInvokationsScanningStack.length-1)+"_"+token_buf).test(a)}),skipRootVariableToBeSolved=!0),n===2&&functionInvokationsScanningStack[functionInvokationsScanningStack.length-1].indexOf("product")!==-1&&(symbolsRightOfAssignment=symbolsRightOfAssignment.filter(function(a){return!new RegExp("product_"+(functionInvokationsScanningStack.length-1)+"_"+token_buf).test(a)}),skipRootVariableToBeSolved=!0),n===2&&functionInvokationsScanningStack[functionInvokationsScanningStack.length-1].indexOf("for")!==-1&&(symbolsRightOfAssignment=symbolsRightOfAssignment.filter(function(a){return!new RegExp("for_"+(functionInvokationsScanningStack.length-1)+"_"+token_buf).test(a)}),skipRootVariableToBeSolved=!0),functionInvokationsScanningStack[functionInvokationsScanningStack.length-1].indexOf("defint")!==-1&&(n===2||n>2&&(n-2)%3===0)&&(symbolsRightOfAssignment=symbolsRightOfAssignment.filter(function(a){return!new RegExp("defint_"+(functionInvokationsScanningStack.length-1)+"_"+token_buf).test(a)}),skipRootVariableToBeSolved=!0),scan_stmt(),skipRootVariableToBeSolved=!1,n++;n===2&&functionInvokationsScanningStack[functionInvokationsScanningStack.length-1].indexOf("roots")!==-1&&(symbolsRightOfAssignment=symbolsRightOfAssignment.filter(function(a){return!new RegExp("roots_"+(functionInvokationsScanningStack.length-1)+"_x").test(a)}))}for(scanningParameters.pop(),t=r=0,i=symbolsRightOfAssignment.length;0<=i?r<=i:r>=i;t=0<=i?++r:--r)symbolsRightOfAssignment[t]!=null&&(e==="roots"&&(symbolsRightOfAssignment[t]=symbolsRightOfAssignment[t].replace(new RegExp("roots_"+(functionInvokationsScanningStack.length-1)+"_"),"")),e==="defint"&&(symbolsRightOfAssignment[t]=symbolsRightOfAssignment[t].replace(new RegExp("defint_"+(functionInvokationsScanningStack.length-1)+"_"),"")),e==="sum"&&(symbolsRightOfAssignment[t]=symbolsRightOfAssignment[t].replace(new RegExp("sum_"+(functionInvokationsScanningStack.length-1)+"_"),"")),e==="product"&&(symbolsRightOfAssignment[t]=symbolsRightOfAssignment[t].replace(new RegExp("product_"+(functionInvokationsScanningStack.length-1)+"_"),"")),e==="for"&&(symbolsRightOfAssignment[t]=symbolsRightOfAssignment[t].replace(new RegExp("for_"+(functionInvokationsScanningStack.length-1)+"_"),"")));if(token!==")"&&scan_error(") expected"),get_next_token(),list(n),(e==="roots"||e==="defint"||e==="sum"||e==="product"||e==="for")&&functionInvokationsScanningStack.pop(),e===symbol(PATTERN).printname&&(patternHasBeenFound=!0),DEBUG)return console.log("-- scan_function_call_with_function_name end")},scan_function_call_without_function_name=function(){var e;if(DEBUG&&console.log("-- scan_function_call_without_function_name start"),push_symbol(EVAL),swap(),list(2),e=1,get_next_token(),scanningParameters.push(!0),token!==")")for(scan_stmt(),e++;token===",";)get_next_token(),scan_stmt(),e++;if(scanningParameters.pop(),token!==")"&&scan_error(") expected"),get_next_token(),list(e),DEBUG)return console.log("-- scan_function_call_without_function_name end: "+stack[tos-1])},scan_subexpr=function(){return token!=="("&&scan_error("( expected"),get_next_token(),scan_stmt(),token!==")"&&scan_error(") expected"),get_next_token()},scan_tensor=function(){var e;for(e=0,token!=="["&&scan_error("[ expected"),get_next_token(),scan_stmt(),e=1;token===",";)get_next_token(),scan_stmt(),e++;return build_tensor(e),token!=="]"&&scan_error("] expected"),get_next_token()},scan_error=function(e){for(errorMessage="";input_str!==scan_str&&!((scanned[input_str]===`
`||scanned[input_str]==="\r")&&input_str+1===scan_str);)errorMessage+=scanned[input_str++];for(errorMessage+=" ? ";scanned[input_str]&&scanned[input_str]!==`
`&&scanned[input_str]!=="\r";)errorMessage+=scanned[input_str++];return errorMessage+=`
`,stop(e)},build_tensor=function(e){var t,r,n;for(t=0,save(),p2=alloc_tensor(e),p2.tensor.ndim=1,p2.tensor.dim[0]=e,t=r=0,n=e;0<=n?r<n:r>n;t=0<=n?++r:--r)p2.tensor.elem[t]=stack[tos-e+t];return check_tensor_dimensions(p2),moveTos(tos-e),push(p2),restore()},get_next_token=function(){for(newline_flag=0;get_token(),token===T_NEWLINE;)newline_flag=1;if(DEBUG)return console.log("get_next_token token: "+token)},get_token=function(){for(;isspace(scanned[scan_str]);){if(scanned[scan_str]===`
`||scanned[scan_str]==="\r"){token=T_NEWLINE,scan_str++;return}scan_str++}if(token_str=scan_str,scan_str===scanned.length){token="";return}if(isdigit(scanned[scan_str])||scanned[scan_str]==="."){for(;isdigit(scanned[scan_str]);)scan_str++;if(scanned[scan_str]==="."){for(scan_str++;isdigit(scanned[scan_str]);)scan_str++;if(scanned[scan_str]==="e"&&(scanned[scan_str+1]==="+"||scanned[scan_str+1]==="-"||isdigit(scanned[scan_str+1])))for(scan_str+=2;isdigit(scanned[scan_str]);)scan_str++;token=T_DOUBLE}else token=T_INTEGER;update_token_buf(token_str,scan_str);return}if(isalpha(scanned[scan_str])){for(;isalnumorunderscore(scanned[scan_str]);)scan_str++;scanned[scan_str]==="("?token=T_FUNCTION:token=T_SYMBOL,update_token_buf(token_str,scan_str);return}if(scanned[scan_str]==='"'){for(scan_str++;scanned[scan_str]!=='"';)scan_str===scanned.length-1&&(scan_str++,scan_error("runaway string"),scan_str--),scan_str++;scan_str++,token=T_STRING,update_token_buf(token_str+1,scan_str-1);return}if(scanned[scan_str]==="#"||scanned[scan_str]==="-"&&scanned[scan_str+1]==="-"){for(;scanned[scan_str]&&scanned[scan_str]!==`
`&&scanned[scan_str]!=="\r";)scan_str++;scanned[scan_str]&&scan_str++,token=T_NEWLINE;return}if(scanned[scan_str]===":"&&scanned[scan_str+1]==="="){scan_str+=2,token=T_QUOTASSIGN;return}if(scanned[scan_str]==="="&&scanned[scan_str+1]==="="){scan_str+=2,token=T_EQ;return}if(scanned[scan_str]==="!"&&scanned[scan_str+1]==="="){scan_str+=2,token=T_NEQ;return}if(scanned[scan_str]==="<"&&scanned[scan_str+1]==="="){scan_str+=2,token=T_LTEQ;return}if(scanned[scan_str]===">"&&scanned[scan_str+1]==="="){scan_str+=2,token=T_GTEQ;return}return token=scanned[scan_str++]},update_token_buf=function(e,t){return token_buf=scanned.substring(e,t)},$.scan=scan,Eval_sgn=function(){return push(cadr(p1)),Eval(),sgn()},sgn=function(){return save(),yysgn(),restore()},yysgn=function(){if(p1=pop(),isdouble(p1))if(p1.d>0){push_integer(1);return}else if(p1.d===0){push_integer(1);return}else{push_integer(-1);return}if(isrational(p1))if(MSIGN(mmul(p1.q.a,p1.q.b))===-1){push_integer(-1);return}else if(MZERO(mmul(p1.q.a,p1.q.b))){push_integer(0);return}else{push_integer(1);return}if(iscomplexnumber(p1)){push_integer(-1),push(p1),absval(),power(),push(p1),multiply();return}if(isnegativeterm(p1)){push_symbol(SGN),push(p1),negate(),list(2),push_integer(-1),multiply();return}return push_symbol(SGN),push(p1),list(2)},Eval_shape=function(){return push(cadr(p1)),Eval(),shape()},shape=function(){var e,t,r,n,s,i,a,l;for(r=0,i=0,e=[],t=[],r=n=0,a=MAXDIM;0<=a?n<a:n>a;r=0<=a?++n:--n)e[r]=0,t[r]=0;if(save(),p1=pop(),!istensor(p1)){isZeroAtomOrTensor(p1)||stop("transpose: tensor expected, 1st arg is not a tensor"),push(zero),restore();return}for(i=p1.tensor.ndim,p2=alloc_tensor(i),p2.tensor.ndim=1,p2.tensor.dim[0]=i,r=s=0,l=i;0<=l?s<l:s>l;r=0<=l?++s:--s)push_integer(p1.tensor.dim[r]),p2.tensor.elem[r]=pop();return push(p2),restore()},simfac=function(){var e;if(e=0,save(),p1=pop(),car(p1)===symbol(ADD)){for(e=tos,p1=cdr(p1);p1!==symbol(NIL);)push(car(p1)),simfac_term(),p1=cdr(p1);add_all(tos-e)}else push(p1),simfac_term();return restore()},simfac_term=function(){var e;if(e=0,save(),p1=pop(),car(p1)!==symbol(MULTIPLY)){push(p1),restore();return}for(e=tos,p1=cdr(p1);p1!==symbol(NIL);)push(car(p1)),p1=cdr(p1);for(;yysimfac(e););return multiply_all_noexpand(tos-e),restore()},yysimfac=function(e){var t,r,n,s,i,a,l,u;for(t=0,r=0,t=n=i=e,a=tos;i<=a?n<a:n>a;t=i<=a?++n:--n)for(p1=stack[t],r=s=l=e,u=tos;l<=u?s<u:s>u;r=l<=u?++s:--s)if(t!==r){if(p2=stack[r],car(p1)===symbol(FACTORIAL)&&car(p2)===symbol(POWER)&&isminusone(caddr(p2))&&equal(cadr(p1),cadr(p2)))return push(cadr(p1)),push(one),subtract(),factorial(),stack[t]=pop(),stack[r]=one,1;if(car(p2)===symbol(POWER)&&isminusone(caddr(p2))&&caadr(p2)===symbol(FACTORIAL)&&equal(p1,cadadr(p2)))return push(p1),push_integer(-1),add(),factorial(),reciprocate(),stack[t]=pop(),stack[r]=one,1;if(car(p2)===symbol(FACTORIAL)&&(push(p1),push(cadr(p2)),subtract(),p3=pop(),isplusone(p3)))return push(p1),factorial(),stack[t]=pop(),stack[r]=one,1;if(car(p1)===symbol(POWER)&&isminusone(caddr(p1))&&car(p2)===symbol(POWER)&&isminusone(caddr(p2))&&caadr(p2)===symbol(FACTORIAL)&&(push(cadr(p1)),push(cadr(cadr(p2))),subtract(),p3=pop(),isplusone(p3)))return push(cadr(p1)),factorial(),reciprocate(),stack[t]=pop(),stack[r]=one,1;if(car(p1)===symbol(FACTORIAL)&&car(p2)===symbol(POWER)&&isminusone(caddr(p2))&&caadr(p2)===symbol(FACTORIAL)){if(push(cadr(p1)),push(cadr(cadr(p2))),subtract(),p3=pop(),isplusone(p3))return stack[t]=cadr(p1),stack[r]=one,1;if(isminusone(p3))return push(cadr(cadr(p2))),reciprocate(),stack[t]=pop(),stack[r]=one,1;if(equaln(p3,2))return stack[t]=cadr(p1),push(cadr(p1)),push_integer(-1),add(),stack[r]=pop(),1;if(equaln(p3,-2))return push(cadr(cadr(p2))),reciprocate(),stack[t]=pop(),push(cadr(cadr(p2))),push_integer(-1),add(),reciprocate(),stack[r]=pop(),1}}return 0},DEBUG_SIMPLIFY=!1,Eval_simplify=function(){return push(cadr(p1)),runUserDefinedSimplifications(),Eval(),simplify()},runUserDefinedSimplifications=function(){var e,t,r,n,s,i,a,l,u,c;if(userSimplificationsInListForm.length!==0&&!Find(cadr(p1),symbol(INTEGRAL))){for(u=expanding,expanding=!1,DEBUG_SIMPLIFY&&console.log("runUserDefinedSimplifications passed: "+stack[tos-1].toString()),Eval(),DEBUG_SIMPLIFY&&console.log("runUserDefinedSimplifications after eval no expanding: "+stack[tos-1].toString()),expanding=u,p1=stack[tos-1],DEBUG_SIMPLIFY&&console.log("patterns to be checked: "),n=0,s=userSimplificationsInListForm.length;n<s;n++)r=userSimplificationsInListForm[n],DEBUG_SIMPLIFY&&console.log("..."+r);for(e=!0,l=0;e&&l<MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES;)for(e=!1,l++,a=0,i=userSimplificationsInListForm.length;a<i;a++){for(r=userSimplificationsInListForm[a],c=!0,t=0;c&&t<MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE;)t++,DEBUG_SIMPLIFY&&console.log("simplify - tos: "+tos+" checking pattern: "+r+" on: "+p1),push_symbol(NIL),c=transform(r,!0),c&&(e=!0),p1=stack[tos-1],DEBUG_SIMPLIFY&&console.log("p1 at this stage of simplification: "+p1);t===MAX_CONSECUTIVE_APPLICATIONS_OF_SINGLE_RULE&&stop("maximum application of single transformation rule exceeded: "+r)}if(l===MAX_CONSECUTIVE_APPLICATIONS_OF_ALL_RULES&&stop("maximum application of all transformation rules exceeded "),DEBUG_SIMPLIFY&&console.log("METAX = "+get_binding(symbol(METAX))),DEBUG_SIMPLIFY&&console.log("METAA = "+get_binding(symbol(METAA))),DEBUG_SIMPLIFY)return console.log("METAB = "+get_binding(symbol(METAB)))}},simplifyForCodeGeneration=function(){return save(),runUserDefinedSimplifications(),codeGen=!0,simplify_main(),codeGen=!1,restore()},simplify=function(){return save(),simplify_main(),restore()},simplify_main=function(){var args,fbody;if(p1=pop(),codeGen&&car(p1)===symbol(FUNCTION)&&(fbody=cadr(p1),push(fbody),eval(),simplify(),p3=pop(),args=caddr(p1),push_symbol(FUNCTION),push(p3),push(args),list(3),p1=pop()),istensor(p1)){simplify_tensor();return}if(Find(p1,symbol(FACTORIAL))&&(push(p1),simfac(),p2=pop(),push(p1),rationalize(),simfac(),p3=pop(),count(p2)<count(p3)?p1=p2:p1=p3),f10(),DEBUG_SIMPLIFY&&console.log("f10: "+p1.toString()),f1(),DEBUG_SIMPLIFY&&console.log("f1: "+p1.toString()),f2(),DEBUG_SIMPLIFY&&console.log("f2: "+p1.toString()),f3(),DEBUG_SIMPLIFY&&console.log("f3: "+p1.toString()),f4(),DEBUG_SIMPLIFY&&console.log("f4: "+p1.toString()),f5(),DEBUG_SIMPLIFY&&console.log("f5: "+p1.toString()),f9(),DEBUG_SIMPLIFY&&console.log("f9: "+p1.toString()),simplify_polarRect(),do_simplify_nested_radicals&&simplify_nested_radicals()){DEBUG_SIMPLIFY&&console.log("de-nesting successful into: "+p1.toString()),push(p1),simplify();return}return simplify_rectToClock(),simplify_rational_expressions(),push(p1)},simplify_tensor=function(){var e,t,r,n,s;for(e=0,p2=alloc_tensor(p1.tensor.nelem),p2.tensor.ndim=p1.tensor.ndim,e=t=0,n=p1.tensor.ndim;0<=n?t<n:t>n;e=0<=n?++t:--t)p2.tensor.dim[e]=p1.tensor.dim[e];for(e=r=0,s=p1.tensor.nelem;0<=s?r<s:r>s;e=0<=s?++r:--r)push(p1.tensor.elem[e]),simplify(),p2.tensor.elem[e]=pop();return check_tensor_dimensions(p2),isZeroAtomOrTensor(p2)&&(p2=zero),push(p2)},f1=function(){if(car(p1)===symbol(ADD)&&(push(p1),rationalize(),p2=pop(),count(p2)<count(p1)))return p1=p2},f2=function(){if(car(p1)===symbol(ADD)&&(push(p1),Condense(),p2=pop(),count(p2)<=count(p1)))return p1=p2},f3=function(){if(push(p1),rationalize(),negate(),rationalize(),negate(),rationalize(),p2=pop(),count(p2)<count(p1))return p1=p2},f10=function(){var e,t,r,n;if(r=car(p1),cdr(p1),(r===symbol(MULTIPLY)||isinnerordot(p1))&&car(car(cdr(p1)))===symbol(TRANSPOSE)&&car(car(cdr(cdr(p1))))===symbol(TRANSPOSE)&&(DEBUG_SIMPLIFY&&console.log("maybe collecting a transpose "+p1),e=cadr(car(cdr(p1))),t=cadr(car(cdr(cdr(p1)))),r===symbol(MULTIPLY)?(push(e),push(t),multiply()):isinnerordot(p1)&&(push(t),push(e),inner()),push_integer(1),push_integer(2),n=expanding,expanding=!1,transpose(),expanding=n,p2=pop(),count(p2)<count(p1)&&(p1=p2),DEBUG_SIMPLIFY))return console.log("collecting a transpose "+p2)},f4=function(){if(!isZeroAtomOrTensor(p1)&&(push(p1),rationalize(),inverse(),rationalize(),inverse(),rationalize(),p2=pop(),count(p2)<count(p1)))return p1=p2},simplify_trig=function(){return save(),p1=pop(),f5(),push(p1),restore()},f5=function(){if(!(Find(p1,symbol(SIN))===0&&Find(p1,symbol(COS))===0)&&(p2=p1,trigmode=1,push(p2),Eval(),p3=pop(),trigmode=2,push(p2),Eval(),p4=pop(),trigmode=0,(count(p4)<count(p3)||nterms(p4)<nterms(p3))&&(p3=p4),count(p3)<count(p1)||nterms(p3)<nterms(p1)))return p1=p3},f9=function(){var e,t;if(car(p1)===symbol(ADD)){for(push_integer(0),p2=cdr(p1);iscons(p2);)push(car(p2)),simplify(),add(),e=p1,t=p2,p1=pop(),simplify_rational_expressions(),push(p1),p1=e,p2=t,p2=cdr(p2);if(p2=pop(),count(p2)<count(p1))return p1=p2}},simplify_rational_expressions=function(){var e,t,r,n;if(push(p1),denominator(),e=pop(),!isone(e)&&(push(p1),numerator(),t=pop(),!isone(t)&&(r=areunivarpolysfactoredorexpandedform(t,e))&&(push(t),push(e),gcd(),push(r),factor(),n=pop(),!isone(n)&&(push(t),push(r),factor(),push(n),inverse(),multiply_noexpand(),simplify(),stack[tos-1].toString(),push(e),push(r),factor(),push(n),inverse(),multiply_noexpand(),simplify(),stack[tos-1].toString(),divide(),Condense(),stack[tos-1].toString(),p2=pop(),count(p2)<count(p1)))))return p1=p2},simplify_rectToClock=function(){if(!(Find(p1,symbol(SIN))===0&&Find(p1,symbol(COS))===0)&&(push(p1),Eval(),clockform(),p2=pop(),DEBUG_SIMPLIFY&&console.log("before simplification clockform: "+p1+" after: "+p2),count(p2)<count(p1)))return p1=p2},simplify_polarRect=function(){if(push(p1),polarRectAMinusOneBase(),Eval(),p2=pop(),count(p2)<count(p1))return p1=p2},polarRectAMinusOneBase=function(){var e;if(save(),p1=pop(),isimaginaryunit(p1)){push(p1),restore();return}if(equal(car(p1),symbol(POWER))&&isminusone(cadr(p1)))push(one),negate(),push(caddr(p1)),polarRectAMinusOneBase(),power(),polar(),rect();else if(iscons(p1)){for(e=tos;iscons(p1);)push(car(p1)),polarRectAMinusOneBase(),p1=cdr(p1);list(tos-e)}else push(p1);restore()},nterms=function(e){return car(e)!==symbol(ADD)?1:length(e)-1},simplify_nested_radicals=function(){var e,t,r,n;return recursionLevelNestedRadicalsRemoval>0?(DEBUG_SIMPLIFY&&console.log("denesting bailing out because of too much recursion"),!1):(push(p1),n=take_care_of_nested_radicals(),r=stack[tos-1],e=expanding,expanding=0,yycondense(),expanding=e,t=pop(),countOccurrencesOfSymbol(symbol(POWER),r)<countOccurrencesOfSymbol(symbol(POWER),t)?push(r):push(t),p1=pop(),n)},take_care_of_nested_radicals=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re,ae,J,ie,ue,fe,Se,_e,me,de,be,ve,Ae,xe;if(recursionLevelNestedRadicalsRemoval>0)return DEBUG_SIMPLIFY&&console.log("denesting bailing out because of too much recursion"),!1;if(save(),p1=pop(),equal(car(p1),symbol(POWER)))if(i=cadr(p1),d=caddr(p1),!isminusone(d)&&equal(car(i),symbol(ADD))&&isfraction(d)&&(equalq(d,1,3)||equalq(d,1,2))){for(m=cadr(i),push(m),take_care_of_nested_radicals(),pop(),be=caddr(i),push(be),take_care_of_nested_radicals(),pop(),ae=0,c=i;cdr(c)!==symbol(NIL);)ae++,c=cdr(c);if(ae>2)return push(p1),restore(),!1;if(u=null,l=[],Ae=[],car(be)===symbol(MULTIPLY)){if(ve=cdr(be),iscons(ve))for(;iscons(ve);)_e=car(ve),car(_e)===symbol(POWER)?(y=cadr(_e),R=caddr(_e),equalq(R,1,2)&&(u==null?(u=R,l.push(y)):equal(R,u)&&l.push(y))):Ae.push(_e),ve=cdr(ve)}else car(be)===symbol(POWER)&&(y=cadr(be),R=caddr(be),u==null&&equalq(R,1,2)&&(u=R,l.push(y)));if(l.length===0)return push(p1),restore(),!1;for(e=m,push_integer(1),w=0,P=l.length;w<P;w++)S=l[w],push(S),multiply();for(r=pop(),push_integer(1),oe=0,C=Ae.length;oe<C;oe++)S=Ae[oe],push(S),multiply();if(t=pop(),equalq(d,1,3)){if(push(e),negate(),push(r),multiply(),push(t),divide(),a=pop(),push(a),real(),yyfloat(),Math.abs(pop().d)>Math.pow(2,32))return push(p1),restore(),!1;if(push(a),push_integer(3),push(r),multiply(),a=pop(),push(a),real(),yyfloat(),Math.abs(pop().d)>Math.pow(2,32))return pop(),push(p1),restore(),!1;if(push(a),push(symbol(SECRETX)),multiply(),push_integer(-3),push(e),multiply(),push(t),divide(),a=pop(),push(a),real(),yyfloat(),Math.abs(pop().d)>Math.pow(2,32))return pop(),pop(),push(p1),restore(),!1;push(a),push(symbol(SECRETX)),push_integer(2),power(),multiply(),push_integer(1),push(symbol(SECRETX)),push_integer(3),power(),multiply(),add(),add(),add()}else if(equalq(d,1,2)){if(push(r),a=pop(),push(a),real(),yyfloat(),Math.abs(pop().d)>Math.pow(2,32))return push(p1),restore(),!1;if(push(a),push_integer(-2),push(e),multiply(),push(t),divide(),a=pop(),push(a),real(),yyfloat(),Math.abs(pop().d)>Math.pow(2,32))return pop(),push(p1),restore(),!1;push(a),push(symbol(SECRETX)),multiply(),push_integer(1),push(symbol(SECRETX)),push_integer(2),power(),multiply(),add(),add()}if(push(symbol(SECRETX)),recursionLevelNestedRadicalsRemoval++,roots(),recursionLevelNestedRadicalsRemoval--,equal(stack[tos-1],symbol(NIL)))return DEBUG_SIMPLIFY&&console.log("roots bailed out because of too much recursion"),pop(),push(p1),restore(),!1;for(Se=[],de=stack[tos-1].tensor.elem,re=0,B=de.length;re<B;re++)f=de[re],Find(f,symbol(POWER))||Se.push(f);if(pop(),Se.length===0)return push(p1),restore(),!1;for(fe=[],me=[],J=0,H=Se.length;J<H;J++)S=Se[J],push(S),real(),yyfloat(),fe.push(S),me.push(pop().d);return xe=me.indexOf(Math.max.apply(Math,me)),n=fe[xe],equalq(d,1,3)?(push(e),push(n),push_integer(3),power(),push_integer(3),push(r),multiply(),push(n),multiply(),add(),divide(),push_rational(1,3),power()):equalq(d,1,2)&&(push(e),push(n),push_integer(2),power(),push(r),add(),divide(),push_rational(1,2),power()),K=pop(),K==null?(push(p1),restore(),!1):(push(K),push(n),multiply(),equalq(d,1,3)?(te=pop(),push(K),push(r),push_rational(1,2),power(),multiply(),push(te),add(),simplify()):equalq(d,1,2)&&(te=pop(),push(K),push(r),push_rational(1,2),power(),multiply(),push(te),add(),simplify(),ie=pop(),push(ie),real(),yyfloat(),ue=pop(),isnegativenumber(ue)?(push(K),negate(),K=pop(),push(te),negate(),te=pop(),push(K),push(r),push_rational(1,2),power(),multiply(),push(te),add(),simplify()):push(ie)),p1=pop(),push(p1),restore(),!0)}else return push(p1),restore(),!1;else if(iscons(p1)){for(g=tos,s=!1;iscons(p1);)push(car(p1)),s=s||take_care_of_nested_radicals(),p1=cdr(p1);return list(tos-g),restore(),s}else return push(p1),restore(),!1},Eval_sin=function(){return push(cadr(p1)),Eval(),sine()},sine=function(){return save(),p1=pop(),car(p1)===symbol(ADD)?sine_of_angle_sum():sine_of_angle(),restore()},sine_of_angle_sum=function(){for(p2=cdr(p1);iscons(p2);){if(p4=car(p2),isnpi(p4)){push(p1),push(p4),subtract(),p3=pop(),push(p3),sine(),push(p4),cosine(),multiply(),push(p3),cosine(),push(p4),sine(),multiply(),add();return}p2=cdr(p2)}return sine_of_angle()},sine_of_angle=function(){var e,t;if(car(p1)===symbol(ARCSIN)){push(cadr(p1));return}if(isdouble(p1)){e=Math.sin(p1.d),Math.abs(e)<1e-10&&(e=0),push_double(e);return}if(isnegative(p1)){push(p1),negate(),sine(),negate();return}if(car(p1)===symbol(ARCTAN)){push(cadr(p1)),push_integer(1),push(cadr(p1)),push_integer(2),power(),add(),push_rational(-1,2),power(),multiply();return}if(push(p1),push_integer(180),multiply(),evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),divide(),t=pop_integer(),t<0||isNaN(t)){push(symbol(SIN)),push(p1),list(2);return}switch(t%360){case 0:case 180:return push_integer(0);case 30:case 150:return push_rational(1,2);case 210:case 330:return push_rational(-1,2);case 45:case 135:return push_rational(1,2),push_integer(2),push_rational(1,2),power(),multiply();case 225:case 315:return push_rational(-1,2),push_integer(2),push_rational(1,2),power(),multiply();case 60:case 120:return push_rational(1,2),push_integer(3),push_rational(1,2),power(),multiply();case 240:case 300:return push_rational(-1,2),push_integer(3),push_rational(1,2),power(),multiply();case 90:return push_integer(1);case 270:return push_integer(-1);default:return push(symbol(SIN)),push(p1),list(2)}},Eval_sinh=function(){return push(cadr(p1)),Eval(),ysinh()},ysinh=function(){return save(),yysinh(),restore()},yysinh=function(){var e;if(e=0,p1=pop(),car(p1)===symbol(ARCSINH)){push(cadr(p1));return}if(isdouble(p1)){e=Math.sinh(p1.d),Math.abs(e)<1e-10&&(e=0),push_double(e);return}if(isZeroAtomOrTensor(p1)){push(zero);return}return push_symbol(SINH),push(p1),list(2)},subst=function(){var e,t,r,n,s,i,a,l,u;if(save(),s=pop(),a=pop(),a===symbol(NIL)||s===symbol(NIL)){restore();return}if(e=pop(),istensor(e)){for(i=alloc_tensor(e.tensor.nelem),i.tensor.ndim=e.tensor.ndim,t=r=0,l=e.tensor.ndim;0<=l?r<l:r>l;t=0<=l?++r:--r)i.tensor.dim[t]=e.tensor.dim[t];for(t=n=0,u=e.tensor.nelem;0<=u?n<u:n>u;t=0<=u?++n:--n)push(e.tensor.elem[t]),push(a),push(s),subst(),i.tensor.elem[t]=pop(),check_tensor_dimensions(i);push(i)}else equal(e,a)?push(s):iscons(e)?(push(car(e)),push(a),push(s),subst(),push(cdr(e)),push(a),push(s),subst(),cons()):push(e);return restore()},Eval_sum=function(){var e,t,r,n,s,i,a,l;if(t=0,n=0,s=0,e=cadr(p1),r=caddr(p1),issymbol(r)||stop("sum: 2nd arg?"),push(cadddr(p1)),Eval(),n=pop_integer(),isNaN(n)){push(p1);return}if(push(caddddr(p1)),Eval(),s=pop_integer(),isNaN(s)){push(p1);return}for(p4=get_binding(r),push_integer(0),t=i=a=n,l=s;a<=l?i<=l:i>=l;t=a<=l?++i:--i)push_integer(t),p5=pop(),set_binding(r,p5),push(e),Eval(),add();return set_binding(r,p4)},Eval_tan=function(){return push(cadr(p1)),Eval(),tangent()},tangent=function(){return save(),yytangent(),restore()},yytangent=function(){var e,t;if(t=0,e=0,p1=pop(),car(p1)===symbol(ARCTAN)){push(cadr(p1));return}if(isdouble(p1)){e=Math.tan(p1.d),Math.abs(e)<1e-10&&(e=0),push_double(e);return}if(isnegative(p1)){push(p1),negate(),tangent(),negate();return}if(push(p1),push_integer(180),multiply(),evaluatingAsFloats?push_double(Math.PI):push_symbol(PI),divide(),t=pop_integer(),t<0||isNaN(t)){push(symbol(TAN)),push(p1),list(2);return}switch(t%360){case 0:case 180:return push_integer(0);case 30:case 210:return push_rational(1,3),push_integer(3),push_rational(1,2),power(),multiply();case 150:case 330:return push_rational(-1,3),push_integer(3),push_rational(1,2),power(),multiply();case 45:case 225:return push_integer(1);case 135:case 315:return push_integer(-1);case 60:case 240:return push_integer(3),push_rational(1,2),power();case 120:case 300:return push_integer(3),push_rational(1,2),power(),negate();default:return push(symbol(TAN)),push(p1),list(2)}},Eval_tanh=function(){var e;if(e=0,push(cadr(p1)),Eval(),p1=pop(),car(p1)===symbol(ARCTANH)){push(cadr(p1));return}if(isdouble(p1)){e=Math.tanh(p1.d),Math.abs(e)<1e-10&&(e=0),push_double(e);return}if(isZeroAtomOrTensor(p1)){push(zero);return}return push_symbol(TANH),push(p1),list(2)},Eval_taylor=function(){return p1=cdr(p1),push(car(p1)),Eval(),p1=cdr(p1),push(car(p1)),Eval(),p2=pop(),p2===symbol(NIL)?guess():push(p2),p1=cdr(p1),push(car(p1)),Eval(),p2=pop(),p2===symbol(NIL)?push_integer(24):push(p2),p1=cdr(p1),push(car(p1)),Eval(),p2=pop(),p2===symbol(NIL)?push_integer(0):push(p2),taylor()},taylor=function(){var e,t,r,n;if(e=0,t=0,save(),p4=pop(),p3=pop(),p2=pop(),p1=pop(),push(p3),t=pop_integer(),isNaN(t)){push_symbol(TAYLOR),push(p1),push(p2),push(p3),push(p4),list(5),restore();return}for(push(p1),push(p2),push(p4),subst(),Eval(),push_integer(1),p5=pop(),e=r=1,n=t;(1<=n?r<=n:r>=n)&&(push(p1),push(p2),derivative(),p1=pop(),!isZeroAtomOrTensor(p1));e=1<=n?++r:--r)push(p5),push(p2),push(p4),subtract(),multiply(),p5=pop(),push(p1),push(p2),push(p4),subst(),Eval(),push(p5),multiply(),push_integer(e),factorial(),divide(),add();return restore()},Eval_tensor=function(){var e,t,r,n,s,i,a,l,u;for(r=0,i=0,a=0,check_tensor_dimensions(p1),a=p1.tensor.nelem,i=p1.tensor.ndim,p2=alloc_tensor(a),p2.tensor.ndim=i,r=n=0,l=i;0<=l?n<l:n>l;r=0<=l?++n:--n)p2.tensor.dim[r]=p1.tensor.dim[r];for(e=p1.tensor.elem,t=p2.tensor.elem,check_tensor_dimensions(p2),r=s=0,u=a;0<=u?s<u:s>u;r=0<=u?++s:--s)push(e[r]),Eval(),t[r]=pop();return check_tensor_dimensions(p1),check_tensor_dimensions(p2),push(p2),promote_tensor()},tensor_plus_tensor=function(){var e,t,r,n,s,i,a,l,u,c,f,d;if(n=0,l=0,u=0,save(),p2=pop(),p1=pop(),l=p1.tensor.ndim,l!==p2.tensor.ndim){push(symbol(NIL)),restore();return}for(n=s=0,c=l;0<=c?s<c:s>c;n=0<=c?++s:--s)if(p1.tensor.dim[n]!==p2.tensor.dim[n]){push(symbol(NIL)),restore();return}for(u=p1.tensor.nelem,p3=alloc_tensor(u),p3.tensor.ndim=l,n=i=0,f=l;0<=f?i<f:i>f;n=0<=f?++i:--i)p3.tensor.dim[n]=p1.tensor.dim[n];for(e=p1.tensor.elem,t=p2.tensor.elem,r=p3.tensor.elem,n=a=0,d=u;0<=d?a<d:a>d;n=0<=d?++a:--a)push(e[n]),push(t[n]),add(),r[n]=pop();return push(p3),restore()},tensor_times_scalar=function(){var e,t,r,n,s,i,a,l,u;for(r=0,i=0,a=0,save(),p2=pop(),p1=pop(),i=p1.tensor.ndim,a=p1.tensor.nelem,p3=alloc_tensor(a),p3.tensor.ndim=i,r=n=0,l=i;0<=l?n<l:n>l;r=0<=l?++n:--n)p3.tensor.dim[r]=p1.tensor.dim[r];for(e=p1.tensor.elem,t=p3.tensor.elem,r=s=0,u=a;0<=u?s<u:s>u;r=0<=u?++s:--s)push(e[r]),push(p2),multiply(),t[r]=pop();return push(p3),restore()},scalar_times_tensor=function(){var e,t,r,n,s,i,a,l,u;for(r=0,i=0,a=0,save(),p2=pop(),p1=pop(),i=p2.tensor.ndim,a=p2.tensor.nelem,p3=alloc_tensor(a),p3.tensor.ndim=i,r=n=0,l=i;0<=l?n<l:n>l;r=0<=l?++n:--n)p3.tensor.dim[r]=p2.tensor.dim[r];for(e=p2.tensor.elem,t=p3.tensor.elem,r=s=0,u=a;0<=u?s<u:s>u;r=0<=u?++s:--s)push(p1),push(e[r]),multiply(),t[r]=pop();return push(p3),restore()},check_tensor_dimensions=function(e){if(e.tensor.nelem!==e.tensor.elem.length){console.log("something wrong in tensor dimensions");debugger}},d_tensor_tensor=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m;if(n=0,s=0,u=0,c=0,u=p1.tensor.ndim,c=p1.tensor.nelem,u+1>=MAXDIM){push_symbol(DERIVATIVE),push(p1),push(p2),list(3);return}for(p3=alloc_tensor(c*p2.tensor.nelem),p3.tensor.ndim=u+1,n=i=0,f=u;0<=f?i<f:i>f;n=0<=f?++i:--i)p3.tensor.dim[n]=p1.tensor.dim[n];for(p3.tensor.dim[u]=p2.tensor.dim[0],e=p1.tensor.elem,t=p2.tensor.elem,r=p3.tensor.elem,n=a=0,d=c;0<=d?a<d:a>d;n=0<=d?++a:--a)for(s=l=0,m=p2.tensor.nelem;0<=m?l<m:l>m;s=0<=m?++l:--l)push(e[n]),push(t[s]),derivative(),r[n*p2.tensor.nelem+s]=pop();return push(p3)},d_scalar_tensor=function(){var e,t,r,n,s;for(p3=alloc_tensor(p2.tensor.nelem),p3.tensor.ndim=1,p3.tensor.dim[0]=p2.tensor.dim[0],e=p2.tensor.elem,t=p3.tensor.elem,r=n=0,s=p2.tensor.nelem;0<=s?n<s:n>s;r=0<=s?++n:--n)push(p1),push(e[r]),derivative(),t[r]=pop();return push(p3)},d_tensor_scalar=function(){var e,t,r,n,s,i,a;for(r=0,p3=alloc_tensor(p1.tensor.nelem),p3.tensor.ndim=p1.tensor.ndim,r=n=0,i=p1.tensor.ndim;0<=i?n<i:n>i;r=0<=i?++n:--n)p3.tensor.dim[r]=p1.tensor.dim[r];for(e=p1.tensor.elem,t=p3.tensor.elem,r=s=0,a=p1.tensor.nelem;0<=a?s<a:s>a;r=0<=a?++s:--s)push(e[r]),push(p2),derivative(),t[r]=pop();return push(p3)},compare_tensors=function(e,t){var r,n,s,i,a;if(r=0,e.tensor.ndim<t.tensor.ndim)return-1;if(e.tensor.ndim>t.tensor.ndim)return 1;for(r=n=0,i=e.tensor.ndim;0<=i?n<i:n>i;r=0<=i?++n:--n){if(e.tensor.dim[r]<t.tensor.dim[r])return-1;if(e.tensor.dim[r]>t.tensor.dim[r])return 1}for(r=s=0,a=e.tensor.nelem;0<=a?s<a:s>a;r=0<=a?++s:--s)if(!equal(e.tensor.elem[r],t.tensor.elem[r]))return lessp(e.tensor.elem[r],t.tensor.elem[r])?-1:1;return 0},power_tensor=function(){var e,t,r,n,s,i,a,l;if(e=0,t=0,s=0,t=p1.tensor.ndim-1,p1.tensor.dim[0]!==p1.tensor.dim[t]){push_symbol(POWER),push(p1),push(p2),list(3);return}if(push(p2),s=pop_integer(),isNaN(s)){push_symbol(POWER),push(p1),push(p2),list(3);return}if(s===0){for(p1.tensor.ndim!==2&&stop("power(tensor,0) with tensor rank not equal to 2"),s=p1.tensor.dim[0],p1=alloc_tensor(s*s),p1.tensor.ndim=2,p1.tensor.dim[0]=s,p1.tensor.dim[1]=s,e=r=0,i=s;0<=i?r<i:r>i;e=0<=i?++r:--r)p1.tensor.elem[s*e+e]=one;check_tensor_dimensions(p1),push(p1);return}for(s<0&&(s=-s,push(p1),inv(),p1=pop()),push(p1),l=[],e=n=1,a=s;(1<=a?n<a:n>a)&&(push(p1),inner(),!isZeroAtomOrTensor(stack[tos-1]));e=1<=a?++n:--n)l.push(void 0);return l},copy_tensor=function(){var e,t,r,n,s;for(e=0,save(),p1=pop(),p2=alloc_tensor(p1.tensor.nelem),p2.tensor.ndim=p1.tensor.ndim,e=t=0,n=p1.tensor.ndim;0<=n?t<n:t>n;e=0<=n?++t:--t)p2.tensor.dim[e]=p1.tensor.dim[e];for(e=r=0,s=p1.tensor.nelem;0<=s?r<s:r>s;e=0<=s?++r:--r)p2.tensor.elem[e]=p1.tensor.elem[e];return check_tensor_dimensions(p1),check_tensor_dimensions(p2),push(p2),restore()},promote_tensor=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m,g,S;if(e=0,t=0,r=0,l=0,a=0,save(),p1=pop(),!istensor(p1)){push(p1),restore();return}for(p2=p1.tensor.elem[0],e=n=1,f=p1.tensor.nelem;1<=f?n<f:n>f;e=1<=f?++n:--n)compatible(p2,p1.tensor.elem[e])||stop("Cannot promote tensor due to inconsistent tensor components.");if(!istensor(p2)){push(p1),restore();return}for(a=p1.tensor.ndim+p2.tensor.ndim,a>MAXDIM&&stop("tensor rank > "+MAXDIM),l=p1.tensor.nelem*p2.tensor.nelem,p3=alloc_tensor(l),p3.tensor.ndim=a,e=s=0,d=p1.tensor.ndim;0<=d?s<d:s>d;e=0<=d?++s:--s)p3.tensor.dim[e]=p1.tensor.dim[e];for(t=i=0,m=p2.tensor.ndim;0<=m?i<m:i>m;t=0<=m?++i:--i)p3.tensor.dim[e+t]=p2.tensor.dim[t];for(r=0,e=u=0,g=p1.tensor.nelem;0<=g?u<g:u>g;e=0<=g?++u:--u)for(p2=p1.tensor.elem[e],t=c=0,S=p2.tensor.nelem;0<=S?c<S:c>S;t=0<=S?++c:--c)p3.tensor.elem[r++]=p2.tensor.elem[t];return check_tensor_dimensions(p2),check_tensor_dimensions(p3),push(p3),restore()},compatible=function(e,t){var r,n,s;if(!istensor(e)&&!istensor(t))return 1;if(!istensor(e)||!istensor(t)||e.tensor.ndim!==t.tensor.ndim)return 0;for(r=n=0,s=e.tensor.ndim;0<=s?n<s:n>s;r=0<=s?++n:--n)if(e.tensor.dim[r]!==t.tensor.dim[r])return 0;return 1},Eval_test=function(){var e,t;for(t=p1,p1=cdr(p1);iscons(p1);){if(cdr(p1)===symbol(NIL)){push(car(p1)),Eval();return}if(e=isZeroLikeOrNonZeroLikeOrUndetermined(car(p1)),e==null){push(t);return}else if(e){push(cadr(p1)),Eval();return}else p1=cddr(p1)}return push_integer(0)},Eval_testeq=function(){var e,t,r;if(t=p1,push(cadr(p1)),Eval(),push(caddr(p1)),Eval(),subtract(),r=pop(),e=isZeroLikeOrNonZeroLikeOrUndetermined(r),e){push_integer(0);return}else if(e!=null&&!e){push_integer(1);return}if(push(cadr(p1)),Eval(),simplify(),push(caddr(p1)),Eval(),simplify(),subtract(),r=pop(),e=isZeroLikeOrNonZeroLikeOrUndetermined(r),e){push_integer(0);return}else if(e!=null&&!e){push_integer(1);return}return push(t)},Eval_testge=function(){var e,t;if(t=p1,e=cmp_args(),e==null){push(t);return}return e>=0?push_integer(1):push_integer(0)},Eval_testgt=function(){var e,t;if(t=p1,e=cmp_args(),e==null){push(t);return}return e>0?push_integer(1):push_integer(0)},Eval_testle=function(){var e,t;if(t=p1,e=cmp_args(),e==null){push(t);return}return e<=0?push_integer(1):push_integer(0)},Eval_testlt=function(){var e,t;if(t=p1,e=cmp_args(),e==null){push(t);return}return e<0?push_integer(1):push_integer(0)},Eval_not=function(){var e,t;return t=p1,e=isZeroLikeOrNonZeroLikeOrUndetermined(cadr(p1)),e==null?push(t):push_integer(e?0:1)},Eval_and=function(){var e,t,r,n;for(n=p1,e=cdr(n),r=!1;iscons(e);)if(t=isZeroLikeOrNonZeroLikeOrUndetermined(car(e)),t==null)r=!0,e=cdr(e);else if(t)e=cdr(e);else if(!t){push_integer(0);return}return r?push(n):push_integer(1)},Eval_or=function(){var e,t,r,n;for(n=p1,t=cdr(n),r=!1;iscons(t);)if(e=isZeroLikeOrNonZeroLikeOrUndetermined(car(t)),e==null)r=!0,t=cdr(t);else if(e){push_integer(1);return}else e||(t=cdr(t));return r?push(n):push_integer(0)},cmp_args=function(){var e;if(e=0,push(cadr(p1)),Eval(),simplify(),push(caddr(p1)),Eval(),simplify(),subtract(),p1=pop(),p1.k!==NUM&&p1.k!==DOUBLE&&(push(p1),yyfloat(),Eval(),p1=pop()),isZeroAtomOrTensor(p1))return 0;switch(p1.k){case NUM:MSIGN(p1.q.a)===-1?e=-1:e=1;break;case DOUBLE:p1.d<0?e=-1:e=1;break;default:e=null}return e},transform=function(e,t){var r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P;if(R=0,save(),p1=null,p4=pop(),p3=pop(),DEBUG&&console.log("         !!!!!!!!!   transform on: "+p3),saveMetaBindings(),set_binding(symbol(METAX),p4),R=tos,push_integer(1),push(p3),push(p4),polyform(),push(p4),r=tos-2,decomp(t),f=tos-r,DEBUG)for(console.log("  "+f+" decomposed elements ====== "),s=i=0,d=f;0<=d?i<d:i>d;s=0<=d?++i:--i)console.log("  decomposition element "+s+": "+stack[tos-1-s]);if(w=!1,t){if(!isNumericAtom(p3))if(y=e,DEBUG&&console.log("applying transform: "+y),DEBUG&&console.log("scanning table entry "+y),push(y),push(symbol(SYMBOL_A_UNDERSCORE)),push(symbol(METAA)),subst(),push(symbol(SYMBOL_B_UNDERSCORE)),push(symbol(METAB)),subst(),push(symbol(SYMBOL_X_UNDERSCORE)),push(symbol(METAX)),subst(),p1=pop(),p5=car(p1),DEBUG&&console.log("template expression: "+p5),p6=cadr(p1),p7=cddr(p1),f_equals_a(R,t))w=!0;else{for(DEBUG&&console.log("p3 at this point: "+p3),P=[],DEBUG&&console.log("car(p3): "+car(p3)),m=p3,iscons(m)&&(P.push(car(p3)),m=cdr(p3));iscons(m);)g=car(m),m=cdr(m),DEBUG&&console.log("tos before recursive transform: "+tos),push(g),push_symbol(NIL),DEBUG&&console.log("testing: "+g),DEBUG&&console.log("about to try to simplify other term: "+g),S=transform(e,t),w=w||S,P.push(pop()),DEBUG&&console.log("tried to simplify other term: "+g+" ...successful?: "+S+" ...transformed: "+P[P.length-1]);if(P.length!==0){for(u=0,a=P.length;u<a;u++)s=P[u],push(s);list(P.length),p6=pop()}}}else for(c=0,l=e.length;c<l;c++){if(n=e[c],DEBUG&&(console.log("scanning table entry "+n),(n+"").indexOf("f(sqrt(a+b*x),2/3*1/b*sqrt((a+b*x)^3))")!==-1))debugger;if(n&&(scan_meta(n),p1=pop(),p5=cadr(p1),p6=caddr(p1),p7=cdddr(p1),f_equals_a(R,t))){w=!0;break}}return moveTos(R),w?(push(p6),Eval(),p1=pop(),w=!0):t?p1=p3:p1=symbol(NIL),restoreMetaBindings(),push(p1),restore(),w},saveMetaBindings=function(){return push(get_binding(symbol(METAA))),push(get_binding(symbol(METAB))),push(get_binding(symbol(METAX)))},restoreMetaBindings=function(){return set_binding(symbol(METAX),pop()),set_binding(symbol(METAB),pop()),set_binding(symbol(METAA),pop())},f_equals_a=function(e,t){var r,n,s,i,a,l,u,c,f;for(r=0,n=0,r=s=l=e,u=tos;l<=u?s<u:s>u;r=l<=u?++s:--s)for(set_binding(symbol(METAA),stack[r]),DEBUG&&console.log("  binding METAA to "+get_binding(symbol(METAA))),n=i=c=e,f=tos;c<=f?i<f:i>f;n=c<=f?++i:--i){for(set_binding(symbol(METAB),stack[n]),DEBUG&&console.log("  binding METAB to "+get_binding(symbol(METAB))),p1=p7;iscons(p1)&&(push(car(p1)),Eval(),p2=pop(),!isZeroAtomOrTensor(p2));)p1=cdr(p1);if(!iscons(p1)&&(push(p3),DEBUG&&console.log("about to evaluate template expression: "+p5+" binding METAA to "+get_binding(symbol(METAA))+" and binding METAB to "+get_binding(symbol(METAB))+" and binding METAX to "+get_binding(symbol(METAX))),push(p5),t&&(a=expanding,expanding=!1),Eval(),t&&(expanding=a),DEBUG&&console.log("  comparing "+stack[tos-1]+" to: "+stack[tos-2]),subtract(),p1=pop(),isZeroAtomOrTensor(p1)))return DEBUG&&(console.log("binding METAA to "+get_binding(symbol(METAA))),console.log("binding METAB to "+get_binding(symbol(METAB))),console.log("binding METAX to "+get_binding(symbol(METAX))),console.log("comparing "+p3+" to: "+p5)),1}return 0},Eval_transpose=function(){return push(cadr(p1)),Eval(),cddr(p1)===symbol(NIL)?(push_integer(1),push_integer(2)):(push(caddr(p1)),Eval(),push(cadddr(p1)),Eval()),transpose()},transpose=function(){var e,t,r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re,ae,J,ie,ue;for(a=0,c=0,f=0,d=0,g=0,R=0,w=0,ue=0,r=[],n=[],a=m=0,H=MAXDIM;0<=H?m<H:m>H;a=0<=H?++m:--m)r[a]=0,n[a]=0;if(save(),p3=pop(),p2=pop(),p1=pop(),isNumericAtom(p1)){push(p1),restore();return}if((isplusone(p2)&&isplustwo(p3)||isplusone(p3)&&isplustwo(p2))&&isidentitymatrix(p1)){push(p1),restore();return}if(istranspose(p1)&&(l=car(cdr(cdr(p1))),u=car(cdr(cdr(cdr(p1)))),equal(l,p3)&&equal(u,p2)||equal(u,p3)&&equal(l,p2)||equal(l,symbol(NIL))&&equal(u,symbol(NIL))&&(isplusone(p3)&&isplustwo(p2)||isplusone(p2)&&isplustwo(p3)))){push(car(cdr(p1))),restore();return}if(expanding&&isadd(p1)){for(p1=cdr(p1),push(zero);iscons(p1);)push(car(p1)),push(p2),push(p3),transpose(),add(),p1=cdr(p1);restore();return}if(expanding&&ismultiply(p1)){for(p1=cdr(p1),push(one);iscons(p1);)push(car(p1)),push(p2),push(p3),transpose(),multiply(),p1=cdr(p1);restore();return}if(expanding&&isinnerordot(p1)){for(p1=cdr(p1),t=[];iscons(p1);)t.push([car(p1),p2,p3]),p1=cdr(p1);for(i=S=te=t.length-1;te<=0?S<=0:S>=0;i=te<=0?++S:--S)push(t[i][0]),push(t[i][1]),push(t[i][2]),transpose(),i!==t.length-1&&inner();restore();return}if(!istensor(p1)){if(!isZeroAtomOrTensor(p1)){push_symbol(TRANSPOSE),push(p1),(!isplusone(p2)||!isplustwo(p3))&&(!isplusone(p3)||!isplustwo(p2))?(push(p2),push(p3),list(4)):list(2),restore();return}push(zero),restore();return}if(R=p1.tensor.ndim,w=p1.tensor.nelem,R===1){push(p1),restore();return}for(push(p2),d=pop_integer(),push(p3),g=pop_integer(),(d<1||d>R||g<1||g>R)&&stop("transpose: index out of range"),d--,g--,p2=alloc_tensor(w),p2.tensor.ndim=R,a=y=0,K=R;0<=K?y<K:y>K;a=0<=K?++y:--y)p2.tensor.dim[a]=p1.tensor.dim[a];for(p2.tensor.dim[d]=p1.tensor.dim[g],p2.tensor.dim[g]=p1.tensor.dim[d],e=p1.tensor.elem,s=p2.tensor.elem,a=P=0,oe=R;0<=oe?P<oe:P>oe;a=0<=oe?++P:--P)r[a]=0,n[a]=p1.tensor.dim[a];for(a=C=0,re=w;0<=re?C<re:C>re;a=0<=re?++C:--C){for(ue=r[d],r[d]=r[g],r[g]=ue,ue=n[d],n[d]=n[g],n[g]=ue,f=0,c=B=0,ae=R;0<=ae?B<ae:B>ae;c=0<=ae?++B:--B)f=f*n[c]+r[c];for(ue=r[d],r[d]=r[g],r[g]=ue,ue=n[d],n[d]=n[g],n[g]=ue,s[f]=e[a],c=ie=J=R-1;(J<=0?ie<=0:ie>=0)&&!(++r[c]<n[c]);c=J<=0?++ie:--ie)r[c]=0}return push(p2),restore()},Eval_user_function=function(){var e,t;if(DEBUG&&console.log("Eval_user_function evaluating: "+car(p1)),car(p1)===symbol(SYMBOL_D)&&get_binding(symbol(SYMBOL_D))===symbol(SYMBOL_D)){Eval_derivative();return}if(push(car(p1)),Eval(),e=pop(),isNumericAtom(e)?stop("expected function invocation, found multiplication instead. Use '*' symbol explicitly for multiplication."):istensor(e)?stop("expected function invocation, found tensor product instead. Use 'dot/inner' explicitly."):isstr(e)&&stop("expected function, found string instead."),p3=car(cdr(e)),p4=car(cdr(cdr(e))),p5=cdr(p1),car(e)!==symbol(FUNCTION)||e===car(p1)){for(t=tos,push(e),p1=p5;iscons(p1);)push(car(p1)),Eval(),p1=cdr(p1);list(tos-t);return}for(p1=p4,p2=p5,t=tos;iscons(p1)&&iscons(p2);)push(car(p1)),push(car(p2)),p1=cdr(p1),p2=cdr(p2);return list(tos-t),p6=pop(),push(p3),iscons(p6)&&(push(p6),rewrite_args()),Eval()},rewrite_args=function(){var e,t;if(t=0,save(),p2=pop(),p1=pop(),istensor(p1))return t=rewrite_args_tensor(),restore(),t;if(iscons(p1)){for(e=tos,car(p1)===car(p2)?(push_symbol(EVAL),push(car(cdr(p2))),list(2)):push(car(p1)),p1=cdr(p1);iscons(p1);)push(car(p1)),push(p2),t+=rewrite_args(),p1=cdr(p1);return list(tos-e),restore(),t}if(!issymbol(p1))return push(p1),restore(),0;for(p3=p2;iscons(p3);){if(p1===car(p3))return push(cadr(p3)),restore(),1;p3=cddr(p3)}return p3=get_binding(p1),push(p3),p1!==p3&&(push(p2),t=rewrite_args(),t===0&&(pop(),push(p1))),restore(),t},rewrite_args_tensor=function(){var e,t,r,n;for(r=0,e=0,push(p1),copy_tensor(),p1=pop(),e=t=0,n=p1.tensor.nelem;0<=n?t<n:t>n;e=0<=n?++t:--t)push(p1.tensor.elem[e]),push(p2),r+=rewrite_args(),p1.tensor.elem[e]=pop();return check_tensor_dimensions(p1),push(p1),r},Eval_zero=function(){var e,t,r,n,s,i,a,l;for(e=0,t=[],n=0,i=0,e=r=0,a=MAXDIM;0<=a?r<a:r>a;e=0<=a?++r:--r)t[e]=0;for(n=1,i=0,p2=cdr(p1);iscons(p2);){if(push(car(p2)),Eval(),e=pop_integer(),e<1||isNaN(e)){push(zero);return}n*=e,t[i++]=e,p2=cdr(p2)}if(i===0){push(zero);return}for(p1=alloc_tensor(n),p1.tensor.ndim=i,e=s=0,l=i;0<=l?s<l:s>l;e=0<=l?++s:--s)p1.tensor.dim[e]=t[e];return push(p1)},allocatedId=0,alloc_tensor=function(e){var t,r,n,s;for(t=0,n=new U,n.k=TENSOR,n.tensor=new tensor,n.tensor.nelem=e,t=r=0,s=e;0<=s?r<s:r>s;t=0<=s?++r:--r)n.tensor.elem[t]=zero;return n.tensor.allocatedId=allocatedId,allocatedId++,check_tensor_dimensions(n),n},Find=function(e,t){var r,n,s;if(r=0,equal(e,t))return 1;if(istensor(e)){for(r=n=0,s=e.tensor.nelem;0<=s?n<s:n>s;r=0<=s?++n:--n)if(Find(e.tensor.elem[r],t))return 1;return 0}for(;iscons(e);){if(Find(car(e),t))return 1;e=cdr(e)}return 0},findPossibleClockForm=function(e){var t,r,n;if(t=0,isimaginaryunit(e))return 0;if(car(e)===symbol(POWER)&&!isinteger(caddr(p1))&&Find(cadr(e),imaginaryunit)||car(e)===symbol(POWER)&&equaln(cadr(e),-1)&&!isinteger(caddr(p1)))return 1;if(istensor(e)){for(t=r=0,n=e.tensor.nelem;0<=n?r<n:r>n;t=0<=n?++r:--r)if(findPossibleClockForm(e.tensor.elem[t]))return 1;return 0}for(;iscons(e);){if(findPossibleClockForm(car(e)))return 1;e=cdr(e)}return 0},findPossibleExponentialForm=function(e){var t,r,n;if(t=0,car(e)===symbol(POWER)&&cadr(e)===symbol(E))return Find(caddr(e),imaginaryunit);if(istensor(e)){for(t=r=0,n=e.tensor.nelem;0<=n?r<n:r>n;t=0<=n?++r:--r)if(findPossibleExponentialForm(e.tensor.elem[t]))return 1;return 0}for(;iscons(e);){if(findPossibleExponentialForm(car(e)))return 1;e=cdr(e)}return 0},$.Find=Find,init=function(){var e,t,r;if(e=0,flag=0,reset_after_error(),chainOfUserSymbolsNotFunctionsBeingEvaluated=[],!flag){for(flag=1,e=t=0,r=NSYM;0<=r?t<r:t>r;e=0<=r?++t:--t)symtab[e]=new U,symtab[e].k=SYM,binding[e]=symtab[e],isSymbolReclaimable[e]=!1;return defn()}},defn_str=['version="'+version+'"',"e=exp(1)","i=sqrt(-1)","autoexpand=1","assumeRealVariables=1","trange=[-pi,pi]","xrange=[-10,10]","yrange=[-10,10]","last=0","trace=0","forceFixedPrintout=1","maxFixedPrintoutDigits=6","printLeaveEAlone=1","printLeaveXAlone=0","cross(u,v)=[u[2]*v[3]-u[3]*v[2],u[3]*v[1]-u[1]*v[3],u[1]*v[2]-u[2]*v[1]]","curl(v)=[d(v[3],y)-d(v[2],z),d(v[1],z)-d(v[3],x),d(v[2],x)-d(v[1],y)]","div(v)=d(v[1],x)+d(v[2],y)+d(v[3],z)","ln(x)=log(x)"],defn=function(){var e,t,r,n,s;for(p0=symbol(NIL),p1=symbol(NIL),p2=symbol(NIL),p3=symbol(NIL),p4=symbol(NIL),p5=symbol(NIL),p6=symbol(NIL),p7=symbol(NIL),p8=symbol(NIL),p9=symbol(NIL),std_symbol("abs",ABS),std_symbol("add",ADD),std_symbol("adj",ADJ),std_symbol("and",AND),std_symbol("approxratio",APPROXRATIO),std_symbol("arccos",ARCCOS),std_symbol("arccosh",ARCCOSH),std_symbol("arcsin",ARCSIN),std_symbol("arcsinh",ARCSINH),std_symbol("arctan",ARCTAN),std_symbol("arctanh",ARCTANH),std_symbol("arg",ARG),std_symbol("atomize",ATOMIZE),std_symbol("besselj",BESSELJ),std_symbol("bessely",BESSELY),std_symbol("binding",BINDING),std_symbol("binomial",BINOMIAL),std_symbol("ceiling",CEILING),std_symbol("check",CHECK),std_symbol("choose",CHOOSE),std_symbol("circexp",CIRCEXP),std_symbol("clear",CLEAR),std_symbol("clearall",CLEARALL),std_symbol("clearpatterns",CLEARPATTERNS),std_symbol("clock",CLOCK),std_symbol("coeff",COEFF),std_symbol("cofactor",COFACTOR),std_symbol("condense",CONDENSE),std_symbol("conj",CONJ),std_symbol("contract",CONTRACT),std_symbol("cos",COS),std_symbol("cosh",COSH),std_symbol("decomp",DECOMP),std_symbol("defint",DEFINT),std_symbol("deg",DEGREE),std_symbol("denominator",DENOMINATOR),std_symbol("det",DET),std_symbol("derivative",DERIVATIVE),std_symbol("dim",DIM),std_symbol("dirac",DIRAC),std_symbol("divisors",DIVISORS),std_symbol("do",DO),std_symbol("dot",DOT),std_symbol("draw",DRAW),std_symbol("dsolve",DSOLVE),std_symbol("erf",ERF),std_symbol("erfc",ERFC),std_symbol("eigen",EIGEN),std_symbol("eigenval",EIGENVAL),std_symbol("eigenvec",EIGENVEC),std_symbol("eval",EVAL),std_symbol("exp",EXP),std_symbol("expand",EXPAND),std_symbol("expcos",EXPCOS),std_symbol("expsin",EXPSIN),std_symbol("factor",FACTOR),std_symbol("factorial",FACTORIAL),std_symbol("factorpoly",FACTORPOLY),std_symbol("filter",FILTER),std_symbol("float",FLOATF),std_symbol("floor",FLOOR),std_symbol("for",FOR),std_symbol("function",FUNCTION),std_symbol("Gamma",GAMMA),std_symbol("gcd",GCD),std_symbol("hermite",HERMITE),std_symbol("hilbert",HILBERT),std_symbol("imag",IMAG),std_symbol("component",INDEX),std_symbol("inner",INNER),std_symbol("integral",INTEGRAL),std_symbol("inv",INV),std_symbol("invg",INVG),std_symbol("isinteger",ISINTEGER),std_symbol("isprime",ISPRIME),std_symbol("laguerre",LAGUERRE),std_symbol("lcm",LCM),std_symbol("leading",LEADING),std_symbol("legendre",LEGENDRE),std_symbol("log",LOG),std_symbol("lookup",LOOKUP),std_symbol("mod",MOD),std_symbol("multiply",MULTIPLY),std_symbol("not",NOT),std_symbol("nroots",NROOTS),std_symbol("number",NUMBER),std_symbol("numerator",NUMERATOR),std_symbol("operator",OPERATOR),std_symbol("or",OR),std_symbol("outer",OUTER),std_symbol("pattern",PATTERN),std_symbol("patternsinfo",PATTERNSINFO),std_symbol("polar",POLAR),std_symbol("power",POWER),std_symbol("prime",PRIME),std_symbol("print",PRINT),std_symbol("print2dascii",PRINT2DASCII),std_symbol("printcomputer",PRINTFULL),std_symbol("printlatex",PRINTLATEX),std_symbol("printlist",PRINTLIST),std_symbol("printhuman",PRINTPLAIN),std_symbol("printLeaveEAlone",PRINT_LEAVE_E_ALONE),std_symbol("printLeaveXAlone",PRINT_LEAVE_X_ALONE),std_symbol("product",PRODUCT),std_symbol("quote",QUOTE),std_symbol("quotient",QUOTIENT),std_symbol("rank",RANK),std_symbol("rationalize",RATIONALIZE),std_symbol("real",REAL),std_symbol("rect",YYRECT),std_symbol("roots",ROOTS),std_symbol("round",ROUND),std_symbol("equals",SETQ),std_symbol("sgn",SGN),std_symbol("silentpattern",SILENTPATTERN),std_symbol("simplify",SIMPLIFY),std_symbol("sin",SIN),std_symbol("sinh",SINH),std_symbol("shape",SHAPE),std_symbol("sqrt",SQRT),std_symbol("stop",STOP),std_symbol("subst",SUBST),std_symbol("sum",SUM),std_symbol("symbolsinfo",SYMBOLSINFO),std_symbol("tan",TAN),std_symbol("tanh",TANH),std_symbol("taylor",TAYLOR),std_symbol("test",TEST),std_symbol("testeq",TESTEQ),std_symbol("testge",TESTGE),std_symbol("testgt",TESTGT),std_symbol("testle",TESTLE),std_symbol("testlt",TESTLT),std_symbol("transpose",TRANSPOSE),std_symbol("unit",UNIT),std_symbol("zero",ZERO),std_symbol("nil",NIL),std_symbol("autoexpand",AUTOEXPAND),std_symbol("bake",BAKE),std_symbol("assumeRealVariables",ASSUME_REAL_VARIABLES),std_symbol("last",LAST),std_symbol("lastprint",LAST_PRINT),std_symbol("last2dasciiprint",LAST_2DASCII_PRINT),std_symbol("lastfullprint",LAST_FULL_PRINT),std_symbol("lastlatexprint",LAST_LATEX_PRINT),std_symbol("lastlistprint",LAST_LIST_PRINT),std_symbol("lastplainprint",LAST_PLAIN_PRINT),std_symbol("trace",TRACE),std_symbol("forceFixedPrintout",FORCE_FIXED_PRINTOUT),std_symbol("maxFixedPrintoutDigits",MAX_FIXED_PRINTOUT_DIGITS),std_symbol("~",YYE),std_symbol("$DRAWX",DRAWX),std_symbol("$METAA",METAA),std_symbol("$METAB",METAB),std_symbol("$METAX",METAX),std_symbol("$SECRETX",SECRETX),std_symbol("version",VERSION),std_symbol("pi",PI),std_symbol("a",SYMBOL_A),std_symbol("b",SYMBOL_B),std_symbol("c",SYMBOL_C),std_symbol("d",SYMBOL_D),std_symbol("i",SYMBOL_I),std_symbol("j",SYMBOL_J),std_symbol("n",SYMBOL_N),std_symbol("r",SYMBOL_R),std_symbol("s",SYMBOL_S),std_symbol("t",SYMBOL_T),std_symbol("x",SYMBOL_X),std_symbol("y",SYMBOL_Y),std_symbol("z",SYMBOL_Z),std_symbol("I",SYMBOL_IDENTITY_MATRIX),std_symbol("a_",SYMBOL_A_UNDERSCORE),std_symbol("b_",SYMBOL_B_UNDERSCORE),std_symbol("x_",SYMBOL_X_UNDERSCORE),std_symbol("$C1",C1),std_symbol("$C2",C2),std_symbol("$C3",C3),std_symbol("$C4",C4),std_symbol("$C5",C5),std_symbol("$C6",C6),defineSomeHandyConstants(),n=codeGen,codeGen=!1,t=r=0,s=defn_str.length;0<=s?r<s:r>s;t=0<=s?++r:--r)e=defn_str[t],scan(e),DEBUG&&(console.log("... evaling "+e),console.log("top of stack:"),console.log(print_list(stack[tos-1]))),Eval(),pop();return codeGen=n},defineSomeHandyConstants=function(){return zero=new_integer(0),one=new_integer(1),push_double(1),one_as_double=pop(),push_symbol(POWER),DEBUG&&console.log(print_list(stack[tos-1])),push_integer(-1),DEBUG&&console.log(print_list(stack[tos-1])),push_rational(1,2),DEBUG&&console.log(print_list(stack[tos-1])),list(3),DEBUG&&console.log(print_list(stack[tos-1])),imaginaryunit=pop()},mcmp=function(e,t){return e.compare(t)},strcmp=function(e,t){return e===t?0:e>t?1:-1},doubleToReasonableString=function(e){var t,r;return codeGen?""+e:(isZeroAtomOrTensor(get_binding(symbol(FORCE_FIXED_PRINTOUT)))?(r=""+e,printMode===PRINTMODE_LATEX?/\d*\.\d*e.*/gm.test(r)?r=r.replace(/e(.*)/gm,"\\mathrm{e}{$1}"):r=r.replace(/(\d+)e(.*)/gm,"$1.0\\mathrm{e}{$2}"):/\d*\.\d*e.*/gm.test(r)?r=r.replace(/e(.*)/gm,"*10^($1)"):r=r.replace(/(\d+)e(.*)/gm,"$1.0*10^($2)")):(push(get_binding(symbol(MAX_FIXED_PRINTOUT_DIGITS))),t=pop_integer(),r=""+e.toFixed(t),r=r.replace(/(\.\d*?[1-9])0+$/gm,"$1"),r=r.replace(/\.0+$/gm,""),r.indexOf(".")===-1&&(r+=".0"),parseFloat(r)!==e&&(r=e.toFixed(t)+"...")),r)},clear_term=function(){},isspace=function(e){return e==null?!1:e===" "||e==="	"||e===`
`||e==="\v"||e==="\f"||e==="\r"},isdigit=function(e){return e==null?!1:/^\d+$/.test(e)},isalpha=function(e){return e==null?!1:e.search(/[^A-Za-z]/)===-1},isalphaOrUnderscore=function(e){return e==null?!1:e.search(/[^A-Za-z_]/)===-1},isalnumorunderscore=function(e){return e==null?!1:isalphaOrUnderscore(e)||isdigit(e)},count=function(e){var t;if(iscons(e))for(t=0;iscons(e);)t+=count(car(e))+1,e=cdr(e);else t=1;return t},countOccurrencesOfSymbol=function(e,t){var r;if(r=0,iscons(t))for(;iscons(t);)r+=countOccurrencesOfSymbol(e,car(t)),t=cdr(t);else equal(e,t)&&(r=1);return r},countsize=function(e){var t,r,n,s;if(n=0,istensor(e))for(t=r=0,s=e.tensor.nelem;0<=s?r<s:r>s;t=0<=s?++r:--r)n+=e.tensor.elem[t];else if(iscons(e))for(;iscons(e);)n+=count(car(e))+1,e=cdr(e);else n=1;return n},stop=function(e){var t;throw errorMessage+="Stop: ",errorMessage+=e,t=errorMessage,errorMessage="",moveTos(0),new Error(t)},findDependenciesInScript=function(e,t){var r,n,s,i,a,l,u,c,f,d,m,g,S,y,R,w,P,C,B,H,te,K,oe,re,ae,J,ie,ue,fe,Se,_e,me,de,be,ve,Ae,xe,Re,Ee,Te,Oe,T,z,Y,se,ye,v,A,k;for(DEBUG&&console.log("stringToBeParsed: "+e),Y=new Date().getTime(),codeGen=!0,symbolsDependencies={},symbolsHavingReassignments=[],symbolsInExpressionsWithoutAssignments=[],patternHasBeenFound=!1,S=0,n="",r="",ae=0,l={affectsVariables:[],affectedBy:[]},Oe=e;;){try{errorMessage="",check_stack(),DEBUG&&console.log("findDependenciesInScript: scanning"),ae=scan(e.substring(S)),DEBUG&&console.log("scanned"),pop(),check_stack()}catch(q){c=q,PRINTOUTRESULT&&console.log(c),errorMessage=c+"",reset_after_error();break}if(ae===0)break;S+=ae}z="",DEBUG&&console.log("all local dependencies ----------------"),z+="All local dependencies: ";for(y in symbolsDependencies){for(A=symbolsDependencies[y],DEBUG&&console.log("variable "+y+" depends on: "),l.affectsVariables.push(y),z+=" variable "+y+" depends on: ",R=0,w=A.length;R<w;R++)m=A[R],DEBUG&&console.log("    "+m),m[0]!=="'"&&l.affectedBy.push(m),z+=m+", ";z+="; "}for(z+=". ",DEBUG&&console.log("Symbols with reassignments ----------------"),z+="Symbols with reassignments: ",re=0,P=symbolsHavingReassignments.length;re<P;re++)y=symbolsHavingReassignments[re],l.affectedBy.indexOf(y)===-1&&(l.affectedBy.push(y),z+=y+", ");for(z+=". ",DEBUG&&console.log("Symbols in expressions without assignments ----------------"),z+="Symbols in expressions without assignments: ",J=0,C=symbolsInExpressionsWithoutAssignments.length;J<C;J++)y=symbolsInExpressionsWithoutAssignments[J],l.affectedBy.indexOf(y)===-1&&(l.affectedBy.push(y),z+=y+", ");if(z+=". ",l.affectedBy.push("PATTERN_DEPENDENCY"),patternHasBeenFound&&(l.affectsVariables.push("PATTERN_DEPENDENCY"),z+=" - PATTERN_DEPENDENCY inserted - "),DEBUG&&console.log("All dependencies recursively ----------------"),z+="All dependencies recursively: ",Te=["",""],d="",be="",errorMessage===""&&!t){try{n="",r="",Te=run(e,!0),n="",r=""}catch(q){c=q,PRINTOUTRESULT&&console.log(c),errorMessage=c+"",init()}if(errorMessage==="")for(y in symbolsDependencies){for(codeGen=!0,DEBUG&&console.log("  variable "+y+" is: "+get_binding(usr_symbol(y)).toString()),codeGen=!1,DEBUG&&console.log("  variable "+y+" depends on: "),z+=" variable "+y+" depends on: ",ve=[],k=[],i=[],recursiveDependencies(y,ve,[],k,[],i),ue=0,B=k.length;ue<B;ue++)m=k[ue],DEBUG&&console.log("    --> cycle through "+m);for(me=0,H=ve.length;me<H;me++)m=ve[me],DEBUG&&console.log("    "+m),z+=m+", ";for(z+="; ",de=0,te=i.length;de<te;de++)m=i[de],z+=" "+m+", ";for(DEBUG&&console.log("  code generation:"+y+" is: "+get_binding(usr_symbol(y)).toString()),push(get_binding(usr_symbol(y))),xe=[],Re=[],Ee=0,K=ve.length;Ee<K;Ee++)u=ve[Ee],u[0]==="'"&&(a=u.substring(1),Se=usr_symbol(a),ie=usr_symbol("AVOID_BINDING_TO_EXTERNAL_SCOPE_VALUE"+a),xe.push(Se),Re.push(ie),push(Se),push(ie),subst(),DEBUG&&console.log("after substitution: "+stack[tos-1]));try{simplifyForCodeGeneration()}catch(q){c=q,PRINTOUTRESULT&&console.log(c),errorMessage=c+"",init()}for(g=T=0,Ae=xe.length;0<=Ae?T<Ae:T>Ae;g=0<=Ae?++T:--T)push(Re[g]),push(xe[g]),subst();if(clearRenamedVariablesToAvoidBindingToExternalScope(),errorMessage===""){if(se=pop(),v=[],collectUserSymbols(se,v),n="",r="",codeGen=!0,f=se.toString(),codeGen=!1,fe=printMode,printMode=PRINTMODE_LATEX,s=se.toString(),printMode=fe,k.indexOf(y)!==-1)d+="// "+y+" is part of a cyclic dependency, no code generated.",be+="#"+y+" is part of a cyclic dependency, no code generated.";else if(v=v.filter(function(q){return predefinedSymbolsInGlobalScope_doNotTrackInDependencies.indexOf(q+"")===-1}),v=v.filter(function(q){return ve.indexOf(q+"")!==-1||ve.indexOf("'"+q)!==-1}),v.length!==0){for(_e="(",ye=0,oe=v.length;ye<oe;ye++)m=v[ye],m.printname!==y&&(_e+=m.printname+", ");_e=_e.replace(/, $/gm,""),_e+=")",d+=y+" = function "+_e+" { return ( "+f+" ); }",be+=y+_e+" = "+s}else d+=y+" = "+f+";",be+=y+" = "+s;d+=`
`,be+=`
`,DEBUG&&console.log("    "+d)}}}return d=d.replace(/\n$/gm,""),be=be.replace(/\n$/gm,""),symbolsDependencies={},symbolsHavingReassignments=[],patternHasBeenFound=!1,symbolsInExpressionsWithoutAssignments=[],DEBUG&&console.log("testable string: "+z),TIMING_DEBUGS&&console.log("findDependenciesInScript time for: "+Oe+" : "+(new Date().getTime()-Y)+"ms"),[z,Te[0],d,be,Te[1],errorMessage,l]},recursiveDependencies=function(e,t,r,n,s,i){var a,l,u,c,f,d,m,g;if(r.push(e),symbolsDependencies[s[s.length-1]]!=null&&symbolsDependencies[s[s.length-1]].indexOf("'"+e)!==-1)return DEBUG&&console.log("can't keep following the chain of "+e+" because it's actually a variable bound to a parameter"),t.indexOf("'"+e)===-1&&t.indexOf(e)===-1&&t.push(e),t;if(s.push(e),symbolsDependencies[e]==null)return t.indexOf(e)===-1&&t.push(e),t;for(g=symbolsDependencies[e],c=0,f=g.length;c<f;c++)if(l=g[c],s.indexOf(l)!==-1){for(DEBUG&&console.log("  found cycle:"),a="",m=0,d=s.length;m<d;m++)u=s[m],n.indexOf(u)===-1&&n.push(u),DEBUG&&console.log(u+" --> "),a+=u+" --> ";DEBUG&&console.log(" ... then "+l+" again"),a+=" ... then "+l+" again",i.push(a),n.indexOf(l)===-1&&n.push(l)}else recursiveDependencies(l,t,r,n,s,i),s.pop();return t},inited=!1,latexErrorSign="\\rlap{\\large\\color{red}\\bigtriangleup}{\\ \\ \\tiny\\color{red}!}",turnErrorMessageToLatex=function(e){return e=e.replace(/\n/g,""),e=e.replace(/_/g,"} \\_ \\text{"),e=e.replace(new RegExp(String.fromCharCode(transpose_unicode),"g"),"}{}^{T}\\text{"),e=e.replace(new RegExp(String.fromCharCode(dotprod_unicode),"g"),"}\\cdot \\text{"),e=e.replace("Stop:","}  \\quad \\text{Stop:"),e=e.replace("->","}  \\rightarrow \\text{"),e=e.replace("?","}\\enspace "+latexErrorSign+" \\enspace  \\text{"),e="$$\\text{"+e.replace(/\n/g,"")+"}$$",e},normaliseDots=function(e){return e=e.replace(new RegExp("","g"),String.fromCharCode(dotprod_unicode)),e=e.replace(new RegExp("","g"),String.fromCharCode(dotprod_unicode)),e=e.replace(new RegExp("","g"),String.fromCharCode(dotprod_unicode)),e=e.replace(new RegExp("\uD800","g"),String.fromCharCode(dotprod_unicode)),e=e.replace(new RegExp("","g"),String.fromCharCode(dotprod_unicode)),e},TIMING_DEBUGS=!1,run=function(e,t=!1){var r,n,s,i,a,l,u,c,f,d,m;if(d=new Date().getTime(),e=normaliseDots(e),e==="selftest"){selftest();return}for(inited||(inited=!0,init()),u=0,l=0,n="",r="";;){try{errorMessage="",check_stack(),u=scan(e.substring(l)),p1=pop(),check_stack()}catch(g){a=g,PRINTOUTRESULT&&console.log(a),n+=a.message,t&&(f=turnErrorMessageToLatex(a.message),r+=f),reset_after_error();break}if(u===0)break;l+=u,push(p1);try{stringsEmittedByUserPrintouts="",top_level_eval(),p2=pop(),check_stack(),isstr(p2)&&(DEBUG&&console.log(p2.str),DEBUG&&console.log(`
`)),p2===symbol(NIL)?(i=stringsEmittedByUserPrintouts,t&&(s="$$"+stringsEmittedByUserPrintouts+"$$")):(i=print_expr(p2),i+=`
`,t&&(s="$$"+collectLatexStringFromReturnValue(p2)+"$$",DEBUG&&console.log("collectedLatexResult: "+s))),n+=i,t&&(r+=s),PRINTOUTRESULT&&(DEBUG&&console.log("printline"),DEBUG&&console.log(i)),PRINTOUTRESULT&&(DEBUG&&console.log("display:"),print2dascii(p2)),t&&(r+=`
`)}catch(g){a=g,i=a.message,t&&(s=turnErrorMessageToLatex(a.message)),PRINTOUTRESULT&&console.log(i),n+=i,i!==""&&(n+=`
`),t&&(r+=s,r+=`
`),init()}}return n[n.length-1]===`
`&&(n=n.substring(0,n.length-1)),t&&r[r.length-1]===`
`&&(r=r.substring(0,r.length-1)),t?(DEBUG&&console.log("allReturnedLatexStrings: "+r),c=[n,r]):c=n,TIMING_DEBUGS&&(m="run time on: "+e+" : "+(new Date().getTime()-d)+"ms",console.log(m)),n="",r="",c},check_stack=function(){if(tos!==0){debugger;stop("stack error")}if(frame!==TOS){debugger;stop("frame error")}if(chainOfUserSymbolsNotFunctionsBeingEvaluated.length!==0){debugger;stop("symbols evaluation still ongoing?")}if(evaluatingAsFloats!==0){debugger;stop("numeric evaluation still ongoing?")}if(evaluatingPolar!==0){debugger;return stop("evaluation of polar still ongoing?")}},top_level_eval=function(){var e,t,r;if(DEBUG&&console.log("#### top level eval"),trigmode=0,r=symbol(AUTOEXPAND),isZeroAtomOrTensor(get_binding(r))?expanding=0:expanding=1,t=top(),Eval(),e=top(),e!==symbol(NIL)&&(set_binding(symbol(LAST),e),isZeroAtomOrTensor(get_binding(symbol(BAKE)))||(bake(),e=top()),!((t===symbol(SYMBOL_I)||t===symbol(SYMBOL_J))&&isimaginaryunit(e)))){if(isimaginaryunit(get_binding(symbol(SYMBOL_J))))return push(imaginaryunit),push_symbol(SYMBOL_J),subst();if(isimaginaryunit(get_binding(symbol(SYMBOL_I))))return push(imaginaryunit),push_symbol(SYMBOL_I),subst()}},check_esc_flag=function(){if(esc_flag)return stop("esc key")},clearAlgebraEnvironment=function(){return do_clearall()},computeDependenciesFromAlgebra=function(e){var t,r,n,s,i,a,l;if(DEBUG&&console.log("computeDependenciesFromAlgebra!!!"),r=!0,e=normaliseDots(e),!r){for(userSimplificationsInListForm=[],l="",n=0,s=userSimplificationsInListForm.length;n<s;n++)t=userSimplificationsInListForm[n],l+="silentpattern("+car(t)+","+car(cdr(t))+","+car(cdr(cdr(t)))+`)
`;do_clearall(),e=l+e,DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}if(DEBUG){for(console.log("computeDependenciesFromAlgebra: patterns in the list --------------- "),a=0,i=userSimplificationsInListForm.length;a<i;a++)t=userSimplificationsInListForm[a],console.log(car(t)+","+cdr(t)+")");console.log("...end of list --------------- ")}return findDependenciesInScript(e,!0)[6]},computeResultsAndJavaScriptFromAlgebra=function(e){var t,r,n,s,i,a,l,u,c,f,d,m,g,S,y;if(s=!0,S=new Date().getTime(),TIMING_DEBUGS&&console.log(" --------- computeResultsAndJavaScriptFromAlgebra input: "+e+" at: "+new Date),e=normaliseDots(e),m=e,DEBUG){for(console.log("computeResultsAndJavaScriptFromAlgebra: patterns in the list --------------- "),i=0,l=userSimplificationsInListForm.length;i<l;i++)n=userSimplificationsInListForm[i],console.log(car(n)+","+cdr(n)+")");console.log("...end of list --------------- ")}if(!s){for(userSimplificationsInListForm=[],y="",c=0,u=userSimplificationsInListForm.length;c<u;c++)n=userSimplificationsInListForm[c],y+="silentpattern("+car(n)+","+car(cdr(n))+","+car(cdr(cdr(n)))+`)
`;do_clearall(),e=y+e,DEBUG&&console.log("codeFromAlgebraBlock including patterns: "+e)}return[g,d,t,f,a,errorMessage,r]=findDependenciesInScript(e),(f!==""||errorMessage!=="")&&(d+=`
`+f,errorMessage!==""&&(d+=`
`+errorMessage),d=d.replace(/\n/g,`

`),a+=`
$$`+f+"$$",errorMessage!==""&&(a+=turnErrorMessageToLatex(errorMessage)),a=a.replace(/\n/g,`

`)),a=a.replace(/\n*/,""),a=a.replace(/\$\$\$\$\n*/g,""),t=t.replace(/Math\./g,""),t=t.replace(/\n/g,`

`),TIMING_DEBUGS&&console.log("computeResultsAndJavaScriptFromAlgebra time (total time from notebook and back) for: "+m+" : "+(new Date().getTime()-S)+"ms"),{code:t,result:a,latexResult:a,dependencyInfo:r}},(exports!==null?exports:this).run=run,(exports!==null?exports:this).findDependenciesInScript=findDependenciesInScript,(exports!==null?exports:this).computeDependenciesFromAlgebra=computeDependenciesFromAlgebra,(exports!==null?exports:this).computeResultsAndJavaScriptFromAlgebra=computeResultsAndJavaScriptFromAlgebra,(exports!==null?exports:this).clearAlgebraEnvironment=clearAlgebraEnvironment,tos=0,nil_symbols=0,push=function(e){if(e==null)debugger;if(e.isZero!=null)debugger;return e===symbol(NIL)&&(nil_symbols++,DEBUG&&console.log("pushing symbol(NIL) #"+nil_symbols)),tos>=frame&&stop("stack overflow"),stack[tos++]=e},moveTos=function(e){if(tos<=e){tos=e;return}for(;tos>e;)stack[tos]=null,tos--},top=function(){return stack[tos-1]},pop=function(){var e;if(tos===0){debugger;stop("stack underflow")}if(stack[tos-1]==null)debugger;return e=stack[--tos],stack[tos]=null,e},push_frame=function(e){var t,r,n,s;if(t=0,frame-=e,frame<tos){debugger;stop("frame overflow, circular reference?")}for(s=[],t=r=0,n=e;0<=n?r<n:r>n;t=0<=n?++r:--r)s.push(stack[frame+t]=symbol(NIL));return s},pop_frame=function(e){if(frame+=e,frame>TOS)return stop("frame underflow")},save=function(){if(frame-=10,frame<tos){debugger;stop("frame overflow, circular reference?")}return stack[frame+0]=p0,stack[frame+1]=p1,stack[frame+2]=p2,stack[frame+3]=p3,stack[frame+4]=p4,stack[frame+5]=p5,stack[frame+6]=p6,stack[frame+7]=p7,stack[frame+8]=p8,stack[frame+9]=p9},restore=function(){return frame>TOS-10&&stop("frame underflow"),p0=stack[frame+0],p1=stack[frame+1],p2=stack[frame+2],p3=stack[frame+3],p4=stack[frame+4],p5=stack[frame+5],p6=stack[frame+6],p7=stack[frame+7],p8=stack[frame+8],p9=stack[frame+9],frame+=10},swap=function(){var e,t;return e=pop(),t=pop(),push(e),push(t)},dupl=function(){var e;return e=pop(),push(e),push(e)},$.dupl=dupl,$.swap=swap,$.restore=restore,$.save=save,$.push=push,$.pop=pop,Eval_symbolsinfo=function(){var e;return e=symbolsinfo(),e!==""?push(new_string(e)):push_symbol(NIL)},symbolsinfo=function(){var e,t,r,n,s,i,a;for(i="",t=r=n=NIL+1,s=symtab.length;n<=s?r<s:r>s;t=n<=s?++r:--r){if(symtab[t].printname===""){if(isSymbolReclaimable[t]===!1)break;continue}a=symtab[t]+"",e=(binding[t]+"").substring(0,4),i+="symbol: "+a+" size: "+countsize(binding[t])+" value: "+e+`...
`}return i},std_symbol=function(e,t,r){var n;if(n=symtab[t],n==null)debugger;return n.printname=e,r!=null?n.latexPrint=r:n.latexPrint=e},usr_symbol=function(e){var t,r,n;for(t=0,t=r=0,n=NSYM;0<=n?r<n:r>n;t=0<=n?++r:--r){if(e===symtab[t].printname)return symtab[t];if(symtab[t].printname==="")break}return t===NSYM&&stop("symbol table overflow"),symtab[t]=new U,symtab[t].k=SYM,symtab[t].printname=e,binding[t]=symtab[t],isSymbolReclaimable[t]=!1,symtab[t]},get_printname=function(e){return e.k!==SYM&&stop("symbol error"),e.printname},set_binding=function(e,t){var r;if(e.k!==SYM&&stop("symbol error"),r=symtab.indexOf(e),symtab.indexOf(e,r+1)!==-1){console.log("ops, more than one element!");debugger}return DEBUG&&console.log("lookup >> set_binding lookup "+r),isSymbolReclaimable[r]=!1,binding[r]=t},get_binding=function(e){var t;if(e.k!==SYM&&stop("symbol error"),t=symtab.indexOf(e),symtab.indexOf(e,t+1)!==-1){console.log("ops, more than one element!");debugger}return DEBUG&&console.log("lookup >> get_binding lookup "+t),binding[t]},is_usr_symbol=function(e){var t;return e.k!==SYM?!1:(t=symnum(e),t>PI&&t!==SYMBOL_I&&t!==SYMBOL_IDENTITY_MATRIX)},lookupsTotal=0,symnum=function(e){var t;if(lookupsTotal++,e.k!==SYM&&stop("symbol error"),t=symtab.indexOf(e),symtab.indexOf(e,t+1)!==-1){console.log("ops, more than one element!");debugger}return DEBUG&&console.log("lookup >> symnum lookup "+t+" lookup # "+lookupsTotal),t},push_symbol=function(e){return push(symtab[e])},clear_symbols=function(){var e,t,r,n,s;for(s=[],e=t=r=NIL+1,n=NSYM;r<=n?t<n:t>n;e=r<=n?++t:--t){if(symtab[e].printname===""){if(isSymbolReclaimable[e]===!1)break;continue}symtab[e]=new U,symtab[e].k=SYM,binding[e]=symtab[e],s.push(isSymbolReclaimable[e]=!1)}return s},collectUserSymbols=function(e,t=[]){var r,n,s;if(is_usr_symbol(e)&&t.indexOf(e)===-1){t.push(e);return}if(istensor(e)){for(r=n=0,s=e.tensor.nelem;0<=s?n<s:n>s;r=0<=s?++n:--n)collectUserSymbols(e.tensor.elem[r],t);return}for(;iscons(e);)collectUserSymbols(car(e),t),e=cdr(e)},$.get_binding=get_binding,$.set_binding=set_binding,$.usr_symbol=usr_symbol,$.symbolsinfo=symbolsinfo,$.collectUserSymbols=collectUserSymbols,inited||(inited=!0,init()),$.init=init,parse_internal=function(e){return typeof e=="string"?scan(e):typeof e=="number"?e%1===0?push_integer(e):push_double(e):e instanceof U?push(e):(console.warn("unknown argument type",e),push(symbol(NIL)))},parse=function(e){var t,r;try{parse_internal(e),t=pop(),check_stack()}catch(n){throw r=n,reset_after_error(),r}return t},exec=function(e,...t){var r,n,s,i,a,l;for(s=get_binding(usr_symbol(e)),check_stack(),push(s),i=0,a=t.length;i<a;i++)r=t[i],parse_internal(r);list(1+t.length),p1=pop(),push(p1);try{top_level_eval(),l=pop(),check_stack()}catch(u){throw n=u,reset_after_error(),n}return l},$.exec=exec,$.parse=parse,function(){var e,t,r,n,s;for(e=["abs","add","adj","and","approxratio","arccos","arccosh","arcsin","arcsinh","arctan","arctanh","arg","atomize","besselj","bessely","binding","binomial","ceiling","check","choose","circexp","clear","clearall","clearpatterns","clock","coeff","cofactor","condense","conj","contract","cos","cosh","decomp","defint","deg","denominator","det","derivative","dim","dirac","divisors","do","dot","draw","dsolve","eigen","eigenval","eigenvec","erf","erfc","eval","exp","expand","expcos","expsin","factor","factorial","factorpoly","filter","float","floor","for","Gamma","gcd","hermite","hilbert","imag","component","inner","integral","inv","invg","isinteger","isprime","laguerre","lcm","leading","legendre","log","mod","multiply","not","nroots","number","numerator","operator","or","outer","pattern","patternsinfo","polar","power","prime","print","print2dascii","printcomputer","printlatex","printlist","printhuman","product","quote","quotient","rank","rationalize","real","rect","roots","round","equals","shape","sgn","silentpattern","simplify","sin","sinh","sqrt","stop","subst","sum","symbolsinfo","tan","tanh","taylor","test","testeq","testge","testgt","testle","testlt","transpose","unit","zero"],s=[],r=0,n=e.length;r<n;r++)t=e[r],s.push($[t]=exec.bind(this,t));return s}()}).call(algebrite)}(algebrite)),algebrite}var algebriteExports=requireAlgebrite();const Algebrite=getDefaultExportFromCjs(algebriteExports);class Matrix{constructor(t,r,n=!1,s=!1,i){we(this,"rowCount");we(this,"colCount");we(this,"isSquare");we(this,"isAugmented");we(this,"determinant");we(this,"matrix");we(this,"kVector");this.rowCount=t,this.colCount=r,this.isSquare=n,this.isAugmented=s,this.determinant=0,this.matrix=[],this.kVector=Array.from({length:t}).fill(0);for(let a=0;a<t;a++)this.matrix[a]=Array.from({length:r}).fill(0);i!==void 0&&(this.matrix=i)}addRow(){this.rowCount<20&&(this.matrix[this.rowCount]=Array.from({length:this.colCount}).fill(0),this.kVector[this.rowCount]=0,this.rowCount++)}removeRow(){this.rowCount>1&&(this.matrix.pop(),this.kVector.pop(),this.rowCount--)}addCol(){if(this.colCount<20){for(let t=0;t<this.rowCount;t++)this.matrix[t][this.colCount]=0;this.colCount++,this.isSquare&&this.addRow()}}setRowCount(t){if(t>0&&t<=20&&t!==this.rowCount){this.matrix.length=t,this.kVector.length=t;for(let r=this.rowCount;r<t;r++)this.matrix[r]=Array.from({length:this.colCount}).fill(0),this.kVector[r]=0;return this.rowCount=t,!0}return!1}setColCount(t){if(t>0&&t<=20&&t!==this.colCount){for(let r=0;r<this.rowCount;r++){this.matrix[r].length=t;for(let n=this.colCount;n<t;n++)this.matrix[r][n]=0}return this.colCount=t,this.isSquare&&this.setRowCount(t),!0}return!1}removeCol(){if(this.colCount>1){for(let t=0;t<this.rowCount;t++)this.matrix[t].pop();this.colCount--,this.isSquare&&this.removeRow()}}updateCellValue(t,r,n){this.matrix[t][r]=n}updateKVectorValue(t,r){this.kVector[t]=r}updateMatrixFromString(t){const r=t.trim().split(`
`),n=r.length;let s=this.isSquare?n:0;this.isSquare||(s=r.reduce((u,c)=>{const f=c.trim().split(/\s+/).length;return Math.max(u,f)},0));const i=[],a=[];for(let u=0;u<n;u++){i[u]=[];const c=r[u].trim().split(/\s+/).map(Number.parseFloat);a[u]=c;for(let f=0;f<s;f++)i[u][f]=c[f]||0;if(!this.isSquare&&s>c.length)for(let f=c.length;f<s;f++)i[u][f]=0}let l;if(this.isAugmented){l=Array.from({length:s-1}).fill(0);for(let u=0;u<n;u++){const c=this.isSquare?a[u][i.length]:i[u].pop();c!==void 0&&(l[u]=c)}}this.setMatrix(i,l)}getMatrixAsString(){let t="";for(let r=0;r<this.rowCount;r++){for(let n=0;n<this.colCount;n++)t+=this.matrix[r][n],n<this.colCount-1&&(t+=" ");this.isAugmented&&(t+=" ",t+=this.kVector[r]),r<this.rowCount-1&&(t+=`
`)}return t}setMatrix(t,r){this.rowCount=t.length,this.colCount=t[0].length,this.matrix=t,r!=null&&(this.kVector=r)}calculateDetetrminantRecursively(t){return t==null?this.calculateDeterminant(this.matrix,this.matrix.length):this.calculateDeterminant(t,t.length)}calculateDeterminant(t,r){if(r===1)return t[0][0];if(r===2)return t[0][0]*t[1][1]-t[1][0]*t[0][1];if(r===3)return t[0][0]*t[1][1]*t[2][2]-t[0][0]*t[1][2]*t[2][1]-t[0][1]*t[1][0]*t[2][2]+t[0][1]*t[1][2]*t[2][0]+t[0][2]*t[1][0]*t[2][1]-t[0][2]*t[1][1]*t[2][0];const n=[];for(let a=0;a<r-1;a++){n[a]=[];for(let l=0;l<r-1;l++)n[a][l]=t[a+1][l+1]}let s=-1,i=t[0][0]*this.calculateDeterminant(n,r-1);for(let a=0;a<r-1;a++){for(let l=0;l<r-1;l++)n[a][l]=t[a][l+1];i+=s*t[a+1][0]*this.calculateDeterminant(n,r-1),s=-s}return Math.round(i*1e4)/1e4}calculateSolutionsWithCramer(){const t=this.matrix,r=this.kVector,n=[],s=t.length,i=t[0].length,a=this.calculateDetetrminantRecursively(t);if(a===0)return{solutions:[],determinant:0};const l=JSON.parse(JSON.stringify(this.matrix));for(let u=0;u<i;u++){if(u>0)for(let f=0;f<s;f++)l[f][u-1]=t[f][u-1];for(let f=0;f<s;f++)l[f][u]=r[f];const c=this.calculateDetetrminantRecursively(l);n[u]=Math.round(c/a*1e4)/1e4}return{solutions:n,determinant:a}}static multiplyMatrices(t,r){const n=[],s=t.length,i=t[0].length,a=r.length;for(let l=0;l<a;l++){n[l]=[];for(let u=0;u<i;u++)n[l][u]=0}for(let l=0;l<a;l++)for(let u=0;u<i;u++)for(let c=0;c<s;c++)n[l][u]+=t[c][u]*r[l][c];return n}findInverseMatrix(){const t=this.calculateDetetrminantRecursively();if(t===0)return{determinant:t};let r=Array.from({length:this.rowCount});if(this.rowCount===1)r=[[1]];else for(let s=0;s<this.rowCount;s++){r[s]=Array.from({length:this.colCount});for(let i=0;i<this.colCount;i++)r[s][i]=this.findAlgebraicComplement(this.matrix,s,i)}const n=this.transposeMatrix(r);for(let s=0;s<n.length;s++)for(let i=0;i<n[0].length;i++)n[s][i]=Math.round(n[s][i]/t*1e4)/1e4;return{determinant:t,inverseMatrix:n}}findAlgebraicComplement(t,r,n){const s=Array.from({length:t.length-1});for(let i=0;i<s.length;i++){s[i]=Array.from({length:t[0].length-1});for(let a=0;a<t.length;a++)s[i][a]=t[i+(i>=r?1:0)][a+(a>=n?1:0)]}return this.calculateDetetrminantRecursively(s)*((r+n)%2?-1:1)}transposeMatrix(t){const r=t[0].length,n=t.length,s=Array.from({length:r});for(let i=0;i<r;i++)s[i]=Array.from({length:n});for(let i=0;i<t.length;i++)for(let a=0;a<t[0].length;a++)s[a][i]=t[i][a];return s}findSolutionsWithInverseMatrix(){const{determinant:t,inverseMatrix:r}=this.findInverseMatrix();if(t===0)return{determinant:0};const n=Array.from({length:this.kVector.length});for(let a=0;a<this.kVector.length;a++)n[a]=[this.kVector[a]];const s=Matrix.multiplyMatrices(n,r),i=[];for(let a=0;a<s.length;a++)i[a]=s[a][0];return{determinant:t,solutions:i}}copyMatrix(t){const r=t===void 0?this.matrix:t,n=r.length;if(n===0)return[];const s=r[0].length,i=Array.from({length:n});for(let a=0;a<n;a++){i[a]=Array.from({length:s});for(let l=0;l<s;l++)i[a][l]=r[a][l]}return i}roundToDecimalPlace(t,r){return Math.round((t+Number.EPSILON*Math.sign(t))*10**r)/10**r}solveWithGaussElimination(){const{rowEchelonMatrix:t,rowEchelonkVector:r}=this.convertMatrixToRowEchelonForm();this.convertToDiagonalFromRowEchelon(t,r);const n=t.length,s=t[0].length,i=[];for(let a=0;a<Math.min(n,s);a++){if(t[a][a]<=Number.EPSILON*100){i[a]={k:"R"};continue}i[a]={k:`${this.roundToDecimalPlace(r[a],4)}`,rationalSubtraction:{}};for(let l=a+1;l<s;l++)if(Math.abs(t[a][l])>Number.EPSILON*100){const u=Math.abs(this.roundToDecimalPlace(t[a][l],4));i[a].k!=="R"&&(i[a].rationalSubtraction[`${l+1}`]=(Math.sign(-t[a][l])===-1?" - ":" + ")+(u===1?"":u))}}for(let a=n;a<s;a++)i[a]={k:"R"};return i}convertMatrixToRowEchelonForm(t,r){const n=this.copyMatrix(t),s=r===void 0?[...this.kVector]:[...r],i=n.length,a=n[0].length;let l=0,u=0;for(;l<i&&u<a;){let c=l,f=Math.abs(n[l][u]);for(let d=l+1;d<i;d++){const m=Math.abs(n[d][u]);m>f&&(f=m,c=d)}if(Math.abs(f)<=Number.EPSILON*100)u++;else{if(c!==l){for(let m=u;m<a;m++){const g=n[c][m];n[c][m]=n[l][m],n[l][m]=g}const d=s[l];s[l]=s[c],s[c]=d}for(let d=l+1;d<i;d++){const m=n[d][u]/n[l][u];n[d][u]=0;for(let g=u+1;g<a;g++)n[d][g]=n[d][g]-n[l][g]*m+Number.EPSILON;s[d]=s[d]-s[l]*m+Number.EPSILON}}l++,u++}return{rowEchelonMatrix:n,rowEchelonkVector:s}}convertToDiagonalFromRowEchelon(t,r){const n=t.length,s=t[0].length;for(let i=1;i<Math.min(n,s);i++)if(Math.abs(t[i][i])>Number.EPSILON*100)for(let a=i-1;a>=0;a--){const l=t[a][i]/t[i][i];r[a]=r[a]-r[i]*l+Number.EPSILON,t[a][i]=0;for(let u=i+1;u<s;u++)t[a][u]=t[a][u]-t[i][u]*l+Number.EPSILON}for(let i=0;i<Math.min(n,s);i++)if(Math.abs(t[i][i])>Number.EPSILON*100){r[i]=r[i]/t[i][i];for(let a=i+1;a<s;a++)t[i][a]/=t[i][i];t[i][i]=1}}getEigenvector(){const t=this.getEigenvectorEquation(),r=[];t.forEach(s=>{const i=this.getEigenvectorFromEigenvalue(s);r.push(i)});const n=[];for(let s=0;s<r.length;s++)n.push({eigenvalue:t[s],eigenvector:r[s]});return n}getEigenvectorEquation(){const t=this.getAlphaStringsMatrix(this.matrix),r=this.getDeterminantFormula(t,t.length),n=Algebrite.nroots(Algebrite.simplify(r)).toString().replace(/[[\]]|\.\.\./g,"").split(",");return console.log("before",n),n.filter(s=>!s.includes("i"))}getDeterminantFormula(t,r){if(r===1)return`${t[0][0]}`;if(r===2)return`${t[0][0]}*${t[1][1]}-${t[1][0]}*${t[0][1]}`;if(r===3)return`${t[0][0]} * ${t[1][1]} * ${t[2][2]}- ${t[0][0]} * ${t[1][2]} * ${t[2][1]}- ${t[0][1]} * ${t[1][0]} * ${t[2][2]}+ ${t[0][1]} * ${t[1][2]} * ${t[2][0]}+ ${t[0][2]} * ${t[1][0]} * ${t[2][1]}- ${t[0][2]} * ${t[1][1]} * ${t[2][0]}`;const n=[];for(let a=0;a<r-1;a++){n[a]=[];for(let l=0;l<r-1;l++)n[a][l]=t[a+1][l+1]}let s=-1,i=`${t[0][0]} * (${this.getDeterminantFormula(n,r-1)})`;for(let a=0;a<r-1;a++){for(let l=0;l<r-1;l++)n[a][l]=t[a][l+1];i+=`${s===1?"+":"-"}${t[a+1][0]} * (${this.getDeterminantFormula(n,r-1)})`,s=-s}return i}getAlphaStringsMatrix(t){const r=t.length,n=Array.from({length:r});for(let s=0;s<r;s++){n[s]=Array.from({length:r});for(let i=0;i<r;i++)s===i?n[s][i]=`(${this.floatToDivisionString(t[s][i])}-x)`:n[s][i]=`${this.floatToDivisionString(t[s][i])}`}return n}countDecimals(t){return t%1!==0?t.toString().split(".")[1].length:0}floatToDivisionString(t){const r=this.countDecimals(t);if(r===0)return`(${t})`;const n=10**r;return`(${t*n}/${n})`}getEigenvectorFromEigenvalue(t){const r=Number.parseFloat(t),n=this.matrix.length,s=this.copyMatrix(this.matrix);for(let a=0;a<n;a++)s[a][a]-=r;const i=this.convertMatrixToRowEchelonForm(s,Array.from({length:n}).fill(0));return console.log(r,i),this.parseMatrixIntoEigenvector(i.rowEchelonMatrix)}parseMatrixIntoEigenvector(t){const r=t.length,n=[];for(let s=0;s<r;s++){if(t[s][s]<=Number.EPSILON*100){n[s]=[`x${s+1}`];continue}let i="";for(let a=s+1;a<r;a++)if(Math.abs(t[s][a])>Number.EPSILON*100){const l=Math.abs(this.roundToDecimalPlace(t[s][a],4));i+=`${(Math.sign(-t[s][a])===-1?" - ":" + ")+(l===1?"":l)}x${a+1}`}i.charAt(1)==="-"&&i.charAt(2)===" "&&(i=i.replace(" - ","-")),i.charAt(1)==="+"&&i.charAt(2)===" "&&(i=i.replace(" + ","")),i=i||"0",n[s]=[i]}return n}}let uid=0;function uidGet(){return uid++,uid}const _hoisted_1$9={class:"matrix"},_hoisted_2$7={class:"matrix-editor"},_hoisted_3$6=["id","cols","rows"],_hoisted_4$5={class:"size-controller"},_hoisted_5$1={class:"matrix-table"},_hoisted_6={class:"size"},_hoisted_7={key:0},_hoisted_8={class:"row-index"},_sfc_main$b=defineComponent({__name:"matrix-editor",props:{userResizable:{type:Boolean,default:!0},matrix:{type:Matrix,required:!0}},setup(e){const t=e,r=uidGet(),n=ref(!1),s=ref(""),i=useTemplateRef("matrixEditor"),a=reactive(t.matrix),l=computed(()=>a.rowCount),u=computed(()=>a.colCount);function c(y,R,w){const P=Number.parseFloat(w.target.value);Number.isNaN(P)||a.updateCellValue(y,R,P)}function f(y,R){const w=Number.parseFloat(R.target.value);Number.isNaN(w)||a.updateKVectorValue(y,w)}function d(){s.value=a.getMatrixAsString(),n.value=!0,setTimeout(()=>{var y;return(y=i.value)==null?void 0:y.select()},0)}function m(){a.updateMatrixFromString(s.value),n.value=!1}function g(y){const R=y.which?y.which:y.keyCode;if(R>31&&(R<48||R>57)&&R!==46&&R!==45)y.preventDefault();else return!0}function S(y){const R=y.which?y.which:y.keyCode;if(R>31&&(R<48||R>57)&&R!==46&&R!==45&&R!==32)y.preventDefault();else return!0}return watch(a,()=>{s.value=a.getMatrixAsString()}),(y,R)=>(openBlock(),createElementBlock("div",_hoisted_1$9,[withDirectives(createBaseVNode("div",_hoisted_2$7,[withDirectives(createBaseVNode("textarea",{id:`matrix-editor-${unref(r)}`,ref_key:"matrixEditor",ref:i,"onUpdate:modelValue":R[0]||(R[0]=w=>s.value=w),cols:u.value*2+4,rows:l.value+2,onKeypress:R[1]||(R[1]=w=>S(w))},null,40,_hoisted_3$6),[[vModelText,s.value]]),createBaseVNode("button",{onClick:withModifiers(m,["prevent"])}," Close ")],512),[[vShow,n.value]]),createBaseVNode("div",_hoisted_4$5,[createBaseVNode("button",{class:"open-editor-button","aria-label":"Open text editor",onClick:withModifiers(d,["prevent"])},[createVNode(EditorIcon)]),!a.isSquare&&e.userResizable?(openBlock(),createBlock(SizeController,{key:0,name:"Rows",size:l.value,class:"row-controller",onUpdate:R[2]||(R[2]=w=>a.setRowCount(w))},null,8,["size"])):createCommentVNode("",!0),e.userResizable?(openBlock(),createBlock(SizeController,{key:1,name:a.isSquare?"Size":"Cols",size:u.value,class:"col-controller",onUpdate:R[3]||(R[3]=w=>a.setColCount(w))},null,8,["name","size"])):createCommentVNode("",!0)]),createBaseVNode("div",_hoisted_5$1,[createBaseVNode("table",null,[createBaseVNode("tbody",null,[createBaseVNode("tr",null,[createBaseVNode("th",_hoisted_6,toDisplayString(l.value)+" x "+toDisplayString(u.value),1),(openBlock(!0),createElementBlock(Fragment,null,renderList(u.value,w=>(openBlock(),createElementBlock("th",{key:w},toDisplayString(w),1))),128)),a.isAugmented?(openBlock(),createElementBlock("th",_hoisted_7," b ")):createCommentVNode("",!0)]),(openBlock(!0),createElementBlock(Fragment,null,renderList(a.matrix,(w,P)=>(openBlock(),createElementBlock("tr",{key:P},[createBaseVNode("td",_hoisted_8,toDisplayString(P+1),1),(openBlock(!0),createElementBlock(Fragment,null,renderList(w,(C,B)=>(openBlock(),createBlock(MatrixCell,{key:`${B}_${P}`,"col-index":B,"row-index":P,"matrix-id":unref(r),value:C===0?0:C,onKeypress:R[4]||(R[4]=H=>g(H)),onInput:H=>c(P,B,H)},null,8,["col-index","row-index","matrix-id","value","onInput"]))),128)),a.isAugmented?(openBlock(),createBlock(MatrixCell,{key:0,"col-index":a.colCount+1,"row-index":P,"matrix-id":unref(r),value:a.kVector[P],onKeypress:R[5]||(R[5]=C=>g(C)),onInput:C=>f(P,C)},null,8,["col-index","row-index","matrix-id","value","onInput"])):createCommentVNode("",!0)]))),128))])])])]))}}),MatrixEditor=_export_sfc(_sfc_main$b,[["__scopeId","data-v-362fcf7b"]]),_hoisted_1$8={class:"calculator"},_hoisted_2$6={class:"determinant"},_hoisted_3$5={key:0,class:"result"},_sfc_main$a=defineComponent({__name:"DeterminantCalculator",setup(e){const t=reactive(new Matrix(4,4,!0,!1)),r=ref(!1),n=ref(0);watch(t,()=>r.value=!1);function s(){r.value=!0,n.value=t.calculateDetetrminantRecursively()}return(i,a)=>(openBlock(),createElementBlock("div",_hoisted_1$8,[createVNode(MatrixEditor,{matrix:t},null,8,["matrix"]),createBaseVNode("div",_hoisted_2$6,[createBaseVNode("button",{onClick:withModifiers(s,["prevent"])}," Calculate determinant "),r.value?(openBlock(),createElementBlock("div",_hoisted_3$5,"  = "+toDisplayString(n.value),1)):createCommentVNode("",!0)])]))}}),DeterminantCalculator=_export_sfc(_sfc_main$a,[["__scopeId","data-v-0d16f009"]]),_hoisted_1$7={class:"calculator"},_hoisted_2$5={key:0,class:"eigenpairs"},_hoisted_3$4={class:"eigenvalue"},_hoisted_4$4={class:"eigenvector"},_hoisted_5=["innerHTML"],_sfc_main$9=defineComponent({__name:"EigenvectorFinder",setup(e){const t=reactive(new Matrix(3,3,!0,!1)),r=ref(!1),n=ref([]);function s(){n.value=[...t.getEigenvector()],r.value=!0}function i(a){return a.toString().replace(/x(\d+)/g,"x<sub>$1</sub>")}return watch(t,()=>{r.value=!1}),(a,l)=>(openBlock(),createElementBlock("div",_hoisted_1$7,[createVNode(MatrixEditor,{matrix:t,onUpdate:l[0]||(l[0]=u=>r.value=!1)},null,8,["matrix"]),r.value?(openBlock(),createElementBlock("div",_hoisted_2$5,[(openBlock(!0),createElementBlock(Fragment,null,renderList(n.value,(u,c)=>(openBlock(),createElementBlock("div",{key:c,class:"eigenpair"},[createBaseVNode("div",_hoisted_3$4,"  = "+toDisplayString(u.eigenvalue),1),createBaseVNode("div",_hoisted_4$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(u.eigenvector,f=>(openBlock(),createElementBlock("div",{key:f.toString(),class:"coefficient",innerHTML:i(f)},null,8,_hoisted_5))),128))])]))),128))])):createCommentVNode("",!0),createBaseVNode("button",{onClick:l[1]||(l[1]=withModifiers(u=>s(),["prevent"]))}," Find eigenvector/eigenvalue ")]))}}),EigenvectorFinder=_export_sfc(_sfc_main$9,[["__scopeId","data-v-b869ad56"]]),_hoisted_1$6={class:"calculator"},_hoisted_2$4={key:0,class:"result"},_sfc_main$8=defineComponent({__name:"MatrixGaussSolver",setup(e){const t=reactive(new Matrix(3,3,!1,!0)),r=ref(!1),n=ref([]);function s(){n.value=t.solveWithGaussElimination(),r.value=!0}return watch(t,()=>{r.value=!1}),(i,a)=>(openBlock(),createElementBlock("div",_hoisted_1$6,[createVNode(MatrixEditor,{matrix:t,onUpdate:a[0]||(a[0]=l=>r.value=!1)},null,8,["matrix"]),createBaseVNode("button",{onClick:a[1]||(a[1]=withModifiers(l=>s(),["prevent"]))}," Find roots "),r.value?(openBlock(),createElementBlock("div",_hoisted_2$4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(n.value,(l,u)=>(openBlock(),createElementBlock("div",{key:u,class:"solution"},[a[2]||(a[2]=createTextVNode(" x ")),createBaseVNode("sub",null,toDisplayString(u+1),1),createTextVNode(" "+toDisplayString(l.k==="R"?"  R":` = ${l.k}`)+" ",1),(openBlock(!0),createElementBlock(Fragment,null,renderList(l.rationalSubtraction,(c,f)=>(openBlock(),createElementBlock("span",{key:f,class:"rational-subtraction"},[createTextVNode(toDisplayString(c)+"x ",1),createBaseVNode("sub",null,toDisplayString(f),1)]))),128)),a[3]||(a[3]=createTextVNode(" ;")),a[4]||(a[4]=createBaseVNode("br",null,null,-1))]))),128))])):createCommentVNode("",!0)]))}}),MatrixGaussSolver=_export_sfc(_sfc_main$8,[["__scopeId","data-v-eca48cd6"]]),_hoisted_1$5={class:"calculator"},_hoisted_2$3={class:"matrix-display"},_hoisted_3$3={class:"inverse-matrix"},_hoisted_4$3={key:0,class:"error"},_sfc_main$7=defineComponent({__name:"MatrixInverse",setup(e){const t=reactive(new Matrix(4,4,!0)),r=reactive(new Matrix(4,4,!0)),n=ref(!1),s=ref(!1);watch(t,()=>{n.value=!1,s.value=!1});function i(){const a=t.findInverseMatrix();a.determinant===0?s.value=!0:(r.setMatrix(a.inverseMatrix),n.value=!0)}return(a,l)=>(openBlock(),createElementBlock("div",_hoisted_1$5,[createBaseVNode("div",_hoisted_2$3,[createVNode(MatrixEditor,{matrix:t},null,8,["matrix"]),withDirectives(createBaseVNode("div",_hoisted_3$3,[createVNode(MatrixEditor,{matrix:r,"user-resizable":!1},null,8,["matrix"])],512),[[vShow,n.value]])]),createBaseVNode("button",{onClick:withModifiers(i,["prevent"])}," Find an inverse matrix "),s.value?(openBlock(),createElementBlock("div",_hoisted_4$3," Error! Determinant is 0 ")):createCommentVNode("",!0)]))}}),MatrixInverse=_export_sfc(_sfc_main$7,[["__scopeId","data-v-fb6426d2"]]),_hoisted_1$4={class:"calculator"},_hoisted_2$2={key:0,class:"result"},_hoisted_3$2={key:0,class:"error"},_hoisted_4$2={key:1,class:"solutions"},_sfc_main$6=defineComponent({__name:"MatrixInverseSolver",setup(e){const t=reactive(new Matrix(4,4,!0,!0)),r=ref([]),n=ref(!1),s=ref(0);function i(){const{determinant:a,solutions:l}=t.findSolutionsWithInverseMatrix();s.value=a,a!==0&&(r.value=l),n.value=!0}return(a,l)=>(openBlock(),createElementBlock("div",_hoisted_1$4,[createVNode(MatrixEditor,{matrix:t,onUpdate:l[0]||(l[0]=u=>n.value=!1)},null,8,["matrix"]),createBaseVNode("button",{onClick:l[1]||(l[1]=withModifiers(u=>i(),["prevent"]))}," Find roots "),n.value?(openBlock(),createElementBlock("div",_hoisted_2$2,[s.value===0?(openBlock(),createElementBlock("div",_hoisted_3$2," Error! Determinant is 0 ")):createCommentVNode("",!0),s.value!==0?(openBlock(),createElementBlock("div",_hoisted_4$2,[(openBlock(!0),createElementBlock(Fragment,null,renderList(r.value,(u,c)=>(openBlock(),createElementBlock("div",{key:c,class:"solution"},[l[2]||(l[2]=createTextVNode(" x ")),createBaseVNode("sub",null,toDisplayString(c+1),1),createTextVNode(" = "+toDisplayString(u)+"; ",1)]))),128))])):createCommentVNode("",!0)])):createCommentVNode("",!0)]))}}),MatrixInverseSolver=_export_sfc(_sfc_main$6,[["__scopeId","data-v-26953c79"]]),_hoisted_1$3={class:"calculator"},_hoisted_2$1={class:"matrix-container"},_hoisted_3$1={class:"matrix-container"},_hoisted_4$1={class:"matrix-container",style:{"padding-top":"16px"}},_sfc_main$5=defineComponent({__name:"MatrixMultiplier",setup(e){const t=reactive(new Matrix(3,2)),r=reactive(new Matrix(4,3)),n=reactive(new Matrix(4,2));function s(){n.setMatrix(Matrix.multiplyMatrices(t.matrix,r.matrix))}return watch(r,()=>{t.setRowCount(r.colCount),s()}),watch(t,()=>{r.setColCount(t.rowCount),s()}),(i,a)=>(openBlock(),createElementBlock("div",_hoisted_1$3,[createBaseVNode("div",_hoisted_2$1,[createVNode(MatrixEditor,{matrix:r},null,8,["matrix"])]),createBaseVNode("div",_hoisted_3$1,[createVNode(MatrixEditor,{matrix:t},null,8,["matrix"])]),createBaseVNode("div",_hoisted_4$1,[createVNode(MatrixEditor,{matrix:n,"user-resizable":!1},null,8,["matrix"])])]))}}),MatrixMultiplier=_export_sfc(_sfc_main$5,[["__scopeId","data-v-2ddff44c"]]),_hoisted_1$2={class:"calculator"},_hoisted_2={key:0,class:"result"},_hoisted_3={key:0,class:"error"},_hoisted_4={key:1,class:"solutions"},_sfc_main$4=defineComponent({__name:"MatrixSolver",setup(e){const t=reactive(new Matrix(4,4,!0,!0)),r=ref(!1),n=ref([]),s=ref(0);function i(){const a=t.calculateSolutionsWithCramer();n.value=a.solutions,s.value=a.determinant,r.value=!0}return(a,l)=>(openBlock(),createElementBlock("div",_hoisted_1$2,[createVNode(MatrixEditor,{matrix:t,onUpdate:l[0]||(l[0]=u=>r.value=!1)},null,8,["matrix"]),createBaseVNode("button",{onClick:l[1]||(l[1]=withModifiers(u=>i(),["prevent"]))}," Find roots "),r.value?(openBlock(),createElementBlock("div",_hoisted_2,[s.value===0?(openBlock(),createElementBlock("div",_hoisted_3," Error! Determinant is 0 ")):createCommentVNode("",!0),s.value!==0?(openBlock(),createElementBlock("div",_hoisted_4,[(openBlock(!0),createElementBlock(Fragment,null,renderList(n.value,(u,c)=>(openBlock(),createElementBlock("div",{key:c,class:"solution"},[l[2]||(l[2]=createTextVNode(" x")),createBaseVNode("sub",null,toDisplayString(c+1),1),createTextVNode(" = "+toDisplayString(u)+"; ",1)]))),128))])):createCommentVNode("",!0)])):createCommentVNode("",!0)]))}}),MatrixSolver=_export_sfc(_sfc_main$4,[["__scopeId","data-v-0b3f2dd2"]]),routes=[{path:"/",alias:"/determinant",name:"Determinant calculator",component:DeterminantCalculator},{path:"/solver",name:"Matrix solver",component:MatrixSolver},{path:"/multiplier",name:"Matrix multiplier",component:MatrixMultiplier},{path:"/inverse",name:"Inverse matrix",component:MatrixInverse},{path:"/inverse-solver",name:"Inverse matrix solver",component:MatrixInverseSolver},{path:"/gauss-solver",name:"Gauss solver",component:MatrixGaussSolver},{path:"/eigenvector",name:"Matrix eigenvectors",component:EigenvectorFinder}],router=createRouter({history:createWebHashHistory(),routes}),_sfc_main$3=defineComponent({__name:"navbar-dropdown",setup(e){const t=ref(!1);function r(){t.value=!t.value}function n(s){var i;(i=s.sourceCapabilities)!=null&&i.firesTouchEvents||(t.value=!0)}return(s,i)=>(openBlock(),createElementBlock("nav",{class:normalizeClass({menuShown:t.value}),onMouseleave:i[0]||(i[0]=a=>t.value=!1),onClick:r,onMouseenter:n},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(routes),a=>(openBlock(),createBlock(NavbarElement,{key:a.path,route:a},null,8,["route"]))),128))],34))}}),NavbarDropdown=_export_sfc(_sfc_main$3,[["__scopeId","data-v-dd7a96c2"]]),_hoisted_1$1={class:"navbar"},_sfc_main$2=defineComponent({__name:"header-top",setup(e){return(t,r)=>(openBlock(),createElementBlock("header",null,[r[0]||(r[0]=createBaseVNode("div",{class:"logo"}," Matrix calculator ",-1)),createBaseVNode("div",_hoisted_1$1,[createVNode(NavbarDropdown)])]))}}),_sfc_main$1=defineComponent({__name:"theme-switch",setup(e){const t=useDark(),r=useToggle(t);return(n,s)=>(openBlock(),createElementBlock("button",{type:"button","aria-label":"Toggle dark mode",onClick:s[0]||(s[0]=i=>unref(r)())}))}}),ThemeSwitcher=_export_sfc(_sfc_main$1,[["__scopeId","data-v-7b31ee29"]]),_hoisted_1={class:"content"},_sfc_main=defineComponent({__name:"app",setup(e){return useDark({selector:"body",attribute:"class",valueDark:"dark",valueLight:"light"}),(t,r)=>{const n=resolveComponent("router-view");return openBlock(),createElementBlock(Fragment,null,[createVNode(_sfc_main$2),createBaseVNode("div",_hoisted_1,[createVNode(n)]),createVNode(ThemeSwitcher,{class:"theme-switcher"})],64)}}}),App=_export_sfc(_sfc_main,[["__scopeId","data-v-b90c05a4"]]),app=createApp(App);app.use(router);app.mount("#app");
